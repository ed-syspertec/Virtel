<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>How to activate and use the FTP File Transfer function of Virtel &mdash; Virtel 9 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Virtel
              <img src="../../_static/logo_virtel_web.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                4.61
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../virtel.html">Virtel Manuals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../newsletters.html">Technical Newsletters</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Virtel</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">How to activate and use the FTP File Transfer function of Virtel</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/newsletters/TN201905/TN201905.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="how-to-activate-and-use-the-ftp-file-transfer-function-of-virtel">
<span id="tn201905"></span><h1>How to activate and use the FTP File Transfer function of Virtel<a class="headerlink" href="#how-to-activate-and-use-the-ftp-file-transfer-function-of-virtel" title="Permalink to this heading"></a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h2>
<p>VIRTEL Web Access v4.59 introduces support for FTP file transfer. This function consists of the following elements:</p>
<ul class="simple">
<li><p>One or more templates that Virtel uses to generate FTP parameters. These can be configured by the Virtel administrator.</p></li>
<li><p>A Virtel scenario that generates the FTP parameter file, when the function is called via a button on the toolbar of from an option on the Virtel administration menu.</p></li>
<li><p>A Windows desktop script that executes the file transfer, using the FTP parameters that have been generated by Virtel.</p></li>
</ul>
<section id="how-does-it-work">
<h3>How does it work?<a class="headerlink" href="#how-does-it-work" title="Permalink to this heading"></a></h3>
<p>Virtel runs in a browser and as such does not provide direct FTP connection to the mainframe. The Virtel FTP function centralizes the FTP file transfer parameters, where they can be configured by the Virtel Administrator. When an end-user requests for an FTP transfer to be initiated, an FTP parameter file is downloaded to the browser default download directory. The file transfer can then be executed by calling a batch script on the user-s desktop, that will use the parameter file as an input.</p>
</section>
<section id="pre-requisites">
<h3>Pre-requisites<a class="headerlink" href="#pre-requisites" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>The user workstation must be able to run Microsoft’s ftp.exe program.</p></li>
<li><p>The user must be authorized to run batch (BAT) and Power shell scripts</p></li>
<li><p>The Virtel Entry point(s) must be defined to load scenarios from the SCE-DIR directory. This is normally the default.</p></li>
<li><p>A directory to keep the ancillary programs should be created on the users PC. This could be something like c:virtelftp. See Appendix A for me details on the ancillary post processing programs.</p></li>
</ul>
</section>
</section>
<section id="installing-and-configuring-the-ftp-function">
<h2>Installing and configuring the FTP function<a class="headerlink" href="#installing-and-configuring-the-ftp-function" title="Permalink to this heading"></a></h2>
<p>Download and apply the Virtel 4.59 UPDT5799 update from the Virtel FTP website. This should apply they latest maintenance to Virtel which includes the FTP feature.
Stop Virtel.
Add the following Virtel transactions: -</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>//INIARBO EXEC PGM=VIRCONF,PARM=LOAD
//STEPLIB  DD  DISP=SHR,DSN=SPTHOLT.VIRT459.LOADLIB
//SYSPRINT DD  SYSOUT=*
//VIRARBO  DD  DISP=SHR,DSN=SPTHOLT.VIRT459.ARBO
//SYSIN    DD  *
   TRANSACT ID=W2H-04E,                                             -
            NAME=FTPPARM,                                           -
            DESC=&#39;FTPPARM   &#39;,                                      -
            APPL=$NONE$,                                            -
            TYPE=2,                                                 -
            TERMINAL=DELOC,                                         -
            STARTUP=1,                                              -
            SECURITY=0,                                             -
            TIOASTA=&amp;/S,                                            -
            EXITSTA=FTPPARM
   TRANSACT ID=CLI-04E,                                             -
            NAME=FTPPARM,                                           -
            DESC=&#39;FTPPARM   &#39;,                                      -
            APPL=$NONE$,                                            -
            TYPE=2,                                                 -
            TERMINAL=CLLOC,                                         -
            STARTUP=1,                                              -
            SECURITY=0,                                             -
            TIOASTA=&amp;/S,                                            -
            EXITSTA=FTPPARM
</pre></div>
</div>
<p>The new transactions will provide the support for the FTP feature. The external/internal is FTPPARM</p>
<p><a class="reference internal" href="../../_images/image1267.png"><img alt="image1" src="../../_images/image1267.png" style="width: 16.0cm; height: 9.5cm;" /></a>
<em>FTP transaction definition for FTP file transfer</em></p>
<p>The FTPPARM scenario, FTPPARM.390, should be loaded up into the SCE directory. It is a part of the UPDT5799 update.</p>
<section id="defining-the-ftp-templates">
<h3>Defining the FTP templates<a class="headerlink" href="#defining-the-ftp-templates" title="Permalink to this heading"></a></h3>
<p>The FTP function provides default templates for Upload and Download FTP requests. These can be customized to your site specifications and then re-uploaded to the W2H-DIR directory.</p>
<p>Example: sendipnw.txt. (Send new file to target with IP address)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;!--VIRTEL start=&quot;{{{&quot; end=&quot;}}}&quot; --&gt;OPEN {{{CURRENT-VALUE-OF &quot;IPDSN&quot;}}}

USER {{{CURRENT-VALUE-OF &quot;USERFTP&quot;}}}

?      &lt;==== Optional Password Trigger!

{{{CURRENT-VALUE-OF &quot;TYPFTP&quot;}}}

quote site blksize={{{CURRENT-VALUE-OF &quot;BSZFTP&quot;}}} lrecl={{{CURRENT-VALUE-OF &quot;LRLFTP&quot;}}} recfm={{{CURRENT-VALUE-OF &quot;RFMFTP&quot;}}} {{{CURRENT-VALUE-OF &quot;SPCFTP&quot;}}} pri={{{CURRENT-VALUE-OF &quot;PRIFTP&quot;}}} sec={{{CURRENT-VALUE-OF &quot;SECFTP&quot;}}}

PUT {{{CURRENT-VALUE-OF &quot;LOCALFILEFTP&quot;}}} {{{CURRENT-VALUE-OF &quot;REMOTEFILEFTP&quot;}}}

QUIT
</pre></div>
</div>
<p>The third line of the template defines the optional user password character. If it is set to “?”, then the user will be prompted for a password when running the FTP PSVirtelFtp.ps1 script on the workstation.</p>
</section>
<section id="template-variables">
<h3>Template Variables<a class="headerlink" href="#template-variables" title="Permalink to this heading"></a></h3>
<p>The following variables can be used in the FTP templates:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{{</span><span class="n">CURRENT</span><span class="o">-</span><span class="n">VALUE</span><span class="o">-</span><span class="n">OF</span> <span class="s2">&quot;USERFTP&quot;</span><span class="p">}}}</span>     <span class="o">=</span> <span class="n">Screen</span> <span class="n">field</span> <span class="o">&lt;&lt;</span><span class="n">Userid</span><span class="o">--</span>
<span class="p">{{{</span><span class="n">CURRENT</span><span class="o">-</span><span class="n">VALUE</span><span class="o">-</span><span class="n">OF</span> <span class="s2">&quot;TYPFTP&quot;</span><span class="p">}}}</span>      <span class="o">=</span> <span class="n">Screen</span> <span class="n">field</span> <span class="o">--</span><span class="n">text</span> <span class="ow">or</span> <span class="n">Binary</span><span class="o">--</span><span class="p">,</span> <span class="n">value</span> <span class="o">--</span><span class="n">ASCII</span><span class="o">--</span> <span class="ow">or</span> <span class="o">--</span><span class="n">TYPE</span> <span class="n">I</span><span class="o">--</span>
<span class="p">{{{</span><span class="n">CURRENT</span><span class="o">-</span><span class="n">VALUE</span><span class="o">-</span><span class="n">OF</span> <span class="s2">&quot;TYPCHS&quot;</span><span class="p">}}}</span>      <span class="o">=</span> <span class="n">Screen</span> <span class="n">field</span> <span class="o">--</span><span class="n">Charset</span><span class="o">--</span>
<span class="p">{{{</span><span class="n">CURRENT</span><span class="o">-</span><span class="n">VALUE</span><span class="o">-</span><span class="n">OF</span> <span class="s2">&quot;REMOTEFILEFTP&quot;</span><span class="p">}}}</span>       <span class="o">=</span> <span class="n">Grouped</span> <span class="n">Screen</span> <span class="n">field</span> <span class="n">of</span>  <span class="o">-</span><span class="n">Path</span><span class="p">:</span><span class="o">--</span> <span class="ow">and</span> <span class="o">--</span><span class="n">File</span><span class="o">-</span><span class="p">:</span><span class="o">--</span> <span class="n">of</span> <span class="n">Section</span> <span class="o">--</span><span class="n">Host</span> <span class="n">File</span><span class="o">--</span>
<span class="p">{{{</span><span class="n">CURRENT</span><span class="o">-</span><span class="n">VALUE</span><span class="o">-</span><span class="n">OF</span> <span class="s2">&quot;LOCALFILEFTP&quot;</span><span class="p">}}}</span>        <span class="o">=</span> <span class="n">Grouped</span> <span class="n">Screen</span> <span class="n">field</span> <span class="o">-</span><span class="n">Path</span><span class="p">:</span><span class="o">--</span> <span class="ow">and</span> <span class="o">--</span><span class="n">File</span><span class="o">-</span><span class="p">:</span><span class="o">--</span> <span class="n">of</span> <span class="n">Section</span> <span class="o">--</span><span class="n">PC</span> <span class="n">File</span><span class="o">--</span>
<span class="p">{{{</span><span class="n">CURRENT</span><span class="o">-</span><span class="n">VALUE</span><span class="o">-</span><span class="n">OF</span> <span class="s2">&quot;IPDSN&quot;</span><span class="p">}}}</span>       <span class="o">=</span> <span class="n">Screen</span> <span class="n">field</span> <span class="o">--</span><span class="n">IUP</span><span class="o">/</span><span class="n">DNS</span><span class="o">--</span>
<span class="p">{{{</span><span class="n">CURRENT</span><span class="o">-</span><span class="n">VALUE</span><span class="o">-</span><span class="n">OF</span> <span class="s2">&quot;BSZFTP&quot;</span><span class="p">}}}</span>      <span class="o">=</span> <span class="n">Screen</span> <span class="n">field</span> <span class="o">--</span><span class="n">Blksize</span><span class="o">-</span>
<span class="p">{{{</span><span class="n">CURRENT</span><span class="o">-</span><span class="n">VALUE</span><span class="o">-</span><span class="n">OF</span> <span class="s2">&quot;LRLFTP&quot;</span><span class="p">}}}</span>      <span class="o">=</span> <span class="n">Screen</span> <span class="n">field</span> <span class="o">--</span><span class="n">Lrecl</span><span class="o">-</span>
<span class="p">{{{</span><span class="n">CURRENT</span><span class="o">-</span><span class="n">VALUE</span><span class="o">-</span><span class="n">OF</span> <span class="s2">&quot;RFMFTP&quot;</span><span class="p">}}}</span>      <span class="o">=</span> <span class="n">Screen</span> <span class="n">field</span> <span class="o">--</span><span class="n">Recfm</span><span class="o">-</span>
<span class="p">{{{</span><span class="n">CURRENT</span><span class="o">-</span><span class="n">VALUE</span><span class="o">-</span><span class="n">OF</span> <span class="s2">&quot;SPCFTP&quot;</span><span class="p">}}}</span>      <span class="o">=</span> <span class="n">Screen</span> <span class="n">field</span> <span class="o">--</span><span class="n">Space</span><span class="o">-</span>
<span class="p">{{{</span><span class="n">CURRENT</span><span class="o">-</span><span class="n">VALUE</span><span class="o">-</span><span class="n">OF</span> <span class="s2">&quot;PRIFTP&quot;</span><span class="p">}}}</span>      <span class="o">=</span> <span class="n">Screen</span> <span class="n">field</span> <span class="o">--</span><span class="n">Pri</span><span class="o">-</span>
<span class="p">{{{</span><span class="n">CURRENT</span><span class="o">-</span><span class="n">VALUE</span><span class="o">-</span><span class="n">OF</span> <span class="s2">&quot;SECFTP&quot;</span><span class="p">}}}</span>      <span class="o">=</span> <span class="n">Screen</span> <span class="n">field</span> <span class="o">--</span><span class="n">Sec</span><span class="o">-</span>
</pre></div>
</div>
</section>
<section id="defining-the-ftp-templates-for-the-action-listbox">
<h3>Defining the FTP templates for the action listbox.<a class="headerlink" href="#defining-the-ftp-templates-for-the-action-listbox" title="Permalink to this heading"></a></h3>
<p>Modify the supplied JavaScript file -dataftplist.js- source to populate the -Action- list box with your personal templates.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>// $Id: dataftplist.js ???? 2019-10-15 09:01:46 lepi $
var FTPLIST = new Array();

var alink = new Array();
alink[&quot;ftpvalue&quot;] = &quot;send&quot;;
alink[&quot;host&quot;] = &quot;T&quot;;
alink[&quot;ftpmsg&quot;] = &quot;Send ip 192.168.92.161&quot;;
FTPLIST[0] = alink;

var alink = new Array();
alink[&quot;ftpvalue&quot;] = &quot;sendip&quot;;
alink[&quot;host&quot;] = &quot;T&quot;;
alink[&quot;ftpmsg&quot;] = &quot;Send ip Target&quot;;
FTPLIST[1] = alink;
</pre></div>
</div>
</section>
<section id="activate-the-toolbar-icons-for-file-transfer">
<h3>Activate the Toolbar icons for file transfer<a class="headerlink" href="#activate-the-toolbar-icons-for-file-transfer" title="Permalink to this heading"></a></h3>
<p>A new icon for FTP parameter generation can be displayed on the VIRTEL Web Access toolbar via a setting in the user parameter settings dialog. When the settings Option “Show the toggle button for VirtelFtp” is checked, a blue FTP icon will appear, as shown below:</p>
<p><img alt="image2" src="../../_images/image2150.png" />
<em>VIRTEL Web Access toolbar for FTP file transfer</em></p>
</section>
<section id="installing-the-bat-files-shortcut-and-ancillary-programs">
<h3>Installing the bat files, shortcut and ancillary programs.<a class="headerlink" href="#installing-the-bat-files-shortcut-and-ancillary-programs" title="Permalink to this heading"></a></h3>
<p>Within the UPDT5799 update there is a zip file called ftpbat.zip. Unzip this to a directory on your workstation, for example c:VirtelFtp. These four files are used to initiate the FTP file transfer and maintain the FTP profiles in local browser storage. See Appendix A for details.</p>
<section id="set-up-a-shortcut-on-your-desktop">
<h4>Set up a shortcut on your desktop<a class="headerlink" href="#set-up-a-shortcut-on-your-desktop" title="Permalink to this heading"></a></h4>
<p>For ease of operation set up a shortcut on your directory, pointing to the .bat file in c:virtelftp. Once the FTP parameters have been built by Virtel FTP, clicking this shortcut will invoke the FTP file transfer.</p>
<p><img alt="image3" src="../../_images/image3140.png" /></p>
<p><em>Example of the desktop shortcut</em></p>
</section>
</section>
</section>
<section id="how-to-use-the-virtel-ftp-function">
<h2>How to use the Virtel FTP function<a class="headerlink" href="#how-to-use-the-virtel-ftp-function" title="Permalink to this heading"></a></h2>
<section id="sending-a-file">
<h3>Sending a file<a class="headerlink" href="#sending-a-file" title="Permalink to this heading"></a></h3>
<p>To send a file from your workstation to a target FTP site, click the FTP icon on the Virtel toolbar. The -VIRTEL FTP- dialog will open:</p>
<p><img alt="image4" src="../../_images/image4131.png" />
<em>VIRTEL FTP dialog (part 1)</em></p>
<ol class="arabic simple">
<li><p>Select –Send ip Target– in the action list box.</p></li>
<li><p>Specify the Username to be used for the FTP connection.-</p></li>
<li><p>In Section -PC File-</p></li>
<li><p>Specify the Local Path if necessary.</p></li>
<li><p>Specify the PC file name. You can also specify the pathname here or -</p></li>
<li><p>Drag And Drop a file onto the -Drag files from your directory path to here!– zone. This will populate the filename field.</p></li>
<li><p>Specify the Charset to be used for the FTP transfer. The default is Windows CP-1252</p></li>
<li><p>In Section -Host File-</p></li>
<li><p>Specify the Path (equal TSO dataset name or TSO PDS), surrounded by quotes if necessary. Dataset names without quotes will be prefixed by your TSO prefix (usually your userid).</p></li>
<li><p>Specify the File (equal TSO dataset name).</p></li>
<li><p>In sub-Section -FTP Options- in the -Host File- section</p></li>
<li><p>Choose either -Text- or -Binary-. -Text- translates the file from EBCDIC to ASCII and inserts carriage return line feed sequences (x-0D0A-) at the end of each record. -Binary- performs no translation.</p></li>
<li><p>In sub-Section -Host- in -Host File-</p></li>
<li><p>Select the target host type (TSO/UNIX/JES2) associated with the “Transfer Type” action. This will modify the actions to the selected type.</p></li>
<li><p>Finally click -Build- to generate the FTP parameter file.</p></li>
</ol>
<p>When the Generate Parameter is complete, the browser’s <em>VIRTEL FTP Save Parameter</em> dialog appears:</p>
<p><img alt="image5" src="../../_images/image5120.png" /></p>
<p><em>VIRTEL FTP receive dialog (part 2)</em></p>
<p>Click <strong>Save</strong>. The <em>Save As</em> dialog will open to allow you to specify the name and location of the destination file on your workstation:</p>
<p><img alt="image6" src="../../_images/image6123.png" /></p>
<p><em>VIRTEL FTP receive dialog (part 3)</em></p>
<p>Now select the destination file and click <strong>Save</strong>. If the file already exists, you will be prompted for permission to overwrite it. The <em>Download Complete</em> dialog appears when the file has been saved. Once the file has downloaded, run the PSVirtelFtp.bat procedure. This should be setup as a shortcut on your desktop.</p>
<p>If the password was defined by a”?” in the template, the following dialog will appear.</p>
<p><img alt="image7" src="../../_images/image7122.png" /></p>
<p>After entering the password, the transfer will be executed, and the following console log should be displayed.</p>
<p><img alt="image8" src="../../_images/image870.png" /></p>
<p>The last line of the execution report in the DOS windows provides information on the execution status.</p>
</section>
<section id="selecting-a-pc-codepage-for-ftp-file-transfer">
<h3>Selecting a PC Codepage for FTP file transfer<a class="headerlink" href="#selecting-a-pc-codepage-for-ftp-file-transfer" title="Permalink to this heading"></a></h3>
<p>Users can select a PC Codepage for FTP file transfer. Possible values are: -</p>
<ul class="simple">
<li><p>Windows (CP-1252)-: CP-1252 ASCII-EBCDIC translation table.</p></li>
<li><p>MS-DOS (CP-850)-: CP-850 ASCII-EBCDIC translation table.</p></li>
</ul>
<p>This depends on the value of the COUNTRY parameter specified in the VIRTCT. If this value is “FR”, “DE” or “BE”, system will use corresponding table FR-850, DE-850 or BE-850. If the specified country value is different, by default the BE-850 table will be used to support CECP 500 international EBCDIC.</p>
</section>
<section id="saving-and-reusing-ftp-file-transfer-parameters">
<h3>Saving and reusing FTP file transfer parameters<a class="headerlink" href="#saving-and-reusing-ftp-file-transfer-parameters" title="Permalink to this heading"></a></h3>
<p>Users who frequently use the same FTP file transfers can save the parameters for later reuse. To save a FTP file transfer, enter the dataset name and the type of transfer, and click the <strong>Save</strong> button: -</p>
<p><img alt="image9" src="../../_images/image989.png" /></p>
<p>VIRTEL FTP Receive dialog (saved transfers)</p>
<p>The user can then choose a name for the saved transfer and click “OK” to save the parameters. At the next transfer, the user clicks the name of the saved transfer to retrieve the parameters, then clicks “Generate Parameter” to start the generate.</p>
<p><img alt="image10" src="../../_images/image1060.png" /></p>
<p>VIRTEL FTP Saving the FTP file transfer parameters</p>
<p>Users can save transfer parameters for -Generate Parameter-. The parameters are saved in browser local storage. The number of sets of parameters which can be saved is limited only by the amount of local storage available.</p>
</section>
</section>
<section id="showing-hiding-ftp-file-transfer">
<h2>Showing / Hiding FTP File Transfer<a class="headerlink" href="#showing-hiding-ftp-file-transfer" title="Permalink to this heading"></a></h2>
<p>The administrator may wish to prevent users from accessing features like FTP File Transfer. This example shows how to hide the toolbar option by setting a parameter in the w2hparm.</p>
<p><img alt="image11" src="../../_images/image11105.png" /></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="o">*</span> <span class="nb">set</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">the</span> <span class="o">-</span><span class="n">Show</span> <span class="n">toggle</span> <span class="n">button</span> <span class="k">for</span> <span class="n">VirtelFtp</span><span class="o">-.</span>
<span class="o">*/</span>
<span class="n">w2hparm</span><span class="o">.</span><span class="n">showftp</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
</pre></div>
</div>
<p><em>Example w2hparm.js for hiding FTP File Transfer.</em></p>
<p>If the default value is used, users can show this function for their own usage by checking “Show the toggle button for VirtelFtp” in the Display tab of the settings panel.</p>
</section>
<section id="appendix-a">
<h2>Appendix A<a class="headerlink" href="#appendix-a" title="Permalink to this heading"></a></h2>
<p>The FTP feature interfaces with the client FTP program provided by Windows. The following four files must be installed into a Virtel FTP folder on your workstation. For example c:Virtelftp. The four files are available within the UPDT5799 update package.</p>
<p>Ancillary files used are used by Virtel FTP and may be customized by a user for their own site requirements.</p>
<ol class="arabic simple">
<li><p>Downloadftp.bat</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Test Batch FTP script.
:: $Id: downloadftp.bat 5228 2019-12-03 13:57:05Z riou $
::Script Batch de transfert ftp.exe avec fichier FTPPARAM.TXT
@echo off
set dateLog=%date:~6,4%%date:~3,2%%date:~0,2%
set h=%TIME:~0,2%
set m=%TIME:~3,2%
set s=%TIME:~6,2%
set timeLog=%h%_%m%_%s%
REM Launch FTP and pass it the  script
ftp -n -s:%HOMEDRIVE%%HomePath%\Downloads\FTPPARAM.txt &gt;%HOMEDRIVE%%HomePath%\Downloads\Log_Ftp_%dateLog%_%timeLog%.log
REM Delete params
rem del %HOMEDRIVE%%HomePath%\Downloads\FTPPARAM.txt
</pre></div>
</div>
<ol class="arabic simple">
<li><p><strong>VirtelFtp.ps1</strong> - Ancillary Power Shell script.</p></li>
<li><p><strong>VirtelFtp.vbs</strong> - Ancillary Visual Basic program.</p></li>
<li><p><strong>PSVirtelFtp.bat</strong> - Initial Bat file which triggers the FTP process.</p></li>
</ol>
<p>Should be defined as a short-cut on the desktop. Will process the FTPPARM.TXT file that has been created in the users -Download- directory. This file contains all the details of the FTP request built from the Virtel FTP screens. The file is used by the ancillary programs to initiate and perform the FTP operation. PSVirtelFtp.bat kicks off a power shell script VirtelFtp.ps1.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="n">off</span>
<span class="n">move</span> <span class="o">%</span><span class="n">USERPROFILE</span><span class="o">%</span>\<span class="n">Downloads</span>\<span class="n">ftpparam</span><span class="o">.</span><span class="n">txt</span> <span class="n">c</span><span class="p">:</span>\<span class="n">virtel</span>\<span class="n">ftp</span>
<span class="n">start</span> <span class="o">/</span><span class="n">W</span> <span class="o">/</span><span class="n">B</span> <span class="n">powershell</span> <span class="o">-</span><span class="n">file</span> <span class="n">VirtelFtp</span><span class="o">.</span><span class="n">ps1</span> <span class="o">%</span><span class="mi">1</span>
<span class="n">rem</span> <span class="k">del</span> <span class="o">%</span><span class="n">USERPROFILE</span><span class="o">%</span>\<span class="n">Downloads</span>\<span class="n">ftpparam</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</section>
<section id="appendix-b">
<h2>Appendix B<a class="headerlink" href="#appendix-b" title="Permalink to this heading"></a></h2>
</section>
<section id="debugging">
<h2>Debugging<a class="headerlink" href="#debugging" title="Permalink to this heading"></a></h2>
<p><strong>Power Shell authority</strong></p>
<p>Users may find that the following error message appears when invoking the Power Shell Script:-</p>
<p><img alt="image12" src="../../_images/image1268.png" /></p>
<p>This can be corrected by issuing the Windows command: <strong>Set-ExecutionPolicy Bypass</strong></p>
</section>
<section id="appendix-c">
<h2>Appendix C<a class="headerlink" href="#appendix-c" title="Permalink to this heading"></a></h2>
<section id="advanced-features">
<h3>Advanced Features<a class="headerlink" href="#advanced-features" title="Permalink to this heading"></a></h3>
<p>The UPDT5799 package ships with an electron directory which contains a Node JS electron program that can monitor the uses Download directory. When a FTPPARAM.TXT file arrives from the -browser- the batch file PSVirtelNodeFtp.bat is automatically invoked to perform the FTP transfer. This functionality removes the need for the user to manually trigger the FTP processes through a desktop shortcut.</p>
<p>To install this feature you must be familiar with Node JS, NPM and Electron web tools. This knowledge is outside the remit of this newsletter.</p>
<section id="installation">
<h4>Installation<a class="headerlink" href="#installation" title="Permalink to this heading"></a></h4>
<ol class="arabic simple">
<li><p>Copy the files in the electron directory to c:VirtelFtp.</p></li>
<li><p>Issue the command NPM INSTALL to created the Node JS/Electron environment.</p></li>
<li><p>Start the FTP Watcher program with the command -Node Main-.</p></li>
</ol>
<p>The watcher program will now start. Whenever a new -FTPPARAM.TXT- hits the download directory the FTP process will begin. Here is an example.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="p">:</span>\<span class="n">virtel</span>\<span class="n">ftp</span><span class="o">&gt;</span><span class="n">node</span> <span class="n">main</span>
<span class="n">Starting</span> <span class="n">FTP</span> <span class="n">Watcher</span> <span class="n">on</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">Holt</span>\<span class="n">Downloads</span>\

<span class="n">Processing</span> <span class="n">FTP</span> <span class="n">Request</span><span class="o">....</span>
<span class="n">VIRU099I</span> <span class="o">-</span> <span class="n">Batch</span> <span class="n">command</span> <span class="n">executed</span> <span class="k">for</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">Holt</span>\<span class="n">Downloads</span>\<span class="n">FTPPARAM</span><span class="o">.</span><span class="n">TXT</span>
<span class="n">c</span><span class="p">:</span>\<span class="n">virtel</span>\<span class="n">ftp</span><span class="o">&gt;</span><span class="n">echo</span> <span class="n">off</span>
<span class="n">Child</span> <span class="n">exited</span> <span class="k">with</span> <span class="n">code</span> <span class="mi">0</span>
</pre></div>
</div>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, Syspertec. All rights reserved.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>