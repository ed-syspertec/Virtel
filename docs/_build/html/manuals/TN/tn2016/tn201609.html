

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>tn201609 - Installing Virtel V4.56 from scratch &mdash; Virtel 1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="Virtel 1 documentation" href="../../../index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> Virtel
          

          
            
            <img src="../../../_static/logo_virtel_web.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docv456.html">Virtel documentation V4.56</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../other.html">Other documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index.html">Virtel</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Docs</a> &raquo;</li>
      
    <li>tn201609 - Installing Virtel V4.56 from scratch</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/manuals/TN/tn2016/tn201609.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tn201609-installing-virtel-v4-56-from-scratch">
<h1>tn201609 - Installing Virtel V4.56 from scratch<a class="headerlink" href="#tn201609-installing-virtel-v4-56-from-scratch" title="Permalink to this headline">¶</a></h1>
<p><strong>Cleaning up from a previous installation.</strong></p>
<p>If you want to delete all the files from a previous installation use the
following job:-:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">S00</span> <span class="n">EXEC</span> <span class="n">PGM</span><span class="o">=</span><span class="n">ADRDSSU</span><span class="p">,</span><span class="n">REGION</span><span class="o">=</span><span class="mi">0</span><span class="n">M</span>
<span class="o">//</span><span class="n">SYSPRINT</span> <span class="n">DD</span> <span class="n">SYSOUT</span><span class="o">=</span>\<span class="o">*</span>
<span class="o">//</span><span class="n">TEMP</span> <span class="n">DD</span> <span class="n">DUMMY</span>
<span class="n">DUMP</span> <span class="n">DATASET</span> <span class="o">-</span>
<span class="p">(</span><span class="n">INCLUDE</span><span class="p">(</span> <span class="o">-</span>
<span class="n">SPTHOLT</span><span class="o">.</span><span class="n">VIRT453</span><span class="o">.</span>\<span class="o">*</span>\<span class="o">*</span> <span class="o">-</span>
<span class="p">))</span> <span class="o">-</span>
<span class="n">DELETE</span> <span class="o">-</span>
<span class="n">PURGE</span> <span class="o">-</span>
<span class="n">TOL</span><span class="p">(</span><span class="n">ENQF</span><span class="p">)</span> <span class="o">-</span>
<span class="n">OUTDDNAME</span><span class="p">(</span><span class="n">TEMP</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Getting the software</strong></p>
<p>Download relevant files from the FTP server: <a class="reference external" href="http://ftp.syspertec.com">http://ftp.syspertec.com</a></p>
<p>/VIRTEL 4.53/Produits/virtel453mvs.zip</p>
<p>/VIRTEL 4.53/Produits/allptfs-mvs453.txt</p>
<p>/VIRTEL 4.53/Produits/virtel453updt5380.zip</p>
<p>Unzip “virtel453mvs.zip” into a folder on your workstation.</p>
<p>Print off the “install.txt” document.</p>
<p>Unzip “/VIRTEL 4.53/Produits/virtel453updt5380.zip” into a folder on
your workstation.</p>
<p>Print off the readme document.</p>
<p><strong>Installing the software</strong></p>
<ol class="arabic simple">
<li>Upload to the mainframe and edit the text file $alocdsu. Run it to
allocate a XMIT file.</li>
<li>Upload the XMIT file virt453.xmit to the file allocated by $alocdsu.</li>
<li>Upload to the mainframe and edit the text file $restdsu. Run it to
restore and install VIRTEL from the uploaded XMIT file.</li>
<li>Upload text file allptfs-mvs453.txt to
<em>yourqual.VIRT453.CNTL(PTF453MV).</em></li>
<li>Modify and run job <em>yourqual.VIRT453.CNTL(ZAPJCL)</em>. This will apply
maintenance to the VIRTEL load library.</li>
<li>Authorize the VIRTEL load library. Use the z/OS SETPROG APF command
- SETPROG APF,ADD,DSN=<em>yourqual.VIRT453.LOADLIB</em>,[VOL=volser |
SMS ]</li>
<li>Edit the VIRTEL TCT member <em>yourqual.VIRT453.CNTL(VIRTCT01</em>) and
assemble using <em>yourqual.VIRT453.CNTL(ASMTCT).</em> See note 6 of
“install.txt” for further information.</li>
<li>Edit <em>yourqual.VIRT453.CNTL(ARBOLOAD)</em> and submit the job. This
builds the default configuration and sample VTAMLST member. See note
8 of the “install.txt” for further information.</li>
<li>Copy <em>yourqual.VIRT453.CNTL(member)</em> to SYS1.VTAMLST. Member is
either VIRTAPPL, the default member name, or the VTAM applid
specified in the ARBOLOAD job on the NODEAPPL= statement. Activate
the “member” with the z/OS command V NET,ACT,ID=member.</li>
<li>Edit member <em>yourqual.VIRT453.CNTL(VIRTEL4)</em> and copy to
SYS1.PROCLIB as member VIRTEL. See notes 11,12 of the “install.txt”.</li>
<li>Start Virtel.</li>
</ol>
<p>Note: You can run VIRTEL as a JOB rather than a STC. This can be useful
during testing. See the JCL below for an example:-</p>
<p>//SPTHOLTV JOB 9000,&#8217;VIRTEL&#8217;,CLASS=A,MSGCLASS=X,NOTIFY=&amp;SYSUID</p>
<p>//VIRTEL PROC QUAL=SPTHOLT.VIRT453,</p>
<p>// TCT=01 = Change to 01</p>
<p>//*&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-*</p>
<p>//* PROCEDURE FOR VIRTEL STARTER EDITION *</p>
<p>//*&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-*</p>
<p>//VIRTEL EXEC PGM=VIR6000,TIME=1440,REGION=32M,PARM=&amp;TCT</p>
<p>//STEPLIB DD DSN=&amp;QUAL..LOADLIB,DISP=SHR</p>
<p>//DFHRPL DD DSN=&amp;QUAL..LOADLIB,DISP=SHR</p>
<p>//SERVLIB DD DSN=&amp;QUAL..SERVLIB,DISP=SHR</p>
<p>//VIRARBO DD DSN=&amp;QUAL..ARBO,DISP=SHR</p>
<p>//VIRSWAP DD DSN=&amp;QUAL..SWAP,DISP=SHR</p>
<p>//VIRHTML DD DSN=&amp;QUAL..HTML,DISP=SHR</p>
<p>//SAMPTRSF DD DSN=&amp;QUAL..SAMP.TRSF,DISP=SHR</p>
<p>//HTMLTRSF DD DSN=&amp;QUAL..HTML.TRSF,DISP=SHR</p>
<p>//SYSOUT DD SYSOUT=*</p>
<p>//VIRLOG DD SYSOUT=*</p>
<p>//VIRTRACE DD SYSOUT=*</p>
<p>//SYSPRINT DD SYSOUT=*</p>
<p>//SYSUDUMP DD SYSOUT=*</p>
<p>// PEND</p>
<p>//S01 EXEC VIRTEL</p>
<p>Once Virtel is started you now need to apply maintenance to the SAMPTRSF
file. This file contains all the related web elements used by VIRTEL.
Before doing so, just check that VIRTEL is running and has correctly
opened sessions to ports 41001 and 41002. Issue the following command:-</p>
<p>F VIRTEL,LINES</p>
<p>The output should be similar to:-</p>
<p>F VIRTEL,LINES</p>
<p>+VIR0200I LINES</p>
<p>+VIR0201I VIRTEL 4.53 APPLID=APPLHOLT LINES</p>
<p>+VIR0202I INT.NAME EXT.NAME TYPE ACB OR IP</p>
<p>+VIR0202I &#8212;&#8212;&#8211; &#8212;&#8212;&#8211; &#8212;&#8211; &#8212;&#8212;&#8212;</p>
<p>+VIR0202I C-HTTP HTTP-CLI TCP1 192.168.170.30:41002</p>
<p>+VIR0202I W-HTTP HTTP-W2H TCP1 192.168.170.30:41001</p>
<p>+VIR0202I &#8212;END OF LIST&#8212;</p>
<p>**
Applying maintenance to Virtel.**</p>
<p>Stop VIRTEL if it is running.</p>
<p><strong>ARBO Changes</strong></p>
<p>Upload the text files ARBOMACR and ARBOMIGR to yourqual.VIRT453.SAMPLIB.</p>
<p>Edit and run ARBOMACR and ARBOMIGR to apply maintenance to the ARBO file
in preparation for the TRSF maintenance. Change the following SET XXXX=
keywords in the JCL to reflect the relevant library names:-</p>
<p>// SET LOAD=yourqual.VIRT453.LOADLIB</p>
<p>// SET ARBO=yourqual.VIRT453.ARBO</p>
<p>ARBOMIGR adds the SCE-DIR (Scenario directory) for loading scenarios.</p>
<p>ARBOMACR turns on the new macro support.</p>
<p><strong>MACLIB changes</strong></p>
<p>Upload the text file VIRTERM to yourqual.VIRT453.MACLIB. Reassemble
TCT01 using <em>yourqual.VIRT453.CNTL(ASMTCT</em>).</p>
<p>Note: If the assembly fails because the at (&#64;) character has been
translated to a French accent à using codepage 1147 (French Euro) when
doing the file upload.</p>
<p>**
TRSF changes**</p>
<p>Start Virtel.</p>
<p>Using a Chrome Browser navigate to the Administration Virtel Portal
which can be accessed through port 41001. The Drag and Drop upload
feature is supported by Chrome and Firefox only.</p>
<p><a class="reference external" href="http://192.168.170.30:41001/">http://192.168.170.30:41001/</a></p>
<p>The following screen image should appear:-</p>
<p><a class="reference internal" href="../../../_images/image16.png"><img alt="image0" src="../../../_images/image16.png" style="width: 6.26806in; height: 3.90694in;" /></a></p>
<p>Figure Virtel Administration Portal</p>
<p>Select Drag and Drop Upload and login with your credentials. The Drag
and Drop Interface will be displayed.</p>
<p><a class="reference internal" href="../../../_images/image21.png"><img alt="image1" src="../../../_images/image21.png" style="width: 6.26806in; height: 3.89722in;" /></a></p>
<p>Figure Virtel Upload Interface</p>
<p>Keeping this browser window open, go to your desktop directory where you
unzipped the virtel453updt5380.zip file:-</p>
<p><a class="reference internal" href="../../../_images/image31.png"><img alt="image2" src="../../../_images/image31.png" style="width: 6.26806in; height: 1.67431in;" /></a></p>
<p>Open the sce directory and select all the files (CTRL-A). Drag this
selection across to the browser window and drop over the SCE-DIR ICON.
This should start an upload of all the files in the SCE directory on
your desktop into the SCE-DIR directory of the SAMP TRSF VSAM file.
There should be 4 files.</p>
<p><a class="reference internal" href="../../../_images/image41.png"><img alt="image3" src="../../../_images/image41.png" style="width: 6.26806in; height: 2.41667in;" /></a></p>
<p>Figure Uploading Files to Virtel</p>
<p>Repeat the exercise, but this time with the W2H directory, dragging the
83 elements into the W2H-DIR directory.</p>
<p>After all the elements have been uploaded into the TRSF VSAM file, press
CTRL-R in your browser to refresh the browser’s cache.</p>
<p><strong>Note:</strong> With some versions of Chrome there is a bug which prevents the
upload from starting. In this case:-</p>
<p>Close the browser.</p>
<p>Re-open a browser window and type in the following URL replacing the IP
stack address (192.168.170.30) with yours. The rest of the URL should be
the same. For example:-</p>
<p><a class="reference external" href="http://192.168.170.30:41001/SECURE/upload.htm+dirlist">http://192.168.170.30:41001/SECURE/upload.htm+dirlist</a></p>
<p>This will open the Drag and Drop interface Window. Continue to upload
the “w2h” and “sce” directories. Once these uploads have completed,
CTRL-R in the browser to refresh the browser’s cache. Close the browser
window and reopen the Virtel portal with the URL
<a class="reference external" href="http://192.168.170.30:41001/">http://192.168.170.30:41001/</a></p>
<p>The last thing to do is to modify the WEB2HOST entry point to use the
SCE-DIR. Stop VIRTEL and then run the following JCL:-</p>
<p>//*&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;*</p>
<p>//* *</p>
<p>//* ARBO MIGRATION. UPDATE ARBO TO CHANGE WEB2HOSTS *</p>
<p>//* *</p>
<p>//* Change Description Release *</p>
<p>//* UPDT5380 Change directory for WEB2HOST V453 *</p>
<p>//* *</p>
<p>//*&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;*</p>
<p>//*</p>
<p>// SET LOAD=yourqual.VIRTnnn.LOADLIB</p>
<p>// SET ARBO=yourqual.VIRTnnn.ARBO</p>
<p>//*</p>
<p>//CONFIG EXEC PGM=VIRCONF,PARM=&#8217;LOAD,REPL&#8217;,REGION=2M</p>
<p>//STEPLIB DD DSN=&amp;LOAD,DISP=SHR</p>
<p>//SYSPRINT DD SYSOUT=*</p>
<p>//SYSUDUMP DD SYSOUT=*</p>
<p>//VIRARBO DD DSN=&amp;ARBO,DISP=SHR</p>
<p>//SYSIN DD *</p>
<p>ENTRY ID=WEB2HOST, -</p>
<p>DESC=&#8217;HTTP entry point (SysperTec menu)&#8217;, -</p>
<p>TRANSACT=W2H, -</p>
<p>TIMEOUT=0720, -</p>
<p>ACTION=0, -</p>
<p>EMUL=HTML, -</p>
<p>SIGNON=VIR0020H, -</p>
<p>MENU=VIR0021A, -</p>
<p>IDENT=SCENLOGM, -</p>
<p>EXTCOLOR=E, -</p>
<p>SCENDIR=SCE-DIR</p>
<p>Start VIRTEL.</p>
<p>Virtel 4.53 maintenance is now complete.</p>
<p>**
Basic health test of Virtel**</p>
<p>From the Virtel Portal Page select “Other Applications”. An application
menu should appear with some default applications. Note that your list
may be different.</p>
<p><a class="reference internal" href="../../../_images/image51.png"><img alt="image4" src="../../../_images/image51.png" style="width: 6.26806in; height: 1.80556in;" /></a></p>
<p>Figure Virtel Application Menu (APPLIST)</p>
<p>Select any application that is flagged green. If no applications are
flagged green (available) then configure you ARBO and add applications
relevant to your site. See the <em>Virtel Connectivity Guide</em> for more
information.</p>
<p>This completes the Virtel 4.53 installation, now let’s look at some
simple configuration.</p>
<p><strong>Configuring Virtel with VIRCONF program.</strong></p>
<p>This section looks at how to perform some simple configuration tasks
using only the ARBO configuration statements and the VIRCONF program. Of
course Virtel has other ways in which the Virtel configuration can be
changed dynamically. For example you can logon to the Administration
Panels through your browser or VTAM direct. See the Virtel User Guide
for further information. In this section will focus on batch updates to
the ARBO configuration using the VIRCONF program. When doing any work
with VIRCONF Virtel must not be running.</p>
<p>The basic JCL for VIRCONG looks like this:-</p>
<p>//VIRCONF EXEC PGM=VIRCONF,PARM=something</p>
<p>//STEPLIB DD DSN=your.VIRTEL.LOADLIB,DISP=SHR</p>
<p>//SYSPRINT DD SYSOUT=*</p>
<p>//SYSUDUMP DD SYSOUT=*</p>
<p>//VIRARBO DD DSN=your.ARBO,DISP=SHR,AMP=(&#8216;RMODE31=NONE&#8217;)</p>
<p>//SYSPUNCH DD DSN=your.ARBO.CNTL,DISP=SHR</p>
<p>PARM = ‘<em>LOAD</em> | UNLOAD,</p>
<p>[REPL | <em>NOREPL,]</em></p>
<p>[LANG = <em>EN</em> | FR’]</p>
<p>First, let’s get an overview of Virtel of some of its terminology. As
delivered, when starting up Virtel 4.53 you should see two active
<strong>*LINES*</strong>. With Virtel running Issue the “<em>F VIRTEL,LINES</em>”
command.</p>
<p>F VIRTEL,LINES</p>
<p>+VIR0200I LINES</p>
<p>+VIR0201I VIRTEL 4.53 APPLID=APPLHOLT LINES</p>
<p>+VIR0202I INT.NAME EXT.NAME TYPE ACB OR IP</p>
<p>+VIR0202I &#8212;&#8212;&#8211; &#8212;&#8212;&#8211; &#8212;&#8211; &#8212;&#8212;&#8212;</p>
<p>+VIR0202I C-HTTP HTTP-CLI TCP1 192.168.170.30:41002</p>
<p>+VIR0202I W-HTTP HTTP-W2H TCP1 192.168.170.30:41001</p>
<p>+VIR0202I &#8212;END OF LIST&#8212;</p>
<p>These two <strong>*LINES*</strong> are related to two separate <strong>*DOMAINS*</strong> in
VIRTEL. Each line is opened with a unique <strong>*PORT*</strong> number which
identifies the Virtel domain. The default ports are 41001 and 41002.
Port 41001 is considered an Administration interface into the
<strong>*Web2Host (W2H) domain*.</strong> Port 41002 is the client interface into the
<strong>*Client*</strong> (<strong>*CLI) domain.*</strong></p>
<p>What’s in a domain? Well a domain is a container for related Virtel
transactions. For example, in the <strong>*W2H*</strong> domain you will find Virtel
Administration transactions plus a couple of VTAM applications, like
TSO. The <strong>*CLI*</strong> domain is where the majority of customer applications
are defined – things like production CICS, IMS and TSO applications.
Virtel listens on the IP ports 41001 and 41002 are these are associated
with <strong>*LINES*</strong> within Virtel. This information and other Virtel
configuration data is stored and maintained in the <strong>*ARBO*</strong> VSAM file.
The <strong>*ARBO VSAM*</strong> file is the main configuration file for VIRTEL. It
contains all the configuration information for Virtel elements like
<strong>*TERMINAL, ENTRY POINTS, LINES, TRANSACTION*</strong> and <strong>*RULE*</strong>
definitions amongst other things.</p>
<p><a class="reference internal" href="../../../_images/image61.jpg"><img alt="image5" src="../../../_images/image61.jpg" style="width: 6.26806in; height: 3.88611in;" /></a></p>
<p>Figure Lines and Domains</p>
<p>The VSAM ARBO configuration file can be unloaded through the VIRCONF
program. To unload a copy of the data held in the ARBO VSAM file run the
following ARBOUNLD job. You’ll need to stop Virtel first. The unload
will write out to the SYSPUNCH DD file and create a ARBO configuration
dadatset.</p>
<p>// SET ARBO=SP000.SPVIREH.ARBO = Your ARBO file</p>
<p>//*</p>
<p>//DEL EXEC PGM=IEFBR14</p>
<p>//DDA DD DSN=&amp;SYSUID..VIRCONF.TEST.SYSIN,DISP=(MOD,DELETE),</p>
<p>// UNIT=SYSDA,SPACE=(TRK,0)</p>
<p>//*</p>
<p>//UNLOAD EXEC PGM=VIRCONF,PARM=UNLOAD</p>
<p>//STEPLIB DD DSN=&amp;LOAD,DISP=SHR</p>
<p>//SYSPRINT DD SYSOUT=*</p>
<p>//SYSUDUMP DD SYSOUT=*</p>
<p>//VIRARBO DD DSN=&amp;ARBO,DISP=SHR,AMP=(&#8216;RMODE31=NONE&#8217;)</p>
<p>//SYSPUNCH DD DSN=&amp;SYSUID..VIRCONF.TEST.SYSIN,DISP=(,CATLG),</p>
<p>// UNIT=SYSDA,VOL=SER=SPT308,SPACE=(CYL,(5,1)),</p>
<p>// DCB=(RECFM=FB,LRECL=80,BLKSIZE=6080)</p>
<p>This file will be used through theis section to look at the
configuration elements that support Virtel.</p>
<p>Browse the dataset &amp;SYSUID..VIRCONF.TEST.SYSIN and look for the
<strong>*LINE*</strong> definitions.</p>
<p>**
LINE Definitions**</p>
<p>Here is the line definition for the CLI domain. The ID= keyword is an
internal Virtel, the NAME=key word is an external name; the name that is
displayed in Virtel Commands. The LOCADDR= identifies the port that is
associated with this Virtel Domain (CLI). By default it will take the IP
address from the TCPIP stack. If you are using a VIPA then you will need
to specify it here. So if my VIPA is 192.168.170.22 then the LOCADDR
definition should be changed to:-</p>
<p>LOCADDR=192.168.170.22:41002</p>
<p>LINE ID=C-HTTP,</p>
<p>NAME=HTTP-CLI,</p>
<p><a href="#id1"><span class="problematic" id="id2">**</span></a>LOCADDR=:41002, **</p>
<p>DESC=&#8217;HTTP line (entry point CLIWHOST)&#8217;,</p>
<p>TERMINAL=CL,</p>
<p><a href="#id3"><span class="problematic" id="id4">**</span></a>ENTRY=CLIWHOST, **</p>
<p>TYPE=TCP1,</p>
<p>INOUT=1,</p>
<p>PROTOCOL=VIRHTTP,</p>
<p>TIMEOUT=0000,</p>
<p>ACTION=0,</p>
<p>WINSZ=0000,</p>
<p>PKTSZ=0000,</p>
<p>RETRY=0010,</p>
<p>RULESET=C-HTTP</p>
<p>Note: Remember that if you are using a VIPA then you will have to change
the LINE LOCADDR= definitions for other lines which default to the TCPIP
stack. These lines can be identified as just having a port only
definition in the LOCADDR= keyword.</p>
<p>The next important definition to discuss is the ENTRY=keyword. The
defines a Virtel <strong>*ENTRY POINT*</strong></p>
<p><strong>ENTRY POINT Definitions</strong></p>
<p>An entry point is another container definition which contains all the
transactions associated with a particular domain. So for the W2H domain
I would have W2H transactions, the CLI domain CLI transactions. There is
always a default Entry Point associated with each line. This is
identified by the ENTRY= keyword on the LINE statement. From the ARBO
configuration file the ENTRY POINT looks like this:-</p>
<p>ENTRY <strong>ID=CLIWHOST,</strong> -</p>
<p>DESC=&#8217;HTTP entry point (CLIENT application)&#8217;, -</p>
<p><strong>TRANSACT=CLI,</strong> -</p>
<p>TIMEOUT=0015, -</p>
<p>ACTION=0, -</p>
<p>EMUL=HTML, -</p>
<p>SIGNON=VIR0020H, -</p>
<p>MENU=VIR0021A, -</p>
<p>IDENT=SCENLOGM, -</p>
<p>EXTCOLOR=E, -</p>
<p>SCENDIR=SCE-DIR</p>
<p>The salient keywords here are the ID= and the TRANSACT= keywords. The
ID= keyword defines that name of the entry point. If this is the default
entry point for the line then it will match the ENTRY= keyword. The
TRANSACT= keyword identifies the prefix, normally 3 characters, of all
the transactions that relate to this ENTRY POINT. So all transactions
that have an ID=CLI-something will be associated with his ENTRY POINT.
This ENTRY POINT is associated by default to a LINE, in this case the
LINE that is servicing PORT 41002, and that PORT defines the CLI domain.
So they sequence for a transaction looks like:-</p>
<p>URL -&gt; OSA -&gt; TCPIP -&gt; VIRTEL -&gt; LINE(PORT) -&gt; DOMAIN(W2H | CLI) -&gt;
ENTRY POINT -&gt; TRANSACTIONS -&gt; TRANSACTION.</p>
<p><a class="reference internal" href="../../../_images/image71.jpg"><img alt="image6" src="../../../_images/image71.jpg" style="width: 6.26806in; height: 4.07778in;" /></a></p>
<p>Figure Virtel Domains</p>
<p><strong>TRANSACTION Definitions</strong></p>
<p>As already stated transactions belong to a particular Virtel Entry Point
and are identified within the entry point by the keyword
TRANSACT=prefix. Here is a transaction definition from the ARBO
configuration file.</p>
<p>TRANSACT <strong>ID=W2H</strong>-00,</p>
<p><strong>NAME=WEB2HOST</strong>,</p>
<p>DESC=&#8217;Default directory = entry point name&#8217;,</p>
<p>APPL=W2H-DIR,</p>
<p>TYPE=4,</p>
<p>TERMINAL=DELOC,</p>
<p>STARTUP=2,</p>
<p>SECURITY=0</p>
<p>It belongs to the W2H administration domain because its ID= begins W2H.
This would tie up with the ENTRY POINT definition for W2H. That would
specify TRANSACT=W2H. Another thing to note is that the external name of
the transaction, as defined by the NAME= keyword, is the same as the
ENTRY POINT name it belongs to. There must be at least one transaction
which is the default transaction for the ENTRY POINT and this
transaction has the same name as the ENTRY POINT. This comes into play
when Virtel is searching for a transaction based upon the URL it has
received. If VIRTEL is presented with a URL <a class="reference external" href="http://192.168.0.1:410001">http://192.168.0.1:410001</a>
this doesn’t identify any particular transaction, therefore the default
transaction for the ENTRY POINT will be used. What the transaction does
is determined by the other keywords which we will cover later.</p>
<p>So to summarise, we have a line which identifies a Virtel domain through
its associated port number. The LINE is also associated with an Entry
Point, which in turns identifies a collection of transactions through a
prefix setting.</p>
<p>LINE:PORT</p>
<p>ENTRY POINT</p>
<p>TRANSACTIONS</p>
<p><strong>Transaction Type 1 – VTAM Applications</strong></p>
<p>If we look at the transactions in the default ARBO configuration we can
see that most are either Type 1, 2 or 4. Here were look at the type 1
transaction, a VTAM transaction. An example follows:-</p>
<p>TRANSACT ID=CLI-10,</p>
<p>NAME=&#8217;Cics&#8217;,</p>
<p>DESC=&#8217;Logon to CICS&#8217;,</p>
<p>APPL= DBDCCICS,</p>
<p>TYPE=1,</p>
<p>TERMINAL=CLVTA,</p>
<p>STARTUP=1,</p>
<p>SECURITY=1,</p>
<p>TIOASTA=&#8221;Signon&amp;/F&amp;*7D4EC9&amp;&#8216;114BE9&#8217;&amp;U&amp;&#8216;114CF9&#8217;&amp;P&amp;/A&#8221;</p>
<p>In this transaction we define a CICS application who’s APPLID is
DBDCCICS. The external name is CICS. So, the first question is how we
can invoke this application. There are several ways but we will look at
two methods. The first involves the default Entry Point transaction for
this domain’s Entry Point. We can see that this is a CLI transaction so
therefore it belongs to the CLI Entry Point which in turn is serviced by
the LINE that identifies the CLI domain with port 41002.</p>
<p>URL-&gt;LINE:41002-&gt;CLI DOMAIN-&gt;CLIHOST(EP - CLIWHOST)-&gt;CLIHOST TRANSACTION
(CLIWHOST)</p>
<p>If I fire the URL //<a class="reference external" href="HTTP:192.168.0.1:41002">HTTP:192.168.0.1:41002</a> to Virtel I should get
something like this:-</p>
<p><a class="reference internal" href="../../../_images/image81.png"><img alt="image7" src="../../../_images/image81.png" style="width: 6.01204in; height: 2.36458in;" /></a></p>
<p>Figure Default CLI Transaction - Menu List</p>
<p>Now, it is very unlikely you will see exactly the same colours against
these applications but nevertheless you should see the same Application
in the Menus because they are all defined as CLI Type 1 or Type 2
applications in the default ARBO. In my case I have two applications
which are “highlighted” green – IMS and Session manager. Now, if I
select IMS3270 Virtel will log me onto that application. The CICS
DBDCCICS application isn’t active so that’s why it is flagged RED.</p>
<p>We got here through the URL //<a class="reference external" href="HTTP:192.168.0.1:41002">HTTP:192.168.0.1:41002</a>. So how did that
happen? Well we know that the URL will fire the default transaction for
the Entry POINT CLIWHOST. That transaction is also called CLIWHOST, so
let’s take a look at that transaction:-</p>
<p>TRANSACT ID=CLI-00,</p>
<p>NAME=CLIWHOST,</p>
<p>DESC=&#8217;Default directory = entry point name&#8217;,</p>
<p>APPL=CLI-DIR,</p>
<p>TYPE=4,</p>
<p>TERMINAL=CLLOC,</p>
<p>STARTUP=2,</p>
<p>SECURITY=0,</p>
<p>TIOASTA=&#8217;/w2h/appmenu.htm+applist&#8217;</p>
<p>If you look at the URL in the screen shot you can see that the string
“/w2h/appmenu.htm+applist” has been added after the port 41002. This has
come from the CLIWHOST transaction. So the process is that default URL
has been amended to identify a particular Virtel transaction by
appending the string defined in the TIOASTA= keyword. That has caused
Virtel to run the appmenu transaction passing it a parameter of applist.</p>
<p>If we search the ARBO load for a transaction called APPLIST this is what
we find:-</p>
<p>TRANSACT ID=CLI-90,</p>
<p>NAME=&#8217;applist&#8217;,</p>
<p>DESC=&#8217;List of applications for appmenu.htm&#8217;,</p>
<p>APPL=VIR0021S,</p>
<p>TYPE=2,</p>
<p>TERMINAL=CLLOC,</p>
<p>STARTUP=2,</p>
<p>SECURITY=1</p>
<p>Well, again it’s a CLI transaction so it is part of our domain, and it’s
a Type=2. A type 2 transaction is a means of invoking a program
internally within Virtel. So when this transaction is called, through
the updated URL, then the program VIR0021S will run. What VIR0021S does
is to build the APPLICATION MENU page and go and test all the Type=1
VTAM transactions to determine if they are ACTIVE in VTAM. If they are
active a green flag is set otherwise it is red. Also, VIR0021S enables
you to access the active applications from this menu page. This is the
sequence:-</p>
<p>URL-&gt;LINE:41002-&gt;CLI DOMAIN-&gt;CLIHOST(EP - CLIWHOST)-&gt;CLIHOST TRANSACTION
(CLIWHOST) -&gt;</p>
<p>Build new URL -&gt; URL //<a class="reference external" href="HTTP:192.168.0.1:41002/w2h/appmenu.htm+applist">HTTP:192.168.0.1:41002/w2h/appmenu.htm+applist</a>&#8216;
-&gt;</p>
<p>CALLS APPLIST transaction -&gt;APPLIST-&gt;</p>
<p>APPLIST transaction will invoke internal program which will:-</p>
<p>TEST ALL VTAM APPLICATIONS (TYPE 1’s) and (TYPE 2’s) and build a HTML
template identifying ACTIVE (GREEN) and INACTIVE(RED) application status
for TYPE 1 VTAM applications. Template will be sent to the user’s
browser as a page.</p>
<p>Phew…</p>
<p>If you check the ARBO configuration you will see that in the CLI domain
there are only 5 Type 1 VTAM Transactions. This corresponds with the
Application Menu list.</p>
<p>The other method of invoking a transaction is through a full URL
reference that identifies the application through the URL. Here is an
example of accessing the IMS application through a URL</p>
<p><a href="#id5"><span class="problematic" id="id6">**</span></a><a class="reference external" href="http://192.168.0.1:41002/w2h/WEB2AJAX.htm+IMS">http://192.168.0.1:41002/w2h/WEB2AJAX.htm+IMS</a> **</p>
<p>We have appended some additional information after the port which will
enable Virtel to identify a transaction called IMS and attempt to logon
onto it as a VTAM application. The WEB2AJAX.HTM script kicks the process
off but the important thing from a VTAM application access is the suffix
of the application you want to log on to – in this case IMS. The +IMS
appended to the WEB2AJAX.htm is what Virtel requires. If we look for a
transaction called IMS in the ARBO configuration file we find the
following:-</p>
<p>TRANSACT ID=CLI-14,</p>
<p>NAME=&#8217;IMS&#8217;,</p>
<p>DESC=&#8217;Logon to IMS&#8217;,</p>
<p>APPL=IMS3270,</p>
<p>TYPE=1,</p>
<p>TERMINAL=CLVTA,</p>
<p>STARTUP=1,</p>
<p>SECURITY=1</p>
<p>So the sequence here is:-</p>
<p>URL-&gt;LINE:41002-&gt;CLI DOMAIN-&gt;CLIWHOST(EP - CLIWHOST)-&gt;CLI TRANSACTION
(IMS) -&gt;</p>
<p>Logon to applid=IMS3270 using Virtel terminals prefixed CLTVTA.</p>
<p>Now we haven’t discussed terminals yet, and they are pretty important in
the context of Virtel. We will come to those later, for now though it’s
good enough to understand that you can access an application using a
default URL which will bring up some Menu List or Administration Portal
in the case of the W2H 42001 port. Or, we can use a full URL to identify
a specific transaction in the domain that I want to execute. In the case
of VTAM applications it is usually:-</p>
<p><a class="reference external" href="http://192.168.0.1:41002/w2h/WEB2AJAX.htm+transaction">http://192.168.0.1:41002/w2h/WEB2AJAX.htm+transaction</a> where transaction
is a transaction defined to Virtel.</p>
<p>Question.</p>
<p>If I try <a class="reference external" href="http://192.168.0.1:41002/w2h/WEB2AJAX.htm+CICSA">http://192.168.0.1:41002/w2h/WEB2AJAX.htm+CICSA</a> it doesn’t
work. I get some messages on the browser that looks like:-</p>
<p><a class="reference internal" href="../../../_images/image91.png"><img alt="image8" src="../../../_images/image91.png" style="width: 3.61458in; height: 1.89181in;" /></a></p>
<p>Figure Transaction not found error</p>
<p>And in the z/OS console I can see the following messages:-</p>
<p>VIRHT51I HTTP-CLI CONNECTING CLLOC049 TO 192.168.092.047:50678</p>
<p>VIRC121E PAGE NOT FOUND FOR CLLOC049 ENTRY POINT &#8216;CLIWHOST&#8217; DIRECTORY &#8216;</p>
<p>176</p>
<p>CLIWHOST&#8217;(CLI-DIR CLI-KEY )</p>
<p>PAGE : &#8216;FAVICON.ICO&#8217; URL : &#8216;/favicon.ico&#8217;</p>
<p>VIR0052I CLLOC049 DISCONNECTED AFTER 0 MINUTES</p>
<p>VIRHT54E INVALID REQUEST ON HTTP-CLI ENTRY POINT &#8216;CLIWHOST&#8217; DIRECTORY &#8216;</p>
<p>178</p>
<p>W2H &#8216;</p>
<p>PAGE &#8216;WEB2AJAX.HTM&#8217; URL &#8216;/w2h/WEB2AJAX.htm+CICSA&#8217;</p>
<p>TRANSACTION &#8216;CICSA &#8216; CALLER 192.168.092.047:50678</p>
<p>rejected transaction :CICSA</p>
<p>VIRT922W HTTP-CLI SOCKET 00010000 ENDED FOR 192.168.092.047:50678</p>
<p>So whats happening here, well the browser has connected, message
VIRHT51I, Virtel is then looking for a “FAVICON.ICO” to place in the top
left corner of the web page. We can ignore this. The we see that Entry
Point CLIWHOST has been unable to find the Transaction CICSA. The
browser session is the closed – message VIRT922W.</p>
<p>That sort of all ties up as we haven’t defined the CICSA transaction to
Virtel so there is no way we can log on to CICSA. We need to define a
CICSA transaction which reflects the VTAM application that we are trying
to logon onto.</p>
<p><a href="#id7"><span class="problematic" id="id8">**</span></a>Defining a VTAM application to Virtel **</p>
<p>Using an existing CICS definition from the ARBO config we will define a
new CICS system. Here is our template taken from the ARBO config.</p>
<p>TRANSACT ID=CLI-10,</p>
<p>NAME=&#8217;Cics&#8217;,</p>
<p>DESC=&#8217;Logon to CICS&#8217;,</p>
<p>APPL=DBDCCICS,</p>
<p>TYPE=1,</p>
<p>TERMINAL=CLVTA,</p>
<p>STARTUP=1,</p>
<p>SECURITY=1</p>
<p>So, we modify it to look like this:-</p>
<p>TRANSACT ID=CLI-10A,</p>
<p>NAME=&#8217;CICSA&#8217;,</p>
<p>DESC=&#8217;Logon to CICSA&#8217;,</p>
<p>APPL=SPCICSQ,</p>
<p>TYPE=1,</p>
<p>TERMINAL=CLVTA,</p>
<p>STARTUP=1,</p>
<p>SECURITY=1</p>
<p>We have given the transaction a new transaction an internal ID of
CLI-10A. This should be unique. It is associated with the CLI domain so
will be accessible via the CLI port of 41002. The external name for this
application is CICSA. This is what will appear in the APPLICATION MENU.
Access to the application will be through the APPMENU if we do not use a
fully qualified URL to identify the transaction. The APPLID of the CICS
system is SPCICSQ. This is what we want Virtel to logon on to. The
terminals we are going to use to support this transaction are prefixed
CLVTA. We will discuss these terminal definitions later. The other
parameters will can leave as is. We add this to our ARBO config and
after the CLI-10 transaction.</p>
<p>Stop Virtel and the run an ARBO LOAD to load up the ARBO VSAM file. See
the JCL below:-</p>
<p>// SET LOAD=yourqual.VIRTnnn.LOADLIB</p>
<p>// SET ARBO=yourqual.VIRTnnn.ARBO</p>
<p>//LOAD EXEC PGM=VIRCONF,PARM=’LOAD,REPL’</p>
<p>//STEPLIB DD DSN=&amp;LOAD,DISP=SHR</p>
<p>//SYSPRINT DD SYSOUT=*</p>
<p>//SYSUDUMP DD SYSOUT=*</p>
<p>//VIRARBO DD DSN=&amp;ARBO,DISP=SHR,AMP=(&#8216;RMODE31=NONE&#8217;)</p>
<p>//SYSPUNCH DD DSN=&amp;SYSUID..VIRCONF.TEST.SYSIN,DISP=OLD</p>
<p>This will rebuild the ARBO VSAM file and add in the new CICS
application. If we start up Virtel now we should see the following
APPMENU list display. I’ve accessed this with just the port number in my
URL <a class="reference external" href="http://192.168.170.33:41002">http://192.168.170.33:41002</a>.</p>
<p><a class="reference internal" href="../../../_images/image101.png"><img alt="image9" src="../../../_images/image101.png" style="width: 6.26806in; height: 3.37708in;" /></a></p>
<p>Figure Updating the APPLIST menu</p>
<p>To directly access my CICS definition I could use the fully qualified
URL of :-</p>
<p><a class="reference external" href="http://192.168.170.33:41002/w2h/web2ajax.html+CICSA">http://192.168.170.33:41002/w2h/web2ajax.html+CICSA</a></p>
<p>Let’s try that and see if I can establish a session with CICS. Nope….I’m
taking straight back to the Virtel APPMENU. What’s in the VIRTEL log:-</p>
<p>19.24.11 JOB03882 VIRT906I HTTP-CLI SOCKET 00020000 CALL FROM
192.168.092.041:50751</p>
<p>19.24.11 JOB03882 VIRHT51I HTTP-CLI CONNECTING CLVTA079 TO
192.168.092.041:50734</p>
<p>19.24.11 JOB03882 VIR0919I CLVTA079 RELAY REHVT000(W2HTP000) ACTIVATED</p>
<p>19.24.11 JOB03882 VIR0919I CLVTA079 RELAY REHIM000(W2HIM000) ACTIVATED</p>
<p>19.24.11 JOB03882 VIR0915E CLVTA079(REHVT000) SESSION REQUEST REFUSED BY
SPCICSQ SENSE=08210000</p>
<p>19.24.11 JOB03882 VIR0052I CLVTA079 DISCONNECTED AFTER 0 MINUTES</p>
<p>19.24.11 JOB03882 VIR0918W W2HIM000 RELAY REHIM000 INACTIVATED</p>
<p>19.24.11 JOB03882 VIR0918W CLVTA079 RELAY REHVT000 INACTIVATED</p>
<p>19.24.11 JOB03882 VIRT922W HTTP-CLI SOCKET 00060000 ENDED FOR
192.168.092.041:50734</p>
<p>19.24.13 JOB03882 VIRHT51I HTTP-CLI CONNECTING CLLOC049 TO
192.168.092.041:50750</p>
<p>19.24.13 JOB03882 VIR0052I CLLOC049 DISCONNECTED AFTER 0 MINUTES</p>
<p>19.24.24 JOB03882 VIRT922W HTTP-CLI SOCKET 00020000 ENDED FOR
192.168.092.041:50751</p>
<p>I can see a call coming in from laptop, 192.168.092.41. Then some
activation messages with RELAY names and my session being refused
SPCICSQ. Let’s have a look in the CICS log:-</p>
<p>TNADDR DUMY,CSNE,19:24:11,192.168.92.41 50749</p>
<p>DFHZC6907 I 03/17/2016 19:24:11 SPCICSQ Autoinstall starting for netname
REHVT000. Network qualified name is SPNET.REHVT000.</p>
<p>DFHZC6908 I 03/17/2016 19:24:11 SPCICSQ Autoinstall in progress for
netname REHVT000. TN3270 IP address is 192.168.92.41 50734.</p>
<p>DFHZC6903 W 03/17/2016 19:24:11 SPCICSQ Autoinstall for terminal T000,
netname REHVT000 using model DFHLU2E2 failed.</p>
<p>DFHZC5983 E 03/17/2016 19:24:11 SPCICSQ Unable to replace T000</p>
<p>DFHZC6942 W 03/17/2016 19:24:11 SPCICSQ Autoinstall for terminal T000
failed.</p>
<p>DFHZC2411 E 03/17/2016 19:24:12 SPCICSQ DUMY CSNE REHVT000 attempted
invalid logon. ((7) Module name: DFHZATA)</p>
<p>NQNAME DUMY,CSNE,19:24:12,SPNET REHVT000</p>
<p>So I can see VIRTEL attempting to establish a session using a VTAM LU
name of REHVT000. That doesn’t exist in my CICS system so I will have
define it or use a different CICS system where it is defined. Virtel
requires that the RELAY LUNAME be defined to CICS as this name is
effectively representing a 3270 terminal within Virtel. Likewise, the
other relay name REHIM00, which was also activated as part of this
session set up, would also have to be defined. This LU represents a
printer which is associated with the terminal or relay REHVT000.</p>
<p>In my case, I stop Virtel, add some new ARBO transaction definition to
CICS systems that I know have the Virtel relay definitions defined. I
start up VIRTEL and access the APPMENU with URL
<a class="reference external" href="http://192.168.170.33:41002">http://192.168.170.33:41002</a></p>
<p><a class="reference internal" href="../../../_images/image111.png"><img alt="image10" src="../../../_images/image111.png" style="width: 6.26806in; height: 3.35486in;" /></a></p>
<p>Figure Additional applications added to the CLI domain</p>
<p>I select CICSH and hopefully can logon; yes indeed I can. In fact I can
open another browser window and logon to TSO1A.</p>
<p><a class="reference internal" href="../../../_images/image121.png"><img alt="image11" src="../../../_images/image121.png" style="width: 6.26806in; height: 3.54722in;" /></a></p>
<p>Figure CICS Session activation</p>
<p>So now my browser is acting like a session manager with each tab
representing a different session. Two to the mainframe, CICS and TSO,
and one Virtel APPMENU display. Using Virtel in place of a session
manager is worth considering as it provides you with similar
functionality as a session manager but at no cost.</p>
<p>Note: As I have mentioned the ARBO VSAM file contains all the
configuration data. This is upload through an ARBO load job which reads
in a configuration data set. The ARBO program has some peculiarities in
that if you specify PARM option of NOREPL than it will not replace any
configurations elements it already finds and returns with a condition
code 0. That’s all well and good but if your trying to update the ARBO
and replace elements that’s not so good. You’ll think the ARBO has been
updated when in fact it hasn’t. To replace elements change the NOREPL to
REPL. NOREPL is also a default so add REPL into the PARM if it is not
already there.</p>
<p>I tend to delete and reallocate my ARBO file and always use NOREPL in my
ARBO build. Here is my JCL:-</p>
<p>//* SAMPLE JOB TO ALLOC AN ARBO</p>
<p>//DEFINE EXEC PGM=IDCAMS</p>
<p>//SYSPRINT DD SYSOUT=*</p>
<p>DELETE (SPTHOLT.VIRT453.ARBO) CLUSTER PURGE</p>
<p>SET MAXCC = 0</p>
<p>DEFINE CLUSTER(NAME(SPTHOLT.VIRT453.ARBO) -</p>
<p>KEYS(9 0) RECSZ(100 4089) FSPC(10 10) -</p>
<p>VOL(SPT30E) REC(250,50) SHR(1) SPEED) -</p>
<p>DATA(NAME(SPTHOLT.VIRT453.ARBO.DATA) CISZ(4096)) -</p>
<p>INDEX(NAME(SPTHOLT.VIRT453.ARBO.INDEX))</p>
<p>Another thing, from time to time ARBO updates are issued as a part of
maintenance. Any updates should be incorporated in a “master ARBO
configuration file” so that when you rebuild your ARBO you don’t regress
any changes. Likewise, when adding transactions etc. make sure that you
update a master ARBO configuration file and always keep a previous
backup.</p>
<p><strong>Terminals definitions</strong></p>
<p>We have mention terminals throughout the document so far but have not
really looked into them in great detail. A terminal in Virtel represents
a task or function that virtel has to do. Several different types of
work will run under a terminal definition with Virtel. If you look at
the Virtel log you will see terminals being allocated and deallocated as
URLs are processed – dealing with session connection, disconnection etc.
Terminals also have a counterpart which is related to VTAM units of
work, for example a CICS session. These related terminals are known as
relay terminals and are only ever used when a VTAM transaction is
involved. You defined some relay definitions in VTAM. By default they
began RHTVT***, RHTIM*** and RHTIP****. The IM and IP group
relays are terminals to support SCS and 3270 printers. Printer terminals
are associated with a screen terminal (RHTVT***).</p>
<p>Let’s take a look at the terminal definitions that are delivered with
the base Virtel product. We can do in in one of three ways:-</p>
<ol class="arabic simple">
<li>Logon to Virtel Administration through its VTAM interface.</li>
<li>Access the 3270 Administration through a browser</li>
<li>Access the HTML GUI Administration interface through a browser.</li>
</ol>
<p>I go for option 2, we will user the browser to access the Administration
panels. Start up Virtel and access the W2H domain using just the port
number in the URL.</p>
<p><a class="reference external" href="http://192.168.0.1:41001">http://192.168.0.1:41001</a></p>
<p>You should get a screen that looks like this:-</p>
<p><a class="reference internal" href="../../../_images/image131.png"><img alt="image12" src="../../../_images/image131.png" style="width: 6.26806in; height: 3.31736in;" /></a></p>
<p>Figure Virtel W2H Administration Portal</p>
<p>Select Admin(3270).That will take you to the 3270 administration pages.
The first page displayed should be the configuration menu :-</p>
<p><a class="reference internal" href="../../../_images/image141.png"><img alt="image13" src="../../../_images/image141.png" style="width: 6.26806in; height: 3.85000in;" /></a></p>
<p>Figure Virtel Configuration Display</p>
<p>Select PF2 to display the default terminal setup.</p>
<p><a class="reference internal" href="../../../_images/image151.png"><img alt="image14" src="../../../_images/image151.png" style="width: 6.26806in; height: 4.02500in;" /></a></p>
<p>So from the top down we have:-</p>
<p>CLLOC000 – CLLOC050 terminals defined for use in the CLI domain. Note
the CL prefix. This ties up with the TERMINAL= on the LINE definition.
We also have a group of 80 terminals (Repeated field) with have been
allocated a starting prefix of CLIVTA. This would tie up with the
transaction definitions and the TERMINAL= keyword. Whats interesting
about this group of terminals is that they have been allocated a pool
relay as defined by the *poolname option in the relay column. So a
relay pool is where VIRTEL can grab a relay terminal when it wants iy
and return it to the pool when it has finished with it. This happens
during session initiation with a CICS system – a relay terminal is
grabbed, used for the CICS session and then when the user logs off it
relay terminal is released back to the pool.</p>
<p>We can see that there are two distinct groups that use the relay pool;
the terminals beginning CLVTA(CLI Domain) and another group, DEVTA. This
group belongs to the W2H domain. So, any VTAM transactions defined in
the administration domain can use the same pool as the CLI domain.</p>
<p>The pool name used by default is *W2HPOOL. The POOL has 80 terminals
defined beginning W2HTP. These terminals have an associated relay
terminal prefixed REHVT which in turn has a second relay, normally a
printer, beginning REHIM***.</p>
<p>If we look at our previous CICS failure we can see these terminals being
allocated and returned to the pool.</p>
<p>19.24.11 JOB03882 VIRT906I HTTP-CLI SOCKET 00020000 CALL FROM
192.168.092.041:50751</p>
<p>19.24.11 JOB03882 VIRHT51I HTTP-CLI CONNECTING <strong>CLVTA079</strong> TO
192.168.092.041:50734</p>
<p>19.24.11 JOB03882 VIR0919I <strong>CLVTA079</strong> <strong>RELAY REHVT000(W2HTP000)
ACTIVATED</strong></p>
<p>19.24.11 JOB03882 VIR0919I <strong>CLVTA079</strong> <strong>RELAY REHIM000(W2HIM000)
ACTIVATED</strong></p>
<p>19.24.11 JOB03882 VIR0915E <strong>CLVTA079</strong>(REHVT000) SESSION REQUEST
REFUSED BY SPCICSQ SENSE=08210000</p>
<p>19.24.11 JOB03882 VIR0052I <strong>CLVTA079</strong> DISCONNECTED AFTER 0 MINUTES</p>
<p>19.24.11 JOB03882 VIR0918W <strong>W2HIM000 RELAY REHIM000</strong> INACTIVATED</p>
<p>19.24.11 JOB03882 VIR0918W <strong>CLVTA079</strong> <strong>RELAY REHVT000</strong> INACTIVATED</p>
<p>19.24.11 JOB03882 VIRT922W HTTP-CLI SOCKET 00060000 ENDED FOR
192.168.092.041:50734</p>
<p>The terminal types and I/O fields are described in the Virtel
Connectivity Guide. If we look in the ARBO configuration file we can see
the definitions that support the TERMINAL configuration.</p>
<p>TERMINAL ID=CLLOC000, -</p>
<p>DESC=&#8217;HTTP terminals (no relay)&#8217;, -</p>
<p>TYPE=3, -</p>
<p>COMPRESS=2, -</p>
<p>INOUT=3, -</p>
<p>STATS=26, -</p>
<p>REPEAT=0050</p>
<p>TERMINAL ID=CLVTA000, -</p>
<p>RELAY=*W2HPOOL, -</p>
<p>DESC=&#8217;HTTP terminals (with relay)&#8217;, -</p>
<p>TYPE=3, -</p>
<p>COMPRESS=2, -</p>
<p>INOUT=3, -</p>
<p>STATS=26, -</p>
<p>REPEAT=0080</p>
<p>TERMINAL ID=W2HTP000, -</p>
<p>RELAY=RHTVT000, -</p>
<p>POOL=*W2HPOOL, -</p>
<p>DESC=&#8217;Relay pool for HTTP&#8217;, -</p>
<p>RELAY2=RHTIM000, -</p>
<p>TYPE=3, -</p>
<p>COMPRESS=2, -</p>
<p>INOUT=3, -</p>
<p>STATS=26, -</p>
<p>REPEAT=0080</p>
<p><a class="reference internal" href="../../../_images/image161.jpg"><img alt="image15" src="../../../_images/image161.jpg" style="width: 6.26806in; height: 4.17847in;" /></a></p>
<p>Figure Terminal Overview</p>
<p>Close the terminal screen by pressing PF3 the RETURN/ENTER key. You
should be back to the Administration Portal.</p>
<p>**
Adding a terminal definition pool**</p>
<p>Most Virtel users have large CICS or IMS environments that need to be
supported by Virtel. In order to do this we need to add terminal
definitions that will support thousands of users. In this section will
add a new terminal pool to our CLI domain capable of supporting up to
1000 concurrent users accessing a CICS application known as CICSPROD. We
also introduce the RULE statement to show how we can separate traffic by
IP address. Let’s look at a schematic.</p>
<p><a class="reference internal" href="../../../_images/image171.jpg"><img alt="image16" src="../../../_images/image171.jpg" style="width: 6.26806in; height: 5.39583in;" /></a></p>
<p>Figure Adding a new terminal pool</p>
<p>Our requirement is that any user coming in on port 192.0.2.*** or
192.0.3.*** should be routed to a particular entry point. Within this
entry point, the only VTAM transaction defined is PRODCICS. This VTAM
transaction uses a terminals prefix CLFD. The CLFD terminals pull a VTAM
relay from the *FWDPOOL through terminal W2HD****. The VTAM relay
is prefix TNCS****. This prefix will corresponds to the VTAM
definitions and to the CICS terminal definitions.</p>
<p>Here is the ARBOLOAD definitions that supports this requirement.</p>
<p>TERMINAL ID=W2HD0000, -</p>
<p>RELAY=TNCD0000, -</p>
<p>POOL<strong>=*FWDPOOL</strong>, -</p>
<p>DESC=&#8217;Relay pool for FWD W2H&#8217;, -</p>
<p>TYPE=3, -</p>
<p>COMPRESS=2, -</p>
<p>INOUT=3, -</p>
<p>STATS=26, -</p>
<p>REPEAT=1000</p>
<p>TERMINAL ID=<strong>CLFD</strong>0000,</p>
<p>RELAY<strong>=*FWDPOOL</strong>,</p>
<p>DESC=&#8217;HTTP terminals (with relay)&#8217;,</p>
<p>TYPE=3,</p>
<p>COMPRESS=2,</p>
<p>INOUT=3,</p>
<p>STATS=26,</p>
<p>REPEAT=1000</p>
<p>ENTRY ID=CLIWFWD1, -</p>
<p>DESC=&#8217;HTTP entry point (FWD Test)&#8217;, -</p>
<p><strong>TRANSACT=FWD</strong>, -</p>
<p>TIMEOUT=0001, -</p>
<p>ACTION=0, -</p>
<p>EMUL=HTML, -</p>
<p>SIGNON=VIR0020H, -</p>
<p>MENU=VIR0021A, -</p>
<p>IDENT=SCENLOGM, -</p>
<p>EXTCOLOR=E</p>
<p>TRANSACT ID=<strong>FWD</strong>-00, -</p>
<p>NAME=CLIWFWD1, -</p>
<p>DESC=&#8217;Default directory = CLIWFWD1&#8217;, -</p>
<p>APPL=CLI-DIR, -</p>
<p>PASSTCKT=0, -</p>
<p>TYPE=4, -</p>
<p>TERMINAL=CLLC, -</p>
<p>STARTUP=2, -</p>
<p>SECURITY=0, -</p>
<p>TIOASTA=&#8217;/w2h/appmenu.htm+applist&#8217;</p>
<p>TRANSACT ID=<strong>FWD</strong>-03W, -</p>
<p>NAME=&#8217;w2h&#8217;, -</p>
<p>DESC=&#8217;W2H toolkit directory (/w2h)&#8217;, -</p>
<p>APPL=W2H-DIR, -</p>
<p>PASSTCKT=0, -</p>
<p>TYPE=4, -</p>
<p>TERMINAL=CLLC, -</p>
<p>STARTUP=2, -</p>
<p>SECURITY=0</p>
<p>TRANSACT ID=<strong>FWD</strong>-11, -</p>
<p>NAME=CICSPROD, -</p>
<p>DESC=&#8217;Logon to CICSPROD using TNCD**** LUs&#8217;, -</p>
<p>APPL=TSO, -</p>
<p>PASSTCKT=0, -</p>
<p>TYPE=1, -</p>
<p>TERMINAL=<strong>CLFD</strong>, -</p>
<p>STARTUP=1, -</p>
<p>SECURITY=1</p>
<p>TRANSACT ID=<strong>FWD</strong>-90, -</p>
<p>NAME=&#8217;applist&#8217;, -</p>
<p>DESC=&#8217;Application list&#8217;, -</p>
<p>APPL=VIR0021S, -</p>
<p>PASSTCKT=0, -</p>
<p>TYPE=2, -</p>
<p>TERMINAL=CLLC, -</p>
<p>STARTUP=2, -</p>
<p>SECURITY=1</p>
<p>RULE ID=C100FWD1,</p>
<p>RULESET=C-HTTP,</p>
<p>STATUS=ACTIVE,</p>
<p>DESC=&#8217;FWD Rule 1&#8217;,</p>
<p>ENTRY=CLIWFWD1,</p>
<p>IPADDR=(EQUAL,192.0.3.000),</p>
<p>NETMASK=255.255.255.000</p>
<p>RULE ID=C100FWD2,</p>
<p>RULESET=C-HTTP,</p>
<p>STATUS=ACTIVE,</p>
<p>DESC=&#8217;FWD Rule 2&#8217;,</p>
<p>ENTRY=CLIWFWD1,</p>
<p>IPADDR=(EQUAL,192.0.2.000),</p>
<p>NETMASK=255.255.255.000</p>
<p>You will notice that the two rules, defined as C100FWD1 and C100FWD2
control the Entry point selection by comparing the incoming callers IP
address. If the IP address matches then the call will be routed towards
Entry Point CLIWFWD1. There are also some Administration transaction
that have been added to support administration functions within the
Entry Point. These are:-</p>
<p>FWD-00 Entry Point Transaction. Identifies our default domain directory
CLI-DIR</p>
<p>FWD-03W Identifies the Administration directory and provides a link to
it.</p>
<p>FWD-11 CICSPROD transaction. Type=1 (VTAM Application).</p>
<p>FWD-90 APPLIST MENU transaction</p>
<p>That’s enough about terminals for the moment.</p>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Syspertec. All rights reserved.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>