

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Building a customized USSTAB using Virtel’s Web Access facility &mdash; Virtel 7 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="Virtel 7 documentation" href="../../../index.html"/>
        <link rel="up" title="Technical Newsletters" href="../../../newsletters.html"/>
        <link rel="next" title="Sharing user macros across multiple instances of Virtel" href="../TN201412/TN201412.html"/>
        <link rel="prev" title="Taking a VTAM trace" href="../TN201410/TN201410.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> Virtel
          

          
            
            <img src="../../../_static/logo_virtel_web.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                4.57
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../virtel.html">Virtel Manuals</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../newsletters.html">Technical Newsletters</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../newsletters.html#id1">2014</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../TN201406/TN201406.html">Taking a VIRTEL terminal trace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201407/TN201407.html">Pass tickets and supporting Proxy Servers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201409/TN201409.html">Mainframe printing with Virtel 4.56</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201410/TN201410.html">Taking a VTAM trace</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Building a customized USSTAB using Virtel’s Web Access facility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201412/TN201412.html">Sharing user macros across multiple instances of Virtel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201413/TN201413.html">Overview of a Virtel Session</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201414/TN201414.html">CICS Printing problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201415/TN201415.html">Virtel JES Writer program</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201416/TN201416.html">Virtel Security. Using server and client certificates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201417/TN201417.html">RACF Grouping Class and Virtel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201419/TN201419.html">Maintaining TRSF file sets</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../newsletters.html#id2">2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../newsletters.html#id3">2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../newsletters.html#id4">2017</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../newsletters.html#id5">2018</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../TN201406/TN201406.html">Taking a VIRTEL terminal trace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201407/TN201407.html">Pass tickets and supporting Proxy Servers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201409/TN201409.html">Mainframe printing with Virtel 4.56</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201410/TN201410.html">Taking a VTAM trace</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Building a customized USSTAB using Virtel’s Web Access facility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201412/TN201412.html">Sharing user macros across multiple instances of Virtel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201413/TN201413.html">Overview of a Virtel Session</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201414/TN201414.html">CICS Printing problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201415/TN201415.html">Virtel JES Writer program</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201416/TN201416.html">Virtel Security. Using server and client certificates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201417/TN201417.html">RACF Grouping Class and Virtel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201419/TN201419.html">Maintaining TRSF file sets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201501/TN201501.html">Dynamic Directory Interface (DDI)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201504/TN201504.html">Running multiple instances of Virtel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201505/TN201505.html">Virtel Macros in Virtel 4.53</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201506/TN201506.html">An example of using web services with Virtel Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201507/TN201507.html">Customising Virtel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201515/TN201515.html">Using Virtel as a Secure Single Access Control Point</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201517/TN201517.html">Virtel Chinese Character Language Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201519/TN201519.html">Processing the VTAM USS MSG10 buffer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201520/TN201520.html">Using the IBM System Logger with Virtel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201522/TN201522.html">What’s new in Virtel 4.55</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201601/TN201601.html">Customizing colours with CSS in Virtel 4.53</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201602/TN201602.html">Installing Virtel V4.53 from scratch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201603/TN201603.html">Field Level Encryption</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201604/TN201604.html">Controlling LU Names</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201605/TN201605.html">CICS Printing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201606/TN201606.html">Virtel Screen Redesigner in action</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201607/TN201607.html">What’s new in Virtel 4.56 (September 2016)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201608/TN201608.html">Installing Virtel V4.56 from scratch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201609/TN201609.html">Nailing LUS with an Identification scenario</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201611/TN201611.html">Customizing Virtel in V4.56</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201701/TN201701.html">Protecting business assets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201702/TN201702.html">Protecting Virtel Applications with Shibboleth</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201703/TN201703.html">Passticket support with CA Top Secret</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201704/TN201704.html">Virtel Macros</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201705/TN201705     .html">Printing PCL files with NodeJS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201706/TN201706     .html">What’s new in Virtel 4.57 (July 2017)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201709/TN201709.html">Virtel Batch Maintenance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201801/TN201801.html">What’s new in Virtel 4.58 (Sept. 2018)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201802/TN201802.html">What’s new in Virtel 4.58 (Sept. 2018)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../howto.html">Miscellaneous</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Virtel</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../newsletters.html">Technical Newsletters</a> &raquo;</li>
        
      <li>Building a customized USSTAB using Virtel’s Web Access facility</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/manuals/newsletters/TN201411/TN201411.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="building-a-customized-usstab-using-virtels-web-access-facility">
<span id="tn201411"></span><h1>Building a customized USSTAB using Virtel’s Web Access facility<a class="headerlink" href="#building-a-customized-usstab-using-virtels-web-access-facility" title="Permalink to this headline">¶</a></h1>
<p>This technical newsletter describes how to build a VTAM USSTAB
equivalent using Web Access facility. The process will cover:-</p>
<ul class="simple">
<li>Modifying the tool bar.</li>
<li>Setting the correct fonts and keys.</li>
<li>Building a template to act as the USSTAB screen.</li>
</ul>
<p>All of these modifications are customised Java Script and HTML modules
which will be kept in the default directory for the relevant Entry
Point. In this sample the entry point EDSHOST is used. Here is what it
looks like:-</p>
<p><a class="reference internal" href="../../../_images/image13.jpeg"><img alt="screen1" src="../../../_images/image13.jpeg" style="width: 6.29167in; height: 5.52083in;" /></a></p>
<p>Fig. 1 – Entry Point detail</p>
<p>The entry point is associated with the line definition E-HTTP which
looks like the following:-</p>
<p><a class="reference internal" href="../../../_images/image21.jpeg"><img alt="screen2" src="../../../_images/image21.jpeg" style="width: 6.29167in; height: 5.52083in;" /></a></p>
<p>Fig. 2 – Line detail</p>
<p>The line and Entry Point combination will use the default transaction
which can be found in the Entry Points transaction list. PF4 from the
Entry Point display. In our case we default to the Entry Point name and
therefore have set up a transaction called EDSHOST.</p>
<p>The default transaction EDSHOST associated with the EDSHOST entry point
will identify our default directory, EDS-DIR, where modifications will
be uploaded to. The detail for the default transaction looks like:-</p>
<p><a class="reference internal" href="../../../_images/image31.jpeg"><img alt="screen3" src="../../../_images/image31.jpeg" style="width: 6.29167in; height: 5.52083in;" /></a></p>
<p>Fig. 3 – Default transaction EDSHOST</p>
<p><strong>USSTAB template USSWSYSP</strong></p>
<p>Template pages are the means by which VIRTEL presents host application
data. In the customized USSTAB template called USSWSYSP, the template
will simulate 3270 controls and actions through Java Script and HTML
programming. Features like AJAX will also be employed in the background
to maintain HTTP session state, however, those features will not be
discussed in this newsletter.</p>
<p>So to start with, this is the end result of our template customization
and what the user will see when accessing the mainframe via the USSWSYSP
template.</p>
<p><a class="reference internal" href="../../../_images/image42.jpeg"><img alt="screen4" src="../../../_images/image42.jpeg" style="width: 6.29167in; height: 5.52083in;" /></a></p>
<p>Fig. 4 – The template USSWSYSP display</p>
<p>The URL for this template is
<em>line_ip_address:line_port/entrypoint/:</em>USSWSYSP.HTML which in our
case is 192.168.170.30:41003/EDSHOST/USSWSYSP.HTML. It looks very
similar to what a VTAM USSTAB might produce. Notice that there is a tool
bar on top with some functions and a cursor/row counter in the bottom
right corner. To use the template, the user simply types in the name of
an application in line 2, where the cursor is positioned. For example,
typing in TSO and pressing enter will establish a TSO session from this
template. If ENTER is pressed with no value on line 2 or any other key
other than ENTER is used than an error message will be displayed.</p>
<p><a class="reference internal" href="../../../_images/image52.jpeg"><img alt="screen5" src="../../../_images/image52.jpeg" style="width: 6.29167in; height: 5.52083in;" /></a></p>
<p>Fig. 5 – Error message displayed as a result of pressing PFK9.</p>
<p>So to access an application the VTAM application name is entered. Here
we enter TSO on line 2 and press ENTER.</p>
<p><a class="reference internal" href="../../../_images/image62.jpeg"><img alt="screen6" src="../../../_images/image62.jpeg" style="width: 6.29167in; height: 5.52083in;" /></a></p>
<p>Fig. 6 – Establishing a TSO session</p>
<p>After pressing enter a TSO logon panel will be presented. Note that the
cursor/row display in the bottom right will update as data is typed into
the line 2 row - just as you would expect from a 3270 emulation program.</p>
<p><a class="reference internal" href="../../../_images/image72.jpeg"><img alt="screen7" src="../../../_images/image72.jpeg" style="width: 6.29167in; height: 5.52083in;" /></a></p>
<p>Fig. 7 – TSO Logon panel</p>
<p>When the disconnect ICON in the tool bar is pressed (Red Square) the
screen will return to the USSWSYSP. This is because the <strong>*lastpage*</strong>
parameter in the Entry Point definition has been set to /USSWSYSP.HTML.</p>
<p><strong>USSWSYSP Logic</strong></p>
<p>The template consists of some JavaScript and HTML. Most of the
JavasSript relates to session state and presentation and should not be
modified. Essential the template, using JavaScript, builds a 24*80 HTML
presentation screen. On line 1 a title is displayed, see the variable
<em>title</em> in the last &lt;script&gt; segment. Line 2 is an input line and line
24 is an error message line.</p>
<p>When a user presses ENTER the JavaScript <em>SubmitForm</em> function is
triggered which analyses the input represented by the <em>zcmd</em> variable.
If <em>zcmd</em> is blank an error message is set in variable <em>errmsg</em>. Also,
if the command entered is not ENTER, as reflected in the <em>pfKey</em>
variable, an error message is also set. The case logic in the
<em>SubmitForm</em> function determines which application to logon onto. This
may be modified to reflect the commands found in a VTAM USSTAB. In the
sample <em>USSHSYSP.HTML</em> the command entered is not tested. It is assumed
that it is a valid application name and in the default section of the
CASE statement is concatenated to the WEB2AJAX url and triggered via the
action statement at the end of the function. This will result in a logon
process to the application entered by the user. The only change to
behavior is if the user entered TSOA. In that case the application name
is changed to TSO.</p>
<p>It is here, in the CASE logic, that a user would modify USSHSYSP.HTML
and specify all the true application test through a series of CASE
elements and set the appropriate action. The default action should be an
error message or default application.</p>
<p>The other customized elements that have been changed are the
<em>customs.js</em> and <em>w2hparm.js</em> modules. You can see in the included
&lt;script&gt; list in USSWSYSP.HTML that the defaults for <em>custom.js</em> and
<em>w2hparm.js</em> are not included from the w2h directory. Instead the html
code pulls these two modules from the users default directory associated
with the entry point.</p>
<p>The modifications made to <em>custom.js</em> are shown in the following piece
of code:-</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="n">Copyright</span> <span class="n">SysperTec</span> <span class="n">Communication</span> <span class="mi">2012</span> <span class="n">All</span> <span class="n">Rights</span> <span class="n">Reserved</span>
<span class="o">*</span> <span class="n">VIRTEL</span> <span class="n">Web</span> <span class="n">Access</span> <span class="n">customer</span><span class="o">-</span><span class="n">specific</span> <span class="n">javascript</span> <span class="n">functions</span>
<span class="o">*/</span>
<span class="n">function</span> <span class="n">after_standardInit</span><span class="p">()</span> <span class="p">{</span>
<span class="o">/*</span> <span class="n">Remove</span> <span class="n">macro</span> <span class="n">buttons</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">toolbar</span> <span class="o">*/</span>
<span class="n">removetoolbarbutton</span><span class="p">(</span><span class="s2">&quot;startrecording&quot;</span><span class="p">);</span>
<span class="n">removetoolbarbutton</span><span class="p">(</span><span class="s2">&quot;playback&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This customs-specific java script module removes the “startrecording”
and “playback” tools from the tool bar.</p>
<p>Also, the <em>w2hparm.js</em> module has been modified to change the fonts and
keys from the defaults. The following is an example of <em>w2hparm.js</em> as
used with USSHSYSP.HTML:-</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Default</span> <span class="n">Virtel</span> <span class="n">Web</span> <span class="n">Access</span> <span class="n">settings</span> <span class="k">for</span> <span class="n">USSHSYSP</span><span class="o">.</span><span class="n">HTML</span>
<span class="o">//</span> <span class="n">see</span> <span class="n">w2hparmdefns</span> <span class="ow">in</span> <span class="n">js01</span><span class="o">.</span><span class="n">js</span> <span class="k">for</span> <span class="n">parameters</span> <span class="ow">and</span> <span class="n">allowable</span> <span class="n">values</span>
<span class="n">var</span> <span class="n">w2hparm</span> <span class="o">=</span> <span class="p">{</span>
<span class="s2">&quot;fontsize&quot;</span><span class="p">:</span><span class="s2">&quot;window&quot;</span><span class="p">,</span>
<span class="s2">&quot;font&quot;</span><span class="p">:</span><span class="s2">&quot;Lucida Console&quot;</span><span class="p">,</span>
<span class="s2">&quot;ctrl&quot;</span><span class="p">:</span><span class="s2">&quot;Newline&quot;</span><span class="p">,</span>
<span class="s2">&quot;enter&quot;</span><span class="p">:</span><span class="s2">&quot;ENTER&quot;</span><span class="p">,</span>
<span class="s2">&quot;shiftesc&quot;</span><span class="p">:</span><span class="s2">&quot;ATTN&quot;</span><span class="p">,</span>
<span class="s2">&quot;pause&quot;</span><span class="p">:</span><span class="s2">&quot;CLEAR&quot;</span><span class="p">,</span>
<span class="s2">&quot;esc&quot;</span><span class="p">:</span><span class="s2">&quot;Reset&quot;</span><span class="p">,</span>
<span class="s2">&quot;home&quot;</span><span class="p">:</span><span class="s2">&quot;Home&quot;</span><span class="p">,</span>
<span class="s2">&quot;end&quot;</span><span class="p">:</span><span class="s2">&quot;ErEof&quot;</span><span class="p">,</span>
<span class="s2">&quot;shiftins&quot;</span><span class="p">:</span><span class="s2">&quot;Dup&quot;</span><span class="p">,</span>
<span class="s2">&quot;shifthome&quot;</span><span class="p">:</span><span class="s2">&quot;FieldMark&quot;</span><span class="p">,</span>
<span class="s2">&quot;shiftend&quot;</span><span class="p">:</span><span class="s2">&quot;End&quot;</span><span class="p">,</span>
<span class="s2">&quot;shiftpgdn&quot;</span><span class="p">:</span><span class="s2">&quot;PA3&quot;</span><span class="p">,</span>
<span class="s2">&quot;pgup&quot;</span><span class="p">:</span><span class="s2">&quot;PA1&quot;</span><span class="p">,</span>
<span class="s2">&quot;pgdn&quot;</span><span class="p">:</span><span class="s2">&quot;PA2&quot;</span><span class="p">,</span>
<span class="s2">&quot;ctrlend&quot;</span><span class="p">:</span><span class="s2">&quot;End&quot;</span><span class="p">,</span>
<span class="s2">&quot;printstyle&quot;</span><span class="p">:</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
<span class="s2">&quot;style&quot;</span><span class="p">:</span><span class="s2">&quot;3270&quot;</span><span class="p">};</span>
</pre></div>
</div>
<p><em>USSWSYSP.HTML, customs.js</em> and <em>w2hparm.js</em> should all be uploaded to
the default directory for the Entry Point you are using. Also, within
that Entry Point, in this EDSHOST, there must be a transaction entry for
the W2H-DIR directory. This is so the shipped JavaScript code can be
accessible. Here is the list of transactions for the Entry Point
EDSHOLT:-</p>
<p><a class="reference internal" href="../../../_images/image82.jpeg"><img alt="screen8" src="../../../_images/image82.jpeg" style="width: 6.30208in; height: 4.15625in;" /></a></p>
<p>Fig. 8 – Transactions associated with Entry Point.</p>
<p>The transaction details for the W2H-DIR, external name <em>w2h</em> look like
this :-</p>
<p><a class="reference internal" href="../../../_images/image92.jpeg"><img alt="screen9" src="../../../_images/image92.jpeg" style="width: 6.30208in; height: 4.15625in;" /></a></p>
<p>Fig. 9 – Transaction entry to access the ../w2h/ directory.</p>
<p>Do not upload any modules to the shipped directory <em>../w2h/.</em> If you do,
you will overwrite the Virtel defaults which would affect behavior
globally. If you want to use the shipped defaults of custom.js and
w2hparm.js then modify the HTML &lt;script&gt; tags in <em>USSWSYSP.HTML</em> to
include <em>custom.js</em> and <em>w2hparm.js</em> from the distributed ../<em>w2h/</em>
directory and not from your default EntryPoint directory.</p>
<p><strong>Appendix A</strong></p>
<p>Code for template USSWSYSP.HTML</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01//EN&quot;
&quot;http://www.w3.org/TR/html4/strict.dtd&quot;&gt;
   &lt;html&gt;
      &lt;head&gt; &lt;!--VIRTEL start=&quot;{{{&quot; end=&quot;}}}&quot; --&gt;
         &lt;!--
         $Id: USSWSYSP.html XXXX 2014-05 09:07:41Z holt $
         Example of Home Page for VIRTEL Web Access _ USS Replacement
         --&gt;
         &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;/&gt;
         &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html;
         charset=ISO-8859-15&quot;&gt;
         &lt;script type=&quot;text/javascript&quot; src=&quot;../w2hparm.js&quot;&gt;&lt;/script&gt;
         &lt;script type=&quot;text/javascript&quot; src=&quot;../w2h/default.js&quot;&gt;&lt;/script&gt;
         &lt;script type=&quot;text/javascript&quot; src=&quot;../w2h/stk.js&quot;&gt;&lt;/script&gt;
         &lt;script type=&quot;text/javascript&quot; src=&quot;../w2h/js01.js&quot;&gt;&lt;/script&gt;
         &lt;script type=&quot;text/javascript&quot; src=&quot;../w2h/vir3270.js&quot;&gt;&lt;/script&gt;
         &lt;script type=&quot;text/javascript&quot; src=&quot;../w2h/virajax.js&quot;&gt;&lt;/script&gt;
         &lt;script type=&quot;text/javascript&quot; src=&quot;../custom.js&quot;&gt;&lt;/script&gt;
         &lt;title&gt;{{{NAME-OF (VIRTEL)}}} VIRTEL Web Access&lt;/title&gt;
      &lt;/head&gt;
   &lt;body onload=&#39;js01onload(); pageSetup(80,&quot;{{{NAME-OF (VIRTEL)}}}&quot;); VIR3270.init(&quot;printReady&quot;, 24, 80, &quot;zcmd&quot;); autoCapture();&#39;&gt;
      &lt;script type=&quot;text/javascript&quot;&gt;
      function submitForm(pfkey) {
         var zcmd, action, errmsg, elem;
         zcmd = stk.trimString(document.virtelForm.zcmd.value).toUpperCase();
         if (pfkey == &quot;CLEAR&quot;) {
            action = &quot;/&quot;;
         } else if (pfkey != &quot;ENTER&quot;) {
            errmsg = &quot;Invalid Key. Please enter application and press ENTER&quot;;
         } else {
            switch (zcmd) {
               case &quot;&quot;:
                  errmsg = &quot;Please specify application and press ENTER&quot;;
                  break;
               case &quot;TSOA&quot;:
                  action = &quot;../w2h/WEB2AJAX.htm+TSO&quot;;
                  break;
               default:
                  // errmsg = &quot;LE CHOIX QUE VOUS AVEZ FAIT N&#39;EST PAS PREVU&quot;;
                  action = &quot;../w2h/WEB2AJAX.htm+&quot;.concat(zcmd);
            }
         }
         if (errmsg) {
            elem = VIR3270.findField(1840);
            if (elem)
               elem.innerHTML = errmsg.fixlen(79).htmlcode();
            VIR3270.cursorOff();
            VIR3270.cursorHome();
            VIR3270.cursorOn();
            VIR3270.resetInhibit();
         }
         if (action)
            document.location.href = action;
      }
      function pageSetup(cols, virtname) {
         var ident1, ident2;
         loadCss(&quot;../w2h/login.css&quot;);
         loadCss(&quot;../w2h/keypad.css&quot;);
         loadCss(&quot;../w2h/custom.css&quot;);
         if (typeof setStatusBarRelayStatus === &quot;function&quot;) {
            fillstatusbar(cols);
            setStatusBarRelayStatus(virtname);
            if (typeof createOnResizeFn === &quot;function&quot;) {
               window.onresize = createOnResizeFn(&quot;window&quot;, 80, 24);
               window.onresize(forceResizeEvent);
            }
         } else {
            fillstatusbar(cols, virtname);
            updateFontsize(&quot;window&quot;, 80, 24);
         }
         document.getElementById(&quot;printReady&quot;).style.visibility = &quot;visible&quot;;
      }
      setFontsize(&quot;window&quot;, 80, 24);
      genkeypad();
      gentoolbar();
      if (typeof after_standardInit === &quot;function&quot;) {
      after_standardInit();
      }
      &lt;/script&gt;

      &lt;div id=&quot;viewport&quot; style=&quot;-webkit-transform-origin:0 0;-ms-transform-origin:0 0; moz-transform-origin:0 0;transform-origin:0 0;&quot;&gt;

         &lt;div id=&quot;virsubpage&quot;&gt;

            &lt;form name=&quot;virtelForm&quot; action=&quot;&quot; method=&quot;get&quot;&gt;
               &lt;script type=&quot;text/javascript&quot;&gt;
                  var title = &quot;Welcome to SysperTec&quot;
                  var blankLine = &#39; &#39;.concat(&#39;&lt;br&gt;&#39;);
                  var screen = &#39;&lt;pre&gt;&lt;div id=&quot;printReady&quot; class=&quot;mainFont&quot;
                  style=&quot;visibility:hidden;&quot;&gt;&lt;span class=&quot;NGREEN&quot;&gt;&#39;;
                  screen = screen.concat(title).concat(blankLine.substring(title.length));
                  screen = screen.concat(&#39;&lt;/span&gt;&#39;);
                  screen = screen.concat(&#39;&lt;input name=&quot;zcmd&quot; type=&quot;text&quot; size=&quot;80&quot;
                  maxsize=&quot;80&quot; class=&quot;NGREEN&quot;&gt;&#39;);
                  screen = screen.concat(&#39;&lt;span class=&quot;NWHITE&quot;&gt;&lt;br&gt;&#39;);
                  for (var i = 0; i &lt; 21; i++) {
                     screen = screen.concat(blankLine);
                  }
                  screen = screen.concat(&#39;&lt;/span&gt;&lt;span
                  class=&quot;NRED&quot;&gt;&#39;).concat(blankLine).concat(&#39;&lt;/span&gt;&lt;span
                  class=&quot;NWHITE&quot;&gt;&amp;nbsp;&#39;)
                  screen = screen.concat(&#39;&lt;/span&gt;&lt;/div&gt;&lt;div id=&quot;statusbar&quot;
                  class=&quot;mainFont&quot;&gt;&lt;/div&gt;&lt;/pre&gt;&#39;);
                  document.write(screen);
               &lt;/script&gt;

               {{{DEFINE-HTML-PFKEY &quot;pf&quot;}}}&lt;input name=&quot;pf&quot; type=&quot;HIDDEN&quot; value=&quot;ENTER&quot;&gt;
               &lt;input name=&quot;cursorField&quot; id=&quot;cursorfield&quot; type=&quot;HIDDEN&quot; value=&quot;&quot;&gt;
            &lt;/form&gt;

         &lt;/div&gt;

      &lt;/div&gt;
      &lt;script type=&quot;text/javascript&quot;&gt;
      genBhoTrigger();
      &lt;/script&gt;
   &lt;/body&gt;
&lt;/html&gt;
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The blankLine variable has 80 blanks between the quotes.</p>
</div>
<p><strong>Related material</strong></p>
<p><a class="reference internal" href="../TN201519/TN201519.html"><span class="doc">Processing the VTAM USS MSG10 buffer</span></a></p>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../TN201412/TN201412.html" class="btn btn-neutral float-right" title="Sharing user macros across multiple instances of Virtel" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../TN201410/TN201410.html" class="btn btn-neutral" title="Taking a VTAM trace" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Syspertec. All rights reserved.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'7',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>