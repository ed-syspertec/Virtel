

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Virtel JES Writer program &mdash; Virtel 7 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="Virtel 7 documentation" href="../../../index.html"/>
        <link rel="up" title="Technical Newsletters" href="../../../newsletters.html"/>
        <link rel="next" title="Virtel Security. Using server and client certificates" href="../TN201416/TN201416.html"/>
        <link rel="prev" title="CICS Printing problem" href="../TN201414/TN201414.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> Virtel
          

          
            
            <img src="../../../_static/logo_virtel_web.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                4.57
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../virtel.html">Virtel Manuals</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../newsletters.html">Technical Newsletters</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../newsletters.html#id1">2014</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../TN201406/TN201406.html">Taking a VIRTEL terminal trace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201407/TN201407.html">Pass tickets and supporting Proxy Servers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201409/TN201409.html">Mainframe printing with Virtel 4.56</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201410/TN201410.html">Taking a VTAM trace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201411/TN201411.html">Building a customized USSTAB using Virtel’s Web Access facility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201412/TN201412.html">Sharing user macros across multiple instances of Virtel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201413/TN201413.html">Overview of a Virtel Session</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201414/TN201414.html">CICS Printing problem</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Virtel JES Writer program</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201416/TN201416.html">Virtel Security. Using server and client certificates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201417/TN201417.html">RACF Grouping Class and Virtel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201419/TN201419.html">Maintaining TRSF file sets</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../newsletters.html#id2">2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../newsletters.html#id3">2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../newsletters.html#id4">2017</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../howto.html">Miscellaneous</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Virtel</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../newsletters.html">Technical Newsletters</a> &raquo;</li>
        
      <li>Virtel JES Writer program</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/manuals/newsletters/TN201415/TN201415.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="virtel-jes-writer-program">
<span id="tn201415"></span><h1>Virtel JES Writer program<a class="headerlink" href="#virtel-jes-writer-program" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This program is an internal development project and is very much a POC idea. It is not officially supported.</p>
</div>
<p>The Virtel JES Writer utility extracts JES2 output and writes to a
Virtel printer relay tasks via a Virtel transaction. The JES output is
converted to a PDF by an input scenario and the PDF can then be printed
or saved at the user’s workstation.</p>
<p><strong>Installation</strong></p>
<ol class="arabic simple">
<li>Download VJRS.TRS from the Virtel FTP Server.</li>
<li>Upload to the mainframe into a dataset with the following DCB
attributes:-</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">LRECL</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span><span class="n">BLKSIZE</span><span class="o">=</span><span class="mi">6144</span><span class="p">,</span><span class="n">RECFM</span><span class="o">=</span><span class="n">FB</span><span class="p">,</span><span class="n">DSN</span><span class="o">=</span><span class="n">HLQ</span><span class="o">.</span><span class="n">VJRS</span><span class="o">.</span><span class="n">TRS</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li>Run the following JCL. This will unterse the file and install the
VJRS load library. Here is a sample of what I use. Change
accordingly.</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">jobcard</span> <span class="n">JOB</span> <span class="mi">9000</span><span class="p">,</span><span class="s1">&#39;ED...HOLT...&#39;</span><span class="p">,</span><span class="n">CLASS</span><span class="o">=</span><span class="n">A</span><span class="p">,</span><span class="n">MSGCLASS</span><span class="o">=</span><span class="n">X</span><span class="p">,</span><span class="n">NOTIFY</span><span class="o">=&amp;</span><span class="n">SYSUID</span>
<span class="o">//</span><span class="n">S01</span> <span class="n">EXEC</span> <span class="n">PGM</span><span class="o">=</span><span class="n">IEFBR14</span>
<span class="o">//</span><span class="n">DDA</span> <span class="n">DD</span> <span class="n">UNIT</span><span class="o">=</span><span class="n">SYSDA</span><span class="p">,</span>
<span class="o">//</span> <span class="n">DSN</span><span class="o">=</span><span class="n">HLQ</span><span class="o">.</span><span class="n">VJRS</span><span class="o">.</span><span class="n">TEMP</span><span class="p">,</span><span class="n">DISP</span><span class="o">=</span><span class="p">(</span><span class="n">MOD</span><span class="p">,</span><span class="n">DELETE</span><span class="p">),</span>
<span class="o">//</span> <span class="n">SPACE</span><span class="o">=</span><span class="p">(</span><span class="n">TRK</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="o">//</span><span class="n">S02</span> <span class="n">EXEC</span> <span class="n">PGM</span><span class="o">=</span><span class="n">TRSMAIN</span><span class="p">,</span><span class="n">PARM</span><span class="o">=</span><span class="n">UNPACK</span>
<span class="o">//</span><span class="n">SYSPRINT</span> <span class="n">DD</span> <span class="n">SYSOUT</span><span class="o">=*</span>
<span class="o">//</span><span class="n">INFILE</span> <span class="n">DD</span> <span class="n">DSN</span><span class="o">=</span><span class="n">HLQ</span><span class="o">.</span><span class="n">VJRS</span><span class="o">.</span><span class="n">TRS</span><span class="p">,</span><span class="n">DISP</span><span class="o">=</span><span class="n">SHR</span>
<span class="o">//</span><span class="n">OUTFILE</span> <span class="n">DD</span> <span class="n">UNIT</span><span class="o">=</span><span class="n">SYSDA</span><span class="p">,</span>
<span class="o">//</span> <span class="n">DSN</span><span class="o">=</span><span class="n">HLQ</span><span class="o">.</span><span class="n">VJRS</span><span class="o">.</span><span class="n">TEMP</span><span class="p">,</span><span class="n">DISP</span><span class="o">=</span><span class="p">(,</span><span class="n">CATLG</span><span class="p">),</span>
<span class="o">//</span> <span class="n">SPACE</span><span class="o">=</span><span class="p">(</span><span class="n">CYL</span><span class="p">,(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">RLSE</span><span class="p">)</span>
<span class="o">//</span><span class="n">S03</span> <span class="n">EXEC</span> <span class="n">PGM</span><span class="o">=</span><span class="n">ADRDSSU</span><span class="p">,</span><span class="n">REGION</span><span class="o">=</span><span class="mi">0</span><span class="n">M</span><span class="p">,</span><span class="n">COND</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">NE</span><span class="p">)</span>
<span class="o">//</span><span class="n">SYSPRINT</span> <span class="n">DD</span> <span class="n">SYSOUT</span><span class="o">=*</span>
<span class="o">//</span><span class="n">IN</span> <span class="n">DD</span> <span class="n">DSN</span><span class="o">=</span><span class="n">HLQ</span><span class="o">.</span><span class="n">VJRS</span><span class="o">.</span><span class="n">TEMP</span><span class="p">,</span><span class="n">DISP</span><span class="o">=</span><span class="n">SHR</span>
<span class="o">//</span><span class="n">OUT</span> <span class="n">DD</span> <span class="n">UNIT</span><span class="o">=</span><span class="n">SYSDA</span><span class="p">,</span><span class="n">VOL</span><span class="o">=</span><span class="n">SER</span><span class="o">=</span><span class="n">VVVVVV</span><span class="p">,</span><span class="n">DISP</span><span class="o">=</span><span class="n">SHR</span>
 <span class="n">RESTORE</span> <span class="n">INDDNAME</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="o">-</span>
 <span class="n">OUTDD</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="o">-</span>
 <span class="n">DATASET</span><span class="p">(</span><span class="n">INCLUDE</span><span class="p">(</span><span class="o">**</span><span class="p">))</span> <span class="o">-</span>
 <span class="n">RENAMEU</span><span class="p">(</span> <span class="o">-</span>
 <span class="p">(</span><span class="n">SPTHOLT</span><span class="o">.**</span><span class="p">,</span><span class="n">HLQ</span><span class="o">.**</span><span class="p">)</span> <span class="o">-</span>
 <span class="p">)</span> <span class="o">-</span>
 <span class="n">CATALOG</span> <span class="n">BYPASSACS</span><span class="p">(</span><span class="o">**</span><span class="p">)</span> <span class="n">NMC</span> <span class="n">NSC</span> <span class="n">CANCELERROR</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li>Authorise the load library. Use the following command:-</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">SETPROG</span> <span class="n">APF</span><span class="p">,</span><span class="n">ADD</span><span class="p">,</span><span class="n">DSNAME</span><span class="o">=</span><span class="n">hlq</span><span class="o">.</span><span class="n">VJRS</span><span class="o">.</span><span class="n">LOAD</span><span class="p">,</span><span class="n">VOL</span><span class="o">=</span><span class="n">vvvvvv</span>
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li>Add the following JCL to SYS1.PROCLIB:-</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">VJRS</span> <span class="n">PROC</span> <span class="n">MAXTASKS</span><span class="o">=</span><span class="mi">02</span>
<span class="o">//</span><span class="n">STEP1</span> <span class="n">EXEC</span> <span class="n">PGM</span><span class="o">=</span><span class="n">VJES0100</span><span class="p">,</span><span class="n">PARM</span><span class="o">=</span><span class="s1">&#39;MAXTASKS=&amp;MAXTASKS&#39;</span>
<span class="o">//</span><span class="n">STEPLIB</span> <span class="n">DD</span> <span class="n">DSN</span><span class="o">=</span><span class="n">hlq</span><span class="o">.</span><span class="n">VJRS</span><span class="o">.</span><span class="n">LOAD</span><span class="p">,</span><span class="n">DISP</span><span class="o">=</span><span class="n">SHR</span>
<span class="o">//</span><span class="n">SYSUDUMP</span> <span class="n">DD</span> <span class="n">SYSOUT</span><span class="o">=*</span>
<span class="o">//</span><span class="n">SYSIN</span> <span class="n">DD</span> <span class="n">DSN</span><span class="o">=</span><span class="n">SYS1</span><span class="o">.</span><span class="n">PARMLIB</span><span class="p">(</span><span class="n">VJRSPRNT</span><span class="p">),</span><span class="n">DISP</span><span class="o">=</span><span class="n">SHR</span>
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li>Add the following VTAMLST as member APPLVJRS definition for VJRP:-</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">APPLVJRS</span> <span class="n">VBUILD</span> <span class="n">TYPE</span><span class="o">=</span><span class="n">APPL</span>
<span class="o">*</span> <span class="o">-----------------------------------------------------------------</span>
<span class="o">*</span>
<span class="o">*</span> <span class="n">Product</span> <span class="p">:</span> <span class="n">Virtel</span> <span class="n">Printer</span> <span class="o">*</span>
<span class="o">*</span> <span class="n">Description</span> <span class="p">:</span> <span class="n">Main</span> <span class="n">ACB</span> <span class="k">for</span> <span class="n">Virtel</span> <span class="n">Printer</span> <span class="n">Application</span> <span class="o">*</span>
<span class="o">*</span> <span class="o">-----------------------------------------------------------------</span>
<span class="o">*</span>
<span class="n">VJRS</span> <span class="n">APPL</span> <span class="n">ACBNAME</span><span class="o">=</span><span class="n">VJRS</span><span class="p">,</span><span class="n">AUTH</span><span class="o">=</span><span class="n">ACQ</span>
</pre></div>
</div>
<ol class="arabic simple" start="7">
<li>Add the following configuration statements to SYS1.PARMLIB as member
VJRSPRNT</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">*----------------------------------------------------------------------------*</span>
<span class="o">*-</span> <span class="n">PRINTER</span> <span class="n">CONTROL</span> <span class="n">STATEMETS</span> <span class="n">FOR</span> <span class="n">VJRS</span> <span class="n">UTILITY</span><span class="o">.</span> <span class="o">-*</span>
<span class="o">*-</span> <span class="o">-*</span>
<span class="o">*-</span> <span class="n">COL</span> <span class="mi">1</span> <span class="n">JES</span> <span class="n">DESTID</span> <span class="o">-*</span>
<span class="o">*-</span> <span class="n">COL</span> <span class="mi">10</span> <span class="n">VIRTEL</span> <span class="n">LU</span> <span class="n">RELAY</span> <span class="n">PRINTER</span> <span class="o">-*</span>
<span class="o">*-</span> <span class="n">COL</span> <span class="mi">19</span> <span class="n">PRINTER</span> <span class="n">TYPE</span> <span class="o">-*</span>
<span class="o">*-</span> <span class="n">S</span> <span class="o">=</span> <span class="n">SCS</span> <span class="n">PRINTER</span><span class="o">.</span> <span class="n">LU</span> <span class="n">TYPE</span> <span class="mi">1</span> <span class="o">-*</span>
<span class="o">*----------------------------------------------------------------------------*</span>
<span class="o">*</span>        <span class="o">*</span>        <span class="o">*</span>
<span class="n">EDSPRT</span>   <span class="n">REHIM000</span> <span class="n">S</span>
<span class="n">EDSPRT1</span>  <span class="n">REHIM001</span> <span class="n">S</span>
<span class="n">EDSPRT2</span>  <span class="n">REHIM002</span> <span class="n">S</span>
</pre></div>
</div>
<ol class="arabic simple" start="8">
<li>Concatenate the hlq.VJRS.LOAD to the SERVLIB DD statement in the
VIRTEL proc.</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">......</span>
<span class="o">//</span><span class="n">SERVLIB</span> <span class="n">DD</span> <span class="n">DISP</span><span class="o">=</span><span class="n">SHR</span><span class="p">,</span><span class="n">DSN</span><span class="o">=</span><span class="n">hlq</span><span class="o">.</span><span class="n">VJRS</span><span class="o">.</span><span class="n">LOAD</span>
<span class="o">//</span> <span class="n">DD</span> <span class="n">DISP</span><span class="o">=</span><span class="n">SHR</span><span class="p">,</span><span class="n">DSN</span><span class="o">=</span><span class="n">hlq</span><span class="o">.</span><span class="n">VIRTEL</span><span class="o">.</span><span class="n">SERVLIB</span>
<span class="o">......</span>
</pre></div>
</div>
<p>9. Assemble the VJRS scenarios into the VIRTEL load library using the sample hlq.VJRS.SAMPLIB(ASMSCEN). This job assemble the two VJRS
scenarios SCVJRS00 and SCVJRS01 into the VIRTEL loadlib.</p>
<p><strong>Virtel Configuration</strong></p>
<p>To use VJRS you must create a transaction(s) in Virtel which provides a
printer interface that converts the JES output to a PDF. This is done by
adding an input scenario to an existing transaction. The input scenario
will convert the JES output to a PDF by calling MAKEPDF through the
$VIRSV interface. In our example we are using the sample scenario
SCVJRS01 which can be found in hlq.VJRS.SAMPLIB. In our case we are
using a TSO transaction as the recipient of the output stream from VJRS.
SCVJRS01 is a scenario that produces landscape print. Scenario SCVJRS00
produces portrait output.</p>
<p>Example of Virtel TSO transaction with PDF input scenario:-</p>
<p><a class="reference internal" href="../../../_images/image110.png"><img alt="image0" src="../../../_images/image110.png" style="width: 6.30000in; height: 4.29306in;" /></a></p>
<p><strong>MAKEPDF configuration</strong></p>
<p>The PDF page format and layout are controlled by text files used by the
ZMAKEPDF program. The following files, found in vjrs.zip distribution
file, must be uploaded to the Virtel W2H directory through the standard
Virtel upload process.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Portrait</span> <span class="n">files</span>
    <span class="n">scenvjrs</span><span class="o">-</span><span class="n">docopt</span><span class="o">.</span><span class="n">txt</span>
    <span class="n">scenvjrs</span><span class="o">-</span><span class="n">layout</span><span class="o">.</span><span class="n">txt</span>
    <span class="n">scenvjrs</span><span class="o">-</span><span class="nb">input</span><span class="o">.</span><span class="n">txt</span>

<span class="n">Landscape</span> <span class="n">files</span>
    <span class="n">scenvjrs</span><span class="o">-</span><span class="n">docopt</span>\<span class="n">_l</span><span class="o">.</span><span class="n">txt</span>
    <span class="n">scenvjrs</span><span class="o">-</span><span class="n">layout</span>\<span class="n">_l</span><span class="o">.</span><span class="n">txt</span>
    <span class="n">scenvjrs</span><span class="o">-</span><span class="nb">input</span>\<span class="n">_l</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>Details about the format of the files can be found in the <em>CASI CICS2PDF
Installation and Reference</em> manual. These files are passed through to
ZMAKEPDF through the calling of the service program VJRS0200. The
service program is invoked from within the scenario by a VIRSV$ call
statement.</p>
<p><strong>Print controls</strong></p>
<p>Print control is basic. Any detected ASA control characters are stripped
off and replaced by a blank. Line count is controlled by the
PDF-LINES-PER-PAGE tag.</p>
<p><strong>Session establishment</strong></p>
<p>To support printing any 3270 session can be used as long as an associate
printer relay is defined. In my case I am using a TSO session to
establish a printer connection. In the screen shot below a TSO session
has been initiated. The LU associated with this session are REHVT000,
the terminal session, and REHIM000 the printer session. VJRS will
establish a VTAM session with REHIM000. Also, in the URL the transaction
name of TSO1A has been defined. This associates the input scenario
SCVJRS01 with the session.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">URL</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">170.30</span><span class="p">:</span><span class="mi">41002</span><span class="o">/</span><span class="n">w2h</span><span class="o">/</span><span class="n">WEB2AJAX</span><span class="o">.</span><span class="n">htm</span><span class="o">+</span><span class="n">TSO1A</span>
</pre></div>
</div>
<p><a class="reference internal" href="../../../_images/image211.png"><img alt="image1" src="../../../_images/image211.png" style="width: 6.30000in; height: 4.82708in;" /></a></p>
<p>Note that there are two VIRTEL relays associated with this session. The
terminal session, REHVT000 and an associated SCS printer relay REHIM000.
The printer relay LU is used by VJRS to transmit the data from JES to
VIRTEL.</p>
<p><strong>Using VJRS</strong></p>
<ol class="arabic">
<li><p class="first">Activate the VTAM node</p>
<blockquote>
<div><p>Issue the following z/OS command to activate the VJRS VTAM
definition:-</p>
</div></blockquote>
</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">V</span> <span class="n">NET</span><span class="p">,</span><span class="n">ACT</span><span class="p">,</span><span class="n">ID</span><span class="o">=</span><span class="n">APPLVJRS</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li>Start the VJRS printer tasks</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="n">VJRS</span>
</pre></div>
</div>
<p>The output from the started task should look like this:-</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>V NET,INACT,ID=APPLVJRS,I
IST097I VARY ACCEPTED
IST105I APPLVJRS NODE NOW INACTIVE
V NET,ACT,ID=APPLVJRS
IST097I VARY ACCEPTED
IST093I APPLVJRS ACTIVE
S VJRS
$HASP100 VJRS ON STCINRDR
IEF695I START VJRS WITH JOBNAME VJRS IS ASSIGNED TO USER START2
, GROUP SYS1
$HASP373 VJRS STARTED
IEF403I VJRS - STARTED - TIME=13.37.47
VJRS001I - VIRTEL JES WRITER READY
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li>Create some output in JES2 by running a batch job. Output should go
to one of the defined destinations that VJRS is serving. Example
batch job:-</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">SPTHOLTP</span> <span class="n">JOB</span> <span class="s1">&#39;JRPTEST1&#39;</span><span class="p">,</span><span class="n">CLASS</span><span class="o">=</span><span class="n">A</span><span class="p">,</span><span class="n">MSGCLASS</span><span class="o">=</span><span class="n">Z</span><span class="p">,</span><span class="n">NOTIFY</span><span class="o">=</span><span class="n">SPTHOLT</span>
<span class="o">//</span><span class="n">STEP1</span> <span class="n">EXEC</span> <span class="n">PGM</span><span class="o">=</span><span class="n">IEBGENER</span>
<span class="o">//</span><span class="n">SYSPRINT</span> <span class="n">DD</span> <span class="n">DUMMY</span>
<span class="o">//</span><span class="n">SYSUT2</span> <span class="n">DD</span> <span class="n">SYSOUT</span><span class="o">=</span><span class="n">A</span><span class="p">,</span><span class="n">DEST</span><span class="o">=</span><span class="n">EDSPRT</span>
<span class="o">//</span><span class="n">SYSUT1</span> <span class="n">DD</span> <span class="n">DSN</span><span class="o">=</span><span class="n">SPTHOLT</span><span class="o">.</span><span class="n">VJESPRT</span><span class="o">.</span><span class="n">ASM</span><span class="p">(</span><span class="n">TESTPRNT</span><span class="p">),</span><span class="n">DISP</span><span class="o">=</span><span class="n">SHR</span>
<span class="o">//</span><span class="n">SYSIN</span> <span class="n">DD</span> <span class="n">DUMMY</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The MSGCLASS=Z ensures that only the Class A output is left on
the JES queue with an associated destination of EDSPRT for the
submitted job.</p>
</div>
<ol class="arabic" start="4">
<li><p class="first">After the job has run, output will appear on JES with a DESTID of
EDSPRT. This will be captured by VJRS, via the JES2 SAPI interface,
and sent to the associated Virtel LU relay. In this case LU REHIM000</p>
</li>
<li><p class="first">Virtel will indicate that Print Output is available by presenting the
user with a Printer ICON in the Operator Interface Area or Taskbar on
the Virtel Terminal screen.</p>
<blockquote>
<div><p><a class="reference internal" href="../../../_images/image38.png"><img alt="image2" src="../../../_images/image38.png" style="width: 6.30000in; height: 4.84931in;" /></a></p>
<p>Pressing the printer ICON will kick off the input scenario SCENFPDF
which will convert the output to a PDF and then issue the ADOBE
option window to open or save the file.</p>
<p>Select the printer ICON and the input scenario will drive the
“MAKEPDF” program which will convert the output to a PDF.</p>
<p><a class="reference internal" href="../../../_images/image43.png"><img alt="image3" src="../../../_images/image43.png" style="width: 6.30000in; height: 5.79028in;" /></a></p>
<p>From here the user can open or save the PDF. In our example we
choose to open the PDF.</p>
<p><a class="reference internal" href="../../../_images/image57.png"><img alt="image4" src="../../../_images/image57.png" style="width: 6.30000in; height: 5.79306in;" /></a></p>
<p>Once you have finished with the PDF close the window and the Virtel
Print Notification dialog. Note that you are still left with the
Printer ICON in the taskbar. This enables you to reopen the print if
required. Once you press Enter or initiate another application
action (PFx) the Printer Icon will disappear and the Virtel session
is now ready for the next print request.</p>
</div></blockquote>
</li>
</ol>
<p><strong>Using VJRS and VIRTEL message log off load</strong></p>
<p>In Virtel 4.54 (not available until 2015/Q1) the LOG feature enables
the VIRTEL log to be spun off to JES2. VJRS can capture the log from
JES2 and send it directly to the LU relay printer and in the process
convert it to a PDF.</p>
<p>Setting up VIRTEL to use the LOG sysout facility requires a change
to the TCT definition to direct WTOs to a SYSOUT dataset. In the TCT
code the following statement:-</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">LOG</span><span class="o">=</span><span class="p">(</span><span class="n">SYSOUT</span><span class="p">,</span><span class="n">class</span><span class="p">,</span><span class="n">destination</span><span class="p">)</span>
</pre></div>
</div>
<p>For example, LOG=(SYSOUT,A,EDSPRT)</p>
<p>This directs all WTOs to a SYSOUT dataset rather than the system
console log (SYSLOG). If you want WTO messages going to both the
system console and a SYSOUT dataset than issue the following VIRTEL
command:-</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="n">VIRTEL</span><span class="p">,</span><span class="n">LOG</span><span class="o">=</span><span class="n">BOTH</span>
</pre></div>
</div>
<p>The LOG feature in Virtel 4.54 is controlled by the TCT parameters
and a new LOG command. The new LOG command has the following
format:-</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="n">VIRTEL</span><span class="p">,</span><span class="n">LOG</span><span class="o">=</span><span class="n">CONSOLE</span> \<span class="o">|</span> <span class="n">SYSOUT</span> \<span class="o">|</span> <span class="n">BOTH</span> \<span class="o">|</span> <span class="n">SPIN</span>
</pre></div>
</div>
<ul class="simple">
<li>LOG=CONSOLE routes all WTO message to the system console. This isthe default action.</li>
<li>LOG=SYSOUT routes all WTO messages to a VIRTEL SYSOUT dataset whichis dynamically allocated.</li>
<li>LOG=BOTH routes all WTO messages to both the system console and a dynamically allocated SYSOUT dataset.</li>
<li>LOG=SPIN forces Virtel to release the current SYSOUT dataset for further processing and allocates a new SYSOUT dataset.</li>
</ul>
<p>Virtel will direct messages to an allocated SYSOUT data set and | or the console (default). If SYSOUT processing is being used you
will see a dynamically allocated dataset in the SDSF display panel.</p>
<p>Issue a “?” next to the VIRTEL started task.</p>
<p><a class="reference internal" href="../../../_images/image613.png"><img alt="image5" src="../../../_images/image613.png" style="width: 6.30000in; height: 1.73958in;" /></a></p>
<p>Here we can see that VIRTEL has allocated a DDNAME SYS00001. If we
select this dataset in SDSF we can see that it is the VIRTEL message
log that would normally be written to the system console log.</p>
<p><a class="reference internal" href="../../../_images/image71.png"><img alt="image6" src="../../../_images/image71.png" style="width: 6.30000in; height: 2.96875in;" /></a></p>
<p>Assuming that VJRS is running, if we spin this dataset off using the
LOG=SPIN command, VIRTEL will release the SYSOUT dataset to JES2.
VJRS will then capture it and send it to its destination which is
EDSPRT. EDSPRT just happens to be the relay LU defined in VIRTEL and
associated with the printer REHIM000.</p>
<p>In the VIRTEL 3270 session issue the command:-</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="n">VIRTEL</span><span class="p">,</span><span class="n">LOG</span><span class="o">=</span><span class="n">SPIN</span>
</pre></div>
</div>
<p>In the top right of the VIRTEL window, next to the language
indicator, a printer box will appear:-</p>
<p><a class="reference internal" href="../../../_images/image81.png"><img alt="image7" src="../../../_images/image81.png" style="width: 6.30000in; height: 1.12500in;" /></a></p>
<p>Pressing the printer icon will process the capture message log from
VIRTEL and convert it to a PDF file through MAKEPDF. The PDF file
will then be display. The message log can then be saved as a PDF
file.</p>
<p><a class="reference internal" href="../../../_images/image91.png"><img alt="image8" src="../../../_images/image91.png" style="width: 6.30000in; height: 4.39792in;" /></a></p>
<p><strong>Messages and Abends</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span>Module VJES0100

    VJRS001I - VIRTEL JES WRITER READY
    VJRS has established a SAPI interface with JES2 and is ready to receive output.

    Action: None

    VJRS002E – (XXXX:YYYY) PRINTER TASK FAILED
    VJRS attached printer task YYYY has failed to print print request
    YYYY. The attached task has terminated.

    Action: Check SYSLOG for the cause of the attached printer task
    failure. Send dump to support. Stop and restart VJRS.

    VJRS008I – VIRTEL JES WRITER CLOSED
    VJRS is closing due to an operator STOP command being issued.

    Action: None

    VJRS009W – PRINTER TABLE FULL
    VJRS can only support 100 printer destinations.

    Action: VJRS terminates with return code 4. Reduce the number of
    printer control statements.

    VJRS010W – PPPPPPPP:LLLLLLLL – LU already defined in printer TTTTTTTT
    While reading in the control statements VJRS has detected that LU
    relay LLLLLLLL is already associated with destination TTTTTTTT and
    cannot be defined to destination PPPPPPPP.

    Action: VJRS ignores the control statement.

    VJRS011W – PPPPPPPP:LLLLLLLL – Waiting for printer task to complete
    VJRS is shutting down and is waiting for printer PPPPPPPP on relay
    LLLLLLLL to complete.

    Action: None

Module VJRES0101

    VJRS103I - (RRRR:TTTT) JES WRITER STARTING FOR XXXXXXXX JJJJJJJJ:NNNNNNNN)
    VJRS printer task has established a VTAM session with Virtel relay
    XXXXXXXX. RRRR is the printer request and TTTT is the printer task
    ID.

    Action: None

    VJRS104I - (RRRR:TTTT) JES WRITER ENDED FOR XXXXXXXX
    VJRS has complete writing the JES output to the Virtel relay session
    XXXXXXXX. RRRR is the printer request and TTTT is the printer task
    ID.

    Action: None

    VJRS105W - (RRRR:TTTT) XXXXXXXX RC=XX RTNCD=XX FDBK2=XX
    VJRS has incurred a SNA error in establishing a VTAM session with
    Virtel relay print LU XXXXXXX.

    Action: Session will be retried up to 10 times and if it still fails
    to establish a session the printer will be disabled from further
    prints. Investigate Virtel LU relay. Issue a D NET command against
    the Virtel LU printer relay and make sure it is in an ACTIVE state.

    VJRS106W - (RRRR:TTTT) SSENSEI=XX SSENSMI=XX USENSEI=XXXX
    Second part of VTAM session failure.

    Action: See message VJRS105W

    VJRS107E - (RRRR:TTTT) VTAM SEND FAILED FOR XXXXXXXX
    VJRS has failed to send data to the Virtel LU printer relay. RRRR is
    the printer request and TTTT is the printer task ID

    Action: Printer task Abends U807

    VJRS108E - LU XXXXXXXX NOT AVAILABLE
    VJRS printer task is unable to contact the Virtel LU printer relay
    XXXXXXXX. The RPLRTNCD code has returned X’0008’.

    Action: Session will be retried up to 10 times and if it still fails
    to establish a session the printer will be disabled from further
    prints. Investigate Virtel LU relay. Issue a D NET command against
    the Virtel LU printer relay and make sure it is in an ACTIVE state.

    VJRS109E - LU XXXXXXXX INVALID

    VJRS printer task is unable to establish a session with the Virtel
    LU printer relay XXXXXXXX. The RPLRTNCD code has returned X’1453’.

    Action: Session will be retried up to 10 times and if it still fails
    to establish a session the printer will be disabled from further
    prints. Investigate Virtel LU relay. Issue a D NET command against
    the Virtel LU printer relay and make sure it is in an ACTIVE state.

    VJRS110E - LU XXXXXXXX DISABLED. ERROR COUNT EXCEEDED
    VJRS has attempted to establish a session with the Virtel LU printer
    relay but after 10 attempts this has still failed: The printer will
    be disabled for further prints.

    Action: Investiagte the status of the Virtel LU printer. It must be
    in an ACTIVE state to accept sessions from VJRS.
</pre></div>
</div>
<p>Abends</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">U800</span> <span class="n">VJES0101</span> <span class="n">Dynamic</span> <span class="n">allocation</span> <span class="n">error</span><span class="o">.</span>
<span class="n">U801</span> <span class="n">VJES0101</span> <span class="n">I</span><span class="o">/</span><span class="n">O</span> <span class="n">Error</span> <span class="n">reading</span> <span class="n">JES2</span> <span class="n">dataset</span><span class="o">.</span>
<span class="n">U802</span> <span class="n">VJES0100</span> <span class="n">VTAM</span> <span class="n">ACB</span> <span class="n">failed</span> <span class="n">to</span> <span class="nb">open</span><span class="o">.</span>
<span class="n">U803</span> <span class="n">VJES0101</span> <span class="n">VTAM</span> <span class="n">OPNDST</span> <span class="n">failed</span><span class="o">.</span>
<span class="n">U804</span> <span class="n">VJES0101</span> <span class="n">VTAM</span> <span class="n">OPNDST</span><span class="o">/</span><span class="n">ACQUIRE</span> <span class="n">failed</span><span class="o">.</span>
<span class="n">U805</span> <span class="n">VJES0101</span> <span class="n">VTAM</span> <span class="n">SIMLOGON</span> <span class="n">failed</span><span class="o">.</span>
<span class="n">U806</span> <span class="n">VJES0101</span> <span class="n">VTAM</span> <span class="n">CLSDST</span> <span class="n">failed</span><span class="o">.</span>
<span class="n">U807</span> <span class="n">VJES0101</span> <span class="n">VTAM</span> <span class="n">SEND</span> <span class="n">failed</span><span class="o">.</span>
<span class="n">U808</span> <span class="n">VJES0100</span> <span class="n">SSOB</span> <span class="n">SAPI</span> <span class="n">failed</span><span class="o">.</span>
<span class="n">U810</span> <span class="n">VJES0101</span> <span class="n">VTAM</span> <span class="n">GENCB</span> <span class="n">NIB</span> <span class="n">failed</span><span class="o">.</span>
<span class="n">U811</span> <span class="n">VJES0101</span> <span class="n">VTAM</span> <span class="n">GENCB</span> <span class="n">RPL</span> <span class="n">failed</span><span class="o">.</span>
</pre></div>
</div>
<p>Bugs and Restrictions</p>
<p>Release 0.0</p>
<ol class="arabic simple">
<li>VJRS doesn’t recover from VTAM or network issues. SNA sense code 087D0001.</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span>$HASP373 VJRS STARTED
IEF403I VJRS - STARTED - TIME=13.44.35
VJRS001I - VIRTEL JES WRITER READY
VJRS103I - (0001:0001) JES WRITER STARTING FOR EDSPRT (SPTHOLTP:JOB05920)
IST663I INIT OTHER REQUEST FAILED, SENSE=087D0001 223
IST664I REAL OLU=SPNET.VJRS ALIAS DLU=SPNET.REHIM000
IST889I SID = CA7B8B52BA578A48
IST1705I SORDER = APPN FROM START OPTION
IST1705I SSCPORD = PRIORITY FROM START OPTION
IST894I ADJSSCPS TRIED FAILURE SENSE ADJSSCPS TRIED FAILURE SENSE
IST895I ISTAPNCP 08400007
IST314I END
VJRS105W - (0001:0001) REHIM000 RC=04 RTNCD=10 FDBK2=01
VJRS106W - (0001:0001) SSENSEI=08 SSENSMI=7D USENSEI=0001
P VIRTEL
VIR0009I APPLHOLT : SHUT DOWN IN PROGRESS
</pre></div>
</div>
<p>Solution:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>Stop Virtel
Stop VJRS
Delete any output on JES2 that is targeted for Virtel
Restart VIRTEL
Establish LU relays – sign on to application
Start VJRS
Run print job again.
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li>VJRS doesn’t recover from Virtel Timeout. When Virtel terminal session times out VJRS fails to reconnect successfully to printer.</li>
</ol>
<p>Solution:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">See</span> <span class="n">problem</span> <span class="n">number</span> <span class="mf">1.</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li>Abend0C7 on Startup</li>
</ol>
<p>Solution:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">MAXTASKS</span> <span class="n">must</span> <span class="n">be</span> <span class="n">two</span> <span class="n">digits</span><span class="o">.</span> <span class="mi">01</span> <span class="n">through</span> <span class="n">to</span> <span class="mf">99.</span> <span class="n">Default</span> <span class="ow">is</span> <span class="mf">05.</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li>Fix multi page support</li>
</ol>
<p>Release 0.1 11/2014</p>
<p>1. MakePDF doesn’t support x’00’ in the data stream and issues an error
meesage “End of block marker not found”. VJRS now checks data stream
before sending to Virtel.</p>
<p>2. Documentation updated. Includes description of how to incorporate
Virtel syslog capture with VJRS.</p>
<p>Release 0.2 02/2015</p>
<p>1. VJRS0200 recompiled with MAKEPDF version 1.2. This MAKEPDF version
has been modified so that the watermark is not printed.</p>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../TN201416/TN201416.html" class="btn btn-neutral float-right" title="Virtel Security. Using server and client certificates" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../TN201414/TN201414.html" class="btn btn-neutral" title="CICS Printing problem" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Syspertec. All rights reserved.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'7',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>