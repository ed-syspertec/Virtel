

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Running multiple instances of Virtel &mdash; Virtel 1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../../search.html"/>
    <link rel="top" title="Virtel 1 documentation" href="../../../../index.html"/> 

  
  <script src="../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../index.html" class="icon icon-home"> Virtel
          

          
            
            <img src="../../../../_static/logo_virtel_web.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../virtel.html">Virtel Manuals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../newsletters.html">Technical Newsletters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../howto.html">Miscellaneous</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../../index.html">Virtel</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../../index.html">Docs</a> &raquo;</li>
      
    <li>Running multiple instances of Virtel</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../../_sources/manuals/newsletters/TN201415/TN201504/TN201504.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="running-multiple-instances-of-virtel">
<h1>Running multiple instances of Virtel<a class="headerlink" href="#running-multiple-instances-of-virtel" title="Permalink to this headline">Â¶</a></h1>
<p>For High Availability and performance reasons it is often necessary to
run multiple copies of Virtel, preferably within separate LPARs on
separate physical machines. This newsletter discusses the issues raised
when implementing such a setup and how Virtel can exploit the IBM
Sysplex technologies. In the following example there are two instances
of Virtel running on separate physical machines sharing the same ARBO
configuration file. The configuration looks like this:-</p>
<p><a class="reference internal" href="../../../../_images/image11.jpg"><img alt="image0" src="../../../../_images/image11.jpg" style="width: 5.88542in; height: 5.21875in;" /></a></p>
<p>Virtel is using several Sysplex technologies to achieve this
configuration. For example, Virtel is using VTAM Generic Resources to
facilitate access to the Virtel Administration functions from either
instance of Virtel. VTAM generic resources can be used to distribute
workloads across applications that perform the same task or function.
Administration of the ARBO file is through the Virtel Administrator who
can logon on to Virtel using the generic Virtel ACB name VIRTPLEX. This
generic ACB enables management of the ARBO file through either VIRTEL1A
or VIRTEL2A. This can be useful, for example, If SYSA was down for
maintenance. VIRTEL administration could still conducted via VIRTEL2A
access. No change would be necessary to any session management tools.</p>
<p>Here are the relevant definitions required to support the VTAM generic
resource within Virtel.</p>
<p><strong>VIRTEL TCT</strong></p>
<p>GRNAME=VIRTPLEX, VTAM GENERIC RESOURCE NAME</p>
<p><strong>SYSPLEX definitions</strong></p>
<p>The ISTGENERIC structure will have to be allocated before you can use
VTAM generic resources. See the IBM Network Implementation Guide for
further information on configuring the CFRM.</p>
<p>Use the following command to display coupling allocation details for
ISTGENERIC.</p>
<p>D XCF,STR,STRNM=ISTGENERIC</p>
<p><strong>VTAM displayof the generic resource</strong></p>
<p>The results from the D NET,ID=VTAMPLEX,E identifies the two Virtel
instances which are grouped into the generic resource name VIRTPLEX. The
example below shows VIRTEL1A and VIRTEL2A as participating in the
VIRTRPLEX resource name group.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="n">NET</span><span class="p">,</span><span class="n">ID</span><span class="o">=</span><span class="n">VIRTPLEX</span><span class="p">,</span><span class="n">E</span>

<span class="n">IST097I</span> <span class="n">DISPLAY</span> <span class="n">ACCEPTED</span>
<span class="n">IST075I</span> <span class="n">NAME</span> <span class="o">=</span> <span class="n">VIRTPLEX</span><span class="p">,</span> <span class="n">TYPE</span> <span class="o">=</span> <span class="n">GENERIC</span> <span class="n">RESOURCE</span> <span class="mi">917</span>
<span class="n">IST1359I</span> <span class="n">MEMBER</span> <span class="n">NAME</span> <span class="n">OWNING</span> <span class="n">CP</span> <span class="n">SELECTABLE</span> <span class="n">APPC</span>
<span class="n">IST1360I</span> <span class="n">SPNET</span><span class="o">.</span><span class="n">VIRTEL1A</span> <span class="n">ZAM1SSCP</span> <span class="n">YES</span> <span class="n">NO</span>
<span class="n">IST1360I</span> <span class="n">SPNET</span><span class="o">.</span><span class="n">VIRTEL2A</span> <span class="n">ZAM2SSCP</span> <span class="n">YES</span> <span class="n">NO</span>
<span class="n">IST2210I</span> <span class="n">GR</span> <span class="n">PREFERENCE</span> <span class="n">TABLE</span> <span class="n">ENTRY</span> <span class="o">=</span> <span class="o">**</span><span class="n">DEFAULT</span><span class="o">**</span>
<span class="n">IST2202I</span> <span class="n">GREXIT</span> <span class="o">=</span> <span class="n">NO</span> <span class="n">WLM</span> <span class="o">=</span> <span class="n">YES</span> <span class="n">LOCLU</span> <span class="o">=</span> <span class="n">YES</span>
<span class="n">IST2204I</span> <span class="n">LOCAPPL</span> <span class="o">=</span> <span class="n">YES</span> <span class="n">PASSOLU</span> <span class="o">=</span> <span class="n">NO</span>
<span class="n">IST314I</span> <span class="n">END</span>
</pre></div>
</div>
<p>When the VIRTEL*A application is display in VTAM the following messages
are written to the console log:-</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="n">NET</span><span class="p">,</span><span class="n">ID</span><span class="o">=</span><span class="n">VIRTEL1A</span><span class="p">,</span><span class="n">E</span>
<span class="n">IST097I</span> <span class="n">DISPLAY</span> <span class="n">ACCEPTED</span>
<span class="n">IST075I</span> <span class="n">NAME</span> <span class="o">=</span> <span class="n">SPNET</span><span class="o">.</span><span class="n">VIRTEL1A</span><span class="p">,</span> <span class="n">TYPE</span> <span class="o">=</span> <span class="n">APPL</span> <span class="mi">925</span>
<span class="n">IST486I</span> <span class="n">STATUS</span><span class="o">=</span> <span class="n">ACT</span><span class="o">/</span><span class="n">S</span><span class="p">,</span> <span class="n">DESIRED</span> <span class="n">STATE</span><span class="o">=</span> <span class="n">ACTIV</span>
<span class="n">IST1447I</span> <span class="n">REGISTRATION</span> <span class="n">TYPE</span> <span class="o">=</span> <span class="n">CDSERVR</span>
<span class="n">IST1363I</span> <span class="n">GENERIC</span> <span class="n">RESOURCE</span> <span class="n">NAME</span> <span class="n">VIRTPLEX</span> <span class="n">REPRESENTS</span> <span class="n">SPNET</span><span class="o">.</span><span class="n">VIRTEL1A</span>
<span class="n">IST977I</span> <span class="n">MDLTAB</span><span class="o">=</span>\<span class="o">*</span>\<span class="o">*</span>\<span class="o">*</span><span class="n">NA</span>\<span class="o">*</span>\<span class="o">*</span>\<span class="o">*</span> <span class="n">ASLTAB</span><span class="o">=</span>\<span class="o">*</span>\<span class="o">*</span>\<span class="o">*</span><span class="n">NA</span>\<span class="o">*</span>\<span class="o">*</span>\<span class="o">*</span>
<span class="n">IST861I</span> <span class="n">MODETAB</span><span class="o">=</span>\<span class="o">*</span>\<span class="o">*</span>\<span class="o">*</span><span class="n">NA</span>\<span class="o">*</span>\<span class="o">*</span>\<span class="o">*</span> <span class="n">USSTAB</span><span class="o">=</span>\<span class="o">*</span>\<span class="o">*</span>\<span class="o">*</span><span class="n">NA</span>\<span class="o">*</span>\<span class="o">*</span>\<span class="o">*</span><span class="n">LOGTAB</span><span class="o">=</span>\<span class="o">*</span>\<span class="o">*</span>\<span class="o">*</span><span class="n">NA</span>\<span class="o">*</span>\<span class="o">*</span>\<span class="o">*</span>
<span class="n">IST934I</span> <span class="n">DLOGMOD</span><span class="o">=</span>\<span class="o">*</span>\<span class="o">*</span>\<span class="o">*</span><span class="n">NA</span>\<span class="o">*</span>\<span class="o">*</span>\<span class="o">*</span> <span class="n">USS</span> <span class="n">LANGTAB</span><span class="o">=</span>\<span class="o">*</span>\<span class="o">*</span>\<span class="o">*</span><span class="n">NA</span>\<span class="o">*</span>\<span class="o">*</span>\<span class="o">*</span>
<span class="n">IST1632I</span> <span class="n">VPACING</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">IST1938I</span> <span class="n">APPC</span> <span class="o">=</span> <span class="n">NO</span>
<span class="n">IST597I</span> <span class="n">CAPABILITY</span><span class="o">-</span><span class="n">PLU</span> <span class="n">ENABLED</span> <span class="p">,</span><span class="n">SLU</span> <span class="n">ENABLED</span> <span class="p">,</span><span class="n">SESSION</span> <span class="n">LIMIT</span> <span class="n">NONE</span>
<span class="n">IST231I</span> <span class="n">APPL</span> <span class="n">MAJOR</span> <span class="n">NODE</span> <span class="o">=</span> <span class="n">APPLVIPX</span>
<span class="n">IST654I</span> <span class="n">I</span><span class="o">/</span><span class="n">O</span> <span class="n">TRACE</span> <span class="o">=</span> <span class="n">OFF</span><span class="p">,</span> <span class="n">BUFFER</span> <span class="n">TRACE</span> <span class="o">=</span> <span class="n">OFF</span>
<span class="n">IST1500I</span> <span class="n">STATE</span> <span class="n">TRACE</span> <span class="o">=</span> <span class="n">OFF</span>
<span class="n">IST271I</span> <span class="n">JOBNAME</span> <span class="o">=</span> <span class="n">SPVIR1A</span><span class="p">,</span> <span class="n">STEPNAME</span> <span class="o">=</span> <span class="n">SPVIR1A</span><span class="p">,</span> <span class="n">DSPNAME</span> <span class="o">=</span> <span class="n">ISTEBBDB</span>
<span class="n">IST228I</span> <span class="n">ENCRYPTION</span> <span class="o">=</span> <span class="n">OPTIONAL</span> <span class="p">,</span> <span class="n">TYPE</span> <span class="o">=</span> <span class="n">DES</span>
<span class="n">IST1563I</span> <span class="n">CKEYNAME</span> <span class="o">=</span> <span class="n">VIRTEL1A</span> <span class="n">CKEY</span> <span class="o">=</span> <span class="n">PRIMARY</span> <span class="n">CERTIFY</span> <span class="o">=</span> <span class="n">NO</span>
<span class="n">IST1552I</span> <span class="n">MAC</span> <span class="o">=</span> <span class="n">NONE</span> <span class="n">MACTYPE</span> <span class="o">=</span> <span class="n">NONE</span>
<span class="n">IST1050I</span> <span class="n">MAXIMUM</span> <span class="n">COMPRESSION</span> <span class="n">LEVEL</span> <span class="o">-</span> <span class="n">INPUT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">OUTPUT</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">IST1633I</span> <span class="n">ASRCVLM</span> <span class="o">=</span> <span class="mi">1000000</span>
<span class="n">IST1634I</span> <span class="n">DATA</span> <span class="n">SPACE</span> <span class="n">USAGE</span><span class="p">:</span> <span class="n">CURRENT</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">MAXIMUM</span> <span class="o">=</span> <span class="mi">1280</span>
<span class="n">IST171I</span> <span class="n">ACTIVE</span> <span class="n">SESSIONS</span> <span class="o">=</span> <span class="mi">0000000001</span><span class="p">,</span> <span class="n">SESSION</span> <span class="n">REQUESTS</span> <span class="o">=</span> <span class="mi">0000000000</span>
<span class="n">IST206I</span> <span class="n">SESSIONS</span><span class="p">:</span>
<span class="n">IST634I</span> <span class="n">NAME</span> <span class="n">STATUS</span> <span class="n">SID</span> <span class="n">SEND</span> <span class="n">RECV</span> <span class="n">VR</span> <span class="n">TP</span> <span class="n">NETID</span>
<span class="n">IST635I</span> <span class="n">SC0TCP13</span> <span class="n">ACTIV</span><span class="o">-</span><span class="n">S</span> <span class="n">CA7B8B52D125F31F</span> <span class="mi">0003</span> <span class="mi">0001</span> <span class="n">SPNET</span>
<span class="n">IST314I</span> <span class="n">END</span>
</pre></div>
</div>
<p>Message IST1363I confirms that VIRTEL operating under the ACB of VIRTEL1A is associated with the VTAM resource name VIRTPLEX.</p>
<p><strong>Using Virtel and VTAM Generic Resource Names to balance workload in a SYSPLEX environment.</strong></p>
<p>In the following configuration we can see how the VTAM generic resource
facility can also be used to distribute workloads across applications.
In this example there are several CICS TOR regions within CICSA, CICSB
and CICSC that are accessed through a VTAM generic resource name or
CICSPLEX group name. VIRTEL uses this name to access the CICS
application. The WLM and/or VTAM will distribute sessions across the
members of the CICS generic resource name.</p>
<p><a class="reference internal" href="../../../../_images/image2.jpg"><img alt="image1" src="../../../../_images/image2.jpg" style="width: 6.17708in; height: 6.46875in;" /></a></p>
<p>From a High Availability aspect both CICSA and CICSB could both be down
and service would still be provided by CICSC either through VIRTEL1A or
VIRTEL2A. In this configuration VIRTEL exploits SYSPLEX technologies to
provide a HA solution. The only VIRTEL requirement is to define a VIRTEL
transaction which targets CICSZ as the VTAM application, i.e. the VTAM
Generic Resource or CICSPLEX group name.</p>
<p><strong>Virtel naming conventions with multiple tasks</strong></p>
<p>When running more than one VIRTEL STC care must be taken when defining
the VTAM relay names that each VIRTEL tasks will use. In the above
configuration each Virtel instance is running on a different LPAR, and
for the HA reasons, probably on a different physical machine; however,
the VTAM names employed must be unique. With Virtel you can define a
single configuration within the ARBO and TCT which contains a unique
pool of Virtel relays for each Virtel instance.</p>
<p>Here are two possible ways to define the relay pools for multiple Virtel
instances:</p>
<p>The first way is to include the SYSCLONE value as part of the LU name.
The relay definitions utilize the system symbolic SYSCLONE value in the
IEASYMxx member of PARMLIB. The clone value is taken from the system
symbolic &amp;SYSCLONE and is identified in the VIRTEL definitions through
the + (plus) character:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">LIST</span> <span class="n">of</span> <span class="n">TERMINALS</span> <span class="o">----------------------------------</span> <span class="n">Applid</span><span class="p">:</span> <span class="n">VIRTEL1A</span> <span class="mi">15</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">01</span>
<span class="n">Terminal</span> Â <span class="n">Repeated</span> <span class="n">Relay</span> Â  Â  <span class="n">Entry</span> Â  Â  Â  Â <span class="n">Type</span> Â  <span class="n">I</span><span class="o">/</span><span class="n">O</span> Â <span class="n">Pool</span> Â  Â   <span class="mi">2</span><span class="n">nd</span>  <span class="n">Relay</span>
<span class="n">CLLOC000</span> Â <span class="mi">0050</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="mi">3</span> Â  Â  Â <span class="mi">3</span>
<span class="n">CLVTA000</span> Â <span class="mi">0080</span> Â  Â  <span class="o">*</span><span class="n">W2HPOOL</span> Â  Â  Â  Â  Â  Â  Â  <span class="mi">3</span> Â  Â  Â <span class="mi">3</span>
<span class="n">DELOC000</span> Â <span class="mi">0010</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="mi">3</span> Â  Â  Â <span class="mi">3</span>
<span class="n">DEVTA000</span> Â <span class="mi">0016</span> Â  Â  <span class="o">*</span><span class="n">W2HPOOL</span> Â  Â  Â  Â  Â  Â  Â  <span class="mi">3</span> Â  Â  Â <span class="mi">3</span>
<span class="n">W2HIM000</span> Â <span class="mi">0080</span> Â  Â  <span class="n">R</span><span class="o">+</span><span class="n">IM000</span> Â  Â  Â  Â  Â  Â  Â  Â <span class="mi">1</span> Â  Â  Â <span class="mi">1</span>
<span class="n">W2HTP000</span> Â <span class="mi">0080</span> Â  Â  <span class="n">R</span><span class="o">+</span><span class="n">VT000</span> Â  Â  Â  Â  Â  Â  Â  Â <span class="mi">3</span> Â  Â  Â <span class="mi">3</span> Â  Â <span class="o">*</span><span class="n">W2HPOOL</span>  <span class="n">R</span><span class="o">+</span><span class="n">IM000</span>
</pre></div>
</div>
<p><strong>TCT definition</strong></p>
<p>In the configuration above there are two Virtel STCs running on
different LPARS whose &amp;SYSCLONE values are 1A and 2A. With the same TCT
being used for both VIRTEL1A and VIRTEL2A the following is specified in
the common TCT:-</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">APPLID</span><span class="o">=</span><span class="n">VIRTEL</span><span class="o">+</span><span class="p">,</span>
<span class="n">SYSPLUS</span><span class="o">=</span><span class="n">YES</span><span class="p">,</span>
</pre></div>
</div>
<p>This will means that the two Virtels STCs will have a VTAM APPLID of
VIRTEL1A and VIRTEL2A. The Virtel relay LU names are R1AVT000-079 for
LPAR 1A, and R2AVT000-079 for LPAR 2A.</p>
<p>Note: It is recommended that only the ARBO file can be shared in this
configuration.</p>
<p>The VTAM definition to support this configuration would like:-</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>APPLVIPX VBUILD TYPE=APPL
\* ------------------------------------------------------------------ \*
\* Product : VIRTEL \*
\* Description : APPL for VIRTEL SYSPLEX (SPVIR1A and SPVIR2A) \*
\* ------------------------------------------------------------------ \*
VIRTEL&amp;SYSCLONE APPL EAS=160,AUTH=(ACQ,BLOCK,PASS,SPO), \*
      ACBNAME=VIRTEL&amp;SYSCLONE
\* ------------------------------------------------------------------ \*
\* R&amp;SYSCLONEVTxxx : VTAM application relays for VIRTEL Web Access \*
\* ------------------------------------------------------------------ \*
R&amp;SYSCLONE.VT??? APPL AUTH=(ACQ,PASS),MODETAB=ISTINCLM, \*
      DLOGMOD=SNX32702,EAS=1
\* ------------------------------------------------------------------ \*
\* R&amp;SYSCLONEIMxxx : Printer relays for VIRTEL Web Access terminals \*
\* ------------------------------------------------------------------ \*
R&amp;SYSCLONE.IM??? APPL AUTH=(ACQ,PASS),MODETAB=ISTINCLM, \*
      DLOGMOD=SCS,EAS=1
R&amp;SYSCLONE.IP??? APPL AUTH=(ACQ,PASS),MODETAB=ISTINCLM, \*
      DLOGMOD=DSILGMOD,EAS=1
</pre></div>
</div>
<p>Because this naming convention could be constraining if you want to use 4-character LU names, there is a second method which allows you to freely choose the LU names without the need to include the SYSCLONE   characters as part of the LU name. In the next example two pools are defined. Pool *W1APOOL has relay names J000-J999, K000-K999, L000-L999 for LPAR 1 (with printer names Pnnn,Qnnn,Rnnn), and pool *W2APOOL has relay names M000-M999, N000-N999, O000-O999 (with printer names Snnn,Tnnn,Unnn) for LPAR 2:-</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Terminal</span> Â <span class="n">Repeated</span> <span class="n">Relay</span> Â  Â  <span class="n">Entry</span> Â  Â  Â  Â <span class="n">Type</span> Â  <span class="n">I</span><span class="o">/</span><span class="n">O</span> Â <span class="n">Pool</span> Â  Â  <span class="mi">2</span><span class="n">nd</span>  <span class="n">Relay</span>
<span class="n">CLLOC000</span> Â <span class="mi">0500</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="mi">3</span> Â  Â  Â <span class="mi">3</span>
<span class="n">CLVTA000</span> Â <span class="mi">1000</span> Â  Â  <span class="o">*</span><span class="n">W</span><span class="o">+</span><span class="n">POOL</span> Â  Â  Â  Â  Â  Â  Â  Â <span class="mi">3</span> Â  Â  Â <span class="mi">3</span>
<span class="n">CLVTB000</span> Â <span class="mi">1000</span> Â  Â  <span class="o">*</span><span class="n">W</span><span class="o">+</span><span class="n">POOL</span> Â  Â  Â  Â  Â  Â  Â  Â <span class="mi">3</span> Â  Â  Â <span class="mi">3</span>
<span class="n">CLVTC000</span> Â <span class="mi">1000</span> Â  Â  <span class="o">*</span><span class="n">W</span><span class="o">+</span><span class="n">POOL</span> Â  Â  Â  Â  Â  Â  Â  Â <span class="mi">3</span> Â  Â  Â <span class="mi">3</span>
<span class="n">DELOC000</span> Â <span class="mi">0010</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="mi">3</span> Â  Â  Â <span class="mi">3</span>
<span class="n">DEVTA000</span> Â <span class="mi">0016</span> Â  Â  <span class="o">*</span><span class="n">W</span><span class="o">+</span><span class="n">POOL</span> Â  Â  Â  Â  Â  Â  Â  Â <span class="mi">3</span> Â  Â  Â <span class="mi">3</span>
<span class="n">W2HIP000</span> Â <span class="mi">1000</span> Â  Â  <span class="n">P000</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="mi">1</span> Â  Â  Â <span class="mi">1</span>
<span class="n">W2HIQ000</span> Â <span class="mi">1000</span> Â  Â  <span class="n">Q000</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="mi">1</span> Â  Â  Â <span class="mi">1</span>
<span class="n">W2HIR000</span> Â <span class="mi">1000</span> Â  Â  <span class="n">R000</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="mi">1</span> Â  Â  Â <span class="mi">1</span>
<span class="n">W2HIS000</span> Â <span class="mi">1000</span> Â  Â  <span class="n">S000</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="mi">1</span> Â  Â  Â <span class="mi">1</span>
<span class="n">W2HIT000</span> Â <span class="mi">1000</span> Â  Â  <span class="n">T000</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="mi">1</span> Â  Â  Â <span class="mi">1</span>
<span class="n">W2HIU000</span> Â <span class="mi">1000</span> Â  Â  <span class="n">U000</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="mi">1</span> Â  Â  Â <span class="mi">1</span>
<span class="n">W2HTJ000</span> Â <span class="mi">1000</span> Â  Â  <span class="n">J000</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="mi">3</span> Â  Â  Â <span class="mi">3</span> Â  Â <span class="o">*</span><span class="n">W1APOOL</span> <span class="n">P000</span>
<span class="n">W2HTK000</span> Â <span class="mi">1000</span> Â  Â  <span class="n">K000</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="mi">3</span> Â  Â  Â <span class="mi">3</span> Â  Â <span class="o">*</span><span class="n">W1APOOL</span> <span class="n">Q000</span>
<span class="n">W2HTL000</span> Â <span class="mi">1000</span> Â  Â  <span class="n">L000</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="mi">3</span> Â  Â  Â <span class="mi">3</span> Â  Â <span class="o">*</span><span class="n">W1APOOL</span> <span class="n">R000</span>
<span class="n">W2HTM000</span> Â <span class="mi">1000</span> Â  Â  <span class="n">M000</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="mi">3</span> Â  Â  Â <span class="mi">3</span> Â  Â <span class="o">*</span><span class="n">W2APOOL</span> <span class="n">S000</span>
<span class="n">W2HTN000</span> Â <span class="mi">1000</span> Â  Â  <span class="n">N000</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="mi">3</span> Â  Â  Â <span class="mi">3</span> Â  Â <span class="o">*</span><span class="n">W2APOOL</span> <span class="n">T000</span>
<span class="n">W2HTO000</span> Â <span class="mi">1000</span> Â  Â  <span class="n">O000</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="mi">3</span> Â  Â  Â <span class="mi">3</span> Â  Â <span class="o">*</span><span class="n">W2APOOL</span> <span class="n">U000</span>
</pre></div>
</div>
<p>The VTAM definitions would be similar to those from the previous example except the &amp;SYSCLONE would be replaced by the relay characters.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>APVIRT&amp;SYSCLONE. VBUILD TYPE=APPL
\* ------------------------------------------------------------------\*
\* Product Â  Â  : Â VIRTEL Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â  Â \*
\* Description : Â Main ACB for VIRTEL application                    \*
\* ------------------------------------------------------------------\*
VIRTEL&amp;SYSCLONE APPL AUTH=(ACQ,BLOCK,PASS,SPO),EAS=160,              Â +
Â  Â  Â  Â  Â  Â  Â ACBNAME=VIRTEL&amp;SYSCLONE
\* ------------------------------------------------------------------\*
\* Jxxx,Kxxx Â  : VTAM application relays for VIRTEL Web Access\*
\* Lxxx,Mxxx Â  : VTAM application relays for VIRTEL Web Access \*
\* Nxxx,Oxxx Â  : VTAM application relays for VIRTEL Web Access\*
\* ------------------------------------------------------------------\*
J??? APPL Â AUTH=(ACQ,PASS),MODETAB=ISTINCLM,DLOGMOD=SNX32702,EAS=1
K??? APPL Â AUTH=(ACQ,PASS),MODETAB=ISTINCLM,DLOGMOD=SNX32702,EAS=1
L??? APPL Â AUTH=(ACQ,PASS),MODETAB=ISTINCLM,DLOGMOD=SNX32702,EAS=1
M??? APPL Â AUTH=(ACQ,PASS),MODETAB=ISTINCLM,DLOGMOD=SNX32702,EAS=1
N??? APPL Â AUTH=(ACQ,PASS),MODETAB=ISTINCLM,DLOGMOD=SNX32702,EAS=1
O??? APPL Â AUTH=(ACQ,PASS),MODETAB=ISTINCLM,DLOGMOD=SNX32702,EAS=1
\* ------------------------------------------------------------------\*
\* Pxxx,Qxxx Â  : Printer relays for VIRTEL Web Access terminals      \*
\* Rxxx,Sxxx Â  : Printer relays for VIRTEL Web Access terminals      \*
\* Txxx,Uxxx Â  : Printer relays for VIRTEL Web Access terminals Â  Â  Â \*
\* ------------------------------------------------------------------\*
P??? APPL AUTH=NVPACE,EAS=1,PARSESS=NO,MODETAB=ISTINCLM,SESSLIM=YES
Q??? APPL AUTH=NVPACE,EAS=1,PARSESS=NO,MODETAB=ISTINCLM,SESSLIM=YES
R??? APPL AUTH=NVPACE,EAS=1,PARSESS=NO,MODETAB=ISTINCLM,SESSLIM=YES
S??? APPL AUTH=NVPACE,EAS=1,PARSESS=NO,MODETAB=ISTINCLM,SESSLIM=YES
T??? APPL AUTH=NVPACE,EAS=1,PARSESS=NO,MODETAB=ISTINCLM,SESSLIM=YES
U??? APPL AUTH=NVPACE,EAS=1,PARSESS=NO,MODETAB=ISTINCLM,SESSLIM=YES
</pre></div>
</div>
<p><strong>Using the Distributed VIPA with Virtel</strong></p>
<p>Using a Dynamic VIPA with IBMâs SYSPLEX Distributor (SD) you can balance
Virtel session workload across more than one Virtel STC. The
distributing TCPIP stack will balance workload across the participating
target TCPIP stacks. Allocation of new sessions on the IP side will
depend on the selected SD/WLM algorithm. For example this can be a Round
Robin policy or WLM policy workload algorithm. Access to the Virtel
tasks is through using distributed VIPA address which is defined in a
TCPIP profile. In the configuration above it is defined as
192.168.170.15. The relevant PROFILE definitions for TCPIP would look
like:-</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">VIPADYNAMIC</span>
<span class="n">VIPARANGE</span> <span class="n">DEFINE</span> <span class="n">MOVEABLE</span> <span class="n">NONDISRUPTIVE</span> <span class="mf">255.255</span><span class="o">.</span><span class="mf">255.0</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">170.20</span>
<span class="n">VIPADEFINE</span> <span class="n">MOVE</span> <span class="n">IMMED</span> <span class="mf">255.255</span><span class="o">.</span><span class="mf">255.0</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">170.15</span>
<span class="n">VIPADISTRIBUTE</span> <span class="n">DEFINE</span> <span class="n">TIMEDAFF</span> <span class="mi">300</span> <span class="n">DISTMETHOD</span> <span class="n">ROUNDROBIN</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">170.15</span>
<span class="n">DESTIP</span> <span class="n">ALL</span>
<span class="n">ENDVIPADYNAMIC</span>
</pre></div>
</div>
<p>It is essential to include the TIMEDAFF parameter in the VIPA definition
as this maintains session affinity. The TIMEDAFF facility ensures that a
user will always connect to the same VIRTEL while a session is open.
Also, it is recommended that the Virtel line W-HTTP (port 41001) is used
for Virtel Administration and line C-HTTP (port 41002) for user access
to applications.</p>
<p>Line W-HTTP should be defined using the base address of the LPAR (i.e.
the home address of the default interface) by specifying only the port
number. For example:</p>
<p>Local address ==&gt; :41001</p>
<p>Line C-HTTP should be defined using the distributed VIPA address with port number:</p>
<p>Local address ==&gt; 192.168.170.15:41002</p>
<p>The Virtel Line display command displays this configuration:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="n">SPVIR1A</span><span class="p">,</span><span class="n">LINES</span>
<span class="n">VIR0200I</span> <span class="n">LINES</span>
<span class="n">VIR0201I</span> <span class="n">VIRTEL</span> <span class="mf">4.54</span> <span class="n">APPLID</span><span class="o">=</span><span class="n">VIRTEL1A</span> <span class="n">LINES</span>
<span class="n">VIR0202I</span> <span class="n">INT</span><span class="o">.</span><span class="n">NAME</span> <span class="n">EXT</span><span class="o">.</span><span class="n">NAME</span> <span class="n">TYPE</span> <span class="n">ACB</span> <span class="n">OR</span> <span class="n">IP</span>
<span class="n">VIR0202I</span> <span class="o">--------</span> <span class="o">--------</span> <span class="o">-----</span> <span class="o">---------</span>
<span class="n">VIR0202I</span> <span class="n">C</span><span class="o">-</span><span class="n">HTTP</span> <span class="n">HTTP</span><span class="o">-</span><span class="n">CLI</span> <span class="n">TCP1</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">170.15</span><span class="p">:</span><span class="mi">41002</span>
<span class="n">VIR0202I</span> <span class="n">W</span><span class="o">-</span><span class="n">HTTP</span> <span class="n">HTTP</span><span class="o">-</span><span class="n">W2H</span> <span class="n">TCP1</span> <span class="p">:</span><span class="mi">41001</span>
<span class="n">VIR0202I</span> <span class="o">---</span><span class="n">END</span> <span class="n">OF</span> <span class="n">LIST</span><span class="o">---</span>
</pre></div>
</div>
<p>In this way the administrator can access a specific Virtel using port 41001 of the appropriate LPARâs IP address, while the users can access both Virtels using port 41002 on the DVIPA address.</p>
<p><strong>Uisng Virtel with Apache Proxy as a load balancing mechanism</strong></p>
<p>Another way of balancing workloads across multiple Virtel instances is through an Apache Reverse Proxy Server. In this setup the proxy server load balances IP sessions across the known TCPIP stacks, very much like IBMâs Sysplex Distributor.</p>
<p>See : <cite>D:\Documents\SysperTec\Newsletters\Proxy Load Balancing.jpg</cite></p>
<p>Again, to maintain session affinity the correct load balancing parameters must be used. An example from the http.conf looks like this:-</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Virtel</span>
<span class="c1">#</span>
<span class="n">ProxyPass</span> <span class="o">/</span> <span class="n">balancer</span><span class="p">:</span><span class="o">//</span><span class="n">hostcluster</span><span class="o">/</span>
<span class="n">ProxyPassReverse</span> <span class="o">/</span> <span class="n">balancer</span><span class="p">:</span><span class="o">//</span><span class="n">hostcluster</span><span class="o">/</span>
<span class="o">&lt;</span><span class="n">Proxy</span> <span class="n">balancer</span><span class="p">:</span><span class="o">//</span><span class="n">hostcluster</span><span class="o">&gt;</span>
<span class="n">BalancerMember</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">syt00101</span><span class="o">.</span><span class="n">gzaop</span><span class="o">.</span><span class="n">local</span><span class="p">:</span><span class="mi">41002</span> <span class="n">retry</span><span class="o">=</span><span class="mi">5</span>
<span class="n">BalancerMember</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">syt00101</span><span class="o">.</span><span class="n">gzaop</span><span class="o">.</span><span class="n">local</span><span class="p">:</span><span class="mi">51002</span> <span class="n">retry</span><span class="o">=</span><span class="mi">5</span>
<span class="n">ProxySet</span> <span class="n">lbmethod</span><span class="o">=</span><span class="n">byrequests</span>
<span class="o">&lt;/</span><span class="n">Proxy</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>For more information on setting up an Apache Proxy Server visit <a class="reference external" href="http://httpd.apache.org/docs/2.2/mod/mod_proxy_balancer.html">http://httpd.apache.org/docs/2.2/mod/mod_proxy_balancer.html</a></p>
<p>To use Apache as a Proxy Server it is essential that the correct configuration modules are loaded at startup:-</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">#LoadModule foo\_module modules/mod\_foo.so</span>
<span class="n">LoadModule</span> <span class="n">authz</span>\<span class="n">_host</span>\<span class="n">_module</span> <span class="n">modules</span><span class="o">/</span><span class="n">mod</span>\<span class="n">_authz</span>\<span class="n">_host</span><span class="o">.</span><span class="n">so</span>
<span class="n">LoadModule</span> <span class="n">auth</span>\<span class="n">_basic</span>\<span class="n">_module</span> <span class="n">modules</span><span class="o">/</span><span class="n">mod</span>\<span class="n">_auth</span>\<span class="n">_basic</span><span class="o">.</span><span class="n">so</span>
<span class="n">LoadModule</span> <span class="n">authn</span>\<span class="n">_file</span>\<span class="n">_module</span> <span class="n">modules</span><span class="o">/</span><span class="n">mod</span>\<span class="n">_authn</span>\<span class="n">_file</span><span class="o">.</span><span class="n">so</span>
<span class="n">LoadModule</span> <span class="n">authz</span>\<span class="n">_user</span>\<span class="n">_module</span> <span class="n">modules</span><span class="o">/</span><span class="n">mod</span>\<span class="n">_authz</span>\<span class="n">_user</span><span class="o">.</span><span class="n">so</span>
<span class="c1">#LoadModule authz\_groupfile\_module modules/mod\_authz\_groupfile.so</span>
<span class="n">LoadModule</span> <span class="n">include</span>\<span class="n">_module</span> <span class="n">modules</span><span class="o">/</span><span class="n">mod</span>\<span class="n">_include</span><span class="o">.</span><span class="n">so</span>
<span class="n">LoadModule</span> <span class="n">log</span>\<span class="n">_config</span>\<span class="n">_module</span> <span class="n">modules</span><span class="o">/</span><span class="n">mod</span>\<span class="n">_log</span>\<span class="n">_config</span><span class="o">.</span><span class="n">so</span>
<span class="n">LoadModule</span> <span class="n">env</span>\<span class="n">_module</span> <span class="n">modules</span><span class="o">/</span><span class="n">mod</span>\<span class="n">_env</span><span class="o">.</span><span class="n">so</span>
<span class="c1">#LoadModule mime\_magic\_module modules/mod\_mime\_magic.so</span>
<span class="c1">#LoadModule expires\_module modules/mod\_expires.so</span>
<span class="n">LoadModule</span> <span class="n">headers</span>\<span class="n">_module</span> <span class="n">modules</span><span class="o">/</span><span class="n">mod</span>\<span class="n">_headers</span><span class="o">.</span><span class="n">so</span>
<span class="n">LoadModule</span> <span class="n">unique</span>\<span class="n">_id</span>\<span class="n">_module</span> <span class="n">modules</span><span class="o">/</span><span class="n">mod</span>\<span class="n">_unique</span>\<span class="n">_id</span><span class="o">.</span><span class="n">so</span>
<span class="n">LoadModule</span> <span class="n">setenvif</span>\<span class="n">_module</span> <span class="n">modules</span><span class="o">/</span><span class="n">mod</span>\<span class="n">_setenvif</span><span class="o">.</span><span class="n">so</span>
<span class="n">LoadModule</span> <span class="n">proxy</span>\<span class="n">_module</span> <span class="n">modules</span><span class="o">/</span><span class="n">mod</span>\<span class="n">_proxy</span><span class="o">.</span><span class="n">so</span>
<span class="n">LoadModule</span> <span class="n">proxy</span>\<span class="n">_connect</span>\<span class="n">_module</span> <span class="n">modules</span><span class="o">/</span><span class="n">mod</span>\<span class="n">_proxy</span>\<span class="n">_connect</span><span class="o">.</span><span class="n">so</span>
<span class="c1">#LoadModule proxy\_ftp\_module modules/mod\_proxy\_ftp.so</span>
<span class="n">LoadModule</span> <span class="n">proxy</span>\<span class="n">_http</span>\<span class="n">_module</span> <span class="n">modules</span><span class="o">/</span><span class="n">mod</span>\<span class="n">_proxy</span>\<span class="n">_http</span><span class="o">.</span><span class="n">so</span>
<span class="n">LoadModule</span> <span class="n">mime</span>\<span class="n">_module</span> <span class="n">modules</span><span class="o">/</span><span class="n">mod</span>\<span class="n">_mime</span><span class="o">.</span><span class="n">so</span>
<span class="c1">#LoadModule dav\_module modules/mod\_dav.so</span>
<span class="c1">#LoadModule dav\_fs\_module modules/mod\_dav\_fs.so</span>
<span class="n">LoadModule</span> <span class="n">autoindex</span>\<span class="n">_module</span> <span class="n">modules</span><span class="o">/</span><span class="n">mod</span>\<span class="n">_autoindex</span><span class="o">.</span><span class="n">so</span>
<span class="c1">#LoadModule asis\_module modules/mod\_asis.so</span>
<span class="c1">#LoadModule info\_module modules/mod\_info.so</span>
<span class="n">LoadModule</span> <span class="n">cgi</span>\<span class="n">_module</span> <span class="n">modules</span><span class="o">/</span><span class="n">mod</span>\<span class="n">_cgi</span><span class="o">.</span><span class="n">so</span>
<span class="n">LoadModule</span> <span class="nb">dir</span>\<span class="n">_module</span> <span class="n">modules</span><span class="o">/</span><span class="n">mod</span>\<span class="n">_dir</span><span class="o">.</span><span class="n">so</span>
<span class="n">LoadModule</span> <span class="n">actions</span>\<span class="n">_module</span> <span class="n">modules</span><span class="o">/</span><span class="n">mod</span>\<span class="n">_actions</span><span class="o">.</span><span class="n">so</span>
<span class="c1">#LoadModule speling\_module modules/mod\_speling.so</span>
<span class="c1">#LoadModule userdir\_module modules/mod\_userdir.so</span>
<span class="n">LoadModule</span> <span class="n">alias</span>\<span class="n">_module</span> <span class="n">modules</span><span class="o">/</span><span class="n">mod</span>\<span class="n">_alias</span><span class="o">.</span><span class="n">so</span>
<span class="c1">#LoadModule rewrite\_module modules/mod\_rewrite.so</span>
<span class="c1">#LoadModule deflate\_module modules/mod\_deflate.so</span>
<span class="n">LoadModule</span> <span class="n">proxy</span>\<span class="n">_balancer</span>\<span class="n">_module</span> <span class="n">modules</span><span class="o">/</span><span class="n">mod</span>\<span class="n">_proxy</span>\<span class="n">_balancer</span><span class="o">.</span><span class="n">so</span>
</pre></div>
</div>
<p>Some other recommendations are:-</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">Timeouts</span>
<span class="n">SSLDisable</span>
<span class="n">SSLV3Timeout</span> <span class="mi">18010</span>
<span class="o">*</span> <span class="n">Format</span> <span class="n">log</span> <span class="k">with</span> <span class="n">router</span> <span class="n">information</span>
<span class="n">LogFormat</span> <span class="s2">&quot;%h %l </span><span class="si">%u</span><span class="s2"> %t </span><span class="se">\\</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">r</span>\\<span class="s2">&quot; %&gt;s %b </span><span class="se">\\</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">{</span><span class="n">Referer</span><span class="p">}</span><span class="n">i</span>\\<span class="s2">&quot; </span><span class="se">\\</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">{</span><span class="n">User</span><span class="o">-</span><span class="n">Agent</span><span class="p">}</span><span class="n">i</span>\\<span class="s2">&quot; </span><span class="se">\\</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">{</span><span class="n">BALANCER</span>\<span class="n">_WORKER</span>\<span class="n">_ROUTE</span><span class="p">}</span><span class="n">e</span>\\<span class="s2">&quot;&quot;</span> <span class="n">combined</span>
<span class="o">*</span> <span class="nb">set</span> <span class="n">Max</span><span class="o">-</span><span class="n">Age</span> <span class="n">to</span> <span class="mi">12</span><span class="n">h</span> <span class="p">(</span><span class="n">doesn</span><span class="s1">&#39;t work with IE)  or</span>
<span class="o">*</span> <span class="n">enable</span> <span class="n">mod</span>\<span class="n">_expires</span> <span class="ow">and</span> <span class="nb">set</span><span class="p">:</span> <span class="p">(</span><span class="n">this</span> <span class="n">should</span> <span class="n">be</span> <span class="n">checked</span><span class="p">)</span>
<span class="n">ExpiresActive</span> <span class="n">On</span>
<span class="n">ExpiresDefault</span> <span class="s2">&quot;access plus 16 h&quot;</span>
</pre></div>
</div>
<p>See <a class="reference external" href="https://httpd.apache.org/docs/2.2/mod/mod_expires.html">https://httpd.apache.org/docs/2.2/mod/mod_expires.html</a> for more information.</p>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Syspertec. All rights reserved.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../',
            VERSION:'1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>