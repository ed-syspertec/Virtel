

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>CICS Printing problem &mdash; Virtel 1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="Virtel 1 documentation" href="../../../index.html"/>
        <link rel="up" title="Technical Newsletters" href="../../../newsletters.html"/>
        <link rel="next" title="Virtel JES Writer program" href="../TN201415/TN201415.html"/>
        <link rel="prev" title="&lt;no title&gt;" href="../TN201413/TN201413.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> Virtel
          

          
            
            <img src="../../../_static/logo_virtel_web.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../newsletters.html">Technical Newsletters</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../newsletters.html#id1">2014</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../TN201402/TN201402.html">Formatting VIRTEL Line Trace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201403/TN201403.html">How to use TESTVTAM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201404/TN201404.html">VIRTEL SMF Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201405/TN201405.html">Multi Line WTO Support in VIRTEL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201406/TN201406.html">Taking a VIRTEL terminal trace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201407/TN201407.html">Pass tickets and supporting Proxy Servers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201409/TN201409.html">Mainframe printing with Virtel 4.56</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201410/TN201410.html">Taking a VTAM trace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201411/TN201411.html">Building a customized USSTAB using Virtel’s Web Access facility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201412/TN201412.html">Sharing user macros across multiple instances of Virtel</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">CICS Printing problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201415/TN201415.html">Virtel JES Writer program</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201416/TN201416.html">Virtel Security. Using server and client certificates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201417/TN201417.html">RACF Grouping Class and Virtel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201419/TN201419.html">Maintaining TRSF file sets</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index.html">Virtel</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../../newsletters.html">Technical Newsletters</a> &raquo;</li>
      
    <li>CICS Printing problem</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/manuals/newsletters/TN201414/TN201414.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cics-printing-problem">
<h1>CICS Printing problem<a class="headerlink" href="#cics-printing-problem" title="Permalink to this headline">¶</a></h1>
<p>The following is a CICS log which highlights the problem of CICS
printing with Virtel.</p>
<p>NQNAME <strong>EHS0</strong>,CSNE,15:35:51,SPNET REHIM000 <a href="#id1"><span class="problematic" id="id2">**</span></a>Entry 1 **</p>
<p>DFHZC3461 I 07/01/2014 15:38:01 SPCICSH EHT0 CSNE Node REHVT000 session
started. ((2) Module name: DFHZOPX)</p>
<p>NQNAME EHT0,CSNE,15:38:01,SPNET REHVT000</p>
<p>DFHSN1100 07/01/2014 15:38:01 SPCICSH Signon at netname REHVT000 by user
SPTHOLT in group SPGPTECH is complete.</p>
<p>DFHZC3461 I 07/01/2014 15:39:13 SPCICSH EHS0 CSNE Node REHIM000 session
started. ((2) Module name: DFHZOPX)</p>
<p>NQNAME <strong>EHS0</strong>,CSNE,15:39:13,SPNET REHIM000 <strong>Entry 2</strong></p>
<p>DFHZC2410 E 07/01/2014 15:40:30 SPCICSH EHT0 CSNE Node Unrecoverable.
VTAM LOSTERM Error Code X&#8216;14&#8217;. ((1) Module name: DFHZLTX)</p>
<p>DFHZC3437 I 07/01/2014 15:40:30 SPCICSH EHT0 CSNE Node REHVT000 action
taken: NOCREATE CLSDST ABTASK ABSEND ABRECV ((1) Module name: DFHZNAC)</p>
<p>DFHZC3424 E 07/01/2014 15:40:30 SPCICSH <strong>EHS0</strong> CSNE Session failure.
Session terminated immediately. ((2) Module name: DFHZNSP)</p>
<p>NQNAME EHS0,CSNE,15:40:30,SPNET REHIM000 <a href="#id3"><span class="problematic" id="id4">**</span></a>Entry 3 **</p>
<p>DFHZC3437 I 07/01/2014 15:40:30 SPCICSH EHS0 CSNE Node REHIM000
<strong>action</strong> taken: CLSDST ABTASK ABSEND ABRECV <strong>SIMLOGON</strong> ((1) Module
name:DFHZNAC)</p>
<p>DFHZC3462 I 07/01/2014 15:40:30 SPCICSH EHS0 CSNE Node REHIM000 session
terminated. ((2) Module name: DFHZCLS)</p>
<p>NQNAME EHS0,CSNE,15:40:30,SPNET REHIM000</p>
<p>DFHSN1200 07/01/2014 15:40:30 SPCICSH Signoff at netname REHVT000 by
user SPTHOLT is complete. 1 transactions entered with 0 errors.</p>
<p>DFHZC3462 I 07/01/2014 15:40:30 SPCICSH EHT0 CSNE Node REHVT000 session
terminated. ((2) Module name: DFHZCLS)</p>
<p>NQNAME EHT0,CSNE,15:40:30,SPNET REHVT000 <strong>Entry 4</strong></p>
<p>DFHZC2405 E 07/01/2014 15:40:30 SPCICSH EHS0 CSNE Node REHIM000 not
activated. VTAM RETURN CODE 1000 ((6) Module name: DFHZSYX)</p>
<p>DFHZC3437 I 07/01/2014 15:40:30 SPCICSH EHS0 CSNE Node REHIM000
<strong>action</strong> taken: <strong>NOCREATE</strong> CLSDST ABTASK ABSEND ABRECV ((1) Module
name: DFHZNAC)</p>
<p>DFHZC3462 I 07/01/2014 15:40:30 SPCICSH EHS0 CSNE Node REHIM000 session
terminated. ((2) Module name: DFHZCLS)</p>
<p>NQNAME EHS0,CSNE,15:40:30,SPNET REHIM000</p>
<p>DFHZC3461 I 07/01/2014 15:42:20 SPCICSH EHT0 CSNE Node REHVT000 session
started. ((2) Module name: DFHZOPX)</p>
<p>NQNAME EHT0,CSNE,15:42:20,SPNET REHVT000 <a href="#id5"><span class="problematic" id="id6">**</span></a>Entry 5 **</p>
<p>DFHSN1100 07/01/2014 15:42:20 SPCICSH Signon at netname REHVT000 by user
SPTHOLT in group SPGPTECH is complete.</p>
<p>DFHZC2405 E 07/01/2014 15:42:20 SPCICSH EHS0 CSNE Node REHIM000 not
activated. VTAM RETURN CODE 1000 ((6) Module name: DFHZSYX)</p>
<p>DFHZC3437 I 07/01/2014 15:42:20 SPCICSH EHS0 CSNE Node REHIM000 action
taken: NOCREATE CLSDST ABTASK ABSEND ABRECV ((1) Module name: DFHZNAC)</p>
<p>DFHZC3462 I 07/01/2014 15:42:20 SPCICSH EHS0 CSNE Node REHIM000 session
terminated. ((2) Module name: DFHZCLS)</p>
<p>Scenario:</p>
<p>Entry 1 Logon to CICS via Virtel, perform a CICS print transaction –
CMSG for example. Virtel printer is acquired (EHS0) and print is
successful.</p>
<p>Entry 2 Virtel session is closed. This causes a session failure for
relay terminals associated with the CICS definitions EHS0/EHT0. LOSTTERM
exit driven for terminal EHT0 but not for printer EHS0. CICS behaviour
is different for printers; this is the cause of the problem.</p>
<p>Entry 3 The ACTION to be taken by CICS for the ESH0’s session failure
includes SIMLOGON. CICS tries to reconnect the printer to the VIRTEL
application. Of course the VIRTEL relay application REHIM000 has gone so
this fails.</p>
<p>Entry 4 The failure of the SIMLOGON returns a VTAM RC 1000. The ACTION
that CICS now takes with regard to EHS0 is NOCREATE which places the
printer in a REL state. Any further print requests will fail.</p>
<p>Entry 5 A new session is started. The terminal EHT0 successfully
connects with CICS but the printer fails. VTAM return code 1000 plus
action of NOCREATE.</p>
<p>This situation will remain until the printer is reset.</p>
<p><strong>How to reset the printer.</strong></p>
<p>The easiest method is to issue a CICS command CEMT I (EHS0) and place
the printer back in session.</p>
<p>The following Screen Images capture this process.</p>
<p>Logon to CICS and issue CEMT I (EHS0) or whatever CICS definition you
have that relates to the printer. The following display will be the
status of the printer after disconnecting from Virtel. This printer will
not except more print request.</p>
<blockquote>
<div><a class="reference internal" href="../../../_images/image110.png"><img alt="image0" src="../../../_images/image110.png" style="width: 6.30000in; height: 5.51528in;" /></a></div></blockquote>
<p>Tab down until the cursor is next to the Ter line and press enter. You
will then see the full terminql display. Notice that the Createsess
parameter is set to NoCreate. This is why there is no printing.</p>
<p><a class="reference internal" href="../../../_images/image23.png"><img alt="image1" src="../../../_images/image23.png" style="width: 6.30000in; height: 5.51389in;" /></a></p>
<p>Change this to create and press enter; PF3 and then press Enter to
reissue the CEMT command. The printer display should look like this:-</p>
<p><a class="reference internal" href="../../../_images/image33.png"><img alt="image2" src="../../../_images/image33.png" style="width: 6.30000in; height: 0.97778in;" /></a></p>
<p>Virtel will now be able to print to using this printer terminal with the
CMSG command.</p>
<p>**
How to fix the problem.**</p>
<p>There are several solutions to this:-</p>
<p>This first is not to terminate your Virtel session, particularly during
a demo, as you will expose the problem. Of course if this does occur you
can manually put the terminal back into CRE mode by following the
instructions above.</p>
<p>A second option and more long term is to create a DFHZNEP module,
assemble it, and place it in a CICS load library. This will prevent the
SIMLOGON taking place following a Session failure. Example code
follows:–</p>
<p>*ASM XOPTS(NOPROLOG NOEPILOG)</p>
<p>TITLE &#8216;CICS NODE ERROR PROGRAM&#8217;</p>
<p>DFHSNEP TYPE=INITIAL,NAME=DFHZNEP,CS=NO</p>
<p>DFHSNEP TYPE=ERRPROC,GROUP=4,CODE=(5C)</p>
<p>***********************************************************************</p>
<p>* NEPROC04</p>
<p>***********************************************************************</p>
<p>* THE GROUP 4 ERRPROC WILL HANDLE RETURN CODES 5C (SESSION FAILURE),</p>
<p>* ON EACH OCCASION WHERE TWAEC IS EQUAL TO X&#8216;5C&#8217; WE WILL TURN OFF</p>
<p>* THE SIMLOGON SPECIFICATION.</p>
<p>* SYMBOLIC LABEL TCZNSP02</p>
<p>* DFH3424 (SESSION FAILURE) OCCURS WITH TWAEC SET TO X&#8216;5C&#8217;</p>
<p>***********************************************************************</p>
<p>EP4BASE EQU R8 BASE REGISTER</p>
<p>USING NEPROC04,EP4BASE ESTABLISH BASE</p>
<p>ST CSVTBAR,NEPEPRS SAVE RETURN REGISTER</p>
<p>LR EP4BASE,EPBAR LOAD BASE REGISTER</p>
<p>CLI TWAEC,TCZNSP02 DFHZC3424 SESSION FAILURE?</p>
<p>BNE NEP04RET NO, GET OUT</p>
<p>NI TWAOPT2,X&#8217;FF&#8217;-TWAOASM TURN OFF SIMLOGON</p>
<p>NEP04RET DS 0H</p>
<p>L CSVTBAR,NEPEPRS RESTORE LINK REGISTER</p>
<p>BR CSVTBAR RETURN</p>
<p>***********************************************************************</p>
<p>DFHSNEP TYPE=FINAL</p>
<p>END DFHNEPNA</p>
<p>The third option, and probably the most common solution, is to create a
CICS AUTOLOGON session which monitors terminals every thirty seconds and
places them back into their correct status. Most shops tend to have
these AUTOLOGON operators running under CICS for this very purpose.
Check with your CICS SysProg as it could be the case that the solution
is in hand and therefore this situation wouldn’t occur very often.</p>
<p><strong>Virtel setup</strong></p>
<p>For this test we used the C-HHTP line, recommended customer default, on
port 41002.</p>
<p><a class="reference internal" href="../../../_images/image42.png"><img alt="image3" src="../../../_images/image42.png" style="width: 6.30000in; height: 4.23056in;" /></a></p>
<p>The default entry point looks like this:-</p>
<p><a class="reference internal" href="../../../_images/image52.png"><img alt="image4" src="../../../_images/image52.png" style="width: 6.30000in; height: 4.30347in;" /></a></p>
<p>And the transaction we are using is CICS which has the following
definition undI-10</p>
<p><a class="reference internal" href="../../../_images/image62.png"><img alt="image5" src="../../../_images/image62.png" style="width: 6.30000in; height: 4.26667in;" /></a></p>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../TN201415/TN201415.html" class="btn btn-neutral float-right" title="Virtel JES Writer program" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../TN201413/TN201413.html" class="btn btn-neutral" title="&lt;no title&gt;" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Syspertec. All rights reserved.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>