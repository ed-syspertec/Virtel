

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Virtel Macros &mdash; Virtel 1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="Virtel 1 documentation" href="../../../index.html"/>
        <link rel="up" title="Technical Newsletters" href="../../../newsletters.html"/>
        <link rel="next" title="An example of using web services with Virtel Integration" href="../TN201506/TN201506.html"/>
        <link rel="prev" title="Running multiple instances of Virtel" href="../TN201504/TN201504.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> Virtel
          

          
            
            <img src="../../../_static/logo_virtel_web.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../virtel.html">Virtel Manuals</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../newsletters.html">Technical Newsletters</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../newsletters.html#id1">2014</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../newsletters.html#id2">2015</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../TN201501/TN201501.html">Dynamic Directory Interface (DDI)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201504/TN201504.html">Running multiple instances of Virtel</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Virtel Macros</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201506/TN201506.html">An example of using web services with Virtel Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201507/TN201507.html">Customising Virtel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201515/TN201515.html">Using Virtel as a Secure Single Access Control Point</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201517/TN201517.html">Virtel Chinese Character Language Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201519/TN201519.html">Processing the VTAM USS MSG10 buffer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201520/TN201520.html">Using the IBM System Logger with Virtel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201522/TN201522.html">What’s new in Virtel 4.55</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../newsletters.html#id3">2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../newsletters.html#id4">2017</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../howto.html">Miscellaneous</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index.html">Virtel</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../../newsletters.html">Technical Newsletters</a> &raquo;</li>
      
    <li>Virtel Macros</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/manuals/newsletters/TN201505/TN201505.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="virtel-macros">
<h1>Virtel Macros<a class="headerlink" href="#virtel-macros" title="Permalink to this headline">¶</a></h1>
<p>Virtel macros capture keystroke operations which can subsequently be
used to automate 3270 functions. Macros are held within a file in a JSON
structure. These file are suffixed with the .json qualifier. An example
of a JSON macro file is shown below:-</p>
<p>{&#8220;macros&#8221;:[{&#8220;name&#8221;:&#8221;SDSF&#8221;,&#8221;rev&#8221;:2,&#8221;def&#8221;:[&#8220;move(435)&#8221;,&#8221;ENTER&#8221;,{&#8220;txt&#8221;:&#8221;=M&#8221;},&#8221;ErEof&#8221;,&#8221;ENTER&#8221;,{&#8220;txt&#8221;:&#8221;6&#8221;},&#8221;ENTER&#8221;]}],&#8221;desc&#8221;:&#8221;user
macros&#8221;,&#8221;fmt&#8221;:1,&#8221;user&#8221;:&#8221;SPTHOLT&#8221;}</p>
<p><strong>Updating custom.js to use Virtel Macros.</strong></p>
<p>Before you can use the Virtel macro facility Macro A custom.js file must
be created or updated and placed in the CLI-DIR in order to use DDI. The
useVirtelMacros flag must be added and set to true.</p>
<p>See the following example:-</p>
<p>/*</p>
<p>* (c)Copyright SysperTec Communication 2014 All Rights Reserved</p>
<p>* VIRTEL Web Access customer-specific javascript functions</p>
<p>*/</p>
<p>/*</p>
<p>* To open an application (issued from applist transaction) in a new TAB
instead of the same (or a new) window</p>
<p>* 2014-02-21 : Add &#8220;options&#8221; field to place eventual options for the
new tab knowing that such option can eventually disturb the</p>
<p>* function, for example, in FF, new tab could be transformed as a new
window if the passed options are not compatible with the</p>
<p>* option active for the opener !</p>
<p>*/</p>
<p>// Specify macros to be held on host site</p>
<p><strong>w2hparm.useVirtelMacros = true;</strong></p>
<p>// Declare the function so that it is known for VWA</p>
<p>var after_responseHandle;</p>
<p>function before_launchApplink(href) {</p>
<p>return {</p>
<p>url: href, // Return received URL</p>
<p>target: &#8216;_blank&#8217;, // Target is a new TAB</p>
<p>options: &#8216;&#8217; // &#8220;menubar,location,toolbar,status,resizable,scrollbars&#8221; -&gt;
Removed from main function due to not necessary</p>
<p>};</p>
<p>}</p>
<p><strong>Macros functions</strong></p>
<p>You can capture and list macros by using the two macro ICONS functions
displayed in the Virtel tool bar. These are the red record/stop button
and the green triangular display button.</p>
<p><strong>The Record function</strong></p>
<p><a class="reference internal" href="../../../_images/image130.png"><img alt="image0" src="../../../_images/image130.png" style="width: 6.30000in; height: 1.51389in;" /></a></p>
<p>Figure 1 - The Macro Record ICON</p>
<p>The record function is a on/off button that will record key strokes.
When recording, the ICON will flash until it is clicked at which point
it will stop recording and save the key strokes to a macros.JSON file. A
save panel will be displayed asking for the name of the macro entry.
Note that an ENTER/PFK key must be pressed at least once, i.e. data must
be sent by some key operation in order to create and save an entry
within the macro.JSON file.</p>
<p><a class="reference internal" href="../../../_images/image215.png"><img alt="image1" src="../../../_images/image215.png" style="width: 6.30000in; height: 4.21111in;" /></a></p>
<p>Figure 2 - Saving a macro</p>
<p>The d<strong>isplay function</strong></p>
<p>The green triangular button will display the macros in the DDI user,
group and global directories. It will also enable you to delete, edit or
execute a macro.</p>
<p><a class="reference internal" href="../../../_images/image316.png"><img alt="image2" src="../../../_images/image316.png" style="width: 2.75000in; height: 3.75799in;" /></a></p>
<p>Within the user macro list there are two additional commands, edit and
delete. The “edit” option will open an editor where you can edit the
user macro as shown below:-</p>
<p><a class="reference internal" href="../../../_images/image413.png"><img alt="image3" src="../../../_images/image413.png" style="width: 2.81250in; height: 4.00700in;" /></a></p>
<p><strong>Macro format and commands</strong></p>
<p>The format of the macro.json is embedded JSON structures. Each name
structure represents a keystroke macro identified by the “name” keyword.</p>
<p>Name: The name of the macro entry.</p>
<p>Rev: The “rev” is a user revision keyword.</p>
<p>Def: The “def” keyword identifies the commands and entry values. The
macro editor supports the following commands:-</p>
<ul class="simple">
<li>&#8220;any string of characters to input into 3270 screen&#8221;</li>
<li>move(pos)</li>
<li>copy(startRow,startCol,endRow,endCol)</li>
<li>paste(pos)</li>
<li>paste(pos,nbRows,nbCols)</li>
<li>key(keyIdentifier)</li>
</ul>
<p><strong>Macro example</strong></p>
<p>{&#8220;macros&#8221;:[</p>
<p>{</p>
<p>&#8220;name&#8221;:&#8221;SDSFLOG&#8221;,</p>
<p>&#8220;rev&#8221;:2,</p>
<p>&#8220;def&#8221;:[&#8220;move(435)&#8221;,&#8221;ENTER&#8221;,{&#8220;txt&#8221;:&#8221;=M&#8221;},&#8221;ErEof&#8221;,&#8221;ENTER&#8221;,{&#8220;txt&#8221;:&#8221;6&#8221;},&#8221;ENTER&#8221;]</p>
<p>},</p>
<p>{</p>
<p>&#8220;name&#8221;:&#8221;SDSFDA&#8221;,</p>
<p>&#8220;rev&#8221;:1,</p>
<p>&#8220;def&#8221;:[77,&#8221;ENTER&#8221;,53,&#8221;ENTER&#8221;,100,97,&#8221;ENTER&#8221;]</p>
<p>}</p>
<p>],&#8221;fmt&#8221;:1}</p>
<p>**
Managing and uploading a macro**</p>
<p>Although macros can be captured and saved in a user’s directory they can
also be uploaded to any of the DDI macro directories – user, group or
global. This can be accomplished using either the ADMIN(HTML) interface
or the DDI interface. Normal practice for an administrator would be to
capture and create a macro in their user directory, download it using
the DDI interface, modify it for general use, and then upload it to any
group, user or global directory for general availability. The upload
process is through a drag and drop operation within the directory list
operation of the ADMIN(HTML) interface or the file list operation with
the DDI interface. In both cases the drop area is designated by a series
of dotted lines.</p>
<p><a class="reference internal" href="../../../_images/image511.png"><img alt="image4" src="../../../_images/image511.png" style="width: 4.51042in; height: 3.34652in;" /></a></p>
<p>Dragging a file into this area will automatically start the upload
function. Once the file has been upload reload the page to clear the
upload results message.</p>
<p><a class="reference internal" href="../../../_images/image611.png"><img alt="image5" src="../../../_images/image611.png" style="width: 4.46875in; height: 3.34565in;" /></a></p>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../TN201506/TN201506.html" class="btn btn-neutral float-right" title="An example of using web services with Virtel Integration" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../TN201504/TN201504.html" class="btn btn-neutral" title="Running multiple instances of Virtel" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Syspertec. All rights reserved.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>