

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Virtel Macros in Virtel 4.53 &mdash; Virtel 7 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="An example of using web services with Virtel Integration" href="../TN201506/TN201506.html" />
    <link rel="prev" title="Running multiple instances of Virtel" href="../TN201504/TN201504.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home" alt="Documentation Home"> Virtel
          

          
            
            <img src="../../../_static/logo_virtel_web.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                4.57
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../virtel.html">Virtel Manuals</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../newsletters.html">Technical Newsletters</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../newsletters.html#id1">2014</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../newsletters.html#id2">2015</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../TN201501/TN201501.html">Dynamic Directory Interface (DDI)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201504/TN201504.html">Running multiple instances of Virtel</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Virtel Macros in Virtel 4.53</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201506/TN201506.html">An example of using web services with Virtel Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201507/TN201507.html">Customising Virtel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201515/TN201515.html">Using Virtel as a Secure Single Access Control Point</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201517/TN201517.html">Virtel Chinese Character Language Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201519/TN201519.html">Processing the VTAM USS MSG10 buffer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201520/TN201520.html">Using the IBM System Logger with Virtel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TN201522/TN201522.html">What’s new in Virtel 4.55</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../newsletters.html#id3">2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../newsletters.html#id4">2017</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../newsletters.html#id5">2018</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../newsletters.html#id6">2019</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../newsletters.html#id7">2020</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Virtel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../newsletters.html">Technical Newsletters</a> &raquo;</li>
        
      <li>Virtel Macros in Virtel 4.53</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/manuals/newsletters/TN201505/TN201505.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="virtel-macros-in-virtel-4-53">
<span id="tn201505"></span><h1>Virtel Macros in Virtel 4.53<a class="headerlink" href="#virtel-macros-in-virtel-4-53" title="Permalink to this headline">¶</a></h1>
<p>Virtel macros capture keystroke operations which can subsequently be
used to automate 3270 functions. By default, macros are held within a JSON object and saved as a file in a users local storage. These file are suffixed with the .json qualifier. An example
of a JSON macro file is shown below:-</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;macros&quot;</span><span class="p">:[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;SDSF&quot;</span><span class="p">,</span><span class="s2">&quot;rev&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;def&quot;</span><span class="p">:[</span><span class="s2">&quot;move(435)&quot;</span><span class="p">,</span><span class="s2">&quot;ENTER&quot;</span><span class="p">,{</span><span class="s2">&quot;txt&quot;</span><span class="p">:</span><span class="s2">&quot;=M&quot;</span><span class="p">},</span><span class="s2">&quot;ErEof&quot;</span><span class="p">,</span><span class="s2">&quot;ENTER&quot;</span><span class="p">,{</span><span class="s2">&quot;txt&quot;</span><span class="p">:</span><span class="s2">&quot;6&quot;</span><span class="p">},</span><span class="s2">&quot;ENTER&quot;</span><span class="p">]}],</span><span class="s2">&quot;desc&quot;</span><span class="p">:</span><span class="s2">&quot;user</span>
<span class="n">macros</span><span class="s2">&quot;,&quot;</span><span class="n">fmt</span><span class="s2">&quot;:1,&quot;</span><span class="n">user</span><span class="s2">&quot;:&quot;</span><span class="n">SPTHOLT</span><span class="s2">&quot;}</span>
</pre></div>
</div>
<p>The macro interface can operate in two modes - local storage or DDI mode. In local storage mode macros are maintained in the user’s local storage. In DDI mode the macros makes use of the DDI facility to store macros on the mainframe. Updates are automatically synchronized between a user’s local storage and the DDI USR-DIR directory which is maintained in the HTML VSAM file in Virtel. Also, using DDI mode gives the users access to a GRP-DIR group directory and GLB-DIR global directory. These DDI directories would be maintained by the Virtel Administrator.</p>
<p><strong>Updating custom.js to use Virtel Macros in DDI mode.</strong></p>
<p>Before you can use the DDI  Virtel macro facility a custom.js file must be created or updated and placed in the CLI-DIR. The useVirtelMacros flag must be added and set to true. Also, the transaction CLI-03CJ must be modified so that the Application field points to CLI-DIR and not W2H-DIR.</p>
<p>The following is an example of a customised custom.js:-</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>/*
* (c)Copyright SysperTec Communication 2014 All Rights Reserved
* VIRTEL Web Access customer-specific javascript functions
*/
/*
* To open an application (issued from applist transaction) in a new TAB instead of the same (or a new) window
* 2014-02-21 : Add &quot;options&quot; field to place eventual options for the new tab knowing that such option can eventually disturb the
* function, for example, in FF, new tab could be transformed as a new window if the passed options are not compatible with the
* option active for the opener !
*/
// Specify macros to be held on host site

w2hparm.useVirtelMacros = true;

// Declare the function so that it is known for VWA

var after_responseHandle;
function before_launchApplink(href) {
   return {
      url: href,              // Return received URL
      target: &#39;_blank&#39;,       // Target is a new TAB
      options: &#39;&#39;             // &quot;menubar,location,toolbar,status,resizable,scrollbars&quot; -&gt; Removed from main function due to not necessary
   };
}
</pre></div>
</div>
<p><strong>The Macro Interface</strong></p>
<p>You can capture and list macros by using the two macro ICONS functions
displayed in the Virtel tool bar. These are the red record/stop button
and the green triangular display button. Regardless of which mode you are running the macro interface presents the same functions. In local mode the interface will look like this:-</p>
<p><img alt="image7" src="../../../_images/image75.png" /></p>
<p>whereas in DDI mode the interface looks like this:-</p>
<p><img alt="image8" src="../../../_images/image85.png" /></p>
<p><strong>The Record function</strong></p>
<p><a class="reference internal" href="../../../_images/image117.png"><img alt="image0" src="../../../_images/image117.png" style="width: 6.30000in; height: 1.51389in;" /></a></p>
<p>Figure 1 - The Macro Record ICON</p>
<p>The record function is a on/off button that will record key strokes.
When recording, the ICON will flash until it is clicked at which point
it will stop recording and save the key strokes to a macros.JSON file. A
save panel will be displayed asking for the name of the macro entry.
Note that an ENTER/PFK key must be pressed at least once, i.e. data must
be sent by some key operation in order to create and save an entry
within the macro.JSON file.</p>
<p><a class="reference internal" href="../../../_images/image29.png"><img alt="image1" src="../../../_images/image29.png" style="width: 6.30000in; height: 4.21111in;" /></a></p>
<p>Figure 2 - Saving a macro</p>
<p><strong>The display function</strong></p>
<p>The green triangular button will display the macros available to the user. For local mode these will be macros in the local storage, for DDI mode these will be the macros maintained in the user,
group and global directories. From the list you will be able to delete, edit or execute a macro.</p>
<p><a class="reference internal" href="../../../_images/image39.png"><img alt="image2" src="../../../_images/image39.png" style="width: 2.75000in; height: 3.75799in;" /></a></p>
<p>Within the user macro list there are two additional commands, edit and
delete. The “edit” option will open an editor where you can edit the
user macro as shown below:-</p>
<p><a class="reference internal" href="../../../_images/image47.png"><img alt="image3" src="../../../_images/image47.png" style="width: 2.81250in; height: 4.00700in;" /></a></p>
<p><strong>Macro format and commands</strong></p>
<p>The format of the macro.json is embedded JSON structures. Each name structure represents a keystroke macro identified by the “name” keyword.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Name:    The name of the macro entry.
Rev:     The “rev” is a user revision keyword.
Def:     The “def” keyword identifies the commands and entry values. The macro editor supports the following commands:-

-  &quot;any string of characters to input into 3270 screen&quot;
-  move(pos)
-  copy(startRow,startCol,endRow,endCol)
-  paste(pos)
-  paste(pos,nbRows,nbCols)
-  key(keyIdentifier)
</pre></div>
</div>
<p><strong>Macro example</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;macros&quot;</span><span class="p">:[</span>
<span class="p">{</span>
<span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;SDSFLOG&quot;</span><span class="p">,</span>
<span class="s2">&quot;rev&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
<span class="s2">&quot;def&quot;</span><span class="p">:[</span><span class="s2">&quot;move(435)&quot;</span><span class="p">,</span><span class="s2">&quot;ENTER&quot;</span><span class="p">,{</span><span class="s2">&quot;txt&quot;</span><span class="p">:</span><span class="s2">&quot;=M&quot;</span><span class="p">},</span><span class="s2">&quot;ErEof&quot;</span><span class="p">,</span><span class="s2">&quot;ENTER&quot;</span><span class="p">,{</span><span class="s2">&quot;txt&quot;</span><span class="p">:</span><span class="s2">&quot;6&quot;</span><span class="p">},</span><span class="s2">&quot;ENTER&quot;</span><span class="p">]</span>
<span class="p">},</span>
<span class="p">{</span>
<span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;SDSFDA&quot;</span><span class="p">,</span>
<span class="s2">&quot;rev&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
<span class="s2">&quot;def&quot;</span><span class="p">:[</span><span class="mi">77</span><span class="p">,</span><span class="s2">&quot;ENTER&quot;</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="s2">&quot;ENTER&quot;</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">97</span><span class="p">,</span><span class="s2">&quot;ENTER&quot;</span><span class="p">]</span>
<span class="p">}</span>
<span class="p">],</span><span class="s2">&quot;fmt&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
</pre></div>
</div>
<p><strong>Managing and uploading a macro</strong></p>
<p>Although macros can be captured and saved in a user’s directory, USR-DIR, they can also be uploaded to any one of the DDI macro directories – user, group or global. To upload a macro.JSON file use the DDI interface from the Administration portal. It would be normal practice for an administrator to capture and create macros in their user directory. These would then be exported using the EXPORT option. This would create a macros.JSON file. The macro.JSON file could then be uploaded to any one of the three DDI macro directories - USER, GROUP or GLOBAL using the DDI interface. Once uploaded , the macros can be modified for general use, and then copied to any other directory within the macros DDI directory structure. This facility enables an administrator to make macros available at any User, Group or Global level. The DDI upload process is through a drag and drop operation within the directory list operation of the ADMIN(HTML) interface or the file list operation with the DDI interface. In both cases the drop area is designated by a series of dotted lines.</p>
<p><a class="reference internal" href="../../../_images/image57.png"><img alt="image4" src="../../../_images/image57.png" style="width: 4.51042in; height: 3.34652in;" /></a></p>
<p>Dragging a file into this area will automatically start the upload
function. Once the file has been upload reload the page to clear the
upload results message.</p>
<p><a class="reference internal" href="../../../_images/image67.png"><img alt="image5" src="../../../_images/image67.png" style="width: 4.46875in; height: 3.34565in;" /></a></p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../TN201506/TN201506.html" class="btn btn-neutral float-right" title="An example of using web services with Virtel Integration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../TN201504/TN201504.html" class="btn btn-neutral float-left" title="Running multiple instances of Virtel" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2017, Syspertec. All rights reserved

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>