

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>How To Guide V4.59 &mdash; Virtel 7 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Installation Guide V4.59" href="../Virtel459IG/Installation_Guide.html" />
    <link rel="prev" title="Connectivity Reference V4.59" href="../Virtel459CN/connectivity_guide.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Virtel
          

          
            
            <img src="../../../_static/logo_virtel_web.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                4.57
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../virtel.html">Virtel Manuals</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../virtel.html#v4-56">V4.56</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../virtel.html#v4-57">V4.57</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../virtel.html#v4-58">V4.58</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../virtel.html#v4-59">V4.59</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../Virtel459AP/audit_operations_ and_performance.html">Audit, Administration, Operations and Performance V4.59</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Virtel459CN/connectivity_guide.html">Connectivity Reference V4.59</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">How To Guide V4.59</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#summary-of-amendments">Summary of Amendments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#customizing">Customizing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#virtel-web-access">Virtel Web Access</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dynamic-directory-interface-ddi">Dynamic Directory Interface (DDI)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lines">Lines</a></li>
<li class="toctree-l4"><a class="reference internal" href="#terminal-lu-nailing">Terminal LU Nailing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#transactions-applications">Transactions &amp; Applications</a></li>
<li class="toctree-l4"><a class="reference internal" href="#macros">Macros</a></li>
<li class="toctree-l4"><a class="reference internal" href="#centralised-user-parameters">Centralised User Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#security">Security</a></li>
<li class="toctree-l4"><a class="reference internal" href="#system-management">System Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="#faq">FAQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="#appendix">Appendix</a></li>
<li class="toctree-l4"><a class="reference internal" href="#trademarks">Trademarks</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Virtel459IG/Installation_Guide.html">Installation Guide V4.59</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Virtel459MG/messages.html">Messages V4.59</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Virtel459MI/Migration_Guide.html">Migration Guide V4.59</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Virtel459UG/User_Guide.html">User Guide V4.59</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../newsletters.html">Technical Newsletters</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Virtel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../virtel.html">Virtel Manuals</a> &raquo;</li>
        
      <li>How To Guide V4.59</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/manuals/virtel/Virtel459CS/Customization.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="toctree-wrapper compound">
</div>
<div class="section" id="how-to-guide-v4-59">
<span id="virtel459hw"></span><h1>How To Guide V4.59<a class="headerlink" href="#how-to-guide-v4-59" title="Permalink to this headline">¶</a></h1>
<p><a class="reference internal" href="../../../_images/logo_virtel_web17.png"><img alt="image0" src="../../../_images/logo_virtel_web17.png" style="width: 275.0px; height: 102.0px;" /></a></p>
<p><strong>VIRTEL How to Guide</strong></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is a draft version of the document.</p>
</div>
<p>Version : 4.59 Draft</p>
<p>Release Date : 27 October 2019. Publication Date : 27/10/2019</p>
<p>Syspertec Communication</p>
<p>196, Bureaux de la Colline 92213 Saint-Cloud Cedex Tél. : +33 (0) 1 46 02 60 42</p>
<p><a class="reference external" href="http://www.syspertec.com/">www.syspertec.com</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Reproduction, transfer, distribution, or storage, in any form, of all or any part of
the contents of this document, except by prior authorization of SysperTec
Communication, is prohibited.</p>
<p>Every possible effort has been made by SysperTec Communication to ensure that this document
is complete and relevant. In no case can SysperTec Communication be held responsible for
any damages, direct or indirect, caused by errors or omissions in this document.</p>
<p>As SysperTec Communication uses a continuous development methodology; the information
contained in this document may be subject to change without notice. Nothing in this
document should be construed in any manner as conferring a right to use, in whole or in
part, the products or trademarks quoted herein.</p>
<p>“SysperTec Communication” and “VIRTEL” are registered trademarks. Names of other products
and companies mentioned in this document may be trademarks or registered trademarks of
their respective owners.</p>
</div>
<div class="section" id="summary-of-amendments">
<span id="virtel459hw-summary-of-ammendments"></span><h2>Summary of Amendments<a class="headerlink" href="#summary-of-amendments" title="Permalink to this headline">¶</a></h2>
<div class="section" id="virtel-version-4-59-27th-oct-2019">
<h3>Virtel version 4.59 (27th Oct 2019)<a class="headerlink" href="#virtel-version-4-59-27th-oct-2019" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For further details see the Virtel Technical Newsletter TN201902: Whats new in Virtel 4.59.</p>
</div>
</div>
</div>
<div class="section" id="customizing">
<h2>Customizing<a class="headerlink" href="#customizing" title="Permalink to this headline">¶</a></h2>
<p>Customization of Virtel can be implemented through customization of the following elements:</p>
<ul class="simple">
<li><p>Custom CSS files, including Print Style CSS files.</p></li>
<li><p>Custom Javascript files.</p></li>
<li><p>Custom setting parameters.</p></li>
<li><p>Custom Help pages.</p></li>
</ul>
<p>As delivered, Virtel provides a dummy settings member, W2HPARM.JS, which is located in both the W2H-DIR and CLI-DIR. Note that any customization should only be made to the CLI-DIR or any other customer directories. No changes should be made to the W2H-DIR as these changes will be lost during any Virtel upgrade or migration.</p>
<div class="section" id="levels-of-customization">
<h3>Levels of customization<a class="headerlink" href="#levels-of-customization" title="Permalink to this headline">¶</a></h3>
<p>Depending on how Virtel is implemented at a site will determine what level of customization is required. For most users, simple modification of the default settings may be all that is required. This can be achieved just by modifying the supplied dummy W2HPARM.JS in the CLI-DIR assuming that this is the only directory in use for any “user” transactions. The setting defaults are listed in Appendix A of the Virtel User Guide.</p>
<p>More complex installations may require different levels of customization invoking bespoke CSS and Javascript members. Furthermore, different customization levels may be required for different Entry points and underlying transactions. The “Option” level of customization meets these requirements.</p>
<div class="section" id="settings-member-w2hparm-js">
<h4>Settings member W2HPARM.JS<a class="headerlink" href="#settings-member-w2hparm-js" title="Permalink to this headline">¶</a></h4>
<p>The Virtel settings member is a JavaScript object consisting of a key:value construct. The key representing the Virtel setting and the value the associated setting. Note that a key value can be another object as is the case in the “global-settings” and “useVirtelMacros” values. Keys names are case sensitive - key “w2hparm” is different to “W2hparm”. Invalid keys name will be ignored by Virtel. Key names are enclosed in quotes when defined within the w2hparm object, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="n">w2hparm</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;ctrl&quot;</span><span class="p">:</span><span class="s2">&quot;Newline&quot;</span><span class="p">,</span>
    <span class="p">};</span>
</pre></div>
</div>
<p>but if a property is defined outside of the object definition, no quotes are specified. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">w2hparm</span><span class="o">.</span><span class="n">ctrl</span> <span class="o">=</span> <span class="s2">&quot;Newline&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>See Appendix A of the Virtel Users Guide for a full list of “key” names and associated default values.</p>
</div>
<div class="section" id="displaying-customized-members">
<h4>Displaying customized members<a class="headerlink" href="#displaying-customized-members" title="Permalink to this headline">¶</a></h4>
<p>To display a settings member use the following URLs as examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">170.48</span><span class="p">:</span><span class="mi">41002</span><span class="o">/</span><span class="n">w2h</span><span class="o">/</span><span class="n">w2hparm</span><span class="o">-</span><span class="n">js</span><span class="o">/</span><span class="n">w2hparm</span><span class="o">.</span><span class="n">js</span>
</pre></div>
</div>
<p><em>Example of displaying the w2hparm.js member</em></p>
<p>To display a customized option member use the following URL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">170.48</span><span class="p">:</span><span class="mi">41002</span><span class="o">/</span><span class="n">option</span><span class="o">/</span><span class="n">w2hparm</span><span class="o">.</span><span class="k">global</span><span class="o">.</span><span class="n">js</span>
</pre></div>
</div>
<p><em>Example of displaying a global option member</em></p>
</div>
<div class="section" id="common-settings-member">
<h4>Common settings member<a class="headerlink" href="#common-settings-member" title="Permalink to this headline">¶</a></h4>
<p>If it is required that a common set of settings member be used for both W2H-DIR and CLI-DIR than a small modification to the W2H-DIR transaction, W2H-03P, is required. Changing the location directory from W2H-DIR to CLI-DIR will ensure that settings will be derived from the CLI-DIR W2HPARM.JS member. For example if you modify a key settings, which keyboard key reflects they “ENTER” key for example, than this change can used by both W2H and CLI transactions. An example of a modified W2H-03P transaction is displayed below:</p>
<p><a href="#id5"><span class="problematic" id="id6">|imagexx|</span></a></p>
<p><em>Example of W2H-03P pointing at the CLI-DIR</em></p>
<p>The following JCL may also be used to modify the W2H-03P transaction.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Virtel must not be running when using the VIRCONF program to update transactions:</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">SET</span> <span class="n">LOAD</span><span class="o">=</span><span class="n">SPTHOLT</span><span class="o">.</span><span class="n">VIRT459</span><span class="o">.</span><span class="n">LOADLIB</span>
<span class="o">//</span> <span class="n">SET</span> <span class="n">ARBO</span><span class="o">=</span><span class="n">SPTHOLT</span><span class="o">.</span><span class="n">VIRT459</span><span class="o">.</span><span class="n">ARBO</span>
<span class="o">//*</span>
<span class="o">//</span><span class="n">CONFIG</span>  <span class="n">EXEC</span> <span class="n">PGM</span><span class="o">=</span><span class="n">VIRCONF</span><span class="p">,</span><span class="n">PARM</span><span class="o">=</span><span class="s1">&#39;LOAD,REPL&#39;</span><span class="p">,</span><span class="n">REGION</span><span class="o">=</span><span class="mi">2</span><span class="n">M</span>
<span class="o">//</span><span class="n">STEPLIB</span>  <span class="n">DD</span>  <span class="n">DSN</span><span class="o">=&amp;</span><span class="n">LOAD</span><span class="p">,</span><span class="n">DISP</span><span class="o">=</span><span class="n">SHR</span>
<span class="o">//</span><span class="n">SYSPRINT</span> <span class="n">DD</span>  <span class="n">SYSOUT</span><span class="o">=*</span>
<span class="o">//</span><span class="n">SYSUDUMP</span> <span class="n">DD</span>  <span class="n">SYSOUT</span><span class="o">=*</span>
<span class="o">//</span><span class="n">VIRARBO</span>  <span class="n">DD</span>  <span class="n">DSN</span><span class="o">=&amp;</span><span class="n">ARBO</span><span class="p">,</span><span class="n">DISP</span><span class="o">=</span><span class="n">SHR</span>
<span class="o">//</span><span class="n">SYSIN</span>      <span class="n">DD</span> <span class="o">*</span>
     <span class="n">TRANSACT</span> <span class="n">ID</span><span class="o">=</span><span class="n">W2H</span><span class="o">-</span><span class="mi">03</span><span class="n">P</span><span class="p">,</span>
     <span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;w2h&#39;</span><span class="p">,</span>
     <span class="n">DESC</span><span class="o">=</span><span class="s1">&#39;Directory for w2hparm.js&#39;</span><span class="p">,</span>
     <span class="n">APPL</span><span class="o">=</span><span class="n">CLI</span><span class="o">-</span><span class="n">DIR</span><span class="p">,</span>
     <span class="n">TYPE</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
     <span class="n">TERMINAL</span><span class="o">=</span><span class="n">DELOC</span><span class="p">,</span>
     <span class="n">STARTUP</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
     <span class="n">SECURITY</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
     <span class="n">LOGMSG</span><span class="o">=</span><span class="s1">&#39;/w2h/w2hparm-js&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="global-options">
<h3>Global Options<a class="headerlink" href="#global-options" title="Permalink to this headline">¶</a></h3>
<p>Virtel implements a “global” option customized level whereby all customized elements apply to all transactions of a particular Entry Point. Each Entry Point may have its own “global” options. To implement global option customization, the W2HPARM.JS settings member is modified to contain a global settings object whose attributes point to members located in the options directory OPT-DIR.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="n">w2hparm</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;global-settings&quot;</span><span class="p">:{</span>
        <span class="s2">&quot;pathToJsCustom&quot;</span><span class="p">:</span><span class="s2">&quot;../option/custJS.global.js&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pathToCssCustom&quot;</span><span class="p">:</span> <span class="s2">&quot;../option/custCSS.global.css&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pathToW2hparm&quot;</span><span class="p">:</span><span class="s2">&quot;../option/w2hparm.global.js&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pathToHelp&quot;</span><span class="p">:</span> <span class="s2">&quot;../option/myHelp.html&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The “option” pathname is normally associated with the OPT-DIR. The directory is pointed to by the OPTION transaction CLI-03CO and by default is the CLI-DIR:</p>
<p><img alt="image33" src="../../../_images/image338.png" /></p>
<p><em>Example of option transaction</em></p>
<p>Each property of the global-settings object uses a “pathTo” property which has the following pattern:- “pathTo.key.id.type” where:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">key</span>     <span class="o">=</span> <span class="n">W2hparm</span> <span class="o">|</span> <span class="n">CssCustom</span> <span class="o">|</span> <span class="n">JSCustom</span> <span class="o">|</span> <span class="n">PrintCss</span> <span class="o">|</span> <span class="n">Help</span>  <span class="n">Case</span> <span class="n">sensitive</span><span class="o">.</span>
<span class="nb">id</span>      <span class="o">=</span> <span class="s2">&quot;global&quot;</span> <span class="ow">or</span> <span class="n">a</span> <span class="n">transaction</span> <span class="n">option</span> <span class="n">identifier</span>       <span class="n">Option</span> <span class="s2">&quot;id&quot;</span>
<span class="nb">type</span>    <span class="o">=</span> <span class="n">css</span> <span class="o">|</span> <span class="n">html</span> <span class="o">|</span> <span class="n">js</span>                                   <span class="n">Type</span>
</pre></div>
</div>
<p>Global-settings object can contain the following pathTo properties:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;pathToJsCustom&quot;</span>  <span class="o">-</span> <span class="n">Customized</span> <span class="n">JavaSCript</span> <span class="n">elements</span>
<span class="s2">&quot;pathToW2hparm&quot;</span>   <span class="o">-</span> <span class="n">Customized</span> <span class="n">w2hparm</span> <span class="n">parameters</span>
<span class="s2">&quot;pathToCssCustom&quot;</span> <span class="o">-</span> <span class="n">Customized</span> <span class="n">CSS</span> <span class="n">stylesheets</span>
<span class="s2">&quot;pathToPrintCss&quot;</span>  <span class="o">-</span> <span class="n">Customized</span> <span class="n">Print</span> <span class="n">CSS</span> <span class="n">Style</span> <span class="n">sheets</span>
<span class="s2">&quot;pathToHelp&quot;</span>      <span class="o">-</span> <span class="n">Customized</span> <span class="n">Help</span> <span class="n">pages</span>
</pre></div>
</div>
<p>Restart Virtel after uploading the W2HPARM.JS and other global members. Refresh the cache then check that the correct settings are being used using the following URLs to list w2hparm.js and w2hparm.global.js:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">170.48</span><span class="p">:</span><span class="mi">41002</span><span class="o">/</span><span class="n">w2h</span><span class="o">/</span><span class="n">w2hparm</span><span class="o">-</span><span class="n">js</span><span class="o">/</span><span class="n">w2hparm</span><span class="o">.</span><span class="n">js</span>

<span class="n">var</span> <span class="n">w2hparm</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;global-settings&quot;</span><span class="p">:{</span>
        <span class="s2">&quot;pathToW2hparm&quot;</span><span class="p">:</span><span class="s2">&quot;../option/w2hparm.global.js&quot;</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
<p><em>Example of w2hparm.js pointing to a global parm member</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">170.48</span><span class="p">:</span><span class="mi">41002</span><span class="o">/</span><span class="n">option</span><span class="o">/</span><span class="n">w2hparm</span><span class="o">.</span><span class="k">global</span><span class="o">.</span><span class="n">js</span>
</pre></div>
</div>
<p>The output from this display should show the DDI/Macros options that we used in compatibility mode.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="n">w2hparm</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ctrl&quot;</span><span class="p">:</span><span class="s2">&quot;Newline&quot;</span><span class="p">,</span>
    <span class="s2">&quot;enter&quot;</span><span class="p">:</span><span class="s2">&quot;ENTER&quot;</span><span class="p">,</span>
    <span class="s2">&quot;pgup&quot;</span><span class="p">:</span><span class="s2">&quot;PA1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;pgdn&quot;</span><span class="p">:</span><span class="s2">&quot;PA2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;useVirtelMacros&quot;</span><span class="p">:{</span><span class="s2">&quot;macrosAutoRefresh&quot;</span><span class="p">:</span><span class="s2">&quot;session&quot;</span><span class="p">}</span>
    <span class="p">};</span>
<span class="n">w2hparm</span><span class="o">.</span><span class="n">keymapping</span><span class="o">=</span><span class="n">true</span><span class="p">;</span>
</pre></div>
</div>
<p><em>Example of a wh2parm.global.js member</em></p>
</div>
<div class="section" id="transaction-options">
<h3>Transaction Options<a class="headerlink" href="#transaction-options" title="Permalink to this headline">¶</a></h3>
<p>Some transactions may require a different set of options or settings than those defined at the Entry Point or Global level. For example, certain transactions may have a modified tool bar containing a Printer Icon. Transactions which require such specific customization should have a unique option identifier or “Id” associated with the transaction definition. This “id” will pull in a different set of options “key”:”values” settings and will override the “global” settings. The option “id” will be used to associate customized elements against specific transaction(s).</p>
<p>In the following example the value “myOptions” has been chosen as an “id” for a particular transaction. A transaction level “core option file”, using the format “option.id.js”, will be used to locate they customized elements. In this example we are using a customized JavaScript member to add a “Printer Icon” to the Virtel Toolbar. Using the option “id” of “myOptions” a javascript file will be created called “option.myOptions.js”. This will be uploaded to CLI-DIR. Customized settings for transactions are held in a Javascript object called “oCustom”. Here is an example of the myOptions Javascript file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">CLI</span><span class="o">-</span><span class="n">DIR</span> <span class="o">-</span> <span class="n">option</span><span class="o">.</span><span class="n">myOptions</span><span class="o">.</span><span class="n">js</span><span class="o">.</span> <span class="n">Transaction</span> <span class="n">level</span> <span class="n">core</span> <span class="n">option</span> <span class="n">file</span>
<span class="n">var</span> <span class="n">oCustom</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">&quot;pathToJsCustom&quot;</span><span class="p">:</span><span class="s2">&quot;../option/custJS.myOptions.js&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Example of a core option file for customized JavaScript</em></p>
<p>This “”core option file” points to our customized JavaScript member for this transaction. This member contains the Virtel Javascript function “after_standardInit” which will be called after initialization to modify the standard Virtel tool bar:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">CLI</span><span class="o">-</span><span class="n">DIR</span> <span class="o">-</span> <span class="n">custJS</span><span class="o">.</span><span class="n">myOptions</span><span class="o">.</span><span class="n">js</span>
<span class="o">//</span><span class="n">Add</span> <span class="n">Print</span> <span class="n">Button</span> <span class="n">To</span> <span class="n">Toolbar</span>
<span class="n">function</span> <span class="n">after_standardInit</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">addtoolbarbutton</span><span class="p">(</span><span class="mi">000</span><span class="p">,</span><span class="s2">&quot;../print.ico&quot;</span><span class="p">,</span><span class="s2">&quot;Print Screen&quot;</span><span class="p">,</span><span class="n">do_print</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">function</span> <span class="n">do_print</span><span class="p">()</span> <span class="p">{</span>
<span class="o">//</span> <span class="n">do_print</span> <span class="n">function</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Example of customized Javascript element associated with a transaction</em></p>
<p>To support this customized transaction the following two files are uploaded to the OPT-DIR or options directory:</p>
<dl class="simple">
<dt>::</dt><dd><p>option.myOptions.js  - core option file for identifier “myOptions”. Points to the custom javascript file for transactions which have option=myOptions set.
custjJS.myOptions.js - customized java script file for “myOptions”.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>More than one transaction within an Entry Point can point to the same “id” option files.</p>
</div>
</div>
<div class="section" id="defining-transaction-customization">
<h3>Defining Transaction customization<a class="headerlink" href="#defining-transaction-customization" title="Permalink to this headline">¶</a></h3>
<p>The Virtel User Guide contains further information on how to use GUI based controls to create the necessary customization members and associated files for transaction customization. See the section “Defining Transaction Options” in the Customization section for further details.</p>
</div>
<div class="section" id="customizable-javascript-functions">
<h3>Customizable JavaScript functions<a class="headerlink" href="#customizable-javascript-functions" title="Permalink to this headline">¶</a></h3>
<p>Virtel provides the following Javascript functions that can be customized to give bespoke behavior:</p>
<ul class="simple">
<li><p>after_standardInit</p></li>
<li><p>after_reponseHandle</p></li>
</ul>
</div>
</div>
<div class="section" id="virtel-web-access">
<h2>Virtel Web Access<a class="headerlink" href="#virtel-web-access" title="Permalink to this headline">¶</a></h2>
<div class="section" id="vwa-user-interface">
<h3>VWA User Interface<a class="headerlink" href="#vwa-user-interface" title="Permalink to this headline">¶</a></h3>
<p>The VIRTEL Web Access user interface is in the form of a conventional 3270 screen divided into three areas:</p>
<ul class="simple">
<li><p>The toolbar located in the upper of the screen contains the icons of functions (1), the information environment (2),the language selection (3).</p></li>
<li><p>The status line at the bottom includes the monitoring zone (4), particulars of the terminals associated with the session(5), mode and cursor position (6).</p></li>
<li><p>The area between the toolbar and the status bar is used to display the contents of 3270 screens, it can be of variable size between 24x80 and 62x132.</p></li>
</ul>
<p><img alt="image1" src="../../../_images/image180.png" />
<em>The VWA 3270 screen areas</em></p>
<div class="section" id="title">
<h4>Title<a class="headerlink" href="#title" title="Permalink to this headline">¶</a></h4>
<div class="section" id="add-the-user-name-in-the-title-tab">
<h5>Add the User Name in the title Tab<a class="headerlink" href="#add-the-user-name-in-the-title-tab" title="Permalink to this headline">¶</a></h5>
<p>You can add the User Name in the title tab by using the following order included in a custom.js file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>function after_responseHandle() {
    document.title =document.body.className + “-“ + getUserId();
}
</pre></div>
</div>
<p><em>Example to add the User Name in the Title tab.</em></p>
</div>
</div>
<div class="section" id="toolbar">
<h4>Toolbar<a class="headerlink" href="#toolbar" title="Permalink to this headline">¶</a></h4>
<p>The toolbar is located at the top of the 3270 screen. It contains, icons, language selection tool and environment
information. Some of those component can be removed, added or modified.</p>
<div class="section" id="how-to-permanently-hide-the-toolbar">
<h5>How to permanently hide the toolbar<a class="headerlink" href="#how-to-permanently-hide-the-toolbar" title="Permalink to this headline">¶</a></h5>
<p>The administrator may wish to prevent users from accessing features like copy/paste, print, and settings by removing correponding icons, or by hidding the toolbar. This example shows how to hide the toolbar using a custom.css file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span> <span class="n">VIRTEL</span> <span class="n">Web</span> <span class="n">Access</span> <span class="n">style</span> <span class="n">sheet</span> <span class="k">for</span> <span class="n">site</span> <span class="n">customization</span>
<span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="n">Copyright</span> <span class="n">SysperTec</span> <span class="n">Communication</span> <span class="mi">2007</span><span class="p">,</span><span class="mi">2010</span> <span class="n">All</span> <span class="n">Rights</span> <span class="n">Reserved</span>
<span class="o">*/</span>
 <span class="c1">#toolbar {display:none;}</span>
</pre></div>
</div>
<p><em>Example custom.css for hiding the toolbar</em></p>
<p>You can also use custom.js to remove icons individually from the toolbar, see “Removing unwanted toolbar icons” on page 11.</p>
</div>
<div class="section" id="let-users-hide-show-the-toolbar-at-their-convenience">
<h5>Let users hide/show the toolbar at their convenience<a class="headerlink" href="#let-users-hide-show-the-toolbar-at-their-convenience" title="Permalink to this headline">¶</a></h5>
<p>The administrator may want to let users hide/show the toolbar at their convenience:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span>
 <span class="o">*</span> <span class="n">Configuration</span> <span class="n">to</span> <span class="n">allow</span> <span class="n">the</span> <span class="n">user</span> <span class="n">to</span> <span class="n">manage</span> <span class="n">show</span><span class="o">/</span><span class="n">hide</span> <span class="n">toolbar</span> <span class="n">by</span> <span class="n">himself</span><span class="o">.</span>
 <span class="o">*/</span>
<span class="n">w2hparm</span><span class="o">.</span><span class="n">switchToolBarDisplay</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
</pre></div>
</div>
<p><em>Example w2hparm.js to allow users to manage the hide / show feature of the toolbar by themselves.</em></p>
<p>If this option is enabled, the “Alt + Insert” and “Alt + Home” keys present in the Key Mappings tab are enhanced with the “Toolbar” option. The user can then assign either of these two keys in order to to hide/show the toolbar at its convenience.</p>
<p><a class="reference internal" href="../../../_images/image250.png"><img alt="image2" src="../../../_images/image250.png" style="width: 390.0px; height: 592.5px;" /></a></p>
<p><em>Key Mappings Setting Tab</em></p>
<p>These two assignments can also be predefined in the w2hparm.js file by using the commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="o">*</span> <span class="n">Configuration</span> <span class="n">to</span> <span class="n">assign</span> <span class="n">Alt</span><span class="o">+</span><span class="n">Insert</span> <span class="ow">and</span><span class="o">/</span><span class="ow">or</span> <span class="n">Alt</span><span class="o">+</span><span class="n">Home</span> <span class="n">key</span> <span class="n">to</span> <span class="n">show</span><span class="o">/</span><span class="n">hide</span> <span class="n">toolbar</span><span class="o">.</span>
<span class="o">*/</span>
<span class="s2">&quot;altins&quot;</span><span class="p">:</span><span class="s2">&quot;ToolBar&quot;</span> <span class="ow">and</span><span class="o">/</span><span class="ow">or</span>
<span class="s2">&quot;althome&quot;</span><span class="p">:</span><span class="s2">&quot;ToolBar&quot;</span>
</pre></div>
</div>
<p><em>Example w2hparm.js to assign Alt+Insert and/or Alt+Home key to show/hide toolbar.</em></p>
<p>The toolbar can be automatically masked at each new session opening by using the following command in w2hparm.js</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="o">*</span> <span class="n">Configuration</span> <span class="n">to</span> <span class="n">automatically</span> <span class="n">hide</span> <span class="n">the</span> <span class="n">toolbar</span> <span class="n">when</span> <span class="n">opening</span> <span class="n">a</span> <span class="n">new</span> <span class="n">session</span><span class="o">.</span>
<span class="o">*/</span>
<span class="s2">&quot;hidetoolbar&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span>
</pre></div>
</div>
<p><em>Example w2hparm.js to automatically hide the toolbar when opening a new session.</em></p>
<p>Under Virtel 4.57, those features require update #5555 or above to be applied.</p>
</div>
<div class="section" id="showing-hiding-running-version-and-maintenance-level">
<h5>Showing / Hiding running version and maintenance level<a class="headerlink" href="#showing-hiding-running-version-and-maintenance-level" title="Permalink to this headline">¶</a></h5>
<p>On the right side of the toolbar, the running version and the level of maintenance of VIRTEL is shown. As this information is important and very helpful in case of troubleshooting, those information cannot be hidden except when the <em>w2hparm.switchToolBarDisplay = true;</em> feature is implemented and if the user hides the toolbar by themself.</p>
</div>
<div class="section" id="changing-background-color-of-the-toolbar-buttons">
<h5>Changing background color of the toolbar buttons<a class="headerlink" href="#changing-background-color-of-the-toolbar-buttons" title="Permalink to this headline">¶</a></h5>
<p>This example shows how to change the background color of the toolbar buttons by adding orders in the custom.css file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="o">*</span> <span class="n">VIRTEL</span> <span class="n">Web</span> <span class="n">Access</span> <span class="n">style</span> <span class="n">sheet</span> <span class="n">customization</span> <span class="n">the</span> <span class="n">background</span> <span class="n">of</span> <span class="n">the</span> <span class="n">toolbar</span>
<span class="o">*</span> <span class="n">buttons</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="n">Copyright</span> <span class="n">SysperTec</span> <span class="n">Communication</span> <span class="mi">2014</span> <span class="n">All</span> <span class="n">Rights</span> <span class="n">Reserved</span>
<span class="o">*/</span>
<span class="o">|-</span> <span class="n">transparent</span> <span class="s2">&quot;at rest&quot;</span>
<span class="o">|-</span> <span class="n">white</span> <span class="n">when</span> <span class="n">cursor</span> <span class="n">moves</span> <span class="n">on</span>
<span class="o">|-</span> <span class="n">yellow</span> <span class="n">when</span> <span class="n">button</span> <span class="ow">is</span> <span class="n">clicked</span>
<span class="c1">#toolbar td .tbButton {</span>
<span class="n">background</span><span class="o">-</span><span class="n">color</span><span class="p">:</span> <span class="n">inherit</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">#toolbar td .tbButton:hover {</span>
<span class="n">background</span><span class="o">-</span><span class="n">color</span><span class="p">:</span> <span class="n">white</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">#toolbar td .tbButton:active {</span>
<span class="n">background</span><span class="o">-</span><span class="n">color</span><span class="p">:</span> <span class="n">yellow</span><span class="p">;</span>
<span class="p">}</span>
    <span class="o">|</span> <span class="n">To</span> <span class="n">remove</span> <span class="n">the</span> <span class="n">background</span> <span class="n">color</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">border</span> <span class="n">of</span> <span class="n">buttons</span> <span class="s2">&quot;at rest&quot;</span><span class="p">:</span>
<span class="c1">#toolbar td .tbButton {</span>
<span class="n">background</span><span class="o">-</span><span class="n">color</span><span class="p">:</span> <span class="n">inherit</span><span class="p">;</span>
<span class="n">border</span><span class="p">:</span> <span class="mi">1</span><span class="n">px</span> <span class="n">solid</span> <span class="n">transparent</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Example custom.css managing the background color of the toolbar buttons</em></p>
</div>
<div class="section" id="customizing-the-toolbar-color-by-application">
<h5>Customizing the toolbar color by application<a class="headerlink" href="#customizing-the-toolbar-color-by-application" title="Permalink to this headline">¶</a></h5>
<p>It is sometimes useful for the user to have a clear visual indication of which system he or she is logged on to. This
example shows how to set the color of the toolbar to yellow for SPCICSP and pink for SPCICSQ.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span> <span class="n">VIRTEL</span> <span class="n">Web</span> <span class="n">Access</span> <span class="n">style</span> <span class="n">sheet</span> <span class="k">for</span> <span class="n">site</span> <span class="n">customization</span>
<span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="n">Copyright</span> <span class="n">SysperTec</span> <span class="n">Communication</span> <span class="mi">2007</span><span class="p">,</span><span class="mi">2010</span> <span class="n">All</span> <span class="n">Rights</span> <span class="n">Reserved</span>
<span class="o">*/</span>

<span class="o">.</span><span class="n">SPCICSP</span> <span class="c1">#toolbar {background-color:yellow;}</span>
<span class="o">.</span><span class="n">SPCICSQ</span> <span class="c1">#toolbar {background-color:pink;}</span>
</pre></div>
</div>
<p><em>Example custom.css for coloring the toolbar according to CICS region</em></p>
<p><img alt="image3" src="../../../_images/image339.png" />
<em>Web Access screen with yellow toolbar for SPCICSP</em></p>
<p><img alt="image4" src="../../../_images/image437.png" />
<em>Web Access screen with pink toolbar for SPCICSQ</em></p>
</div>
<div class="section" id="add-a-web-link-in-the-toolbar">
<h5>Add a web link in the toolbar<a class="headerlink" href="#add-a-web-link-in-the-toolbar" title="Permalink to this headline">¶</a></h5>
<p>You can add a web link in the toolbar by using the following order included in a custom.js file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">function</span> <span class="n">after_standardInit</span><span class="p">()</span> <span class="p">{</span>
    <span class="o">*</span> <span class="n">Adds</span> <span class="n">a</span> <span class="n">button</span> <span class="n">to</span> <span class="n">the</span> <span class="n">toolbar</span> <span class="n">which</span> <span class="n">performs</span> <span class="n">a</span> <span class="n">Google</span> <span class="n">search</span>
    <span class="n">addtoolbarbutton</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="s2">&quot;http://www.yourtargetsit.com/favicon.ico&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="n">linked_function</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Example to add a web link in the toolbar.</em></p>
</div>
<div class="section" id="example-add-a-google-search-link-in-the-toolbar">
<h5>Example : Add a Google Search link in the toolbar<a class="headerlink" href="#example-add-a-google-search-link-in-the-toolbar" title="Permalink to this headline">¶</a></h5>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">function</span> <span class="n">after_standardInit</span><span class="p">()</span> <span class="p">{</span>
<span class="o">/*</span>
<span class="o">*</span> <span class="n">Adds</span> <span class="n">a</span> <span class="n">button</span> <span class="n">to</span> <span class="n">the</span> <span class="n">toolbar</span> <span class="n">which</span> <span class="n">performs</span> <span class="n">a</span> <span class="n">Google</span> <span class="n">search</span> <span class="k">for</span>
<span class="o">*</span> <span class="n">the</span> <span class="n">text</span> <span class="n">selected</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">red</span> <span class="n">box</span> <span class="ow">in</span> <span class="n">the</span> <span class="mi">3270</span> <span class="n">screen</span><span class="p">,</span> <span class="ow">or</span> <span class="k">for</span> <span class="n">the</span>
<span class="o">*</span> <span class="n">word</span> <span class="n">at</span> <span class="n">the</span> <span class="n">cursor</span> <span class="k">if</span> <span class="n">no</span> <span class="n">box</span> <span class="ow">is</span> <span class="n">drawn</span>
<span class="o">*/</span>
<span class="n">addtoolbarbutton</span><span class="p">(</span><span class="mi">999</span><span class="p">,</span> <span class="s2">&quot;http://www.google.com/favicon.ico&quot;</span><span class="p">,</span>
<span class="s2">&quot;Search engine query&quot;</span><span class="p">,</span> <span class="n">do_search</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">function</span> <span class="n">do_search</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">var</span> <span class="n">searcharg</span> <span class="o">=</span> <span class="n">VIR3270</span><span class="o">.</span><span class="n">getBoxedText</span><span class="p">()</span> <span class="o">||</span> <span class="n">VIR3270</span><span class="o">.</span><span class="n">getWordAtCursor</span><span class="p">();</span>
    <span class="n">var</span> <span class="n">windowname</span> <span class="o">=</span> <span class="s2">&quot;search&quot;</span><span class="p">;</span>
    <span class="n">var</span> <span class="n">searchURL</span> <span class="o">=</span> <span class="s2">&quot;http://www.google.com&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">searcharg</span><span class="p">)</span> <span class="n">searchURL</span> <span class="o">+=</span> <span class="s2">&quot;/search?q=&quot;</span> <span class="o">+</span>
        <span class="n">encodeURIComponent</span><span class="p">(</span><span class="n">searcharg</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">/</span>\<span class="n">s</span><span class="o">+/</span><span class="n">g</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">));</span>
    <span class="n">var</span> <span class="n">windowopts</span> <span class="o">=</span> <span class="s2">&quot;location=yes,status=yes,resizable=yes,&quot;</span> <span class="o">+</span>
    <span class="s2">&quot;scrollbars=yes,toolbar=yes,menubar=yes,width=640,height=480&quot;</span><span class="p">;</span>
    <span class="n">var</span> <span class="n">searchwin</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">searchURL</span><span class="p">,</span> <span class="n">windowname</span><span class="p">,</span> <span class="n">windowopts</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">searchwin</span><span class="p">)</span> <span class="n">searchwin</span><span class="o">.</span><span class="n">focus</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-a-company-logo">
<h5>Adding a company logo<a class="headerlink" href="#adding-a-company-logo" title="Permalink to this headline">¶</a></h5>
<p>This example shows how to display an icon (for example, a company logo) at the left of the toolbar:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="o">*</span> <span class="n">VIRTEL</span> <span class="n">Web</span> <span class="n">Access</span> <span class="n">style</span> <span class="n">sheet</span> <span class="n">customisation</span> <span class="k">for</span> <span class="n">company</span> <span class="n">logo</span>
<span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="n">Copyright</span> <span class="n">SysperTec</span> <span class="n">Communication</span> <span class="mi">2012</span> <span class="n">All</span> <span class="n">Rights</span> <span class="n">Reserved</span>
<span class="o">*/</span>
<span class="c1">#toolbar td#companyIcon {</span>
<span class="n">height</span><span class="p">:</span><span class="mi">30</span><span class="n">px</span><span class="p">;</span>
<span class="n">display</span><span class="p">:</span><span class="n">table</span><span class="o">-</span><span class="n">cell</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">#companyIcon div {</span>
    <span class="n">background</span><span class="o">-</span><span class="n">image</span><span class="p">:</span><span class="n">url</span><span class="p">(</span><span class="s2">&quot;/w2h/virtblue.jpg&quot;</span><span class="p">);</span>
    <span class="n">background</span><span class="o">-</span><span class="n">position</span><span class="p">:</span><span class="mi">0</span><span class="n">px</span> <span class="o">-</span><span class="mi">4</span><span class="n">px</span><span class="p">;</span>
    <span class="n">background</span><span class="o">-</span><span class="n">repeat</span><span class="p">:</span><span class="n">no</span><span class="o">-</span><span class="n">repeat</span><span class="p">;</span>
    <span class="n">height</span><span class="p">:</span><span class="mi">26</span><span class="n">px</span><span class="p">;</span>
    <span class="n">width</span><span class="p">:</span><span class="mi">145</span><span class="n">px</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Example custom.css for displaying company logo in the toolbar</em></p>
<p>This example shows how to replace the Virtel logo in the VIRTEL Web Access menu and the Application menu by your company logo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>/*
* VIRTEL Web Access style sheet for site customization
* (c)Copyright SysperTec Communication 2013 All Rights Reserved
* $Id$
*/
#appmenulogo {
    background-image: url(&quot;mycompany.gif&quot;);
    height: 65px;
    width: 266px;
}
</pre></div>
</div>
<p><em>Example custom.css for replacing the Virtel logo by a company logo</em></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If no explicit path is given, the company logo will be loaded from the same directory as the custom.css file.</p>
</div>
</div>
</div>
<div class="section" id="toolbar-icons">
<h4>Toolbar Icons<a class="headerlink" href="#toolbar-icons" title="Permalink to this headline">¶</a></h4>
<div class="section" id="adding-a-toolbar-icon">
<h5>Adding a toolbar icon<a class="headerlink" href="#adding-a-toolbar-icon" title="Permalink to this headline">¶</a></h5>
<p>This example uses the after_standardInit function to insert additional icons into the toolbar when the session is started. Icons may subsequently be added or removed from the toolbar after each screen by means of the after_responseHandle function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="n">Copyright</span> <span class="n">SysperTec</span> <span class="n">Communication</span> <span class="mi">2012</span> <span class="n">All</span> <span class="n">Rights</span> <span class="n">Reserved</span>
<span class="o">*</span> <span class="n">VIRTEL</span> <span class="n">Web</span> <span class="n">Access</span> <span class="n">customer</span><span class="o">-</span><span class="n">specific</span> <span class="n">javascript</span> <span class="n">functions</span>
<span class="o">*/</span>
<span class="o">/*</span>
<span class="o">*</span> <span class="n">Adds</span> <span class="n">a</span> <span class="n">button</span> <span class="n">to</span> <span class="n">the</span> <span class="n">toolbar</span> <span class="n">which</span> <span class="n">performs</span> <span class="n">a</span> <span class="n">Google</span> <span class="n">search</span> <span class="k">for</span>
<span class="o">*</span> <span class="n">the</span> <span class="n">text</span> <span class="n">selected</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">red</span> <span class="n">box</span> <span class="ow">in</span> <span class="n">the</span> <span class="mi">3270</span> <span class="n">screen</span><span class="p">,</span> <span class="ow">or</span> <span class="k">for</span> <span class="n">the</span>
<span class="o">*</span> <span class="n">word</span> <span class="n">at</span> <span class="n">the</span> <span class="n">cursor</span> <span class="k">if</span> <span class="n">no</span> <span class="n">box</span> <span class="ow">is</span> <span class="n">drawn</span>
<span class="o">*</span> <span class="n">after_standardInit</span><span class="p">()</span> <span class="n">function</span> <span class="n">must</span> <span class="n">be</span> <span class="n">implemented</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">custom</span><span class="o">.</span><span class="n">js</span> <span class="n">file</span>
<span class="o">*/</span>

<span class="n">function</span> <span class="n">after_standardInit</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">addtoolbarbutton</span><span class="p">(</span><span class="mi">999</span><span class="p">,</span> <span class="s2">&quot;http://www.google.com/favicon.ico&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Search engine query&quot;</span><span class="p">,</span> <span class="n">do_search</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">function</span> <span class="n">do_search</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">var</span> <span class="n">searcharg</span> <span class="o">=</span> <span class="n">VIR3270</span><span class="o">.</span><span class="n">getBoxedText</span><span class="p">()</span> <span class="o">||</span> <span class="n">VIR3270</span><span class="o">.</span><span class="n">getWordAtCursor</span><span class="p">();</span>
    <span class="n">var</span> <span class="n">windowname</span> <span class="o">=</span> <span class="s2">&quot;search&quot;</span><span class="p">;</span>
    <span class="n">var</span> <span class="n">searchURL</span> <span class="o">=</span> <span class="s2">&quot;http://www.google.com&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">searcharg</span><span class="p">)</span> <span class="n">searchURL</span> <span class="o">+=</span> <span class="s2">&quot;/search?q=&quot;</span> <span class="o">+</span>
        <span class="n">encodeURIComponent</span><span class="p">(</span><span class="n">searcharg</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">/</span>\<span class="n">s</span><span class="o">+/</span><span class="n">g</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">));</span>
    <span class="n">var</span> <span class="n">windowopts</span> <span class="o">=</span> <span class="s2">&quot;location=yes,status=yes,resizable=yes,&quot;</span><span class="o">+</span>
    <span class="s2">&quot;scrollbars=yes,toolbar=yes,menubar=yes,width=640,height=480&quot;</span><span class="p">;</span>
    <span class="n">var</span> <span class="n">searchwin</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">searchURL</span><span class="p">,</span> <span class="n">windowname</span><span class="p">,</span> <span class="n">windowopts</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">searchwin</span><span class="p">)</span> <span class="n">searchwin</span><span class="o">.</span><span class="n">focus</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Example custom.js to customize the toolbar icons</em></p>
</div>
<div class="section" id="removing-unwanted-toolbar-icons">
<h5>Removing unwanted toolbar icons<a class="headerlink" href="#removing-unwanted-toolbar-icons" title="Permalink to this headline">¶</a></h5>
<p>This example uses the after_standardInit function to disable macro functions by removing the corresponding icons from the toolbar.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="n">Copyright</span> <span class="n">SysperTec</span> <span class="n">Communication</span> <span class="mi">2017</span> <span class="n">All</span> <span class="n">Rights</span> <span class="n">Reserved</span>
<span class="o">*</span> <span class="n">VIRTEL</span> <span class="n">Web</span> <span class="n">Access</span> <span class="n">customer</span><span class="o">-</span><span class="n">specific</span> <span class="n">javascript</span> <span class="n">functions</span>
<span class="o">*</span> <span class="n">after_standardInit</span><span class="p">()</span> <span class="n">function</span> <span class="n">must</span> <span class="n">be</span> <span class="n">implemented</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">custom</span><span class="o">.</span><span class="n">js</span> <span class="n">file</span>
<span class="o">*/</span>
<span class="n">function</span> <span class="n">after_standardInit</span><span class="p">()</span> <span class="p">{</span>
    <span class="o">/*</span> <span class="n">Remove</span> <span class="n">macro</span> <span class="n">buttons</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">toolbar</span> <span class="o">*/</span>
    <span class="n">removetoolbarbutton</span><span class="p">(</span><span class="s2">&quot;startrecording&quot;</span><span class="p">);</span>
    <span class="n">removetoolbarbutton</span><span class="p">(</span><span class="s2">&quot;playback&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Example custom.js to remove selected toolbar icons</em></p>
<p>The names of the other toolbar icons which can be removed in this way are:</p>
<ul class="simple">
<li><p>capture,</p></li>
<li><p>disconnect,</p></li>
<li><p>document-print-preview,</p></li>
<li><p>edit-copy,</p></li>
<li><p>edit-cut,</p></li>
<li><p>edit-paste,</p></li>
<li><p>emptybuf,</p></li>
<li><p>file-rcv,</p></li>
<li><p>file-send,</p></li>
<li><p>help,</p></li>
<li><p>keypad,</p></li>
<li><p>playback,</p></li>
<li><p>printer,</p></li>
<li><p>settings,</p></li>
<li><p>settingsV2,</p></li>
<li><p>startrecording.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>(settingsV2 is présent only if w2hparms.js contains “settingsGUI”:{“version”:”V2”}, or “settingsGUI”:{“version”:”V1+V2”},)</p>
</div>
<p>To hide the toolbar completely, see “Hiding the toolbar” on page 6. To hide only the Virtel Application name, see “Showing / Hiding server information”, on page 15.</p>
</div>
<div class="section" id="removing-file-transfer-icons">
<h5>Removing file transfer icons<a class="headerlink" href="#removing-file-transfer-icons" title="Permalink to this headline">¶</a></h5>
<p>VIRTEL Web Access supports transfer of files between the browser and a TSO session using the IND$FILE protocol. The function is activated displayed only for the transaction defined with the SCENINDT scenario entered in Input and Output scenario fields. For some specific users, it may be necessary to remove the file transfer icons from the toolbar.
This can be done by using the “removetoolbarbutton” function using the appropriate variable name.(See “Removing unwanted toolbar icons”, page 11.)</p>
</div>
<div class="section" id="removing-macro-icons">
<h5>Removing macro icons<a class="headerlink" href="#removing-macro-icons" title="Permalink to this headline">¶</a></h5>
<p>Icons for recording or executing a Macro are automatically present in the toolbar. To make them unavailable you should use the “removetoolbarbutton” function using the appropriate variable name.(See “Removing unwanted toolbar icons”, page 11.)</p>
</div>
<div class="section" id="positioning-toolbar-icons">
<h5>Positioning toolbar icons<a class="headerlink" href="#positioning-toolbar-icons" title="Permalink to this headline">¶</a></h5>
<p>In certain circumstances, the default position of an icon may not be at the user’s convenience. Is possible to change an icon’s position based on the position of another icon.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="o">*</span> <span class="n">Customize</span> <span class="n">the</span> <span class="n">location</span> <span class="n">of</span> <span class="n">dynamic</span> <span class="n">toolbar</span> <span class="n">buttons</span><span class="o">.</span>
<span class="o">*</span> <span class="n">The</span> <span class="n">calls</span> <span class="n">to</span> <span class="n">this</span> <span class="n">function</span> <span class="n">are</span> <span class="n">ignored</span> <span class="n">when</span> <span class="n">they</span>
<span class="o">*</span> <span class="k">return</span> <span class="n">nothing</span><span class="p">,</span> <span class="ow">or</span> <span class="n">an</span> <span class="n">integer</span> <span class="ow">not</span> <span class="n">greater</span> <span class="n">than</span> <span class="mf">0.</span>
<span class="o">*</span>
<span class="o">*</span> <span class="n">Customizable</span> <span class="n">buttons</span> <span class="n">IDs</span> <span class="p">:</span>
<span class="o">*</span> <span class="o">&gt;</span> <span class="s1">&#39;3278T&#39;</span>
<span class="o">*</span> <span class="o">&gt;</span> <span class="s1">&#39;document-print-preview&#39;</span>
<span class="o">*</span> <span class="o">&gt;</span> <span class="s1">&#39;file-send&#39;</span>
<span class="o">*</span> <span class="o">&gt;</span> <span class="s1">&#39;file-recv&#39;</span>
<span class="o">*</span> <span class="o">&gt;</span> <span class="s1">&#39;printer&#39;</span>
<span class="o">*/</span>
<span class="n">function</span> <span class="n">customize_toolbarButtonIndex</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">id</span><span class="o">===</span><span class="s1">&#39;printer&#39;</span> <span class="o">||</span> <span class="nb">id</span><span class="o">===</span><span class="s1">&#39;document-print-preview&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">getToolbarButtonIndex</span><span class="p">(</span><span class="s1">&#39;disconnect&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Example custom.js to select a position for printer icon</em></p>
</div>
<div class="section" id="centering-non-standard-icons">
<h5>Centering non standard icons<a class="headerlink" href="#centering-non-standard-icons" title="Permalink to this headline">¶</a></h5>
<p>The best size for an icon is 32x32 pixels. For bigger or smaller icons, it possible to offer better center rendering in modifying the content of the class attribute passed within the “addtoolbarbutton” function in conjunction of using a specific css attribute.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="n">Copyright</span> <span class="n">SysperTec</span> <span class="n">Communication</span> <span class="mi">2014</span> <span class="n">All</span> <span class="n">Rights</span> <span class="n">Reserved</span>
<span class="o">*</span> <span class="n">VIRTEL</span> <span class="n">Web</span> <span class="n">Access</span> <span class="n">customer</span><span class="o">-</span><span class="n">specific</span> <span class="n">javascript</span> <span class="n">functions</span>
<span class="o">*</span> <span class="n">Resizing</span> <span class="n">a</span> <span class="n">too</span> <span class="n">small</span> <span class="ow">or</span> <span class="n">too</span> <span class="n">big</span> <span class="n">toolbar</span> <span class="n">icon</span><span class="o">.</span>
<span class="o">*</span> <span class="n">For</span> <span class="n">example</span> <span class="n">toosmall_pic</span><span class="o">.</span><span class="n">png</span><span class="o">=</span><span class="mi">22</span><span class="n">x22</span> <span class="ow">and</span> <span class="n">toobig_pic</span><span class="o">.</span><span class="n">jpg</span><span class="o">=</span><span class="mi">145</span><span class="n">x30</span>
<span class="o">*/</span>
<span class="n">addtoolbarbutton</span><span class="p">(</span><span class="mi">999</span><span class="p">,</span> <span class="s2">&quot;/w2h/toosmall_pic.png&quot;</span><span class="p">,</span> <span class="s2">&quot;Custom button #1 tooltip&quot;</span><span class="p">,</span>
    <span class="n">do_search</span><span class="p">,</span> <span class="s2">&quot;tbButton size22x22&quot;</span><span class="p">);</span>
<span class="n">addtoolbarbutton</span><span class="p">(</span><span class="mi">999</span><span class="p">,</span> <span class="s2">&quot;/w2h/toobig_pic.jpg&quot;</span><span class="p">,</span> <span class="s2">&quot;Custom button #2 tooltip&quot;</span><span class="p">,</span>
    <span class="n">do_search</span><span class="p">,</span> <span class="s2">&quot;tbButton size145x30&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p><em>Example custom.js to specify the toolbar icon size</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="c1">#toolbar td img.tbButton.size22x22 {</span>
    <span class="n">width</span><span class="p">:</span> <span class="mi">22</span><span class="n">px</span><span class="p">;</span>
    <span class="n">height</span><span class="p">:</span> <span class="mi">22</span><span class="n">px</span><span class="p">;</span>
    <span class="n">padding</span><span class="p">:</span> <span class="mi">5</span><span class="n">px</span><span class="p">;</span> <span class="o">/*</span> <span class="n">padding</span> <span class="ow">is</span> <span class="n">calculated</span> <span class="n">to</span> <span class="n">center</span> <span class="n">the</span> <span class="n">picture</span> <span class="n">horizontaly</span>
    <span class="ow">and</span> <span class="n">verticaly</span> <span class="ow">in</span> <span class="n">the</span> <span class="mi">32</span><span class="n">x32</span> <span class="n">allocated</span> <span class="n">area</span><span class="o">.</span> <span class="p">(</span><span class="mi">5</span><span class="o">+</span><span class="mi">22</span><span class="o">+</span><span class="mi">5</span> <span class="o">=</span> <span class="mi">32</span><span class="p">)</span> <span class="o">*/</span>
<span class="p">}</span>

<span class="c1">#toolbar td img.tbButton.size145x30 {</span>
    <span class="n">width</span><span class="p">:</span> <span class="mi">145</span><span class="n">px</span><span class="p">;</span>
    <span class="n">height</span><span class="p">:</span> <span class="mi">30</span><span class="n">px</span><span class="p">;</span>
    <span class="n">padding</span><span class="p">:</span> <span class="mi">1</span><span class="n">px</span> <span class="mi">0</span><span class="p">;</span> <span class="o">/*</span> <span class="n">padding</span> <span class="ow">is</span> <span class="n">calculated</span> <span class="n">to</span> <span class="n">center</span> <span class="n">the</span> <span class="n">picture</span> <span class="n">verticaly</span>
    <span class="ow">in</span> <span class="n">the</span> <span class="mi">32</span><span class="n">x32</span> <span class="n">allocated</span> <span class="n">area</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">30</span><span class="o">+</span><span class="mi">1</span> <span class="o">=</span> <span class="mi">32</span><span class="p">)</span> <span class="n">without</span> <span class="nb">any</span> <span class="n">horizontaly</span> <span class="n">padding</span> <span class="o">*/</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Example custom.css to manage a toolbar icon with a non standard size</em></p>
</div>
<div class="section" id="removing-3d-hover-effects-on-the-toolbar-buttons">
<h5>Removing 3D/hover effects on the toolbar buttons<a class="headerlink" href="#removing-3d-hover-effects-on-the-toolbar-buttons" title="Permalink to this headline">¶</a></h5>
<p>This example shows how to remove the 3D/hover effects on toolbar buttons by adding orders in the custom.css file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="o">*</span> <span class="n">VIRTEL</span> <span class="n">Web</span> <span class="n">Access</span> <span class="n">style</span> <span class="n">sheet</span> <span class="n">customisation</span> <span class="k">for</span> <span class="n">removing</span> <span class="mi">3</span><span class="n">D</span><span class="o">/</span><span class="n">hover</span> <span class="n">effects</span>
<span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="n">Copyright</span> <span class="n">SysperTec</span> <span class="n">Communication</span> <span class="mi">2014</span> <span class="n">All</span> <span class="n">Rights</span> <span class="n">Reserved</span>
<span class="o">*/</span>
<span class="c1">#toolbar td .tbButton,</span>
<span class="c1">#toolbar td .tbButton:hover,</span>
<span class="c1">#toolbar td .tbButton:active {</span>
    <span class="n">background</span><span class="o">-</span><span class="n">color</span><span class="p">:</span> <span class="n">inherit</span><span class="p">;</span>
    <span class="n">border</span><span class="p">:</span> <span class="n">inherit</span><span class="p">;</span>
    <span class="n">box</span><span class="o">-</span><span class="n">shadow</span><span class="p">:</span> <span class="n">inherit</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Example custom.css for removing 3D/hover effects on buttons</em></p>
</div>
</div>
<div class="section" id="file-transfer-icons">
<h4>File Transfer icons<a class="headerlink" href="#file-transfer-icons" title="Permalink to this headline">¶</a></h4>
<p>The File Transfer icons are present in the toolbar only for access to TSO and if the transaction includes an INPUT and/or OUTPUT scenario with a call to the INDSCEN$ macro (See “TSO File Transfer” in “Virtel Web Access User Guide”).</p>
<div class="section" id="id1">
<h5>Removing file transfer icons<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h5>
<p>VIRTEL Web Access supports transfer of files between the browser and a TSO session using the IND$FILE protocol. The function is activated displayed only for the transaction defined with the SCENINDT scenario entered in Input and Output scenario fields. For some specific users, it may be necessary to remove the file transfer icons from the toolbar.
This can be done by using the removetoolbarbutton function using the appropriate variable name.(see “Removing unwanted toolbar icons”, page 11.)</p>
</div>
</div>
<div class="section" id="macro-icons">
<h4>Macro Icons<a class="headerlink" href="#macro-icons" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id2">
<h5>Removing Macro icons<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h5>
<p>See “Removing unwanted toolbar icons”, page 11.</p>
</div>
</div>
<div class="section" id="icon-display-troubleshooting">
<h4>Icon display troubleshooting<a class="headerlink" href="#icon-display-troubleshooting" title="Permalink to this headline">¶</a></h4>
<p>If some icons on the toolbar are displayed with some parasites on the border, please check that the browser is not in a zoom mode greater than 100%.</p>
</div>
<div class="section" id="background-information">
<h4>Background information<a class="headerlink" href="#background-information" title="Permalink to this headline">¶</a></h4>
<div class="section" id="adding-custom-text-by-application-to-the-toolbar">
<h5>Adding custom text by application to the toolbar<a class="headerlink" href="#adding-custom-text-by-application-to-the-toolbar" title="Permalink to this headline">¶</a></h5>
<p>Another way of providing a clear visual indication of which application the user is logged on to is to add a text label to the toolbar. In this example the text “MVS1” is displayed when logged on to application TSO1A, and “MVS2” is displayed for application TSO2A.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="o">*</span> <span class="n">VIRTEL</span> <span class="n">Web</span> <span class="n">Access</span> <span class="n">style</span> <span class="n">sheet</span> <span class="k">for</span> <span class="n">site</span> <span class="n">customisation</span>
<span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="n">Copyright</span> <span class="n">SysperTec</span> <span class="n">Communication</span> <span class="mi">2007</span><span class="p">,</span><span class="mi">2010</span> <span class="n">All</span> <span class="n">Rights</span> <span class="n">Reserved</span>
<span class="o">*/</span>
<span class="o">.</span><span class="n">toolbarLast</span><span class="p">{</span>
    <span class="n">text</span><span class="o">-</span><span class="n">align</span><span class="p">:</span> <span class="n">right</span><span class="p">;</span> <span class="o">/*</span> <span class="n">Text</span> <span class="n">alignement</span> <span class="o">*/</span>
<span class="p">}</span>
<span class="o">.</span><span class="n">TSO1A</span> <span class="o">.</span><span class="n">toolbarLast</span><span class="p">:</span><span class="n">before</span> <span class="p">{</span>
    <span class="n">content</span><span class="p">:</span> <span class="s2">&quot;MVS1&quot;</span><span class="p">;</span>
    <span class="n">opacity</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">;</span>
    <span class="n">font</span><span class="o">-</span><span class="n">size</span><span class="p">:</span> <span class="mi">30</span><span class="n">px</span><span class="p">;</span>
    <span class="n">width</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span><span class="p">;</span>
    <span class="n">z</span><span class="o">-</span><span class="n">index</span><span class="p">:</span> <span class="mi">1000</span><span class="p">;</span>
    <span class="o">-</span><span class="n">webkit</span><span class="o">-</span><span class="n">text</span><span class="o">-</span><span class="n">stroke</span><span class="p">:</span> <span class="mi">1</span><span class="n">px</span> <span class="n">blue</span><span class="p">;</span> <span class="o">/*</span> <span class="n">Select</span> <span class="n">color</span> <span class="o">*/</span>
    <span class="n">padding</span><span class="o">-</span><span class="n">right</span><span class="p">:</span> <span class="mi">5</span><span class="n">px</span><span class="p">;</span> <span class="o">/*</span> <span class="n">To</span> <span class="n">separate</span> <span class="n">cells</span> <span class="o">*/</span>
<span class="p">}</span>

<span class="o">.</span><span class="n">TSO2A</span> <span class="o">.</span><span class="n">toolbarLast</span><span class="p">:</span><span class="n">before</span> <span class="p">{</span>
    <span class="n">content</span><span class="p">:</span> <span class="s2">&quot;MVS2&quot;</span><span class="p">;</span>
    <span class="n">opacity</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">;</span>
    <span class="n">font</span><span class="o">-</span><span class="n">size</span><span class="p">:</span> <span class="mi">30</span><span class="n">px</span><span class="p">;</span>
    <span class="n">width</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span><span class="p">;</span>
    <span class="n">z</span><span class="o">-</span><span class="n">index</span><span class="p">:</span> <span class="mi">1000</span><span class="p">;</span>
    <span class="o">-</span><span class="n">webkit</span><span class="o">-</span><span class="n">text</span><span class="o">-</span><span class="n">stroke</span><span class="p">:</span> <span class="mi">1</span><span class="n">px</span> <span class="n">red</span><span class="p">;</span> <span class="o">/*</span> <span class="n">Select</span> <span class="n">color</span> <span class="o">*/</span>
    <span class="n">padding</span><span class="o">-</span><span class="n">right</span><span class="p">:</span> <span class="mi">5</span><span class="n">px</span><span class="p">;</span> <span class="o">/*</span> <span class="n">To</span> <span class="n">separate</span> <span class="n">cells</span> <span class="o">*/</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Example custom.css for adding custom text to the toolbar</em></p>
<p><img alt="image5" src="../../../_images/image535.png" />
<em>Web Access screen with custom text in the toolbar</em></p>
</div>
<div class="section" id="adding-application-name-to-the-toolbar">
<h5>Adding application name to the toolbar<a class="headerlink" href="#adding-application-name-to-the-toolbar" title="Permalink to this headline">¶</a></h5>
<p>Another way of providing a clear visual indication of which application the user is logged on to is to add the application name label to the toolbar. In this example the text “TSO” is displayed when logged on to application TSO, and “SPCICSH” is displayed for application SPCICSH.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="o">*</span> <span class="n">VIRTEL</span> <span class="n">Web</span> <span class="n">Access</span> <span class="n">style</span> <span class="n">sheet</span> <span class="k">for</span> <span class="n">site</span> <span class="n">customisation</span>
<span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="n">Copyright</span> <span class="n">SysperTec</span> <span class="n">Communication</span> <span class="mi">2007</span><span class="p">,</span><span class="mi">2010</span> <span class="n">All</span> <span class="n">Rights</span> <span class="n">Reserved</span>
<span class="o">*/</span>
<span class="o">.</span><span class="n">toolbarLast</span><span class="p">{</span>
    <span class="n">text</span><span class="o">-</span><span class="n">align</span><span class="p">:</span> <span class="n">right</span><span class="p">;</span> <span class="o">/*</span> <span class="n">Text</span> <span class="n">alignment</span> <span class="o">*/</span>
<span class="p">}</span>
<span class="o">.</span><span class="n">TSO</span> <span class="o">.</span><span class="n">toolbarLast</span><span class="p">:</span><span class="n">before</span> <span class="p">{</span>
    <span class="n">content</span><span class="p">:</span> <span class="s2">&quot;TSO&quot;</span><span class="p">;</span>
    <span class="n">opacity</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">;</span>
    <span class="n">font</span><span class="o">-</span><span class="n">size</span><span class="p">:</span> <span class="mi">30</span><span class="n">px</span><span class="p">;</span>
    <span class="n">width</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span><span class="p">;</span>
    <span class="n">z</span><span class="o">-</span><span class="n">index</span><span class="p">:</span> <span class="mi">1000</span><span class="p">;</span>
    <span class="o">-</span><span class="n">webkit</span><span class="o">-</span><span class="n">text</span><span class="o">-</span><span class="n">stroke</span><span class="p">:</span> <span class="mi">1</span><span class="n">px</span> <span class="n">red</span><span class="p">;</span> <span class="o">/*</span> <span class="n">Select</span> <span class="n">color</span> <span class="o">*/</span>
    <span class="n">padding</span><span class="o">-</span><span class="n">right</span><span class="p">:</span> <span class="mi">5</span><span class="n">px</span><span class="p">;</span> <span class="o">/*</span> <span class="n">To</span> <span class="n">separate</span> <span class="n">cells</span> <span class="o">*/</span>
<span class="p">}</span>
<span class="o">.</span><span class="n">SPCICSH</span> <span class="o">.</span><span class="n">toolbarLast</span><span class="p">:</span><span class="n">before</span> <span class="p">{</span>
    <span class="n">content</span><span class="p">:</span> <span class="s2">&quot;SPCICSH&quot;</span><span class="p">;</span>
    <span class="n">opacity</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">;</span>
    <span class="n">font</span><span class="o">-</span><span class="n">size</span><span class="p">:</span> <span class="mi">30</span><span class="n">px</span><span class="p">;</span>
    <span class="n">width</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span><span class="p">;</span>
    <span class="n">z</span><span class="o">-</span><span class="n">index</span><span class="p">:</span> <span class="mi">1000</span><span class="p">;</span>
    <span class="o">-</span><span class="n">webkit</span><span class="o">-</span><span class="n">text</span><span class="o">-</span><span class="n">stroke</span><span class="p">:</span> <span class="mi">1</span><span class="n">px</span> <span class="n">blue</span><span class="p">;</span> <span class="o">/*</span> <span class="n">Select</span> <span class="n">color</span> <span class="o">*/</span>
    <span class="n">padding</span><span class="o">-</span><span class="n">right</span><span class="p">:</span> <span class="mi">5</span><span class="n">px</span><span class="p">;</span> <span class="o">/*</span> <span class="n">To</span> <span class="n">separate</span> <span class="n">cells</span> <span class="o">*/</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Example custom.css for adding custom text to the toolbar</em></p>
<p><img alt="image6" src="../../../_images/image630.png" />
<em>Web Access screen with custom application name in the toolbar</em></p>
</div>
<div class="section" id="showing-hiding-server-informations">
<h5>Showing / Hiding server informations<a class="headerlink" href="#showing-hiding-server-informations" title="Permalink to this headline">¶</a></h5>
<p>It is sometimes useful to have a clear visual indication of which server a user is logged on to, its version and the maintenance level applied on the system. By default, the value specified into the APPLID parameter of the VIRTCT is displayed at the top-right of the toolbar as shown below. This information is followed by the running version number and the Virtel Web access level of maintenance used. This last information is enclosed in parentheses.</p>
<p><img alt="image7" src="../../../_images/image730.png" /></p>
<p>The running version and the level of maintenance cannot be hidden, only the server name can be <strong>permanently</strong> removed by modifying the w2hparm.hideinfo attribut present in the customized w2hparms.js file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="o">*</span> <span class="n">Configuration</span> <span class="n">of</span> <span class="n">the</span> <span class="n">server</span> <span class="n">name</span> <span class="n">connected</span> <span class="n">to</span><span class="o">.</span>
<span class="o">*/</span>
<span class="n">w2hparm</span><span class="o">.</span><span class="n">hideinfo</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
</pre></div>
</div>
<p><em>Example w2hparm.js for hiding the mainframe application name on which a user is connected to.</em></p>
<p>If the default value is preserved, the user can hide this information for his own usage by checking “Hide Virtel information in toolbar” in the Display tab of the settings panel.</p>
</div>
<div class="section" id="id3">
<h5>Showing / Hiding running version and maintenance level<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h5>
<p>On the right side of the toolbar, the running version and the level of maintenance of VIRTEL is shown. As this information is important and very helpful in case of troubleshooting, those information cannot be hidden.</p>
</div>
</div>
<div class="section" id="language">
<h4>Language<a class="headerlink" href="#language" title="Permalink to this headline">¶</a></h4>
<div class="section" id="hide-the-language-icon">
<h5>Hide the Language Icon<a class="headerlink" href="#hide-the-language-icon" title="Permalink to this headline">¶</a></h5>
<p>You can hide the language icon by using the following orders included in a custom.css file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#toolbar td#toolbar-lang { width: 1px; }</span>
<span class="c1">#toolbar td#toolbar-lang a { display: none; }</span>
</pre></div>
</div>
<p><em>Example to hide the language icon</em></p>
</div>
<div class="section" id="assign-a-default-language">
<h5>Assign a default language<a class="headerlink" href="#assign-a-default-language" title="Permalink to this headline">¶</a></h5>
<p>You can force default language and leave to the customer the possibility to select another one if necessary by using the following order included in a custom.js file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">function</span> <span class="n">after_standardInit</span><span class="p">()</span> <span class="p">{</span>
    <span class="o">/*</span> <span class="n">Will</span> <span class="n">force</span> <span class="n">default</span> <span class="n">language</span> <span class="n">to</span> <span class="n">Croatian</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">leave</span> <span class="n">to</span> <span class="n">the</span> <span class="n">customer</span> <span class="n">the</span> <span class="n">possibility</span> <span class="n">to</span> <span class="n">select</span> <span class="n">another</span> <span class="n">one</span> <span class="k">if</span> <span class="n">necessary</span> <span class="o">*/</span>
    <span class="n">oVWAmsg</span><span class="o">.</span><span class="n">changeLang</span><span class="p">(</span><span class="s2">&quot;hr&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Example to assign a default langage</em></p>
<p>Possible values for the language code are:</p>
<ul class="simple">
<li><p>DE for Deutsch</p></li>
<li><p>EN for English</p></li>
<li><p>ES for Spanish</p></li>
<li><p>FR for French</p></li>
<li><p>HR for Croatian</p></li>
<li><p>IT for Italian</p></li>
</ul>
<p>They must be entered in lower case.</p>
</div>
<div class="section" id="assign-a-permanent-default-language">
<h5>Assign a permanent default language<a class="headerlink" href="#assign-a-permanent-default-language" title="Permalink to this headline">¶</a></h5>
<p>You can force default language and not allow the customer to select another one. You can do it by using the following order included in a custom.js file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">function</span> <span class="n">after_standardInit</span><span class="p">()</span> <span class="p">{</span>
    <span class="o">/*</span> <span class="n">Will</span> <span class="n">force</span> <span class="n">default</span> <span class="n">language</span> <span class="n">to</span> <span class="n">Croatian</span> <span class="ow">and</span> <span class="n">will</span> <span class="ow">not</span> <span class="n">allow</span> <span class="n">the</span> <span class="n">customer</span> <span class="n">to</span> <span class="n">select</span> <span class="n">another</span> <span class="n">one</span> <span class="k">if</span> <span class="n">necessary</span> <span class="o">*/</span>
    <span class="n">oVWAmsgVWAmsg</span><span class="o">.</span><span class="n">restrictLanguages</span><span class="p">(</span><span class="s2">&quot;hr&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Example to assign a permanent default language</em></p>
<p>Possible values for the language code are:</p>
<ul class="simple">
<li><p>DE for Deutsch</p></li>
<li><p>EN for English</p></li>
<li><p>ES for Spanish</p></li>
<li><p>FR for French</p></li>
<li><p>HR for Croatian</p></li>
<li><p>IT for Italian</p></li>
</ul>
<p>They must be entered in lower case.</p>
</div>
</div>
</div>
<div class="section" id="status-bar">
<h3>Status bar<a class="headerlink" href="#status-bar" title="Permalink to this headline">¶</a></h3>
<p>The status bar of the VWA user interface is located at the bottom and includes the monitoring zone (4), particulars of the terminals associated with the session (5), mode and cursor position (6).</p>
<p><img alt="image7" src="../../../_images/image730.png" />
<em>The VWA 3270 screen’s areas</em></p>
<div class="section" id="how-to-deactivate-the-virtel-status-bar">
<h4>How to deactivate the Virtel status bar<a class="headerlink" href="#how-to-deactivate-the-virtel-status-bar" title="Permalink to this headline">¶</a></h4>
<p>To deativate the status bar create a ccs rule and add it to a custom css file. For example to deactivate it fo transactions associated with the iptions id “test1” create a “e in</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">CLI</span><span class="o">-</span><span class="n">DIR</span> <span class="o">-</span> <span class="n">option</span><span class="o">.</span><span class="n">myOptions</span><span class="o">.</span><span class="n">css</span><span class="o">.</span> <span class="n">Transaction</span> <span class="n">level</span> <span class="n">core</span> <span class="n">option</span> <span class="n">file</span>
<span class="n">var</span> <span class="n">oCustom</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">&quot;pathToCssCustom&quot;</span><span class="p">:</span><span class="s2">&quot;../option/custCSS.myOptions.css&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Example of a core option file for customized CSS file</em></p>
<p>This “”core option file” points to our customized CSS member for transactions which have the option=”myOptions” defined. This member contains a CSS style statement:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">div</span><span class="c1">#statusbar {display:none!important}</span>
</pre></div>
</div>
<p><em>Example of customized CSS element</em></p>
</div>
<div class="section" id="relay-and-printer-name">
<h4>Relay and Printer name<a class="headerlink" href="#relay-and-printer-name" title="Permalink to this headline">¶</a></h4>
<div class="section" id="managing-relay-and-printer-name-area">
<h5>Managing Relay and Printer name area<a class="headerlink" href="#managing-relay-and-printer-name-area" title="Permalink to this headline">¶</a></h5>
<p>The area (5) of the VWA user interface contains information about the terminals used during the session. The name of the 3270 relay terminal is shown in the leftmost portion of the area while the name of the virtual printer terminal is shown in the rightmost portion of the area. The presence of a printer device is optional and depends on the terminal
definition itself. The information in this area can be managed using the following functions:</p>
<ul class="simple">
<li><p>Editing functions</p>
<ul>
<li><p>vwaStatusBar.setRelay(“some txt”) to customize the 3270 relay area</p></li>
<li><p>vwaStatusBar.setPrintRelay(“some txt”) to customize the print relay area</p></li>
</ul>
</li>
<li><p>Retrieval functions</p>
<ul>
<li><p>vwaStatusBar.getRelay(P1) to retrieve the content of the 3270 relay area</p></li>
<li><p>vwaStatusBar.getPrintRelay(P1) to retrieve the content of the print relay area</p></li>
</ul>
</li>
</ul>
<p>For the retrieval function, if the value of the parameter P1 is “true” (without the double quotes), the information returned is the value of “Relay or Printer” as valued at the time the command executes. If the P1 is undefined or if its value is different from “true” the information returned is the value of “Relay or Printer” as existed at the time the page
was sent by VWA to the browser.</p>
</div>
<div class="section" id="relay-name-area">
<h5>Relay name area<a class="headerlink" href="#relay-name-area" title="Permalink to this headline">¶</a></h5>
<p>You can manage the content of the relay name area by adding appropriate orders in after_responseHandle function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="n">Copyright</span> <span class="n">SysperTec</span> <span class="n">Communication</span> <span class="mi">2012</span> <span class="n">All</span> <span class="n">Rights</span> <span class="n">Reserved</span>
<span class="o">*</span> <span class="n">VIRTEL</span> <span class="n">Web</span> <span class="n">Access</span> <span class="n">customer</span><span class="o">-</span><span class="n">specific</span> <span class="n">javascript</span> <span class="n">functions</span>
<span class="o">*/</span>
<span class="n">function</span> <span class="n">after_responseHandle</span><span class="p">(</span><span class="n">httpXmlObj</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">xmitTimestamp</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">vwaStatusBar</span><span class="o">.</span><span class="n">setRelay</span><span class="p">();</span> <span class="o">//</span> <span class="n">Clears</span> <span class="n">relay</span> <span class="n">field</span>
    <span class="n">vwaStatusBar</span><span class="o">.</span><span class="n">setRelay</span><span class="p">(</span><span class="s2">&quot;Relay: &quot;</span> <span class="o">+</span> <span class="o">//</span> <span class="n">Adds</span> <span class="n">some</span> <span class="n">text</span>
    <span class="n">vwaStatusBar</span><span class="o">.</span><span class="n">getRelay</span><span class="p">());</span> <span class="o">//</span> <span class="n">Get</span> <span class="n">the</span> <span class="n">relay</span> <span class="n">name</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Example custom.js to customize the content of the relay name area</em></p>
</div>
<div class="section" id="hide-relay-name-area-content">
<h5>Hide Relay name area content<a class="headerlink" href="#hide-relay-name-area-content" title="Permalink to this headline">¶</a></h5>
<p>You can hide the content of the realy name by replacing its content by spaces.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="n">Copyright</span> <span class="n">SysperTec</span> <span class="n">Communication</span> <span class="mi">2012</span> <span class="n">All</span> <span class="n">Rights</span> <span class="n">Reserved</span>
<span class="o">*</span> <span class="n">VIRTEL</span> <span class="n">Web</span> <span class="n">Access</span> <span class="n">customer</span><span class="o">-</span><span class="n">specific</span> <span class="n">javascript</span> <span class="n">functions</span>
<span class="o">*/</span>
<span class="n">function</span> <span class="n">after_responseHandle</span><span class="p">(</span><span class="n">httpXmlObj</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">xmitTimestamp</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">vwaStatusBar</span><span class="o">.</span><span class="n">setRelay</span><span class="p">();</span> <span class="o">//</span> <span class="n">Clears</span> <span class="n">relay</span> <span class="n">field</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Example custom.js to hide the content of the relay name area</em></p>
</div>
<div class="section" id="printer-name-area">
<h5>Printer name area<a class="headerlink" href="#printer-name-area" title="Permalink to this headline">¶</a></h5>
<p>You can manage the content of the printer name area by adding appropriate orders in after_responseHandle function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="n">Copyright</span> <span class="n">SysperTec</span> <span class="n">Communication</span> <span class="mi">2012</span> <span class="n">All</span> <span class="n">Rights</span> <span class="n">Reserved</span>
<span class="o">*</span> <span class="n">VIRTEL</span> <span class="n">Web</span> <span class="n">Access</span> <span class="n">customer</span><span class="o">-</span><span class="n">specific</span> <span class="n">javascript</span> <span class="n">functions</span>
<span class="o">*/</span>
<span class="n">function</span> <span class="n">after_responseHandle</span><span class="p">(</span><span class="n">httpXmlObj</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">xmitTimestamp</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">vwaStatusBar</span><span class="o">.</span><span class="n">setPrintRelay</span><span class="p">();</span> <span class="o">//</span> <span class="n">Clears</span> <span class="n">printer</span> <span class="n">field</span>
    <span class="n">vwaStatusBar</span><span class="o">.</span><span class="n">setPrintRelay</span><span class="p">(</span><span class="s2">&quot;CICS printer: &quot;</span> <span class="o">+</span> <span class="o">//</span> <span class="n">Adds</span> <span class="n">some</span> <span class="n">text</span>
    <span class="n">vwaStatusBar</span><span class="o">.</span><span class="n">getPrintRelay</span><span class="p">());</span> <span class="o">//</span> <span class="n">Get</span> <span class="n">the</span> <span class="n">printer</span> <span class="n">name</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Example custom.js to customize the content of the printer name area</em></p>
</div>
<div class="section" id="hide-printer-name-area-content">
<h5>Hide Printer name area content<a class="headerlink" href="#hide-printer-name-area-content" title="Permalink to this headline">¶</a></h5>
<p>You can hide the content of the printer name by replacing its content by spaces.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="o">*</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="n">Copyright</span> <span class="n">SysperTec</span> <span class="n">Communication</span> <span class="mi">2012</span> <span class="n">All</span> <span class="n">Rights</span> <span class="n">Reserved</span>
<span class="o">*</span> <span class="n">VIRTEL</span> <span class="n">Web</span> <span class="n">Access</span> <span class="n">customer</span><span class="o">-</span><span class="n">specific</span> <span class="n">javascript</span> <span class="n">functions</span>
<span class="o">*/</span>

<span class="n">function</span> <span class="n">after_responseHandle</span><span class="p">(</span><span class="n">httpXmlObj</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">xmitTimestamp</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">vwaStatusBar</span><span class="o">.</span><span class="n">setPrintRelay</span><span class="p">();</span> <span class="o">//</span> <span class="n">Clears</span> <span class="n">printer</span> <span class="n">field</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Example custom.js to hide the content of the printer name area</em></p>
</div>
</div>
</div>
</div>
<div class="section" id="dynamic-directory-interface-ddi">
<h2>Dynamic Directory Interface (DDI)<a class="headerlink" href="#dynamic-directory-interface-ddi" title="Permalink to this headline">¶</a></h2>
<p>The Dynamic Directory Interface is intended for the administrator, to enable the users to deal with dynamic directories including those dedicated to various users and groups. The DDI application is accessible from the link “Dynamic directory interface” present in the main page associated with the Administration portal supported by the W-HTTP line.</p>
<p><img alt="image26" src="../../../_images/image2610.png" /></p>
<p><em>Accessing the Dynamic Directory Interface</em></p>
</div>
<div class="section" id="lines">
<h2>Lines<a class="headerlink" href="#lines" title="Permalink to this headline">¶</a></h2>
<div class="section" id="starting-and-stopping-a-line">
<h3>Starting and stopping a line<a class="headerlink" href="#starting-and-stopping-a-line" title="Permalink to this headline">¶</a></h3>
<p>By default, a line is automatically initialized at Virtel startup, and is terminated when Virtel stops. In some cases, the handling of line initialization/termination needs to be managed differently:
Initialization of a line is determined by the “Possible Calls” parameter of the line definition.</p>
<p><img alt="image27" src="../../../_images/image2710.png" /></p>
<p><em>Line definition - Possible Calls Parameter</em></p>
<p><strong>Initilaization through “Possible Calls” definition</strong></p>
<p>A “Possible Calls” determines the possible direction of communication and can have one of four values:-</p>
<ul class="simple">
<li><p>0 - No Calls</p></li>
<li><p>1 - Inbound Calls.</p></li>
<li><p>2 - Outbound Calls.</p></li>
<li><p>3 - Inbound and Outbound Calls.</p></li>
</ul>
<p>If the value is 0 then the line is not initialized at Virtel start-up. It must be started manually. For values 1, 2, 3 the line is initialized automatically at Virtel start-up except for the cases below.</p>
<p><strong>Initialization permanately completely inhibited</strong></p>
<p>If the VIRTCT contains a parameter IGNLU that references the line, then this line shall not be initialized automatically at Virtel start-up. In this case it will no longer be possible to start this line manually after Virtel has started.</p>
<p><strong>Conditional initialization of a line</strong></p>
<p>It is possible to condition the initialization of a line to that of another line. This can be necessary for example when an application communicates with Virtel via MQ/Series, with one line that accepts inbound messages and another line that handles outbound messages. In this case, it is useful to wait until the communication with the partner has been
established before accepting inbound messages.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LINE</span> <span class="n">ID</span><span class="o">=</span><span class="n">M</span><span class="o">-</span><span class="n">MQ1</span><span class="p">,</span> <span class="o">-</span>
    <span class="n">NAME</span><span class="o">=</span><span class="n">MQ</span><span class="o">-</span><span class="n">IN</span><span class="p">,</span> <span class="o">-</span>
    <span class="n">LOCADDR</span><span class="o">=</span><span class="n">REQ</span><span class="o">.</span><span class="n">INPUT</span><span class="o">.</span><span class="n">QUEUE</span><span class="p">,</span> <span class="o">-</span>
    <span class="n">DESC</span><span class="o">=</span><span class="s1">&#39;MQ - REQUEST&#39;</span><span class="p">,</span> <span class="o">-</span>
    <span class="n">TERMINAL</span><span class="o">=</span><span class="n">MQINT</span><span class="p">,</span> <span class="o">-</span>
    <span class="n">ENTRY</span><span class="o">=</span><span class="n">MQINEP</span><span class="p">,</span> <span class="o">-</span>
    <span class="n">TYPE</span><span class="o">=</span><span class="n">MQ1</span><span class="p">,</span> <span class="o">-</span>
    <span class="n">INOUT</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span>
    <span class="n">COND</span><span class="o">=</span><span class="s1">&#39;MIMIC-LINE(M-MQO)&#39;</span><span class="p">,</span> <span class="o">-</span>
    <span class="n">PROTOCOL</span><span class="o">=</span><span class="n">PREFIXED</span><span class="p">,</span> <span class="o">-</span>
    <span class="n">RULESET</span><span class="o">=</span><span class="n">M</span><span class="o">-</span><span class="n">MQ1</span>
    <span class="n">LINE</span> <span class="n">ID</span><span class="o">=</span><span class="n">M</span><span class="o">-</span><span class="n">MQ2</span><span class="p">,</span> <span class="o">-</span>
    <span class="n">NAME</span><span class="o">=</span><span class="n">MQ</span><span class="o">-</span><span class="n">OUT</span><span class="p">,</span> <span class="o">-</span>
    <span class="n">LOCADDR</span><span class="o">=</span><span class="n">REQ</span><span class="o">.</span><span class="n">OUTPUT</span><span class="o">.</span><span class="n">QUEUE</span><span class="p">,</span> <span class="o">-</span>
    <span class="n">DESC</span><span class="o">=</span><span class="s1">&#39;MQ - OUTPUT REQUETE&#39;</span><span class="p">,</span> <span class="o">-</span>
    <span class="n">TERMINAL</span><span class="o">=</span><span class="n">MQOUT</span><span class="p">,</span> <span class="o">-</span>
    <span class="n">TYPE</span><span class="o">=</span><span class="n">MQ1</span><span class="p">,</span> <span class="o">-</span>
    <span class="n">INOUT</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span>
    <span class="n">PROTOCOL</span><span class="o">=</span><span class="n">PREFIXED</span><span class="p">,</span> <span class="o">-</span>
    <span class="n">RULESET</span><span class="o">=</span><span class="n">M</span><span class="o">-</span><span class="n">MQ2</span>
</pre></div>
</div>
<p><strong>Deferred initialization</strong></p>
<p>The “Possible calls” field must be set to 0. The line may subsequently be started by a START command. It must not be referenced by an IGNLU parameter in the VIRTCT.</p>
<p><strong>Virtel Line Commands</strong></p>
<p>Using commands at the system console Lines can be used to start or stop a line by entering the appropriate command at the console. For further information on how to issue Virtel commands, see the Virtel “Audit, Operation And Performance” manuel.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LINE</span><span class="o">=</span><span class="n">linename</span><span class="p">,</span><span class="n">START</span> <span class="p">(</span><span class="ow">or</span> <span class="n">L</span><span class="o">=</span><span class="n">linename</span><span class="p">,</span><span class="n">S</span><span class="p">)</span>
<span class="n">LINE</span><span class="o">=</span><span class="n">linename</span><span class="p">,</span><span class="n">STOP</span> <span class="p">(</span><span class="ow">or</span> <span class="n">L</span><span class="o">=</span><span class="n">linename</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>

<span class="o">**</span><span class="n">linename</span><span class="o">**</span> <span class="o">-</span> <span class="n">internal</span> <span class="ow">or</span> <span class="n">external</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">line</span>
</pre></div>
</div>
<p>The LINE START and LINE STOP commands perform the same function as using the “S” and “P” commands on the “Status of lines” application panel. These commands may only be issued for line types AntiGATE, AntiPCNE, AntiFASTC, and TCP/IP.</p>
</div>
</div>
<div class="section" id="terminal-lu-nailing">
<h2>Terminal LU Nailing<a class="headerlink" href="#terminal-lu-nailing" title="Permalink to this headline">¶</a></h2>
<p>When a user connects to a 3270 application through VIRTEL Web Access, VIRTEL makes it appear to the application as if the user is connecting from a virtual 3270 terminal. In VTAM terms a virtual 3270 terminal is called a Logical Unit or LU, and each LU has a unique eight character name (LU name). VIRTEL has at its disposal a pool of LUs known to VTAM,
whose names are specified in the VIRTEL configuration file (the VIRARBO file). Normally when a user connects to a 3270 application, VIRTEL chooses any available LU from the pool.
While most mainframe applications will accept a connection from any LU name, certain applications (particularly applications which run under IMS) are sensitive to the LU name because they assign permissions to the user based upon the LU name of the user’s terminal. LU nailing allows VIRTEL to assign a particular LU name to a user based upon the user’s IP address or upon a cookie presented by the user’s browser. In this section we describes the following types of LU nailing:</p>
<ul class="simple">
<li><p>LU nailing by work station name</p></li>
<li><p>LU nailing by LU (Pre-defined terminal)</p></li>
<li><p>LU nailing by LU (Non-predefined terminal)</p></li>
<li><p>LU nailing by IP address</p></li>
<li><p>LU nailing by cookie</p></li>
<li><p>LU nailing by URL</p></li>
</ul>
<div class="section" id="lu-nailing-using-the-work-station-name-predefined-terminals">
<h3>LU nailing using the work station name (Predefined terminals)<a class="headerlink" href="#lu-nailing-using-the-work-station-name-predefined-terminals" title="Permalink to this headline">¶</a></h3>
<p>In this example we use a batch job on the user’s PC to initiate a session with Virtel. The batch job obtains the terminal name of the work station, opens a browser window and passes the work station name through to Virtel. With a Virtel RULE we can test the name of the workstation and assign a particular relay LUNAME from a Virtel terminal POOL.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RULE</span> <span class="n">ID</span><span class="o">=</span><span class="n">ESH0000</span><span class="p">,</span> <span class="o">-</span>
<span class="n">RULESET</span><span class="o">=</span><span class="n">E</span><span class="o">-</span><span class="n">HTTP</span><span class="p">,</span> <span class="o">-</span>
<span class="n">STATUS</span><span class="o">=</span><span class="n">ACTIVE</span><span class="p">,</span> <span class="o">-</span>
<span class="n">DESC</span><span class="o">=</span><span class="s1">&#39;Rule for terminal EHPMA00&#39;</span><span class="p">,</span> <span class="o">-</span>
<span class="n">ENTRY</span><span class="o">=</span><span class="n">EDSWHOST</span><span class="p">,</span> <span class="o">-</span>
<span class="n">PARAM</span><span class="o">=</span><span class="n">EHPMA000</span><span class="p">,</span> <span class="o">/*</span> <span class="n">Or</span> <span class="n">EHPMA00</span><span class="o">*</span> <span class="o">*/</span> <span class="o">-</span>
<span class="n">NETMASK</span><span class="o">=</span><span class="mf">255.255</span><span class="o">.</span><span class="mf">255.255</span><span class="p">,</span> <span class="o">-</span>
<span class="n">USERDATA</span><span class="o">=</span><span class="p">(</span><span class="n">EQUAL</span><span class="p">,</span><span class="n">HOLT</span><span class="o">-</span><span class="n">W</span><span class="p">)</span>
</pre></div>
</div>
<p><em>Example of a Virtel RULE to be activated with a user data</em></p>
<p>The rule instructs Virtel to test the user data field passed in a URL and if it matches the string POOL-W than to assign an LU name prefix of EHPMA00 and direct the terminal call to use an entry point of EDSWHOST. A static rule would have to be built for each unique work station name. The EDSWHOST entry point looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ENTRY</span> <span class="n">ID</span><span class="o">=</span><span class="n">EDSWHOST</span><span class="p">,</span> <span class="o">-</span>
<span class="n">DESC</span><span class="o">=</span><span class="s1">&#39;EDS WEB ENTRY POINT (USERS WITH USERDATA)&#39;</span><span class="p">,</span> <span class="o">-</span>
<span class="n">TRANSACT</span><span class="o">=</span><span class="n">EDSW</span><span class="p">,</span> <span class="o">-</span>
<span class="n">TIMEOUT</span><span class="o">=</span><span class="mi">0720</span><span class="p">,</span> <span class="o">-</span>
<span class="n">ACTION</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span>
<span class="n">EMUL</span><span class="o">=</span><span class="n">HTML</span><span class="p">,</span> <span class="o">-</span>
<span class="n">SIGNON</span><span class="o">=</span><span class="n">VIR0020H</span><span class="p">,</span> <span class="o">-</span>
<span class="n">MENU</span><span class="o">=</span><span class="n">VIR0021A</span><span class="p">,</span> <span class="o">-</span>
<span class="n">EXTCOLOR</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="o">-</span>
<span class="n">ENDPAGE</span><span class="o">=</span><span class="n">CLOSE</span><span class="o">.</span><span class="n">HTM</span>
</pre></div>
</div>
<p>In this entry point you would define the relevant transactions. In our case we have defined the following:</p>
<ul class="simple">
<li><p>A transaction using EHLOC terminals to access the /w2h directory</p></li>
<li><p>A Virtel transaction using EHLOC terminals to support the application menu list</p></li>
<li><p>VTAM transaction using EHVTS terminal to establish a relationship with the VTAM application</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TRANSACT</span> <span class="n">ID</span><span class="o">=</span><span class="n">EDSW</span><span class="o">-</span><span class="mi">00</span><span class="p">,</span> <span class="o">-</span>
<span class="n">NAME</span><span class="o">=</span><span class="n">EDSWHOST</span><span class="p">,</span> <span class="o">-</span>
<span class="n">DESC</span><span class="o">=</span><span class="s1">&#39;HTML page directory (default access)&#39;</span><span class="p">,</span> <span class="o">-</span>
<span class="n">APPL</span><span class="o">=</span><span class="n">W2H</span><span class="o">-</span><span class="n">DIR</span><span class="p">,</span> <span class="o">-</span>
<span class="n">TYPE</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span>
<span class="n">TERMINAL</span><span class="o">=</span><span class="n">EHLOC</span><span class="p">,</span> <span class="o">-</span>
<span class="n">STARTUP</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span>
<span class="n">SECURITY</span><span class="o">=</span><span class="mi">0</span>

<span class="n">TRANSACT</span> <span class="n">ID</span><span class="o">=</span><span class="n">EDSW</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span>
<span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;w2h&#39;</span><span class="p">,</span> <span class="o">-</span>
<span class="n">DESC</span><span class="o">=</span><span class="s1">&#39;W2H toolkit directory (/w2h)&#39;</span><span class="p">,</span> <span class="o">-</span>
<span class="n">APPL</span><span class="o">=</span><span class="n">W2H</span><span class="o">-</span><span class="n">DIR</span><span class="p">,</span> <span class="o">-</span>
<span class="n">TYPE</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span>
<span class="n">TERMINAL</span><span class="o">=</span><span class="n">EHLOC</span><span class="p">,</span> <span class="o">-</span>
<span class="n">STARTUP</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span>
<span class="n">SECURITY</span><span class="o">=</span><span class="mi">0</span>

<span class="n">TRANSACT</span> <span class="n">ID</span><span class="o">=</span><span class="n">EDSW</span><span class="o">-</span><span class="mi">41</span><span class="p">,</span> <span class="o">-</span>
<span class="n">NAME</span><span class="o">=</span><span class="n">IMS</span><span class="p">,</span> <span class="o">-</span>
<span class="n">DESC</span><span class="o">=</span><span class="s1">&#39;IMS access with userdata&#39;</span><span class="p">,</span> <span class="o">-</span>
<span class="n">APPL</span><span class="o">=</span><span class="n">IMS3270</span><span class="p">,</span> <span class="o">-</span>
<span class="n">PASSTCKT</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span>
<span class="n">TYPE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span>
<span class="n">TERMINAL</span><span class="o">=</span><span class="n">EHVTS</span><span class="p">,</span> <span class="o">-</span>
<span class="n">STARTUP</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span>
<span class="n">SECURITY</span><span class="o">=</span><span class="mi">0</span>

<span class="n">TRANSACT</span> <span class="n">ID</span><span class="o">=</span><span class="n">EDSW</span><span class="o">-</span><span class="mi">42</span><span class="p">,</span> <span class="o">-</span>
<span class="n">NAME</span><span class="o">=</span><span class="n">TSO</span><span class="p">,</span> <span class="o">-</span>
<span class="n">DESC</span><span class="o">=</span><span class="s1">&#39;TSO access with userdata&#39;</span><span class="p">,</span> <span class="o">-</span>
<span class="n">APPL</span><span class="o">=</span><span class="n">TSO</span><span class="p">,</span> <span class="o">-</span>
<span class="n">PASSTCKT</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span>
<span class="n">TYPE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span>
<span class="n">TERMINAL</span><span class="o">=</span><span class="n">EHVTS</span><span class="p">,</span> <span class="o">-</span>
<span class="n">STARTUP</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span>
<span class="n">SECURITY</span><span class="o">=</span><span class="mi">0</span>

<span class="n">TRANSACT</span> <span class="n">ID</span><span class="o">=</span><span class="n">EDSW</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span>
<span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;applist&#39;</span><span class="p">,</span> <span class="o">-</span>
<span class="n">DESC</span><span class="o">=</span><span class="s1">&#39;List of applications for appmenu.htm&#39;</span><span class="p">,</span> <span class="o">-</span>
<span class="n">APPL</span><span class="o">=</span><span class="n">VIR0021S</span><span class="p">,</span> <span class="o">-</span>
<span class="n">TYPE</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span>
<span class="n">TERMINAL</span><span class="o">=</span><span class="n">EHLOC</span><span class="p">,</span> <span class="o">-</span>
<span class="n">STARTUP</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span>
<span class="n">SECURITY</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
<p>In VTAM we would have the following definition:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="o">------------------------------------------------------------------</span> <span class="o">*</span>
<span class="o">*</span> <span class="n">LU</span> <span class="n">Test</span> <span class="p">:</span> <span class="n">VTAM</span> <span class="n">application</span> <span class="n">relays</span> <span class="k">with</span> <span class="n">user</span> <span class="n">data</span><span class="o">.</span> <span class="o">*</span>
<span class="o">*</span> <span class="o">------------------------------------------------------------------</span> <span class="o">*</span>
<span class="n">EHPMA000</span> <span class="n">APPL</span> <span class="n">AUTH</span><span class="o">=</span><span class="p">(</span><span class="n">ACQ</span><span class="p">,</span><span class="n">PASS</span><span class="p">),</span><span class="n">MODETAB</span><span class="o">=</span><span class="n">ISTINCLM</span><span class="p">,</span><span class="n">DLOGMOD</span><span class="o">=</span><span class="n">SNX32702</span><span class="p">,</span><span class="n">EAS</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
<p>Or for EHPMA00*</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>* ------------------------------------------------------------------ *
* LU Test : VTAM application relays with user data. *
* ------------------------------------------------------------------ *
EHPMA00? APPL AUTH=(ACQ,PASS),MODETAB=ISTINCLM,DLOGMOD=SNX32702,EAS=1
</pre></div>
</div>
<p><em>Example of VTAM APPL definitions</em></p>
<p>We also need a terminal and pool definition. Here is the pool definition:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TERMINAL</span> <span class="n">ID</span><span class="o">=</span><span class="n">EHPMA000</span><span class="p">,</span> <span class="o">-</span>
<span class="n">RELAY</span><span class="o">=</span><span class="n">EHPMA000</span><span class="p">,</span> <span class="o">/*</span> <span class="n">Or</span> <span class="n">EHPMA00</span><span class="o">*</span> <span class="o">*/</span> <span class="o">-</span>
<span class="n">POOL</span><span class="o">=*</span><span class="n">STAPOOL</span><span class="p">,</span> <span class="o">-</span>
<span class="n">DESC</span><span class="o">=</span><span class="s1">&#39;Terminal definition for EHPMA000&#39;</span><span class="p">,</span> <span class="o">-</span>
<span class="n">TYPE</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span>
<span class="n">COMPRESS</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span>
<span class="n">INOUT</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span>
<span class="n">STATS</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span> <span class="o">-</span>
<span class="n">REPEAT</span><span class="o">=</span>
</pre></div>
</div>
<p>and a pool definition for out static pool:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TERMINAL</span> <span class="n">ID</span><span class="o">=</span><span class="n">EHVTS000</span><span class="p">,</span> <span class="o">-</span>
<span class="n">RELAY</span><span class="o">=*</span><span class="n">STAPOOL</span><span class="p">,</span> <span class="o">-</span>
<span class="n">DESC</span><span class="o">=</span><span class="s1">&#39;Static definition pool&#39;</span><span class="p">,</span> <span class="o">-</span>
<span class="n">TYPE</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span>
<span class="n">COMPRESS</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span>
<span class="n">INOUT</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span>
<span class="n">STATS</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span> <span class="o">-</span>
<span class="n">REPEAT</span><span class="o">=</span><span class="mi">0010</span>
</pre></div>
</div>
<p>This setup will support up to 10 predefined terminal definitions. For each terminal we have to provide a static definition. Of course we could have used a generic terminal definition of EHPMA00* but this would only work for numerically sequenced terminal names – EHPMA000 – EHPMA009. Getting the PC workstation name to Virtel is through a batch job which fires up the default browser and passes the work station name as a user data parameter. Here is an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">title</span> <span class="n">Test</span> <span class="n">Propagation</span> <span class="n">of</span> <span class="n">Userdata</span> <span class="n">Parameter</span>
<span class="nd">@echo</span> <span class="n">on</span>
<span class="n">color</span> <span class="mi">1</span><span class="n">f</span>
<span class="bp">cls</span>
<span class="n">SET</span> <span class="n">P1</span><span class="o">=%</span><span class="n">COMPUTERNAME</span><span class="p">:</span><span class="o">~</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="o">%</span>
<span class="n">start</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">170.33</span><span class="p">:</span><span class="mi">41003</span><span class="o">/</span><span class="n">w2h</span><span class="o">/</span><span class="n">appmenu</span><span class="o">.</span><span class="n">htm</span><span class="o">+</span><span class="n">applist</span><span class="o">+%</span><span class="n">P1</span><span class="o">%</span> <span class="o">&amp;</span><span class="n">goto</span><span class="p">:</span><span class="n">eof</span>
<span class="p">:</span><span class="n">exit</span>
</pre></div>
</div>
<p><em>Example of a batch job to pass the work station name</em></p>
<p>The SET command takes the first six characters of the work station name and passes it into the start command. Following the Virtel transaction I wish to execute which in this case is an APPLIST menu list. The start command will open a default browser window and connect to Virtel:</p>
<p><img alt="image10" src="../../../_images/image1020.png" /></p>
<p>When a transaction is selected from the menu list the RULE will be invoked to allocate the correct LUNAME.</p>
<p><img alt="image11" src="../../../_images/image1128.png" /></p>
<p>The Virtel RULE has forced an LU name prefixed EHPMA00* to be used from the the VIRTEL terminal pool associated with the Virtel line. In this case relay LUNAME EHPMA000 has been allocated. In the VTAM display we can see that a session has been set up using that LU name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>D NET,ID=EHPMA000,E
IST097I DISPLAY ACCEPTED
IST075I NAME = SPNET.EHPMA000, TYPE = DYNAMIC APPL 073
IST486I STATUS= ACT/S, DESIRED STATE= ACTIV
IST1447I REGISTRATION TYPE = CDSERVR
IST1629I MODSRCH = NEVER
IST977I MDLTAB=***NA*** ASLTAB=***NA***
IST861I MODETAB=ISTINCLM USSTAB=***NA*** LOGTAB=***NA***
IST934I DLOGMOD=SNX32702 USS LANGTAB=***NA***
IST1632I VPACING = 7
IST1938I APPC = NO
IST597I CAPABILITY-PLU ENABLED ,SLU ENABLED ,SESSION LIMIT NONE
IST231I APPL MAJOR NODE = APPLSPEH
IST1425I DEFINED USING MODEL EHPMA???
IST654I I/O TRACE = OFF, BUFFER TRACE = OFF
IST1500I STATE TRACE = OFF
IST271I JOBNAME = SPVIREH, STEPNAME = SPVIREH, DSPNAME = IST217EE
IST228I ENCRYPTION = OPTIONAL , TYPE = DES
IST1563I CKEYNAME = EHPMA000 CKEY = PRIMARY CERTIFY = NO
IST1552I MAC = NONE MACTYPE = NONE
IST1050I MAXIMUM COMPRESSION LEVEL - INPUT = 0, OUTPUT = 0
IST1633I ASRCVLM = 1000000
IST1634I DATA SPACE USAGE: CURRENT = 0 MAXIMUM = 0
IST1669I IPADDR..PORT 192.168.92.65..50027
IST171I ACTIVE SESSIONS = 0000000001, SESSION REQUESTS = 0000000000
IST206I SESSIONS:
IST634I NAME STATUS SID SEND RECV VR TP NETID
IST635I TSO1A005 ACTIV-P CA7B8B52114E7A85 0000 0002 SPNET
IST314I END
</pre></div>
</div>
</div>
<div class="section" id="lu-nailing-using-an-lu-name-predefined-terminal">
<h3>LU nailing using an LU name (Predefined Terminal)<a class="headerlink" href="#lu-nailing-using-an-lu-name-predefined-terminal" title="Permalink to this headline">¶</a></h3>
<p>Instead of passing a work station name in the user data field of the URL in this example we are passing an LU name. Again with a Virtel RULE we can extract the user data parameter from the URL and use that as the Virtel relay LUNAME name. For this example the rule looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>RULE ID=ESH0001, -
RULESET=E-HTTP, -
STATUS=ACTIVE, -
DESC=&#39;Rule for terminal EHPMA00&#39;, -
ENTRY=EDSWHOST, -
PARAM=$URL$, -
NETMASK=255.255.255.255
</pre></div>
</div>
<p>We use the special PARAM=$URL$ which indicates that the VTAM LU Name to be used is the user data passed in the URL.</p>
<p><img alt="image28" src="../../../_images/image2811.png" /></p>
<p>The user data in the URL, in this case EHPMA00*, will be added to each transaction in the APPLIST menu and used as the Virtel relay LUNAME. When connecting to an application VIRTEL will use the LU name defined in the URL. In this example we are using a generic LUNAME (This could support a range from EHPMA000 through to EHPMA009</p>
</div>
<div class="section" id="lu-nailing-using-an-lu-name-no-predefined-terminal">
<h3>Lu Nailing using an LU Name (No predefined terminal)<a class="headerlink" href="#lu-nailing-using-an-lu-name-no-predefined-terminal" title="Permalink to this headline">¶</a></h3>
<p>Both of the above techniques require that a relay terminal be predefined for each terminal. For some installations this could be a maintenance headache and doesn’t scale up very well. Virtel provides a feature whereby predefined names are not necessary. In this next example we look at a technique that doesn’t require terminal predefinition. Virtel will
grab a terminal entry from a pool and use the LU name passed in the URL as the relay LU name. To use this set-up certain conditions must be in place. Also note that no rules are required. Those definitions required are:</p>
<ul class="simple">
<li><p>The HTTP Line must specify a pool name,</p></li>
<li><p>A pool name needs to be defined,</p></li>
<li><p>Transactions must specify $LINE$ in the “Pseudo-terminals” field.</p></li>
</ul>
<p>Line definition</p>
<p><img alt="image12" src="../../../_images/image1221.png" /></p>
<p><em>Pool definition for non-predefined LU Names</em></p>
<p><img alt="image13" src="../../../_images/image1319.png" /></p>
<p><em>Transaction definition</em></p>
<p><img alt="image14" src="../../../_images/image1418.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that the Pseudo-Terminal is defined as $LINE$. We have also assign a printer definition to this set-up. So if our LU relay name was HOLTWIN7 then our associated printer LU would be HOLTWINP.Accessing the transaction TSOF would be through the following URL forcing the relay LU NAME to HOLTWIN7. We would still have to define a terminal pool for DYNPOOL,but we avoid having to define individual terminal definitions, or ranges of, for every static terminals.</p>
</div>
<p><img alt="image15" src="../../../_images/image1514.png" /></p>
</div>
<div class="section" id="lu-nailing-using-a-cookie-correspondent-sub-application">
<h3>Lu Nailing using a cookie (Correspondent Sub Application)<a class="headerlink" href="#lu-nailing-using-a-cookie-correspondent-sub-application" title="Permalink to this headline">¶</a></h3>
<p>Virtel also can use cookies to select a relay LU name. Virtel uses a cookie as a part of the “Correspondence Sub Application’. Within the cookie sent to Virtel is a security token. This token is used to identify a user and their associated VTAM LU relay name. A Correspondent file is used to maintain the user details. The cookie can be sent to the use as part of an Email from which the User selects a link to access Virtel or it can be part of the ‘self-registration’ process. For further information see Virtel – How to Activate LU Nailing.</p>
</div>
<div class="section" id="lu-nailing-by-ip">
<h3>LU Nailing by IP<a class="headerlink" href="#lu-nailing-by-ip" title="Permalink to this headline">¶</a></h3>
<p>This technique uses a rule to associate an IP address with an LU Name. The rule is associated with a line. In the example below we define a rule on line W-HTTP which will force a terminal connecting with IP address 192.168.000.039 to use LU name RHTVT001. The LU name must be pre-defined in a Virtel terminal pool. Multiple terminals can be defined with a rule by using the * suffix. In the following example a range of IP address is mapped to a pool of LU names. Address range 192.168.100.0 through to 192.168.100.255 will be assigned the next unused LU name in the range RHTVT1xx. The new rule is named WHT00140, the “IP Subnet” field specifies the IP address 192.168.100.000, and the “Mask” is set to 255.255.255.000 to indicate that only the first three octets of the IP address are tested to determine whether the rule matches the IP address of the client browser. The “parameter” field specifies a generic LU name RHTVT1* which signifies that any LU whose name begins with RHTVT1 may be assigned to clients whose IP address matches this rule.</p>
<p><strong>Comparison Table</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 27%" />
<col style="width: 26%" />
<col style="width: 18%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>Rule defintion</p></th>
<th class="head"><p>Terminal Definition</p></th>
<th class="head"><p>Cookies Used</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Work Station Name in URL</p></td>
<td><p><strong>Yes. 1 per work station</strong></p></td>
<td><p><strong>Yes. Individual or Group</strong></p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>LUNAME in URL</p></td>
<td><p><strong>Yes. 1 per work station</strong></p></td>
<td><p><strong>Yes. Individual or Group</strong></p></td>
<td><p>No</p></td>
</tr>
<tr class="row-even"><td><p>Using Forced LU</p></td>
<td><p>No</p></td>
<td><p>Pool Only</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>Correspondant</p></td>
<td><p><strong>Yes</strong></p></td>
<td><p><strong>Yes</strong></p></td>
<td><p><strong>Yes</strong></p></td>
</tr>
<tr class="row-even"><td><p>By IP</p></td>
<td><p><strong>Yes</strong></p></td>
<td><p><strong>Yes</strong></p></td>
<td><p>No</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="transactions-applications">
<h2>Transactions &amp; Applications<a class="headerlink" href="#transactions-applications" title="Permalink to this headline">¶</a></h2>
<div class="section" id="virtel-multi-session-within-virtel-web-access">
<h3>Virtel Multi-session Within Virtel Web Access<a class="headerlink" href="#virtel-multi-session-within-virtel-web-access" title="Permalink to this headline">¶</a></h3>
<p>In some situations, it is necessary to allow a group of users to simultaneously access several distinct 3270 applications. This can be solved by using the “appmenu.htm” associated with the “applist” transaction, or by using the 3270 Multi-session function of Virtel. In the first situation, for a same original calling terminal, Virtel uses as many relays as VTAM open sessions, in the second configuration, a single relay is used for all sessions, Virtel ensuring the swapping between the opened session. To access the Multi-session function of Virtel, you must define a transaction whose application name is the same as the main Virtel ACB name. This transaction is accessible in the same way as any other VTAM application. As the first screen shown is a signature screen, the transaction does not necessarily need to be secured. The lists of applications presented to the user depends on the selected parameter setting (See the Virtel Multi-session documented section for further information on this subject). Use of the multi-session Virtel module, even in a VWA context, requires an appropriate license agreement.</p>
<p><img alt="image29" src="../../../_images/image298.png" /></p>
<p><em>Transaction definition for the Virtel Multi-session module</em></p>
</div>
<div class="section" id="how-to-access-a-host-application-directly">
<h3>How To Access A Host Application Directly<a class="headerlink" href="#how-to-access-a-host-application-directly" title="Permalink to this headline">¶</a></h3>
<p>It is not always necessary to pass via an application selection menu to connect to a host application. A host application may be accessed directly by opening the URL containing the complete path to the application. This URL may result in the display of the host signon screen, the first application screen, or possibly (if a script or scenario is used), a
subsequent screen sent by the application. For more information about how VIRTEL can be used to automate the process of connection to a host application, see Virtel URL formats in the Virtel Web Access Reference manual, and “Connection/Disconnection Scripts” in the VIRTEL Connectivity Reference manual.</p>
<div class="section" id="full-path-url">
<h4>Full path URL<a class="headerlink" href="#full-path-url" title="Permalink to this headline">¶</a></h4>
<p>For example, you can access the VIRTEL transaction whose external name is “Cics” by pointing the browser at a URL of the following format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">n</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">n</span><span class="p">:</span><span class="mi">41001</span><span class="o">/</span><span class="n">w2h</span><span class="o">/</span><span class="n">WEB2AJAX</span><span class="o">.</span><span class="n">htm</span><span class="o">+</span><span class="n">Cics</span>
</pre></div>
</div>
<p>At the end of the session with the host application, VIRTEL examines the “Last page” field (see previous section) to decide whether to return to the desktop or to redisplay the application selection menu.</p>
</div>
<div class="section" id="default-url-for-the-entry-point">
<h4>Default URL for the entry point<a class="headerlink" href="#default-url-for-the-entry-point" title="Permalink to this headline">¶</a></h4>
<p>An application URL may be coded in the “TIOA at logon” field of the default transaction for the entry point (the default transaction is the transaction whose external name is the same as the entry point name). This allows the user to go directly to the host application simply by entering a URL of the format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">n</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">n</span><span class="p">:</span><span class="mi">41001</span>
</pre></div>
</div>
<p>The example below shows the default transaction for the WEB2HOST entry point set up to go directly to the transaction whose external name is “Cics”:</p>
<p><img alt="image30" src="../../../_images/image307.png" /></p>
<p><em>Example of default URL</em></p>
<p>For more information see Virtel URL formats in the Virtel Web Access Users Guide.</p>
</div>
<div class="section" id="how-to-use-different-screen-sizes">
<h4>How To Use Different Screen Sizes<a class="headerlink" href="#how-to-use-different-screen-sizes" title="Permalink to this headline">¶</a></h4>
<p>Although the standard 3270 screen size is 24 rows by 80 columns, certain applications benefit from the use of terminals with larger screen sizes. The screen size is determined by the LOGMODE used for the session between VIRTEL and the host application. VTAM offers logmodes for the following standard screen sizes:</p>
<ul class="simple">
<li><p>model 2 : 24x80 (logmode SNX32702)</p></li>
<li><p>model 3 : 32x80 (logmode SNX32703)</p></li>
<li><p>model 4 : 43x80 (logmode SNX32704)</p></li>
<li><p>model 5 : 27x132 (logmode SNX32705)</p></li>
</ul>
<p>There are two different ways that the VIRTEL administrator can set up the configuration to allow the VIRTEL Web Access user to select the desired logmode:</p>
<ul class="simple">
<li><p>Define a separate VIRTEL transaction for each screen size, and allow the user to select the appropriate transaction.</p></li>
<li><p>Group the VTAM relay LUs into pools, each pool having a different logmode, and allow the user to select the pool by coding an appropriate parameter on the URL.</p></li>
</ul>
</div>
<div class="section" id="logmode-defined-by-the-transaction">
<h4>LOGMODE defined by the transaction<a class="headerlink" href="#logmode-defined-by-the-transaction" title="Permalink to this headline">¶</a></h4>
<p>With this method, the administrator defines multiple VIRTEL transactions for a single application, each transaction specifying a different logmode. For example, transactions Tso2 and Tso5 delivered in the sample configuration both define TSO as the target application, but specify different logmodes SNX32702 and SNX32705 respectively. The user selects the desired transaction from the applist menu displayed by the “Other applications” link in the VIRTEL Web Access menu.</p>
<p>The figure below shows the definition of the Tso5 transaction defined under the WEB2HOST entry point:</p>
<p><img alt="image31" src="../../../_images/image3117.png" /></p>
<p><em>Example of TSO transaction TSO specifying logmode SNX32705</em></p>
<p>The URL to access this transaction could be of the format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">n</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">n</span><span class="p">:</span><span class="mi">41001</span><span class="o">/</span><span class="n">w2h</span><span class="o">/</span><span class="n">WEB3270</span><span class="o">.</span><span class="n">htm</span><span class="o">+</span><span class="n">Tso5</span>
</pre></div>
</div>
</div>
<div class="section" id="assigning-a-logmode-by-url-parameter">
<h4>Assigning a LOGMODE by URL parameter<a class="headerlink" href="#assigning-a-logmode-by-url-parameter" title="Permalink to this headline">¶</a></h4>
<p>The URL which allows the browser to connect to a host application via VIRTEL may contain a parameter, such as “model5” as shown in this example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">n</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">n</span><span class="p">:</span><span class="mi">41001</span><span class="o">/</span><span class="n">w2h</span><span class="o">/</span><span class="n">WEB3270</span><span class="o">.</span><span class="n">htm</span><span class="o">+</span><span class="n">Tso</span><span class="o">+</span><span class="n">model5</span>
</pre></div>
</div>
<p>This form of a VIRTEL URL is described in the section “Dynamic URL with user data”, page 1. This form of URL is processed by VIRTEL with reference to the “rule set” associated with the HTTP line. VIRTEL looks for a rule whose “User Data” field matches the value of the parameter (model5). The “Parameter” field of the selected rule assigns a relay LU name from the pool defined with logmode SNX32705. The VTAM definition of the relay pool is shown in the example below. In this example, LU names in the range RHTVT5nn are defined to have the
model5 logmode SNX32705 :-</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>VIRTAPPL VBUILD TYPE=APPL
* ------------------------------------------------------------------ *
* RHTVTxxx : Relay for VTAM applications acceded by WEB to HOST *
* ------------------------------------------------------------------ *
* 3270 model 2 terminals
RHTVT0?? APPL AUTH=(ACQ,PASS),MODETAB=ISTINCLM,DLOGMOD=SNX32702,EAS=1
* 3270 model 5 terminals
RHTVT5?? APPL AUTH=(ACQ,PASS),MODETAB=ISTINCLM,DLOGMOD=SNX32705,EAS=1
VTAM definition of terminal groups
</pre></div>
</div>
<p>The screen below shows an example rule which assigns a relay LU from the range RHTVT5nn when the URL contains the parameter model5:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DETAIL</span> <span class="n">of</span> <span class="n">RULE</span> <span class="kn">from</span> <span class="nn">RULE</span> <span class="n">SET</span><span class="p">:</span> <span class="n">W</span><span class="o">-</span><span class="n">HTTP</span> <span class="o">-------------</span> <span class="n">Applid</span><span class="p">:</span> <span class="n">VIRTEL</span> <span class="mi">17</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">15</span>
<span class="n">Name</span> <span class="o">===&gt;</span> <span class="n">WHT00150</span>                      <span class="n">Rule</span> <span class="n">priority</span> <span class="ow">is</span> <span class="n">per</span> <span class="n">name</span>
<span class="n">Status</span> <span class="o">===&gt;</span> <span class="n">INACTIVE</span>                    <span class="n">Mon</span><span class="p">,</span> <span class="mi">24</span> <span class="n">Sep</span> <span class="mi">2001</span> <span class="mi">14</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">14</span>
<span class="n">Description</span> <span class="o">===&gt;</span> <span class="n">HTTP</span> <span class="n">access</span>    <span class="p">(</span><span class="k">with</span> <span class="n">model5</span> <span class="n">URL</span> <span class="n">parameter</span><span class="p">)</span>
<span class="n">Entry</span> <span class="n">point</span> <span class="o">===&gt;</span> <span class="n">WEB2HOST</span>               <span class="n">Target</span> <span class="n">Entry</span> <span class="n">Point</span>
<span class="n">Parameter</span> <span class="o">===&gt;</span> <span class="n">RHTVT5</span><span class="o">*</span>                  <span class="o">&amp;</span><span class="mi">1</span> <span class="n">value</span> <span class="ow">or</span> <span class="n">LUNAME</span>
<span class="n">Trace</span> <span class="o">===&gt;</span>                              <span class="mi">1</span><span class="o">=</span><span class="n">commands</span> <span class="mi">2</span><span class="o">=</span><span class="n">data</span> <span class="mi">3</span><span class="o">=</span><span class="n">partner</span>
<span class="n">C</span> <span class="p">:</span> <span class="mi">0</span><span class="o">=</span><span class="n">IGNORE</span> <span class="mi">1</span><span class="o">=</span><span class="n">IS</span> <span class="mi">2</span><span class="o">=</span><span class="n">IS</span> <span class="n">NOT</span> <span class="mi">3</span><span class="o">=</span><span class="n">STARTS</span> <span class="n">WITH</span> <span class="mi">4</span><span class="o">=</span><span class="n">DOES</span> <span class="n">NOT</span> <span class="mi">5</span><span class="o">=</span><span class="n">ENDS</span> <span class="n">WITH</span> <span class="mi">6</span><span class="o">=</span><span class="n">DOES</span> <span class="n">NOT</span>
<span class="mi">0</span> <span class="n">IP</span> <span class="n">Subnet</span> <span class="o">===&gt;</span> <span class="n">Mask</span> <span class="o">===&gt;</span>
<span class="mi">0</span> <span class="n">Host</span> <span class="o">===&gt;</span>
<span class="mi">0</span> <span class="n">eMail</span> <span class="o">===&gt;</span>
<span class="mi">0</span> <span class="n">Calling</span> <span class="n">DTE</span> <span class="o">===&gt;</span>                      <span class="n">Calling</span> <span class="n">DTE</span> <span class="n">address</span> <span class="ow">or</span> <span class="n">proxy</span>
<span class="mi">0</span> <span class="n">Called</span> <span class="o">===&gt;</span>                           <span class="n">Called</span> <span class="n">DTE</span> <span class="n">address</span>
<span class="mi">0</span> <span class="n">CUD0</span> <span class="p">(</span><span class="n">Hex</span><span class="p">)</span> <span class="o">===&gt;</span>                       <span class="n">First</span> <span class="mi">4</span> <span class="nb">bytes</span> <span class="n">of</span> <span class="n">CUD</span> <span class="p">(</span><span class="n">X25</span> <span class="n">protocol</span><span class="p">)</span>
<span class="mi">1</span> <span class="n">User</span> <span class="n">Data</span> <span class="o">===&gt;</span> <span class="n">model5</span>
<span class="mi">0</span> <span class="n">Days</span>       <span class="o">===&gt;</span> <span class="n">M</span><span class="p">:</span>  <span class="n">T</span><span class="p">:</span>  <span class="n">W</span><span class="p">:</span>  <span class="n">T</span><span class="p">:</span>  <span class="n">F</span><span class="p">:</span>  <span class="n">S</span><span class="p">:</span>  <span class="n">S</span><span class="p">:</span>
<span class="mi">0</span> <span class="n">Start</span> <span class="n">time</span> <span class="o">===&gt;</span> <span class="n">H</span><span class="p">:</span>  <span class="n">M</span><span class="p">:</span>  <span class="n">S</span><span class="p">:</span> <span class="n">End</span> <span class="n">time</span> <span class="o">===&gt;</span> <span class="n">H</span><span class="p">:</span>   <span class="n">M</span><span class="p">:</span>  <span class="n">S</span><span class="p">:</span>

<span class="n">P1</span><span class="o">=</span><span class="n">Update</span>                           <span class="n">P3</span><span class="o">=</span><span class="n">Return</span>                       <span class="n">Enter</span><span class="o">=</span><span class="n">Add</span>
<span class="n">P4</span><span class="o">=</span><span class="n">Activate</span>                         <span class="n">P5</span><span class="o">=</span><span class="n">Inactivate</span>                   <span class="n">P12</span><span class="o">=</span><span class="n">Entry</span> <span class="n">P</span><span class="o">.</span>
</pre></div>
</div>
<p><em>Example rule for selection of logmode by URL</em></p>
<p>The LU name (RHTVT5nn) assigned by the rule must belong to the LU pool shared assigned to the HTTP line, as shown
in the example below :-</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>TERMINAL DETAIL DEFINITION ------------------------- Applid: VIRTEL 13:32:28
Terminal ===&gt; W2HTP500      ?wxyZZZZ for dynamic allocation
                            w : Sna or Non-sna or * (category)
                            x : 1, 2, 3, 4, 5 or * (model)
                            y : Colour, Monochrome or *
                            Z : any characters
Relay ===&gt; RHTVT500         Name seen by VTAM applications
                            = : copied from the terminal name
*Pool name ===&gt; *W2HPOOL    Pool where to put this terminal
Description ===&gt; Relay pool for HTTP (3270 model 5)

Entry Point ===&gt;            Enforced Entry Point
2nd relay ===&gt; RHTIM500     Possible 2nd relay (Printer)
Terminal type ===&gt; 3        1=LU1 2=3270 3=FC P=Printer S=Scs
Compression ===&gt; 2          0, 1, 2 or 3 : compression type
Possible Calls ===&gt; 3       0=None 1=Inbound 2=Outbound 3=Both
Write Stats to ===&gt; 12      1,4=VIRSTAT 2=VIRLOG

Repeat ===&gt; 0020            Number of generated terminals

P1=Update               P3=Return                           Enter=Add
                                                            P12=Server
</pre></div>
</div>
<p><em>Definition of model 5 terminals in the W2HPOOL pool</em></p>
</div>
<div class="section" id="user-specified-logmode">
<h4>User-specified LOGMODE<a class="headerlink" href="#user-specified-logmode" title="Permalink to this headline">¶</a></h4>
<p>When the entry point definition specifies SCENLOGM in the “Identification scenario” field, the user may override the default logmode by appending an additional parameter LOGMODE=modename to the URL, as shown in this example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://n.n.n.n:41001/w2h/WEB3270.htm+Tso?logmode=SNX32705
</pre></div>
</div>
<p>The source code for the SCENLOGM scenario is supplied in the VIRTEL SAMPLIB.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To activate this functionality, SCENLOGM must be specified in the “Identification scenario” field of the ENTRY POINT (not the transaction definition).</p>
</div>
</div>
<div class="section" id="dynamic-logmode-with-user-specified-screen-size">
<h4>Dynamic logmode with user-specified screen size<a class="headerlink" href="#dynamic-logmode-with-user-specified-screen-size" title="Permalink to this headline">¶</a></h4>
<p>VIRTEL Web Access also supports the use of “dynamic” logmodes, such as D4A32XX3, which allow the user to specify a non-standard alternate screen size. When the entry point definition specifies SCENLOGM in the “Identification scenario” field, the user may also append ROWS and COLS parameters to the URL, as shown in this example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://n.n.n.n:41001/w2h/WEB3270.htm+Tso?logmode=D4A32XX3&amp;rows=54&amp;cols=132
</pre></div>
</div>
<p>VIRTEL allows a maximum screen size of 62 rows by 160 columns. The host application must also support the use of non-standard screen sizes.</p>
</div>
<div class="section" id="session-management-in-the-application-menu-list">
<h4>Session Management In The Application Menu List<a class="headerlink" href="#session-management-in-the-application-menu-list" title="Permalink to this headline">¶</a></h4>
<p>When the user connects to the “Application Selection Menu” described ine the “Virtel Web Access User Guide”, by default, clicking on an available application will open the session in the current tab replacing the APPMENU application list. You may want to operate differently.</p>
</div>
<div class="section" id="open-session-in-separate-tab">
<h4>Open session in separate tab<a class="headerlink" href="#open-session-in-separate-tab" title="Permalink to this headline">¶</a></h4>
<p>To open each session in separate tabs and keep the application menu available, add the following code in a “custom.js” file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span> <span class="n">To</span> <span class="nb">open</span> <span class="n">an</span> <span class="n">application</span> <span class="p">(</span><span class="n">issued</span> <span class="kn">from</span> <span class="nn">applist</span> <span class="n">transaction</span><span class="p">)</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">new</span> <span class="n">TAB</span> <span class="n">instead</span> <span class="n">of</span> <span class="n">the</span> <span class="n">same</span> <span class="n">window</span> <span class="o">*/</span>
<span class="n">function</span> <span class="n">before_launchApplink</span><span class="p">(</span><span class="n">href</span><span class="p">)</span> <span class="p">{</span>
<span class="k">return</span> <span class="p">{</span>
    <span class="n">url</span><span class="p">:</span> <span class="n">href</span><span class="p">,</span> <span class="o">//</span> <span class="n">Return</span> <span class="n">received</span> <span class="n">URL</span>
    <span class="n">target</span><span class="p">:</span> <span class="s1">&#39;_blank&#39;</span> <span class="o">//</span> <span class="n">Target</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">new</span> <span class="n">TAB</span>
    <span class="p">};</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>Example of Javascript code to open different sessions in separate tabs</em></p>
<div class="section" id="restrictions">
<h5>Restrictions<a class="headerlink" href="#restrictions" title="Permalink to this headline">¶</a></h5>
<p>Opening simultaneous sessions in different tabs imposes certain restrictions:</p>
<ul class="simple">
<li><p>Browsers deliberately limit the opening of multiple simultaneous HTTP sessions on the same domain. This number varies depending on the browser itself and the version used. A detailed census is available on the BrowserScope website.</p></li>
<li><p>Each new session gives rise to the opening of a specific IP socket, and therefore the use of a separate relay terminal for each session. The LU Nailing is therefore not always possible or easy to implement in such situation.</p></li>
</ul>
</div>
</div>
</div>
<div class="section" id="how-to-handle-host-session-termination">
<h3>How To Handle Host Session Termination<a class="headerlink" href="#how-to-handle-host-session-termination" title="Permalink to this headline">¶</a></h3>
<p>When the user terminates the application session by pressing the “Disconnect” button in the browser, various options are available: -</p>
<ul class="simple">
<li><p>Return to the application selection menu</p></li>
<li><p>Display a specific HTML page</p></li>
<li><p>Close the browser window and return to the desktop</p></li>
</ul>
<p>Remember that it is always best to exit cleanly from the host application by pressing the “Disconnect” button, rather than closing the browser window. If the browser window is closed abruptly, the host session resources may not be freed until the expiry of the time-out period specified in the entry point definition.</p>
<div class="section" id="return-to-the-application-selection-menu">
<h4>Return to the application selection menu<a class="headerlink" href="#return-to-the-application-selection-menu" title="Permalink to this headline">¶</a></h4>
<p>When a “Disconnect” request is received, VIRTEL returns to the root URL and displays the default page for the line, which will normally be an application selection menu. For detailed information, see “Virtel URL formats”, page 1. The user can then choose to connect to the same or a different application by clicking on the appropriate link in the
application selection menu.</p>
</div>
<div class="section" id="displaying-a-specific-page-on-disconnection">
<h4>Displaying a specific page on disconnection<a class="headerlink" href="#displaying-a-specific-page-on-disconnection" title="Permalink to this headline">¶</a></h4>
<p>Those sites wishing to display a specific page at the end of a session may use the “Last page” field in the definition of the entry point associated with the HTTP line or the entry point selected by the rules of the line. The “Last page” field indicates the name of the page to be displayed following disconnection from the host application. The indicated file
must be uploaded to the same directory as specified in the URL for the host application (for example W2H-DIR if the URL specifies /w2h/WEB3270.htm). The “Last page” may contain instructions to the user and may include system information provided by VIRTEL (such as the application and terminal name, date and time, etc.)</p>
</div>
<div class="section" id="closing-the-browser-window-automatically">
<h4>Closing the browser window automatically<a class="headerlink" href="#closing-the-browser-window-automatically" title="Permalink to this headline">¶</a></h4>
<p>Sites who wish to close the browser window and return to the desktop when the user disconnects from the host application may specify close.htm in the “Last page” field of the entry point definition. This page contains JavaScript code which will attempt to close the current browser window. Depending on the browser version and security settings, the window may close, a prompt may be issued, or the window may remain open. The close.htm page is delivered as standard in the W2H-DIR directory but may be copied to another directory if required.
The figure below shows an example of an entry point definition with close.htm specified as the “Last page”:</p>
<p><img alt="image32" src="../../../_images/image3215.png" /></p>
<p><em>Example of entry point with last page</em></p>
</div>
</div>
</div>
<div class="section" id="macros">
<h2>Macros<a class="headerlink" href="#macros" title="Permalink to this headline">¶</a></h2>
<div class="section" id="introduction">
<h3>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h3>
<p>Virtel macros capture keystroke operations which can subsequently be used to automate 3270 functions. These user captured macros are stored within a file called MACROS.JSON. This file is a JavaScript array of JSON objects, with each object representing a user macro. Here is an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;macros&quot;</span><span class="p">:[</span>
    <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;mylogon&quot;</span><span class="p">,</span><span class="s2">&quot;rev&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;def&quot;</span><span class="p">:[</span>
            <span class="p">{</span><span class="s2">&quot;txt&quot;</span><span class="p">:</span><span class="s2">&quot;sptholt&quot;</span><span class="p">},</span><span class="s2">&quot;ENTER&quot;</span><span class="p">,</span>
            <span class="p">{</span><span class="s2">&quot;txt&quot;</span><span class="p">:</span><span class="s2">&quot;myPassword&quot;</span><span class="p">},</span><span class="s2">&quot;ENTER&quot;</span><span class="p">,</span><span class="s2">&quot;ENTER&quot;</span><span class="p">,</span><span class="s2">&quot;ENTER&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;mapping&quot;</span><span class="p">:{</span><span class="s2">&quot;key&quot;</span><span class="p">:</span><span class="s2">&quot;ctrl&quot;</span><span class="p">,</span><span class="s2">&quot;keycode&quot;</span><span class="p">:</span><span class="mi">76</span><span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;logoff&quot;</span><span class="p">,</span><span class="s2">&quot;rev&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;def&quot;</span><span class="p">:[</span>
        <span class="p">{</span><span class="s2">&quot;txt&quot;</span><span class="p">:</span><span class="s2">&quot;=x&quot;</span><span class="p">},</span><span class="s2">&quot;ENTER&quot;</span><span class="p">,</span>
        <span class="p">{</span><span class="s2">&quot;txt&quot;</span><span class="p">:</span><span class="s2">&quot;logoff&quot;</span><span class="p">},</span><span class="s2">&quot;ENTER&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;mapping&quot;</span><span class="p">:{</span><span class="s2">&quot;key&quot;</span><span class="p">:</span><span class="s2">&quot;ctrl&quot;</span><span class="p">,</span><span class="s2">&quot;keycode&quot;</span><span class="p">:</span><span class="mi">79</span><span class="p">}</span>
        <span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;logon&quot;</span><span class="p">,</span><span class="s2">&quot;rev&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;def&quot;</span><span class="p">:[</span>
        <span class="s2">&quot;Tab&quot;</span><span class="p">,</span><span class="s2">&quot;Down&quot;</span><span class="p">,</span>
        <span class="p">{</span><span class="s2">&quot;txt&quot;</span><span class="p">:</span><span class="s2">&quot;sptholx&quot;</span><span class="p">},</span><span class="s2">&quot;ENTER&quot;</span><span class="p">,</span>
        <span class="p">{</span><span class="s2">&quot;txt&quot;</span><span class="p">:</span><span class="s2">&quot;password&quot;</span><span class="p">},</span><span class="s2">&quot;ENTER&quot;</span><span class="p">,</span><span class="s2">&quot;ENTER&quot;</span><span class="p">,</span><span class="s2">&quot;ENTER&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;mapping&quot;</span><span class="p">:{</span><span class="s2">&quot;key&quot;</span><span class="p">:</span><span class="s2">&quot;alt&quot;</span><span class="p">,</span><span class="s2">&quot;keycode&quot;</span><span class="p">:</span><span class="mi">76</span><span class="p">}</span>
        <span class="p">}</span>
<span class="p">],</span><span class="s2">&quot;fmt&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="macro-modes">
<h3>Macro modes<a class="headerlink" href="#macro-modes" title="Permalink to this headline">¶</a></h3>
<div class="section" id="local-mode">
<h4>Local mode<a class="headerlink" href="#local-mode" title="Permalink to this headline">¶</a></h4>
<p>All user macros are objects within a file called MACROS.JSON and with suitable knowledge this file can be maintained locally, known as local mode. The MACROS.JSON file is maintained through either the local macro interface, as launched by the user from the Virtel toolbar, or can be imported from a flat file where the MACROS.JSON file can be edited outside of these interfaces but this is not recommended unless you understand the macro structure and are familiar with JavaScript. By default Virtel maintains macros in local mode with the contents of the MACROS.JSON file being stored in the browsers local storage.</p>
<div class="section" id="user-interface">
<h5>User Interface<a class="headerlink" href="#user-interface" title="Permalink to this headline">¶</a></h5>
<p><strong>Macro functions</strong></p>
<p>You can capture and list macros by using the two macro ICON functions displayed in the Virtel tool bar. These are the red record/stop button and the green triangular play/display button. Green indicates local mode and will display the macros held in local storage.</p>
<p><img alt="image34" src="../../../_images/image345.png" /></p>
<p><em>The local storage record and play/display macro buttons</em></p>
<p>The record function is an on/off button that will record key strokes. When recording, the ICON will flash until it is clicked at which point it will stop recording and save the key strokes. A save panel will be displayed asking for the name of the macro entry. Note that an ENTER/PFK key must be pressed at least once, i.e. data must be sent by some key operation in order to create and save an entry within the macro.JSON file.</p>
<p><img alt="image35" src="../../../_images/image355.png" /></p>
<p><em>Creating a new macro</em></p>
<p><strong>Keyboard mapping</strong></p>
<p>When saving the macro you have the option of assigning a “hot key” or shortcut to the macro through keyboard mapping. Keyboard mapping can be a combination of ALT or CTRL keys and another keyboard key (F1 thru F12, A thru to Z, 1 thru 9). Beware that some keyboard combinations may be reserved for the operating system or Virtel functions. For example, CTRL-R is a browser refresh option. Allocating this combination as a hotkey will only invoke the refresh option and not the Virtel macro. Keyboard mapping is a feature that is turned on through a parameter in the w2hparm.js file. By default, keyboard mapping is set to false. To turn on keyboard mapping specify the following in the w2hparm.js member:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">w2hparm</span><span class="o">.</span><span class="n">keymapping</span><span class="o">=</span><span class="n">true</span>
</pre></div>
</div>
<p>With keyboard mapping enabled the macro interface will display the associated key mapping against the macro.</p>
<p><img alt="image36" src="../../../_images/image365.png" /></p>
<p><em>Saving a macro with keyboard mapping</em></p>
<p><strong>Settings for macros</strong></p>
<p>Although local macros will work “out of the box” most users would probably want to have the key mapping option set. To use this function the global options parameters must be customized to add the w2hparm.keymapping=true to the w2hparm options file. The following instructions can be used as an example as to how to set up global w2hparm customization for the CLI port 41002. Create the following two JavaScript members and upload them to the CLI-DIR directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="n">w2hparm</span> <span class="o">=</span> <span class="p">{</span>
<span class="s2">&quot;global-settings&quot;</span><span class="p">:{</span>
<span class="s2">&quot;pathToW2hparm&quot;</span><span class="p">:</span><span class="s2">&quot;../option/w2hparm.global.js&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
<p><em>w2hparm.js</em></p>
<dl class="simple">
<dt>::</dt><dd><p>w2hparm.keymapping=true;</p>
</dd>
</dl>
<p><em>w2hparm.global.js</em></p>
<p>These setup will use the customized w2hparms for CLI from the member w2hparms.global.js. The keymapping property has been set to true.</p>
<p><strong>The Display Play/Display Button</strong></p>
<p>The green triangular button will display the local storage macros. From here a context menu can be opened against each macro using the mouse right click. This will provide delete, edit, save as and run functions.</p>
<p><img alt="image37" src="../../../_images/image375.png" /></p>
<p><em>Displaying the local macros</em></p>
<p><strong>Export and Import Options</strong></p>
<p>Macros can be exported or imported using the Export and Import buttons. On export, the MACROS.JSON file will be created. If you plan to migrate to using the DDI option you will need to export the macros and then upload the relevant MACROS.JSON file through the DDI interface.</p>
</div>
</div>
<div class="section" id="centralised-macros-ddi-mode">
<h4>Centralised Macros - DDI mode<a class="headerlink" href="#centralised-macros-ddi-mode" title="Permalink to this headline">¶</a></h4>
<p>The MACROS.JSON file can be automatically downloaded from a centralized repository on the host through the Virtel Dynamic Directory Interface (DDI). This is known as remote or DDI mode. The browser’s local storage is synchronized, via a date stamp, with the centralized VSAM repository. Management of the centralised repository is through the DDI GUI interface accessed and managed by the Virtel Administrator within the Administration Portal, normally located via port 41001. In DDI mode the macro definitions are initially initialized through an imported MACROS.JSON file. The actual centralized repository normally resides within the HTMLTRSF VSAM file made up of user, group and global directories.</p>
<p>The advantage of maintaining macros in a central repository is that the administrator has control over the business logic defined by the macros and can also control who has access to them through Group, Global and User profiles. As part of their Virtel interface a user can now only access site controlled macros. Each user has access to three distinct levels of a macro - User, Group and global. A user’s user and group level are assigned based upon their corresponding security subsystem security profiles whereas all macros are available at the global level. A user can maintain macros at their user level.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To use centralized DDI mode users have a userid and group defined within a security subsystem such as RACF.</p>
</div>
<div class="section" id="implementation">
<h5>Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h5>
<p>To use Centralised Macros users and Administrators must have “READ” access to the relevant DDI security resources. All transactions that use DDI must be defined with at least Security=1 (Basic Security) in order that the security context can be established for the user.  Stop Virtel and run the following JCL to create these resources:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">STEP0</span>   <span class="n">EXEC</span> <span class="n">PGM</span><span class="o">=</span><span class="n">IKJEFT01</span><span class="p">,</span><span class="n">DYNAMNBR</span><span class="o">=</span><span class="mi">20</span> <span class="n">COND</span><span class="o">=</span><span class="n">ONLY</span>
<span class="o">//</span><span class="n">SYSTSPRT</span> <span class="n">DD</span>  <span class="n">SYSOUT</span><span class="o">=*</span>
<span class="o">//</span><span class="n">SYSTSIN</span>  <span class="n">DD</span>  <span class="o">*</span>
<span class="o">/*-------------------------------------------------------*/</span>
<span class="o">/*</span> <span class="n">Directory</span> <span class="n">Access</span>                                      <span class="o">*/</span>
<span class="o">/*-------------------------------------------------------*/</span>
<span class="n">RDEF</span> <span class="n">FACILITY</span> <span class="n">SPVIREH</span><span class="o">.</span><span class="n">GLB</span><span class="o">-</span><span class="n">DIR</span> <span class="n">UACC</span><span class="p">(</span><span class="n">NONE</span><span class="p">)</span> <span class="o">/*</span> <span class="n">Global</span> <span class="n">Dir</span><span class="o">.</span> <span class="o">*/</span>
<span class="n">PE</span> <span class="n">SPVIREH</span><span class="o">.</span><span class="n">GLB</span><span class="o">-</span><span class="n">DIR</span> <span class="n">CL</span><span class="p">(</span><span class="n">FACILITY</span><span class="p">)</span> <span class="n">RESET</span>
<span class="n">PE</span> <span class="n">SPVIREH</span><span class="o">.</span><span class="n">GLB</span><span class="o">-</span><span class="n">DIR</span> <span class="n">CL</span><span class="p">(</span><span class="n">FACILITY</span><span class="p">)</span> <span class="n">ACC</span><span class="p">(</span><span class="n">READ</span><span class="p">)</span> <span class="n">ID</span><span class="p">(</span><span class="n">SPGPTECH</span><span class="p">)</span>
<span class="n">RDEF</span> <span class="n">FACILITY</span> <span class="n">SPVIREH</span><span class="o">.</span><span class="n">GRP</span><span class="o">-</span><span class="n">DIR</span> <span class="n">UACC</span><span class="p">(</span><span class="n">NONE</span><span class="p">)</span> <span class="o">/*</span> <span class="n">Group</span> <span class="n">Dir</span><span class="o">.</span>  <span class="o">*/</span>
<span class="n">PE</span> <span class="n">SPVIREH</span><span class="o">.</span><span class="n">GRP</span><span class="o">-</span><span class="n">DIR</span> <span class="n">CL</span><span class="p">(</span><span class="n">FACILITY</span><span class="p">)</span> <span class="n">RESET</span>
<span class="n">PE</span> <span class="n">SPVIREH</span><span class="o">.</span><span class="n">GRP</span><span class="o">-</span><span class="n">DIR</span> <span class="n">CL</span><span class="p">(</span><span class="n">FACILITY</span><span class="p">)</span> <span class="n">ACC</span><span class="p">(</span><span class="n">READ</span><span class="p">)</span> <span class="n">ID</span><span class="p">(</span><span class="n">SPGPTECH</span><span class="p">)</span>
<span class="n">RDEF</span> <span class="n">FACILITY</span> <span class="n">SPVIREH</span><span class="o">.</span><span class="n">USR</span><span class="o">-</span><span class="n">DIR</span> <span class="n">UACC</span><span class="p">(</span><span class="n">NONE</span><span class="p">)</span> <span class="o">/*</span> <span class="n">Global</span> <span class="n">Dir</span><span class="o">.</span> <span class="o">*/</span>
<span class="n">PE</span> <span class="n">SPVIREH</span><span class="o">.</span><span class="n">USR</span><span class="o">-</span><span class="n">DIR</span> <span class="n">CL</span><span class="p">(</span><span class="n">FACILITY</span><span class="p">)</span> <span class="n">RESET</span>
<span class="n">PE</span> <span class="n">SPVIREH</span><span class="o">.</span><span class="n">USR</span><span class="o">-</span><span class="n">DIR</span> <span class="n">CL</span><span class="p">(</span><span class="n">FACILITY</span><span class="p">)</span> <span class="n">ACC</span><span class="p">(</span><span class="n">READ</span><span class="p">)</span> <span class="n">ID</span><span class="p">(</span><span class="n">SPGPTECH</span><span class="p">)</span>
<span class="o">/*-------------------------------------------------------*/</span>
<span class="o">/*</span> <span class="n">DDI</span> <span class="o">/</span> <span class="n">Capability</span>                                      <span class="o">*/</span>
<span class="o">/*-------------------------------------------------------*/</span>
<span class="n">RDEF</span> <span class="n">FACILITY</span> <span class="n">SPVIREH</span><span class="o">.</span><span class="n">W2H</span><span class="o">-</span><span class="mi">07</span>  <span class="n">UACC</span><span class="p">(</span><span class="n">NONE</span><span class="p">)</span>  <span class="o">/*</span> <span class="n">DDI</span>         <span class="o">*/</span>
<span class="n">PE</span> <span class="n">SPVIREH</span><span class="o">.</span><span class="n">W2H</span><span class="o">-</span><span class="mi">07</span> <span class="n">CL</span><span class="p">(</span><span class="n">FACILITY</span><span class="p">)</span> <span class="n">RESET</span>
<span class="n">PE</span> <span class="n">SPVIREH</span><span class="o">.</span><span class="n">W2H</span><span class="o">-</span><span class="mi">07</span> <span class="n">CL</span><span class="p">(</span><span class="n">FACILITY</span><span class="p">)</span> <span class="n">ACC</span><span class="p">(</span><span class="n">READ</span><span class="p">)</span> <span class="n">ID</span><span class="p">(</span><span class="n">SPGPTECH</span><span class="p">)</span>
<span class="n">RDEF</span> <span class="n">FACILITY</span> <span class="n">SPVIREH</span><span class="o">.</span><span class="n">W2H</span><span class="o">-</span><span class="mi">66</span>  <span class="n">UACC</span><span class="p">(</span><span class="n">NONE</span><span class="p">)</span>  <span class="o">/*</span> <span class="n">DDI</span>         <span class="o">*/</span>
<span class="n">PE</span> <span class="n">SPVIREH</span><span class="o">.</span><span class="n">W2H</span><span class="o">-</span><span class="mi">66</span> <span class="n">CL</span><span class="p">(</span><span class="n">FACILITY</span><span class="p">)</span> <span class="n">RESET</span>
<span class="n">PE</span> <span class="n">SPVIREH</span><span class="o">.</span><span class="n">W2H</span><span class="o">-</span><span class="mi">66</span> <span class="n">CL</span><span class="p">(</span><span class="n">FACILITY</span><span class="p">)</span> <span class="n">ACC</span><span class="p">(</span><span class="n">READ</span><span class="p">)</span> <span class="n">ID</span><span class="p">(</span><span class="n">SPGPTECH</span><span class="p">)</span>
<span class="o">/*-------------------------------------------------------*/</span>
<span class="o">/*</span> <span class="n">Administrators</span> <span class="n">Upload</span>                                 <span class="o">*/</span>
<span class="o">/*-------------------------------------------------------*/</span>
<span class="n">RDEF</span> <span class="n">FACILITY</span> <span class="n">SPVIREH</span><span class="o">.</span><span class="n">W2H</span><span class="o">-</span><span class="mi">80</span><span class="n">A</span> <span class="n">UACC</span><span class="p">(</span><span class="n">NONE</span><span class="p">)</span> <span class="o">/*</span> <span class="n">Global</span> <span class="n">Dir</span><span class="o">.</span> <span class="o">*/</span>
<span class="n">PE</span> <span class="n">SPVIREH</span><span class="o">.</span><span class="n">W2H</span><span class="o">-</span><span class="mi">80</span><span class="n">A</span> <span class="n">CL</span><span class="p">(</span><span class="n">FACILITY</span><span class="p">)</span> <span class="n">RESET</span>
<span class="n">PE</span> <span class="n">SPVIREH</span><span class="o">.</span><span class="n">W2H</span><span class="o">-</span><span class="mi">80</span><span class="n">A</span> <span class="n">CL</span><span class="p">(</span><span class="n">FACILITY</span><span class="p">)</span> <span class="n">ACC</span><span class="p">(</span><span class="n">READ</span><span class="p">)</span> <span class="n">ID</span><span class="p">(</span><span class="n">SPGPTECH</span><span class="p">)</span>
<span class="n">RDEF</span> <span class="n">FACILITY</span> <span class="n">SPVIREH</span><span class="o">.</span><span class="n">W2H</span><span class="o">-</span><span class="mi">80</span><span class="n">G</span> <span class="n">UACC</span><span class="p">(</span><span class="n">NONE</span><span class="p">)</span> <span class="o">/*</span> <span class="n">Global</span> <span class="n">Dir</span><span class="o">.</span> <span class="o">*/</span>
<span class="n">PE</span> <span class="n">SPVIREH</span><span class="o">.</span><span class="n">W2H</span><span class="o">-</span><span class="mi">80</span><span class="n">G</span> <span class="n">CL</span><span class="p">(</span><span class="n">FACILITY</span><span class="p">)</span> <span class="n">RESET</span>
<span class="n">PE</span> <span class="n">SPVIREH</span><span class="o">.</span><span class="n">W2H</span><span class="o">-</span><span class="mi">80</span><span class="n">G</span> <span class="n">CL</span><span class="p">(</span><span class="n">FACILITY</span><span class="p">)</span> <span class="n">ACC</span><span class="p">(</span><span class="n">READ</span><span class="p">)</span> <span class="n">ID</span><span class="p">(</span><span class="n">SPGPTECH</span><span class="p">)</span>
<span class="n">RDEF</span> <span class="n">FACILITY</span> <span class="n">SPVIREH</span><span class="o">.</span><span class="n">W2H</span><span class="o">-</span><span class="mi">80</span><span class="n">U</span> <span class="n">UACC</span><span class="p">(</span><span class="n">NONE</span><span class="p">)</span> <span class="o">/*</span> <span class="n">Global</span> <span class="n">Dir</span><span class="o">.</span> <span class="o">*/</span>
<span class="n">PE</span> <span class="n">SPVIREH</span><span class="o">.</span><span class="n">W2H</span><span class="o">-</span><span class="mi">80</span><span class="n">U</span> <span class="n">CL</span><span class="p">(</span><span class="n">FACILITY</span><span class="p">)</span> <span class="n">RESET</span>
<span class="n">PE</span> <span class="n">SPVIREH</span><span class="o">.</span><span class="n">W2H</span><span class="o">-</span><span class="mi">80</span><span class="n">U</span> <span class="n">CL</span><span class="p">(</span><span class="n">FACILITY</span><span class="p">)</span> <span class="n">ACC</span><span class="p">(</span><span class="n">READ</span><span class="p">)</span> <span class="n">ID</span><span class="p">(</span><span class="n">SPGPTECH</span><span class="p">)</span>
</pre></div>
</div>
<p><em>Security Resources required for DDI</em></p>
<p>Additional Virtel transactions and directories are required to support DDI. These can be implemented by running the ARBOLOAD job, located in the Virtel CNTL library, with VMACROS=YES. After executing this job start Virtel and access the Drag and Drop GUI from the Administration Portal on 41001. You should now see additional GRP-DIR, GLB-DIR and USR-DIR directories.</p>
<p><img alt="image38" src="../../../_images/image388.png" /></p>
<p><em>DDI Directories</em></p>
<p>Once the DDI directories are set up will can configure the necessary settings to invoke DDI. A w2hParm.global.js object is uploaded to the CLI_DIR and will contain the the DDI settings. We also need to ensure that our global-settings object is defined in the wh2parm.js member. The w2hparm.js in CLI-DIR looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">NOTE</span><span class="p">:</span> <span class="n">this</span> <span class="n">file</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">sample</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">replaced</span> <span class="n">after</span> <span class="n">a</span> <span class="n">new</span> <span class="n">install</span><span class="o">.</span>
<span class="o">//</span> <span class="n">please</span> <span class="n">see</span> <span class="n">the</span> <span class="n">documentation</span> <span class="n">on</span> <span class="n">possible</span> <span class="n">parameter</span> <span class="n">values</span>
<span class="o">//</span> <span class="ow">and</span> <span class="n">on</span> <span class="n">how</span> <span class="n">to</span> <span class="nb">set</span> <span class="n">this</span> <span class="n">file</span> <span class="n">up</span> <span class="ow">in</span> <span class="n">CLI</span><span class="o">-</span><span class="n">DIR</span> <span class="n">instead</span> <span class="n">of</span> <span class="n">W2H</span><span class="o">-</span><span class="n">DIR</span>
<span class="o">//</span>
<span class="o">//</span><span class="n">var</span> <span class="n">w2hparm</span> <span class="o">=</span> <span class="p">{};</span>
<span class="n">var</span> <span class="n">w2hparm</span> <span class="o">=</span> <span class="p">{</span>
     <span class="s2">&quot;global-settings&quot;</span><span class="p">:{</span>
        <span class="s2">&quot;pathToW2hparm&quot;</span><span class="p">:</span><span class="s2">&quot;../option/w2hparm.global.js&quot;</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
<p><em>Sample w2hparm.js setting</em></p>
<p>Our w2hparm.global.js member looks like the following example. This too is also uploaded to the CLI-DIR:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">w2hparm</span><span class="o">.</span><span class="k">global</span><span class="o">.</span><span class="n">js</span> <span class="p">(</span><span class="n">CLI</span><span class="o">-</span><span class="n">DIR</span><span class="p">)</span>
<span class="o">//</span> <span class="n">w2h</span> <span class="n">parameters</span> <span class="n">to</span> <span class="n">override</span> <span class="n">defaults</span> <span class="ow">and</span> <span class="n">add</span> <span class="n">DDI</span> <span class="n">macro</span> <span class="n">support</span><span class="o">.</span>
<span class="n">var</span> <span class="n">w2hparm</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ctrl&quot;</span><span class="p">:</span><span class="s2">&quot;Newline&quot;</span><span class="p">,</span>
    <span class="s2">&quot;enter&quot;</span><span class="p">:</span><span class="s2">&quot;ENTER&quot;</span><span class="p">,</span>
    <span class="s2">&quot;pgup&quot;</span><span class="p">:</span><span class="s2">&quot;PA1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;pgdn&quot;</span><span class="p">:</span><span class="s2">&quot;PA2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;useVirtelMacros&quot;</span><span class="p">:{</span><span class="s2">&quot;macrosAutoRefresh&quot;</span><span class="p">:</span><span class="s2">&quot;session&quot;</span><span class="p">}</span>
<span class="p">};</span>
<span class="n">w2hparm</span><span class="o">.</span><span class="n">keymapping</span><span class="o">=</span><span class="n">true</span><span class="p">;</span>
</pre></div>
</div>
<p>The “useVirtelMacros” is the key property required for DDI. The various values for this key name control the synchronisation between the user’s local macro storage and the DDI central repository. Specify one of the following options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&quot;w2hparm.useVirtelMacros&quot;:{“macrosAutoRefresh”: “never” | “once” | “daily” | “session” }
</pre></div>
</div>
<p><strong>Macro Options</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 12%" />
<col style="width: 88%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Option</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Never</p></td>
<td><p>Do not synchronise with DDI unless the user presses the refresh button. Default</p></td>
</tr>
<tr class="row-odd"><td><p>Once</p></td>
<td><p>Synchronise with DDI only when local storage hasn’t been initialised</p></td>
</tr>
<tr class="row-even"><td><p>Daily</p></td>
<td><p>Once a Day</p></td>
</tr>
<tr class="row-odd"><td><p>Session</p></td>
<td><p>Every time a new browser session is opened</p></td>
</tr>
</tbody>
</table>
<p>Two other settings that can be used with DDI are: -</p>
<ul>
<li><p><strong>w2hparm.keymapping=true | false</strong>                        Turn on keymapping</p>
<blockquote>
<div><p>This option turns on the ability to assign a macro with a shortcut or “hot key” made up of a combination of keys; such as ALT+F1, or CTRL+A.  Beware that some keyboard combinations may be reserved for the operating system or other Virtel functions. For example, CTRL-R is a browser refresh option.</p>
</div></blockquote>
</li>
<li><p><strong>w2hparm.synchronizeVirtelMacros=true | false</strong>           Synchronize all Centralised Repositories</p>
<blockquote>
<div><p>If you are running multiple images of Virtel, say in a SYSPLEX arrangement using separate centralized repositories then the “synchronizeVirtelMacros” option should be set to true. This ensures that macro changes are reflected in all DDI repositories and associated local storage.</p>
</div></blockquote>
</li>
</ul>
</div>
</div>
<div class="section" id="centralised-ddi-validation">
<h4>Centralised DDI validation<a class="headerlink" href="#centralised-ddi-validation" title="Permalink to this headline">¶</a></h4>
<p>After uploading the settings objects stop and restart Virtel and then open a TSO or CICS session through the client port 41002.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">170.48</span><span class="p">:</span><span class="mi">41002</span><span class="o">/</span><span class="n">w2h</span><span class="o">/</span><span class="n">WEB2AJAX</span><span class="o">.</span><span class="n">htm</span><span class="o">+</span><span class="n">TSO</span>
</pre></div>
</div>
<p>The macro ICON should now be blue, indicating centralised DDI has been correctly configured. In local mode this ICON is green.</p>
<p><img alt="image39" src="../../../_images/image398.png" /></p>
<p><em>Centralized DDI is active - ICON is blue</em></p>
<p>Pressing the Blue ICON should display an empty macro list:</p>
<p><img alt="image40" src="../../../_images/image404.png" /></p>
<p><em>Empty Macro list</em></p>
<p><em>Configuring the Centralised Repository</em></p>
<p>To configure the centralised DDI repository we need to create an “initial” MACROS.JSON file. If we load up a TSO or CICS transaction on the W2H line (41001) we can see that the Macro ICON is green, which is what we would also expect as DDI is not active on this port. We will use this line to create some initial macros to load up into our centralized repository on the mainframe. Remember, that in centralized DDI mode, macros are downloaded from the repository. Users do not have any capability of “writing” or exporting their own macros.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">170.48</span><span class="p">:</span><span class="mi">41001</span><span class="o">/</span><span class="n">w2h</span><span class="o">/</span><span class="n">WEB2AJAX</span><span class="o">.</span><span class="n">htm</span><span class="o">+</span><span class="n">Tso</span>
</pre></div>
</div>
<p><img alt="image41" src="../../../_images/image4117.png" /></p>
<p><em>Accessing a local macro facility -  Green ICON</em></p>
</div>
<div class="section" id="creating-an-initial-macro">
<h4>Creating an initial macro<a class="headerlink" href="#creating-an-initial-macro" title="Permalink to this headline">¶</a></h4>
<div class="section" id="sdsf-test-macro">
<h5>SDSF test macro<a class="headerlink" href="#sdsf-test-macro" title="Permalink to this headline">¶</a></h5>
<p>In the next section we will create a macro, which performs a basic SDSF task in TSO, export it and then import it into the USR-DIR directory through the Centralised DDI import facility. We will use the non-DDI macro feature on port 41001 to create a test macro using the macro record button. The macro will be called SDSF. The following key sequences where entered from the ISPF primary option menu after logging on to TSO on line 41001:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Logon</span> <span class="n">to</span> <span class="n">TSO</span> <span class="ow">and</span> <span class="n">bring</span> <span class="n">up</span> <span class="n">the</span> <span class="n">ISPF</span> <span class="n">primary</span> <span class="n">menu</span> <span class="n">panel</span><span class="o">.</span>
<span class="n">Press</span> <span class="n">Virtel</span> <span class="n">macro</span> <span class="n">record</span> <span class="n">button</span>    <span class="p">[</span><span class="n">To</span> <span class="n">the</span> <span class="n">left</span> <span class="n">of</span> <span class="n">the</span> <span class="n">green</span> <span class="n">ICON</span><span class="p">]</span>
<span class="o">=</span><span class="n">S</span>                                                  <span class="n">Short</span> <span class="n">cut</span> <span class="n">to</span> <span class="n">SDSF</span> <span class="p">(</span><span class="n">This</span> <span class="n">will</span> <span class="n">be</span> <span class="n">site</span> <span class="n">dependant</span><span class="p">]</span>
<span class="n">LOG</span>                                                 <span class="n">SDSF</span> <span class="n">Log</span> <span class="n">command</span>
<span class="n">Press</span> <span class="n">Virtel</span> <span class="n">macro</span> <span class="n">record</span> <span class="n">button</span> <span class="n">again</span> <span class="n">to</span> <span class="n">cease</span> <span class="n">recording</span><span class="o">.</span>
</pre></div>
</div>
<p>The following panel should now pop up:</p>
<p><img alt="image42" src="../../../_images/image4212.png" /></p>
<p><em>Creating a MACROS.JSON file</em></p>
<p>Saved the macro with the name SDSF. Now, press the Green ICON. The macro should appear in the local list and would have been saved to local browser storage. To run the macro press the green arrow to the left of the macro name SDSF.</p>
<p><img alt="image43" src="../../../_images/image438.png" /></p>
<p>Next, we need to create a “MACROS.JSON” file by exporting the SDSF macro we have just created.</p>
</div>
<div class="section" id="uploading-macros-to-the-centralized-repository">
<h5>Uploading macros to the centralized repository<a class="headerlink" href="#uploading-macros-to-the-centralized-repository" title="Permalink to this headline">¶</a></h5>
<p>To upload any MACROS.JSON file to the centralized repository we must first create a “local” export version. In the “Local Macros” popup export the SDSF macro using the export option. This will create a local “macros.json” file. The “MACROS.JSON” file will be exported to your default “download” directory on your PC.</p>
<p>If you view the file the following will be displayed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;macros&quot;</span><span class="p">:[</span>
    <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;SDSF&quot;</span><span class="p">,</span><span class="s2">&quot;rev&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;def&quot;</span><span class="p">:[</span><span class="mi">61</span><span class="p">,</span><span class="mi">115</span><span class="p">,</span><span class="s2">&quot;ENTER&quot;</span><span class="p">,</span><span class="mi">108</span><span class="p">,</span><span class="mi">111</span><span class="p">,</span><span class="mi">103</span><span class="p">,</span><span class="s2">&quot;ENTER&quot;</span><span class="p">]}</span>
    <span class="p">],</span>
<span class="s2">&quot;fmt&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
</pre></div>
</div>
<p>We now have a macro which we can import to the centralized repository. From the Administration portal, select the Dynamic Directory Interface option:</p>
<p><img alt="image44" src="../../../_images/image445.png" /></p>
<p>This will open the Dynamic directories main panel. Select the Global tab. The Global Drag and Drop area will be displayed. Drag the MACROS.JSON file from the “downloads” folder on to the Global D&amp;D upload zone delineated by a dotted line. The MACROS.JSON file will be uploaded to the GLOBAL-DIR. The upload results will be shown on the D&amp;D zone area.</p>
<p><img alt="image45" src="../../../_images/image455.png" /></p>
<p><em>Global DDI Upload</em></p>
<p>Refresh the GLOBAL directory by clicking the broken circled arrow in the top left of the screen. The MACROS.JSON file will be displayed. We can validate the Global macro upload by opening a TSO or CICS session with the DDI configured line (41002). Press the “Blue” ICON to display all available macros. It should now show that the SDSF macro has indeed been imported to the GLOBAL area.</p>
<p><img alt="image46" src="../../../_images/image468.png" /></p>
<p><em>Uploaded Global Macro</em></p>
<p>To run the macro, enter the ISPF primary menu and then press the Green “ARROW” next to the SDSF name. The SDSF log display should appear.</p>
</div>
</div>
<div class="section" id="creating-a-user-macro">
<h4>Creating a user macro<a class="headerlink" href="#creating-a-user-macro" title="Permalink to this headline">¶</a></h4>
<p>With centralized macros, users can create “local” macros which will by synchronized with the centralized repository. They will not have the ability to import/export any macro.
Creating a “user” macro follows the same process as before. The user clicks the “record” button, records their macro, stops recording by pressing the record button again. As before, a popup window will open allowing the user to name the macro and associate with a “keyboard mapping” if that option has been set. The macro will then appear in the users list of macros.</p>
<p>Here is an example of a user macro called “CUSTINQ” which drives a sequence of CICS keyboard sequences to display a customer Inquiry panel within a CICS transaction. The macro has been associated with key mapping “ALT+6”.</p>
<p><img alt="image47" src="../../../_images/image478.png" /></p>
</div>
<div class="section" id="macro-options">
<h4>Macro Options<a class="headerlink" href="#macro-options" title="Permalink to this headline">¶</a></h4>
<p>Pressing the “right click” button against the macro name will reveal a small popup which provides the user with some options.</p>
<p><img alt="image48" src="../../../_images/image485.png" /></p>
<p>The user has the ability to “DELETE”, RENAME (“Save As”), EDIT or RUN the macro. Whatever changes are made will be synchronized with the central repository.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The “Edit” feature is for viewing only.</p>
</div>
</div>
<div class="section" id="directory-and-macro-administration">
<h4>Directory and Macro Administration<a class="headerlink" href="#directory-and-macro-administration" title="Permalink to this headline">¶</a></h4>
<p>Users do not have the ability to create macros. This function is performed by the Virtel Administrator. The Administrator would develop macros using a “local” facility and export these up into the central repository to make them available to users at a Global, Group and User level.</p>
<div class="section" id="making-a-user-s-ddi-macro-available-to-a-ddi-group">
<h5>Making a user’s DDI macro available to a DDI Group<a class="headerlink" href="#making-a-user-s-ddi-macro-available-to-a-ddi-group" title="Permalink to this headline">¶</a></h5>
<p>The following procedure describes how to move a user’s DDI macro to a DDI GROUP level. Start by opening the DDI interface from the main Administration Portal and select the USER tab;specify the userid in the user name field. Press the Green tick. The macros associated with the userid will be listed.</p>
<p><img alt="image49" src="../../../_images/image495.png" /></p>
<p><em>Moving macros to a Group</em></p>
<p>Select the MACROS.JSON file. This file contains all the macros associated with this userid. Right click to reveal the options available - Valid options are EDIT, DOWNLOAD or DELETE.
Note, the “COPY” option cannot be used to move MACRO.JSON files to another directory, such as GRP-DIR. To move the macro to GRP-DIR the MACRO.JSON must be downloaded and then uploaded, through the DDI upload interface, to the target group DDI zone.</p>
<p>Select the “DOWNLOAD” tab. The MACROS.JSON will be downloaded to the default download directory.</p>
<p>Now, select the GROUP TAB and specify the target RACF GROUP name. Press the GREEN tick. The GROUP directory for the group name will be displayed in a delineated DDI zone area. Select the MACROS.JSON file from the default download directory, or another directory where you might have a customised MACROS.JSON file, and drag it into the zone area, delineated by a row of dots. The macro will be uploaded to the selected GROUP.</p>
<p>If you now go to the TSO session under port 41002, the centralized DDI line, and list the macros by pressing the Blue ICON, you should see that the Group Macros now contains a list of macros. In our example it should be the macro CUSTINQ.</p>
<p><img alt="image50" src="../../../_images/image504.png" /></p>
<p><em>Populated Group macro</em></p>
<p>From this display you can see that the User Macro CUSTINQ has been moved to the Group area. The CUSTINQ macro can now be delete the user’s MACROS.JSON list using the DDI interface. To do this, enter the Administration Portal DDI interface, select the USERTAB, enter the userid into the username, press the Green tick to list the user’s MACROS.JSON file. Select the MACROS.JSON file, right click and press the DELETE tab. Confirm the deletion. The user’s MACRO.JSON fill will be deleted from the DDI USR-DIR directory and will no longer appear in the User macros list when listing the macros in the TSO session.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Press the Refresh button after “deleting” the user macro.</p>
</div>
<p><img alt="image51" src="../../../_images/image5113.png" />
<em>Deleting macros from user’s list</em></p>
<p>The process of moving macros between the various DDI levels, USER, GROUP and GLOBAL, can be applied using the procedure described above. You must “download” and then “upload” using the DDI drag and drop interface to move macros between levels. Also, remember that all macros are associated with a JSON file – MACROS.JSON. One such file will exist for each USER,  GROUP and there will be only one global MARCOS.JSON file available to all users.</p>
<p>It is not recommended that you EDIT a downloaded MACROS.JSON file unless you have an understanding of JavaScript and JSON objects. It is better the use the online “EDIT” functions associated with the DDI interface or that of the Macro display list. Right click either against the MACROS.JSON file or the individual Macros listed in the TSO session will bring up the Editor function.</p>
</div>
<div class="section" id="dummy-macro-file">
<h5>Dummy Macro File<a class="headerlink" href="#dummy-macro-file" title="Permalink to this headline">¶</a></h5>
<p>It is not necessary to export a “dummy” macro from a “local mode” setup to get started. You can start with a dummy MACROS.JSON file and upload it to User, Group and Global levels. From there you can build up your MACROS.JSON files and upload them to the relevant User, Group and Global zones. A dummy macro file looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;macros&quot;</span><span class="p">:[],</span><span class="s2">&quot;fmt&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
</pre></div>
</div>
<p><em>Dummy MACROS.JSON file</em></p>
</div>
</div>
<div class="section" id="centralized-ddi-problems">
<h4>Centralized DDI Problems<a class="headerlink" href="#centralized-ddi-problems" title="Permalink to this headline">¶</a></h4>
<div class="section" id="out-of-sync-condition-or-no-transaction-security">
<h5>Out of Sync condition or no transaction security<a class="headerlink" href="#out-of-sync-condition-or-no-transaction-security" title="Permalink to this headline">¶</a></h5>
<p>If the Virtel cache is out of sync with the DDI/macro settings or you are trying to access DDI macros using a non-secure transaction i.e. TRANSACTION SECURITY=0  then following page can appear when pressing the macro ICON:-</p>
<p><img alt="image52" src="../../../_images/image5211.png" /></p>
<p><em>Out of Sync. Problem</em></p>
<p><strong>Solution</strong></p>
<ul>
<li><p>Make sure you are using a transaction with security set.</p></li>
<li><p>Refresh the cache with the following commands.</p>
<p>CTRL-SHIFT-DEL
CTRL R</p>
</li>
</ul>
</div>
</div>
<div class="section" id="macro-formats-and-commands">
<h4>Macro formats and Commands<a class="headerlink" href="#macro-formats-and-commands" title="Permalink to this headline">¶</a></h4>
<p>The format of the MACROS.JSON file is an embedded JSON structure. Each name structure represents a keystroke macro identified by the “name” keyword.</p>
<ul class="simple">
<li><p>Name : The name of the macro entry.</p></li>
<li><p>Rev : The “rev” is a user revision keyword.</p></li>
<li><p>Def : The “def” keyword identifies the commands and entry values.</p></li>
</ul>
<p>The macro editor supports the following commands:-
*   “any string of characters to input into 3270 screen”
*   move(pos)
*   copy(startRow,startCol,endRow,endCol)
*   paste(pos)
*   paste(pos,nbRows,nbCols)
*   key(keyIdentifier)</p>
<p><strong>Macro example</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;macros&quot;</span><span class="p">:[</span>
    <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;SDSFLOG&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rev&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;def&quot;</span><span class="p">:[</span><span class="s2">&quot;move(435)&quot;</span><span class="p">,</span><span class="s2">&quot;ENTER&quot;</span><span class="p">,{</span><span class="s2">&quot;txt&quot;</span><span class="p">:</span><span class="s2">&quot;=M&quot;</span><span class="p">},</span><span class="s2">&quot;ErEof&quot;</span><span class="p">,</span><span class="s2">&quot;ENTER&quot;</span><span class="p">,{</span><span class="s2">&quot;txt&quot;</span><span class="p">:</span><span class="s2">&quot;6&quot;</span><span class="p">},</span><span class="s2">&quot;ENTER&quot;</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;SDSFDA&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rev&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;def&quot;</span><span class="p">:[</span><span class="mi">77</span><span class="p">,</span><span class="s2">&quot;ENTER&quot;</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="s2">&quot;ENTER&quot;</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">97</span><span class="p">,</span><span class="s2">&quot;ENTER&quot;</span><span class="p">]</span>
    <span class="p">}</span>
<span class="p">],</span><span class="s2">&quot;fmt&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="centralised-user-parameters">
<h2>Centralised User Parameters<a class="headerlink" href="#centralised-user-parameters" title="Permalink to this headline">¶</a></h2>
<p>Centralized USERPARM provides the ability to save user settings in a centralized VSAM file on the mainframe. The user settings with be synchronized with the browser whenever a user logs on, regardless of the device they are using. Users must have a RACF or equivalent userid.</p>
<div class="section" id="userparm-setup">
<h3>USERPARM Setup<a class="headerlink" href="#userparm-setup" title="Permalink to this headline">¶</a></h3>
<p>1   Stop Virtel. Update the TCT with the following definitions and re-assemble using the ASMTCT JCL found in the CNTL library.</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">UPARMS</span><span class="o">=</span><span class="p">(</span><span class="n">USERPARM</span><span class="p">),</span>                                                      <span class="o">*</span>
<span class="n">UFILE3</span><span class="o">=</span><span class="p">(</span><span class="n">USERTRSF</span><span class="p">,</span><span class="n">ACBH3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">01</span><span class="p">),</span>                                        <span class="o">*</span>
<span class="n">ACBH3</span>    <span class="n">ACB</span>   <span class="n">AM</span><span class="o">=</span><span class="n">VSAM</span><span class="p">,</span><span class="n">DDNAME</span><span class="o">=</span><span class="n">USERTRSF</span><span class="p">,</span><span class="n">MACRF</span><span class="o">=</span><span class="p">(</span><span class="n">SEQ</span><span class="p">,</span><span class="n">DIR</span><span class="p">,</span><span class="n">OUT</span><span class="p">),</span>     <span class="o">*</span>
       <span class="n">STRNO</span><span class="o">=</span><span class="mi">3</span>
</pre></div>
</div>
</div></blockquote>
<p>2   Run HLQ.VIRTxxx.SAMPLIB(USERPARM)</p>
<blockquote>
<div><p>You will need to modify the JCL before running the Job. This job will allocate the USERTRSF VSAM file which will be the repository for user parameters.</p>
</div></blockquote>
<p>3   Update RACF to support the USERPARM transactions</p>
<blockquote>
<div><p>The following security definitions will be needed to support the USERPARM feature. For example, for RACF the following FACILITY profile definitions need to be added and users given READ access.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">STEP1</span>   <span class="n">EXEC</span> <span class="n">PGM</span><span class="o">=</span><span class="n">IKJEFT01</span><span class="p">,</span><span class="n">DYNAMNBR</span><span class="o">=</span><span class="mi">20</span>
<span class="o">//</span><span class="n">SYSTSPRT</span> <span class="n">DD</span>  <span class="n">SYSOUT</span><span class="o">=*</span>
<span class="o">//</span><span class="n">SYSTSIN</span>  <span class="n">DD</span>  <span class="o">*</span>
<span class="n">RDEF</span> <span class="n">FACILITY</span> <span class="n">VIRTEL</span><span class="o">.</span><span class="n">USERPARM</span> <span class="n">UACC</span><span class="p">(</span><span class="n">NONE</span><span class="p">)</span>     <span class="o">/*</span> <span class="n">DIRECTORY</span> <span class="o">*/</span>
<span class="n">PE</span> <span class="n">VIRTEL</span><span class="o">.</span><span class="n">USERPARM</span> <span class="n">CL</span><span class="p">(</span><span class="n">FACILITY</span><span class="p">)</span> <span class="n">RESET</span>
<span class="n">PE</span> <span class="n">VIRTEL</span><span class="o">.</span><span class="n">USERPARM</span> <span class="n">CL</span><span class="p">(</span><span class="n">FACILITY</span><span class="p">)</span> <span class="n">ACC</span><span class="p">(</span><span class="n">READ</span><span class="p">)</span> <span class="n">ID</span><span class="p">(</span><span class="n">SPGPTECH</span><span class="p">)</span>
<span class="n">RDEF</span> <span class="n">FACILITY</span> <span class="n">VIRTEL</span><span class="o">.</span><span class="n">W2H</span><span class="o">-</span><span class="mi">74</span> <span class="n">UACC</span><span class="p">(</span><span class="n">NONE</span><span class="p">)</span>       <span class="o">/*</span> <span class="n">UPLOAD</span> <span class="o">*/</span>
<span class="n">PE</span> <span class="n">VIRTEL</span><span class="o">.</span><span class="n">W2H</span><span class="o">-</span><span class="mi">74</span> <span class="n">CL</span><span class="p">(</span><span class="n">FACILITY</span><span class="p">)</span> <span class="n">RESET</span>
<span class="n">PE</span> <span class="n">VIRTEL</span><span class="o">.</span><span class="n">W2H</span><span class="o">-</span><span class="mi">74</span> <span class="n">CL</span><span class="p">(</span><span class="n">FACILITY</span><span class="p">)</span> <span class="n">ACC</span><span class="p">(</span><span class="n">READ</span><span class="p">)</span> <span class="n">ID</span><span class="p">(</span><span class="n">SPGPTECH</span><span class="p">)</span>
<span class="n">SETR</span> <span class="n">REFRESH</span> <span class="n">RACLIST</span><span class="p">(</span><span class="n">FACILITY</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>4   Update the VIRTEL procedure</p>
<blockquote>
<div><p>Add the USERTRSF JCL statement to the Virtel procedure. For example :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">USERTRSF</span> <span class="n">DD</span>  <span class="n">DSN</span><span class="o">=&amp;</span><span class="n">QUAL</span><span class="o">..</span><span class="n">USER</span><span class="o">.</span><span class="n">TRSF</span><span class="p">,</span><span class="n">DISP</span><span class="o">=</span><span class="n">SHR</span>
</pre></div>
</div>
<p>Restart Virtel</p>
</div></blockquote>
<p>5   Perform a USERPARM sanity check</p>
<blockquote>
<div><p>A ‘sanity check’ template is provided to validate the USERPARM environment at the transaction level. For example:-</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">170.48</span><span class="p">:</span><span class="mi">41002</span><span class="o">/</span><span class="n">w2h</span><span class="o">/</span><span class="n">checkCentralizedSettings</span><span class="o">.</span><span class="n">htm</span><span class="o">+</span><span class="n">TSO</span>
</pre></div>
</div>
<p>If every has been configured correctly you should get a “GREEN” light.</p>
</div></blockquote>
<p><img alt="image53" src="../../../_images/image536.png" /></p>
<p><em>Example of a Sanity Check after setting up USERPARM</em></p>
<div class="section" id="testing-the-userparm-feature">
<h4>Testing the USERPARM feature<a class="headerlink" href="#testing-the-userparm-feature" title="Permalink to this headline">¶</a></h4>
<p>To test the USERPARM feature follow the procedure below :-</p>
<p>1   Logon to a 3270 application, say TSO
2   Open the settings dialog
3   Change the “Display Style” to Grey and save. The background colour should change to grey.
4   Disconnect from Virtel using the Red button in the tool bar.
5   Reconnect to Virtel, using a different browser and open a 3270 session.
6   The background colour should still be set to grey.
7   Open the settings dialogue and confirm that Grey button is still highlighted.</p>
<p>In the Virtel log you should see the following “upload” message:-</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">VIRU122I</span> <span class="n">CLVTA079</span> <span class="n">FILE</span> <span class="n">UPLOAD</span> <span class="p">:</span> <span class="n">ENTRY</span> <span class="n">POINT</span> <span class="s1">&#39;CLIWHOST&#39;</span> <span class="n">DIRECTORY</span> <span class="s1">&#39;USERP  882</span>
<span class="n">ARM</span><span class="s1">&#39; USER &#39;</span><span class="n">SPTHOLT</span>             <span class="s1">&#39;</span>
        <span class="n">FILE</span> <span class="p">:</span> <span class="s1">&#39;8393DD4A16F0E1C9723F9D9CFA2C39F1&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="removing-a-user-s-settings">
<h4>Removing a user’s settings<a class="headerlink" href="#removing-a-user-s-settings" title="Permalink to this headline">¶</a></h4>
<p>This can be done by deleting the key associated with the user from the USERPARM directory. For example, the key associated with SPTHOLT is C6D24022819C599803A86BB3C42298B6. If we look at USERPARM directory in the Administration portal on line 41001 we can see it listed:</p>
<p><img alt="image55" src="../../../_images/image557.png" /></p>
<p><em>Listing the USERPARM directory</em></p>
<p>We can remove the entry by using the delete option. This will remove any user settings. The user will then have to “restore defaults” to correctly pickup up the default user parameters as defined by the Administrator.</p>
</div>
<div class="section" id="userparm-problems">
<h4>USERPARM Problems<a class="headerlink" href="#userparm-problems" title="Permalink to this headline">¶</a></h4>
<p>When I try to save my settings, I get the following dialog box and the following messages in the Virtel log.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">VIRU122I</span> <span class="n">CLVTA079</span> <span class="n">FILE</span> <span class="n">UPLOAD</span> <span class="p">:</span> <span class="n">ENTRY</span> <span class="n">POINT</span> <span class="s1">&#39;CLIWHOST&#39;</span> <span class="n">DIRECTORY</span> <span class="s1">&#39;USERP</span>
<span class="mi">330</span>
<span class="n">ARM</span><span class="s1">&#39; USER &#39;</span><span class="n">SPTHOLT</span>             <span class="s1">&#39;</span>
    <span class="n">FILE</span> <span class="p">:</span> <span class="s1">&#39;9346CCEF695D8FF2D7C1B2DA6C81CFC8&#39;</span>
<span class="n">VIRC121E</span> <span class="n">PAGE</span> <span class="n">NOT</span> <span class="n">FOUND</span> <span class="n">FOR</span> <span class="n">CLVTA079</span> <span class="n">ENTRY</span> <span class="n">POINT</span> <span class="s1">&#39;CLIWHOST&#39;</span> <span class="n">DIRECTORY</span> <span class="s1">&#39;</span>
<span class="mi">331</span>
<span class="n">W2H</span>     <span class="s1">&#39;(W2H-DIR  W2H-KEY )</span>
    <span class="n">PAGE</span> <span class="p">:</span> <span class="s1">&#39;VPLEX=UNDEFINEDPARAMETERS-CODE.TXT&#39;</span> <span class="n">URL</span> <span class="p">:</span> <span class="s1">&#39;/w2h/VPLEX=un</span>
<span class="n">definedPARAMETERS</span><span class="o">-</span><span class="n">CODE</span><span class="o">.</span><span class="n">txt</span><span class="o">++</span><span class="n">AjaxSession</span><span class="o">=</span><span class="n">ADvzWAAAAAAeu</span>
</pre></div>
</div>
<p><img alt="image54" src="../../../_images/image545.png" /></p>
<p><em>Userparm Error</em></p>
<p><strong>Solution</strong></p>
<p>Apply the latest maintenance. You must be at UPDT5708 or higher.</p>
<p><strong>Problem</strong></p>
<p>I save my user parameter changes but when I use a different PC or browser I am reverted back to my old or default settings.</p>
<p><strong>Solution</strong></p>
<p>Check the Virtel log and look for any RACF violations that may be preventing a user from uploading their user parameters definitions to the mainframe repository. In the console log you may well see RACF error messages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ICH408I</span> <span class="n">USER</span><span class="p">(</span><span class="n">CTKHOLT</span> <span class="p">)</span> <span class="n">GROUP</span><span class="p">(</span><span class="n">CTKGROUP</span><span class="p">)</span> <span class="n">NAME</span><span class="p">(</span><span class="n">ED</span> <span class="n">HOLT</span>             <span class="p">)</span> <span class="mi">451</span>
<span class="n">SPVIREH</span><span class="o">.</span><span class="n">USERPARM</span> <span class="n">CL</span><span class="p">(</span><span class="n">FACILITY</span><span class="p">)</span>
<span class="n">INSUFFICIENT</span> <span class="n">ACCESS</span> <span class="n">AUTHORITY</span>
<span class="n">ACCESS</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">READ</span>   <span class="p">)</span>  <span class="n">ACCESS</span> <span class="n">ALLOWED</span><span class="p">(</span><span class="n">NONE</span>   <span class="p">)</span>
<span class="n">VIRU121E</span> <span class="n">CLVTA079</span> <span class="n">FILE</span> <span class="n">UPLOAD</span> <span class="n">FAILED</span> <span class="p">:</span> <span class="n">ENTRY</span> <span class="n">POINT</span> <span class="s1">&#39;CLIWHOST&#39;</span> <span class="n">DIRECTORY</span>
<span class="mi">452</span>
<span class="s1">&#39;USERPARM&#39;</span> <span class="n">USER</span> <span class="s1">&#39;SPTHOLT             &#39;</span>
    <span class="n">FILE</span> <span class="p">:</span> <span class="s1">&#39;C6D24022819C599803A86BB3C42298B6&#39;</span>
</pre></div>
</div>
<p><strong>Solution</strong></p>
<p>Check the correct RACF security is in place.</p>
<p><strong>Problem</strong></p>
<p>Changed defaults not updated in another browser session.</p>
<p><strong>Solution</strong></p>
<p>This is normally related to configuration. Try the “sanity” URL test to make sure that the setup is correct for the line in use.</p>
</div>
</div>
</div>
<div class="section" id="security">
<h2>Security<a class="headerlink" href="#security" title="Permalink to this headline">¶</a></h2>
<div class="section" id="how-to-activate-ssl-using-at-tls">
<h3>How To Activate SSL Using AT-TLS<a class="headerlink" href="#how-to-activate-ssl-using-at-tls" title="Permalink to this headline">¶</a></h3>
<p>To provide secure HTTP (https) sessions to client browsers, VIRTEL uses the Application Transparent Transport Layer Security (AT-TLS) feature of z/OS Communication Server. AT-TLS is included with z/OS V1R7 and later releases. AT-TLS allows socket applications to access encrypted sessions by invoking system SSL within the transport layer of the TCP/IP stack. The Policy Agent decides which connections are to use AT-TLS, and provides system SSL configuration for those connections. The application continues to send and receive clear text over the socket, but data sent over the network is protected by system SSL. The supported protocols are TLS, SSLv3, and SSLv2.</p>
<div class="section" id="installation-steps">
<h4>Installation steps<a class="headerlink" href="#installation-steps" title="Permalink to this headline">¶</a></h4>
<div class="section" id="install-policy-agent-procedure">
<h5>Install Policy Agent procedure<a class="headerlink" href="#install-policy-agent-procedure" title="Permalink to this headline">¶</a></h5>
<p>If you do not already have the Communications Server Policy Agent (PAGENT) active in your z/OS system, copy the cataloged procedure EZAPAGSP from TCPIP.SEZAINST into your proclib, renaming it as PAGENT.</p>
</div>
<div class="section" id="create-the-policy-agent-configuration-file">
<h5>Create the Policy Agent configuration file<a class="headerlink" href="#create-the-policy-agent-configuration-file" title="Permalink to this headline">¶</a></h5>
<p>If you do not already run the Policy Agent, you will need to create a configuration file /etc/pagent.conf using z/OS Unix System Services. If you already run Policy Agent, you will need to find the existing configuration file and add the TTLS definitions to it. Step PCONFIG in the SSLSETUP sample job contains a starter configuration. The following changes should be made:</p>
<ul class="simple">
<li><p>Replace %virtjob% by the name of your VIRTEL started task (SSLSETUP line 70)</p></li>
<li><p>Replace 41000-41002 by 41002 in the LocalPortRange parameter (SSLSETUP line 71) to activate AT-TLS for VIRTEL line C-HTTP</p></li>
<li><p>Replace ServerWithClientAuth by Server in the HandshakeRole parameter (SSLSETUP line 82) as we will not be using Client Certificates.</p></li>
</ul>
</div>
<div class="section" id="allow-the-policy-agent-to-run-during-tcp-ip-initialization">
<h5>Allow the Policy Agent to run during TCP/IP initialization<a class="headerlink" href="#allow-the-policy-agent-to-run-during-tcp-ip-initialization" title="Permalink to this headline">¶</a></h5>
<p>The Policy Agent must be given READ access to the resource EZB.INITSTACK.* in RACF class SERVAUTH. See step EZBAUTH in the SSLSETUP sample job (delivered in VIRTEL SAMPLIB).</p>
</div>
<div class="section" id="create-the-server-certificate">
<h5>Create the server certificate<a class="headerlink" href="#create-the-server-certificate" title="Permalink to this headline">¶</a></h5>
<p>A server certificate for VIRTEL must be created, signed by a certificate authority, and stored in the RACF database. In the SSLSETUP sample job we create a signing certificate and use RACF itself as the certificate authority. Alternatively, you may use an external certificate authority such as Verisign to create and sign the certificate, then import it into
RACF. At SSLSETUP line 228, replace %virtssl% by the DNS name assigned to the VIRTEL host (for example, virtssl.syspertec.com)</p>
</div>
<div class="section" id="add-the-certificate-to-the-keyring">
<h5>Add the certificate to the keyring<a class="headerlink" href="#add-the-certificate-to-the-keyring" title="Permalink to this headline">¶</a></h5>
<p>The server certificate must be added to the VIRTRING keyring. See step CCERTIF in the SSLSETUP sample job.</p>
</div>
<div class="section" id="allow-virtel-to-access-its-own-certificate">
<h5>Allow VIRTEL to access its own certificate<a class="headerlink" href="#allow-virtel-to-access-its-own-certificate" title="Permalink to this headline">¶</a></h5>
<p>To allow VIRTEL to access its own keyring and server certificate, the VIRTEL started task must have READ access to the resource IRR.DIGTCERT.LISTRING in the RACF class FACILITY. See step IRRAUTH in the SSLSETUP sample job.</p>
</div>
<div class="section" id="activate-at-tls">
<h5>Activate AT-TLS<a class="headerlink" href="#activate-at-tls" title="Permalink to this headline">¶</a></h5>
<p>To activate AT-TLS, add the following statements to TCPIP PROFILE:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TCPCONFIG</span> <span class="n">TTLS</span>
<span class="n">AUTOLOG</span> <span class="mi">5</span> <span class="n">PAGENT</span> <span class="n">ENDAUTOLOG</span>
</pre></div>
</div>
<p>Stop and restart TCP/IP to activate the TCPCONFIG TTLS profile statement. The AUTOLOG statement will cause the PAGENT procedure to be started automatically during TCP/IP initialization.</p>
</div>
</div>
<div class="section" id="operations">
<h4>Operations<a class="headerlink" href="#operations" title="Permalink to this headline">¶</a></h4>
<div class="section" id="starting-the-policy-agent">
<h5>Starting the Policy Agent<a class="headerlink" href="#starting-the-policy-agent" title="Permalink to this headline">¶</a></h5>
<p>The AUTOLOG statement in the TCP/IP profile will start the PAGENT procedure automatically at TCP/IP initialization. Alternatively you can issue the MVS command S PAGENT.
Note: if this is the first time you have activated the SERVAUTH class, you are likely to see RACF failure messages during TCP/IP initialization indicating that other applications are unable to access the resource EZB.INITSTACK. This is normal, because Communications Server uses this mechanism to prevent applications from accessing TCP/IP before the Policy
Agent is started. Do not be tempted to authorize applications to use this RACF resource. Either ignore the messages (they will go away once PAGENT has started), or ensure that PAGENT starts before all other applications.</p>
</div>
<div class="section" id="altering-the-policy-agent-configuration">
<h5>Altering the Policy Agent configuration<a class="headerlink" href="#altering-the-policy-agent-configuration" title="Permalink to this headline">¶</a></h5>
<p>To make changes to the Policy Agent configuration file, either edit and resubmit the PCONFIG step of the SSLSETUP sample job, or use the TSO ISHELL command to edit the file /etc/pagent.conf directly from ISPF. After you make changes to the Policy Agent configuration, use the MVS command F PAGENT,REFRESH to force PAGENT to reread the file.</p>
</div>
<div class="section" id="logon-to-virtel-using-secure-session">
<h5>Logon to VIRTEL using secure session<a class="headerlink" href="#logon-to-virtel-using-secure-session" title="Permalink to this headline">¶</a></h5>
<p>To access VIRTEL line C-HTTP you must now use URL <a class="reference external" href="https://n.n.n.n:41002">https://n.n.n.n:41002</a> instead of <a class="reference external" href="http://n.n.n.n:41002">http://n.n.n.n:41002</a> (where n.n.n.n is the IP address of the z/OS host running VIRTEL).</p>
</div>
</div>
<div class="section" id="problem-determination">
<h4>Problem determination<a class="headerlink" href="#problem-determination" title="Permalink to this headline">¶</a></h4>
<div class="section" id="policy-agent-log-file">
<h5>Policy Agent log file<a class="headerlink" href="#policy-agent-log-file" title="Permalink to this headline">¶</a></h5>
<p>Policy Agent startup messages are written to the /tmp/pagent.log file of z/OS Unix System Services. You can use the TSO ISHELL command to browse this file from ISPF.</p>
</div>
<div class="section" id="common-error-messages">
<h5>Common error messages<a class="headerlink" href="#common-error-messages" title="Permalink to this headline">¶</a></h5>
<p>Error messages relating to session setup are written to the MVS SYSLOG. The most common error message is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">EZD1287I</span> <span class="n">TTLS</span> <span class="n">Error</span> <span class="n">RC</span><span class="p">:</span> <span class="n">nnn</span> <span class="n">event</span>
</pre></div>
</div>
<p>where nnn represents a return code. Return codes under 5000 are generated by System SSL and are defined in the System SSL Programming manual. Return codes over 5000 are generated by AT-TLS and are defined in the IP Diagnosis Guide. Some commonly encountered return codes are:</p>
<ul class="simple">
<li><p>7 No certificate</p></li>
<li><p>8 Certificate not trusted</p></li>
<li><p>109 No certification authority certificates</p></li>
<li><p>202 Keyring does not exist</p></li>
<li><p>401 Certificate expired or not yet valid</p></li>
<li><p>402 or 412 Client and server cannot agree on cipher suite</p></li>
<li><p>416 VIRTEL does not have permission to list the keyring</p></li>
<li><p>431 Certificate is revoked</p></li>
<li><p>434 Certificate key not compatible with cipher suite</p></li>
<li><p>435 Certificate authority unknown</p></li>
<li><p>5003 Browser sent clear text (http instead of https)</p></li>
</ul>
</div>
<div class="section" id="cipher-suite">
<h5>Cipher suite<a class="headerlink" href="#cipher-suite" title="Permalink to this headline">¶</a></h5>
<p>The client and server cipher specifications must contain at least one value in common. The TTLSEnvironmentAdvancedParms parameter of the Policy Agent configuration file allows you to turn on or off the SSLv2, SSLv3, and TLSv1 protocols at the server end. The list of supported cipher suites for each protocol is in the TTLSCipherParms parameter. Check the /tmp/pagent.log file to determine whether any cipher suites were discarded at startup time. In Microsoft Internet Explorer, follow the menu Tools – Internet Options – Advanced. Under the security heading there are three options which allow you to enable or disable the SSL 2.0, SSL 3.0, and TLS 1.0 protocols. You cannot enable or disable individual cipher suites.
In Firefox the cipher specifications are accessed by typing <a class="reference external" href="about:config">about:config</a> in the address bar and typing security in the filter box. By default, ssl2 is disabled, and ssl3 and tls are enabled. By default, all weak encryption cipher suites are disabled, and 128-bit or higher cipher suites are enabled.</p>
</div>
<div class="section" id="bibliography">
<h5>Bibliography<a class="headerlink" href="#bibliography" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><p>SA22-7683-07 z/OS V1R7 Security Server: RACF Security Administrator’s Guide Chapter 21. RACF and Digital Certificates</p></li>
<li><p>SC24-5901-04 z/OS V1R6 Cryptographic Services: System SSL Programming Chapter 12. Messages and Codes</p></li>
<li><p>SC31-8775-07 z/OS V1R7 Communications Server: IP Configuration Guide Chapter 14. Policy-based networking Chapter 18. Application Transparent Transport Layer Security (AT-TLS) data protection</p></li>
<li><p>SC31-8776-08 z/OS V1R7 Communications Server: IP Configuration Reference Chapter 21. Policy Agent and policy applications</p></li>
<li><p>GC31-8782-06 z/OS V1R7 Communications Server: IP Diagnosis Guide Chapter 28. Diagnosing Application Transparent Transport Layer Security (AT-TLS)</p></li>
<li><p>SC31-8784-05 z/OS V1R7 Communications Server: IP Messages: Volume 2 (EZB, EZD) Chapter 10. EZD1xxxx messages</p></li>
</ul>
</div>
</div>
<div class="section" id="ssl-signing-on-using-server-and-client-certificates">
<h4>SSL - Signing On Using Server And Client Certificates<a class="headerlink" href="#ssl-signing-on-using-server-and-client-certificates" title="Permalink to this headline">¶</a></h4>
<p>In this section we look at setting up Virtel to work with client and user certificates and to effectively remove the need for a user to provide a user id and password. This is equivalent to the Express Logon Feature (ELF) provided by Host on Demand and other Telnet clients. First, let’s review what is going on behind the scenes with certificate authentication and X.509 certificate validation within TLS/SSL. The guiding principle here is that Public Key Infrastructure (PKI) requires that data encrypted with a
public key can only be decrypted with a private key and data encrypted with a private key can only be decrypted with a public key. The secure session (https) that runs between the browser and Virtel uses the Application Transparent Transport Layer Security feature of z/OS Communications Server, also known as AT-TLS. AT-TLS allows socket applications to access encrypted sessions by invoking Secure Socket Layer (SSL) within the transport layer of the TCP/IP stack. A policy agent (PAGENT) is used to configure AT-TLS using parameter statements which will determine which sessions are to use AT-TLS. AT_TLS inserts itself in the connection between the application and browser. This means that the application will send and receive clear text over the socket interface, but data over the network is encrypted by system SSL. System SSL has three supported protocol levels:</p>
<ul class="simple">
<li><p>TLSv1</p></li>
<li><p>SSLv2</p></li>
<li><p>SSLv3</p></li>
</ul>
<p>In this configuration we will be using SSLv3. The server / client process, which in Virtel’s case is the Virtel started task (server) and the browser (client), implements
the following SSL protocol or handshake during the “hello” phase of establishing a secure session:</p>
<ol class="arabic simple">
<li><p>The Client contacts the Server ;</p></li>
<li><p>The Server sends a certificate;</p></li>
<li><p>Server authentication is performed by the Client ;</p></li>
<li><p>Client sends the certificate;</p></li>
<li><p>Client authentication is performed by the Server ;</p></li>
<li><p>An encryption algorithm and single key is chosen to encrypt / decrypt data The purpose of the authentication is to ensure that the server/client are in fact who they say they are. This is to ensure that they server/client private and public keys haven’t been stolen and are purporting to be an entity that they aren’t and thereby compromising security. Authentication uses X.509 digital certificates. Further details of this handshake and the certificate exchange can be found in Appendix B. TLS/SSL Security z/OS Communications Server: IP Configuration Guide.</p></li>
</ol>
</div>
<div class="section" id="certificates">
<h4>Certificates<a class="headerlink" href="#certificates" title="Permalink to this headline">¶</a></h4>
<div class="section" id="whats-in-a-x-509-certificate">
<h5>What’s in a X.509 certificate?<a class="headerlink" href="#whats-in-a-x-509-certificate" title="Permalink to this headline">¶</a></h5>
<p>Amongst other things it includes the Distinguished Name of the Server (DNS), the public key of the Server, Distinguished Name of the Server organization issuing the certificate and the issuer’s signature. If we look at a certificate held with RACF we can see this information. Certificates are identified by a combination of LABEL, USERID or Certification Authority (CA).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">READY</span>
<span class="n">RACDCERT</span> <span class="n">ID</span><span class="p">(</span><span class="n">SPVIRSTC</span><span class="p">)</span> <span class="n">LIST</span><span class="p">(</span><span class="n">LABEL</span><span class="p">(</span><span class="s1">&#39;VIRTEL SSL DEMO&#39;</span><span class="p">))</span>
<span class="n">Digital</span> <span class="n">certificate</span> <span class="n">information</span> <span class="k">for</span> <span class="n">user</span> <span class="n">SPVIRSTC</span><span class="p">:</span>
<span class="n">Label</span><span class="p">:</span> <span class="n">VIRTEL</span> <span class="n">SSL</span> <span class="n">DEMO</span>
<span class="n">Certificate</span> <span class="n">ID</span><span class="p">:</span> <span class="mi">2</span><span class="n">Qji1</span><span class="o">+</span><span class="n">XJ2eLjw</span><span class="o">+</span><span class="n">XJ2ePF00Di4tNAxMXU1kBA</span>
<span class="n">Status</span><span class="p">:</span> <span class="n">TRUST</span>
<span class="n">Start</span> <span class="n">Date</span><span class="p">:</span> <span class="mi">2014</span><span class="o">/</span><span class="mi">07</span><span class="o">/</span><span class="mi">08</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
<span class="n">End</span> <span class="n">Date</span><span class="p">:</span> <span class="mi">2015</span><span class="o">/</span><span class="mi">07</span><span class="o">/</span><span class="mi">08</span> <span class="mi">23</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mi">59</span>
<span class="n">Serial</span> <span class="n">Number</span><span class="p">:</span>
    <span class="o">&gt;</span><span class="mi">05</span><span class="o">&lt;</span>
<span class="n">Issuer</span><span class="s1">&#39;s Name:</span>
    <span class="o">&gt;</span><span class="n">CN</span><span class="o">=</span><span class="n">z</span><span class="o">/</span><span class="n">OS</span> <span class="n">Security</span> <span class="n">Server</span><span class="o">.</span><span class="n">O</span><span class="o">=</span><span class="n">SYSPERTEC</span><span class="o">.</span><span class="n">C</span><span class="o">=</span><span class="n">FR</span><span class="o">&lt;</span>
<span class="n">Subject</span><span class="s1">&#39;s Name:</span>
    <span class="o">&gt;</span><span class="n">CN</span><span class="o">=</span><span class="n">RECETTE</span> <span class="n">VIRTEL</span><span class="o">.</span><span class="n">T</span><span class="o">=</span><span class="n">VIRTEL</span> <span class="n">Web</span> <span class="n">Access</span><span class="o">.</span><span class="n">O</span><span class="o">=</span><span class="n">SYSPERTEC</span><span class="o">.</span><span class="n">C</span><span class="o">=</span><span class="n">FR</span><span class="o">&lt;</span>
<span class="n">Key</span> <span class="n">Usage</span><span class="p">:</span> <span class="n">HANDSHAKE</span><span class="p">,</span> <span class="n">DATAENCRYPT</span>
<span class="n">Key</span> <span class="n">Type</span><span class="p">:</span> <span class="n">RSA</span>
<span class="n">Key</span> <span class="n">Size</span><span class="p">:</span> <span class="mi">1024</span>
<span class="n">Private</span> <span class="n">Key</span><span class="p">:</span> <span class="n">YES</span>
<span class="n">Ring</span> <span class="n">Associations</span><span class="p">:</span>
<span class="n">Ring</span> <span class="n">Owner</span><span class="p">:</span> <span class="n">SPVIRSTC</span>
<span class="n">Ring</span><span class="p">:</span>
    <span class="o">&gt;</span><span class="n">VIRTRING</span><span class="o">&lt;</span>
</pre></div>
</div>
<p>Similar details can be found in the browser settings. For example here is what Chrome displays in the HTTPS/SSL certificate database.</p>
<p><img alt="image18" src="../../../_images/image187.png" /></p>
</div>
<div class="section" id="types-of-certificates">
<h5>Types of certificates<a class="headerlink" href="#types-of-certificates" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><p>Client certificate</p></li>
<li><p>Server certificate</p></li>
<li><p>Well-known Certificate Authority (CA) Signing certificate</p></li>
<li><p>RACF signing certificate</p></li>
</ul>
<p>In this configuration we will be using self-signed server and client certificates. In most installation you would use server and client certificates signed by a well-known CA. These well-known CA certificates are normally available in the RACF and browser key data bases.</p>
</div>
<div class="section" id="configuring-the-certificates">
<h5>Configuring the certificates<a class="headerlink" href="#configuring-the-certificates" title="Permalink to this headline">¶</a></h5>
<p>The first step is to create the necessary certificates. We require a server certificate, a RACF signing certificate and a user certificate. In the Virtel SAMPLIB there is a member called SSLSETUP. This will initialize the SSL environment and create the RACF signing certificate. Some of the steps may or may not be relevant so you will need to customize SSLSETUP accordingly. For example, you might already be running the PAGENT started task and have RACF definitions in place to support the required SSL access. The following is the certificate generation statement for the RACF signing certificate.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">DCERTCA</span> <span class="n">EXEC</span> <span class="n">PGM</span><span class="o">=</span><span class="n">IKJEFT01</span>
<span class="o">//</span><span class="n">SYSTSPRT</span> <span class="n">DD</span> <span class="n">SYSOUT</span><span class="o">=*</span>
<span class="o">//</span><span class="n">SYSTSIN</span> <span class="n">DD</span> <span class="o">*</span>
<span class="o">/*-----------------------------------------------------------------*/</span>
<span class="o">/*</span> <span class="n">Delete</span> <span class="n">previous</span> <span class="n">signing</span> <span class="n">certificate</span> <span class="o">*/</span>
<span class="o">/*-----------------------------------------------------------------*/</span>
<span class="n">RACDCERT</span> <span class="n">CERTAUTH</span> <span class="o">+</span>
<span class="n">DELETE</span><span class="p">(</span><span class="n">LABEL</span><span class="p">(</span><span class="s1">&#39;z/OS signing certificate&#39;</span><span class="p">))</span>
<span class="o">//*----------------------------------------------------------------*</span>
<span class="o">//*</span> <span class="n">CCERTCA</span> <span class="p">:</span> <span class="n">CREATE</span> <span class="n">SIGNING</span> <span class="n">CERTIFICATE</span> <span class="o">*</span>
<span class="o">//*----------------------------------------------------------------*</span>
<span class="o">//</span><span class="n">CCERTCA</span> <span class="n">EXEC</span> <span class="n">PGM</span><span class="o">=</span><span class="n">IKJEFT1A</span>
<span class="o">//</span><span class="n">SYSTSPRT</span> <span class="n">DD</span> <span class="n">SYSOUT</span><span class="o">=*</span>
<span class="o">//</span><span class="n">SYSTSIN</span> <span class="n">DD</span> <span class="o">*</span>
<span class="o">/*-----------------------------------------------------------------*/</span>
<span class="o">/*</span> <span class="n">Create</span> <span class="n">a</span> <span class="n">signing</span> <span class="n">certificate</span> <span class="o">*/</span>
<span class="o">/*-----------------------------------------------------------------*/</span>
<span class="n">RACDCERT</span> <span class="n">CERTAUTH</span> <span class="o">+</span>
<span class="n">GENCERT</span> <span class="o">+</span>
<span class="n">WITHLABEL</span><span class="p">(</span><span class="s1">&#39;z/OS signing certificate&#39;</span><span class="p">)</span> <span class="o">+</span>
<span class="n">SUBJECTSDN</span><span class="p">(</span> <span class="o">+</span>
<span class="n">CN</span><span class="p">(</span><span class="s1">&#39;z/OS Security Server&#39;</span><span class="p">)</span> <span class="o">+</span>
<span class="n">O</span><span class="p">(</span><span class="s1">&#39;SYSPERTEC&#39;</span><span class="p">)</span> <span class="o">+</span>
<span class="n">C</span><span class="p">(</span><span class="s1">&#39;FR&#39;</span><span class="p">))</span> <span class="o">+</span>
<span class="n">KEYUSAGE</span><span class="p">(</span><span class="n">CERTSIGN</span><span class="p">)</span> <span class="n">SIZE</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span> <span class="o">+</span>
<span class="n">NOTAFTER</span><span class="p">(</span><span class="n">DATE</span><span class="p">(</span><span class="mi">2026</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">30</span><span class="p">))</span>
</pre></div>
</div>
<p>If we list the certificate after we have created it will get the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">READY</span>
<span class="n">RACDCERT</span> <span class="n">CERTAUTH</span> <span class="n">LIST</span><span class="p">(</span><span class="n">LABEL</span><span class="p">(</span><span class="s1">&#39;z/OS signing certificate&#39;</span><span class="p">))</span>
<span class="n">Digital</span> <span class="n">certificate</span> <span class="n">information</span> <span class="k">for</span> <span class="n">CERTAUTH</span><span class="p">:</span>
<span class="n">Label</span><span class="p">:</span> <span class="n">z</span><span class="o">/</span><span class="n">OS</span> <span class="n">signing</span> <span class="n">certificate</span>
<span class="n">Certificate</span> <span class="n">ID</span><span class="p">:</span> <span class="mi">2</span><span class="n">QiJmZmDhZmjgalh1uJAoomHlYmVh0CDhZmjiYaJg4GjhUBA</span>
<span class="n">Status</span><span class="p">:</span> <span class="n">TRUST</span>
<span class="n">Start</span> <span class="n">Date</span><span class="p">:</span> <span class="mi">2013</span><span class="o">/</span><span class="mi">07</span><span class="o">/</span><span class="mi">03</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
<span class="n">End</span> <span class="n">Date</span><span class="p">:</span> <span class="mi">2026</span><span class="o">/</span><span class="mi">06</span><span class="o">/</span><span class="mi">30</span> <span class="mi">23</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mi">59</span>
<span class="n">Serial</span> <span class="n">Number</span><span class="p">:</span>
    <span class="o">&gt;</span><span class="mi">00</span><span class="o">&lt;</span>
<span class="n">Issuer</span><span class="s1">&#39;s Name:</span>
    <span class="o">&gt;</span><span class="n">CN</span><span class="o">=</span><span class="n">z</span><span class="o">/</span><span class="n">OS</span> <span class="n">Security</span> <span class="n">Server</span><span class="o">.</span><span class="n">O</span><span class="o">=</span><span class="n">SYSPERTEC</span><span class="o">.</span><span class="n">C</span><span class="o">=</span><span class="n">FR</span><span class="o">&lt;</span>
<span class="n">Subject</span><span class="s1">&#39;s Name:</span>
    <span class="o">&gt;</span><span class="n">CN</span><span class="o">=</span><span class="n">z</span><span class="o">/</span><span class="n">OS</span> <span class="n">Security</span> <span class="n">Server</span><span class="o">.</span><span class="n">O</span><span class="o">=</span><span class="n">SYSPERTEC</span><span class="o">.</span><span class="n">C</span><span class="o">=</span><span class="n">FR</span><span class="o">&lt;</span>
<span class="n">Key</span> <span class="n">Usage</span><span class="p">:</span> <span class="n">CERTSIGN</span>    <span class="o">&lt;&lt;&lt;</span>
<span class="n">Key</span> <span class="n">Type</span><span class="p">:</span> <span class="n">RSA</span>
<span class="n">Key</span> <span class="n">Size</span><span class="p">:</span> <span class="mi">1024</span>
<span class="n">Private</span> <span class="n">Key</span><span class="p">:</span> <span class="n">YES</span>
<span class="n">Ring</span> <span class="n">Associations</span><span class="p">:</span>
<span class="n">Ring</span> <span class="n">Owner</span><span class="p">:</span> <span class="n">SPVIRSTC</span>
<span class="n">Ring</span><span class="p">:</span>
    <span class="o">&gt;</span><span class="n">VIRTRING</span><span class="o">&lt;</span>
</pre></div>
</div>
<p>The key usage identifies this certificate as a signing certificate. This certificate will be used to sign other certificates that we generate. Next is the server certificate. Again we use RACF to generate the certificate and use the RACF signing certificate to “sign” it. The following extract is from the Virtel SAMPLIB member SSLUCERT.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">CCERTIF</span> <span class="n">EXEC</span> <span class="n">PGM</span><span class="o">=</span><span class="n">IKJEFT1A</span>
<span class="o">//</span><span class="n">SYSTSPRT</span> <span class="n">DD</span> <span class="n">SYSOUT</span><span class="o">=*</span>
<span class="o">//</span><span class="n">SYSTSIN</span> <span class="n">DD</span> <span class="o">*</span>
<span class="o">/*-----------------------------------------------------------------*/</span>
<span class="o">/*</span> <span class="n">Create</span> <span class="n">a</span> <span class="n">digital</span> <span class="n">certificate</span> <span class="o">*/</span>
<span class="o">/*-----------------------------------------------------------------*/</span>
<span class="n">RACDCERT</span> <span class="n">ID</span><span class="p">(</span><span class="n">SPVIRSTC</span><span class="p">)</span> <span class="o">/*</span> <span class="n">VIRTEL</span> <span class="n">userid</span> <span class="o">*/</span> <span class="o">+</span>
<span class="n">GENCERT</span> <span class="o">+</span>
<span class="n">WITHLABEL</span><span class="p">(</span><span class="s1">&#39;VIRTEL SSL DEMO&#39;</span><span class="p">)</span> <span class="o">+</span>
<span class="n">SIGNWITH</span><span class="p">(</span><span class="n">CERTAUTH</span> <span class="n">LABEL</span><span class="p">(</span><span class="s1">&#39;z/OS signing certificate&#39;</span><span class="p">))</span> <span class="o">+</span>     <span class="o">&lt;&lt;&lt;&lt;</span>
<span class="n">SUBJECTSDN</span><span class="p">(</span> <span class="o">+</span>
<span class="n">CN</span><span class="p">(</span><span class="s1">&#39;RECETTE VIRTEL&#39;</span><span class="p">)</span> <span class="o">+</span>
<span class="n">T</span><span class="p">(</span><span class="s1">&#39;VIRTEL Web Access&#39;</span><span class="p">)</span> <span class="o">+</span>
<span class="n">O</span><span class="p">(</span><span class="s1">&#39;SYSPERTEC&#39;</span><span class="p">)</span> <span class="o">+</span>
<span class="n">C</span><span class="p">(</span><span class="s1">&#39;FR&#39;</span><span class="p">))</span> <span class="o">+</span>
<span class="n">KEYUSAGE</span><span class="p">(</span><span class="n">HANDSHAKE</span> <span class="n">DATAENCRYPT</span><span class="p">)</span> <span class="n">SIZE</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</pre></div>
</div>
<p>Note how we identify the signing certificate with the SIGNWITH parameter using the same label information that we used when defining the RACF signing certificate.</p>
</div>
</div>
<div class="section" id="cerificates-and-key-rings">
<h4>Cerificates and Key rings<a class="headerlink" href="#cerificates-and-key-rings" title="Permalink to this headline">¶</a></h4>
<p>Having generated two of our certificates we now need a place to keep them. We place the certificates on a key ring and associate the key ring with the VIRTEL server RACF user id (in our case SPVIRSTC). The member SSLSETUP has some RACF commands to perform the key ring generation. Here is an extract:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*-----------------------------------------------------------------*/</span>
<span class="o">/*</span> <span class="n">Create</span> <span class="n">a</span> <span class="n">keyring</span> <span class="o">*/</span>
<span class="o">/*-----------------------------------------------------------------*/</span>
<span class="n">RACDCERT</span> <span class="n">ID</span><span class="p">(</span><span class="n">SPVIRSTC</span><span class="p">)</span> <span class="o">/*</span> <span class="n">VIRTEL</span> <span class="n">userid</span> <span class="o">*/</span> <span class="o">+</span>
<span class="n">ADDRING</span><span class="p">(</span><span class="n">VIRTRING</span><span class="p">)</span>
<span class="o">/*-----------------------------------------------------------------*/</span>
<span class="o">/*</span> <span class="n">Add</span> <span class="n">the</span> <span class="n">certificate</span> <span class="n">to</span> <span class="n">the</span> <span class="n">keyring</span> <span class="o">*/</span>
<span class="o">/*-----------------------------------------------------------------*/</span>
<span class="n">RACDCERT</span> <span class="n">ID</span><span class="p">(</span><span class="n">SPVIRSTC</span><span class="p">)</span> <span class="o">/*</span> <span class="n">VIRTEL</span> <span class="n">userid</span> <span class="o">*/</span> <span class="o">+</span>
<span class="n">CONNECT</span><span class="p">(</span> <span class="o">+</span>
<span class="n">ID</span><span class="p">(</span><span class="n">SPVIRSTC</span><span class="p">)</span> <span class="o">+</span>
<span class="n">LABEL</span><span class="p">(</span><span class="s1">&#39;VIRTEL SSL DEMO&#39;</span><span class="p">)</span> <span class="o">+</span>
<span class="n">RING</span><span class="p">(</span><span class="n">VIRTRING</span><span class="p">)</span> <span class="o">+</span>
<span class="n">DEFAULT</span><span class="p">)</span>
</pre></div>
</div>
<p>Again it is the label that identifies the key(certificate) that we want to add to the key ring owned by user SPVIRSTC.</p>
<div class="section" id="user-certificate">
<h5>User Certificate<a class="headerlink" href="#user-certificate" title="Permalink to this headline">¶</a></h5>
<p>The next step is to create a user certificate which we will export and import into our browser’s key data base. In the Virtel SAMPLIB member SSLUCERT performs the task of creating the user certificate and creating an “exportable” file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//*----------------------------------------------------------------*</span>
<span class="o">//*</span> <span class="n">Associate</span> <span class="n">certificate</span> <span class="k">with</span> <span class="n">user</span> <span class="nb">id</span> <span class="o">*</span>
<span class="o">//*----------------------------------------------------------------*</span>
<span class="o">//</span><span class="n">UCERTIF</span> <span class="n">EXEC</span> <span class="n">PGM</span><span class="o">=</span><span class="n">IKJEFT1A</span>
<span class="o">//</span><span class="n">SYSTSPRT</span> <span class="n">DD</span> <span class="n">SYSOUT</span><span class="o">=*</span>
<span class="o">//</span><span class="n">SYSTSIN</span> <span class="n">DD</span> <span class="o">*</span>
<span class="o">/*-----------------------------------------------------------------*/</span>
<span class="o">/*</span> <span class="n">Add</span> <span class="n">certificate</span> <span class="n">to</span> <span class="n">Server</span> <span class="n">ring</span> <span class="o">*/</span>
<span class="o">/*-----------------------------------------------------------------*/</span>
<span class="n">RACDCERT</span> <span class="n">ID</span><span class="p">(</span><span class="n">SPVIRSTC</span><span class="p">)</span> <span class="o">/*</span> <span class="n">client</span> <span class="n">userid</span> <span class="o">*/</span> <span class="o">+</span>
<span class="n">CONNECT</span> <span class="p">(</span><span class="n">CERTAUTH</span> <span class="o">+</span>
<span class="n">LABEL</span><span class="p">(</span><span class="s1">&#39;z/OS signing certificate&#39;</span><span class="p">)</span> <span class="o">+</span>
<span class="n">RING</span><span class="p">(</span><span class="n">VIRTRING</span><span class="p">)</span> <span class="o">+</span>
<span class="n">USAGE</span><span class="p">(</span><span class="n">CERTAUTH</span><span class="p">))</span>
<span class="o">/*-----------------------------------------------------------------*/</span>
<span class="o">/*</span> <span class="n">Add</span> <span class="n">certificate</span> <span class="n">to</span> <span class="n">Server</span> <span class="n">ring</span> <span class="o">*/</span>
<span class="o">/*-----------------------------------------------------------------*/</span>
<span class="n">RACDCERT</span> <span class="n">ID</span><span class="p">(</span><span class="n">SPVIRSTC</span><span class="p">)</span> <span class="o">/*</span> <span class="n">client</span> <span class="n">userid</span> <span class="o">*/</span> <span class="o">+</span>
<span class="n">CONNECT</span> <span class="p">(</span><span class="n">ID</span><span class="p">(</span><span class="n">SPTHOLT</span><span class="p">)</span> <span class="o">+</span>
<span class="n">LABEL</span><span class="p">(</span><span class="s1">&#39;SSL client certificate&#39;</span><span class="p">)</span> <span class="o">+</span>
<span class="n">RING</span><span class="p">(</span><span class="n">VIRTRING</span><span class="p">)</span> <span class="o">+</span>
<span class="n">USAGE</span><span class="p">(</span><span class="n">CERTAUTH</span><span class="p">))</span>
<span class="o">/*-----------------------------------------------------------------*/</span>
<span class="o">/*</span> <span class="n">Refresh</span> <span class="n">the</span> <span class="n">RACF</span> <span class="n">profiles</span> <span class="o">*/</span>
<span class="o">/*-----------------------------------------------------------------*/</span>
<span class="n">SETROPTS</span> <span class="n">RACLIST</span><span class="p">(</span><span class="n">DIGTRING</span><span class="p">)</span> <span class="n">REFRESH</span>
<span class="n">SETROPTS</span> <span class="n">RACLIST</span><span class="p">(</span><span class="n">DIGTCERT</span><span class="p">)</span> <span class="n">REFRESH</span>
</pre></div>
</div>
<p>The “CONNECT CERTAUTH” tells RACF that this is a signing CA certificate and the “CONNECT ID(SPTHOLT) indicates that the certificate labelled ‘SSL client certificate’ is associated with USERID SPTHOLT. This is how Virtel obtains the USERID. Also, note that we refresh the RACF profiles related to certificates and key rings. If we list our key ring for user SPVIRSTC we should have three certificates.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">READY</span>
<span class="n">RACDCERT</span> <span class="n">ID</span><span class="p">(</span><span class="n">SPVIRSTC</span><span class="p">)</span> <span class="n">LISTRING</span><span class="p">(</span><span class="n">VIRTRING</span><span class="p">)</span>
<span class="n">Digital</span> <span class="n">ring</span> <span class="n">information</span> <span class="k">for</span> <span class="n">user</span> <span class="n">SPVIRSTC</span><span class="p">:</span>
<span class="n">Ring</span><span class="p">:</span>
    <span class="o">&gt;</span><span class="n">VIRTRING</span><span class="o">&lt;</span>
<span class="n">Certificate</span>         <span class="n">Label</span>   <span class="n">Name</span>    <span class="n">Cert</span> <span class="n">Owner</span>     <span class="n">USAGE</span>        <span class="n">DEFAULT</span>
<span class="o">--------------------------------</span>    <span class="o">------------</span>   <span class="o">--------</span>     <span class="o">-------</span>
<span class="n">VIRTEL</span> <span class="n">SSL</span>          <span class="n">DEMO</span>            <span class="n">ID</span><span class="p">(</span><span class="n">SPVIRSTC</span><span class="p">)</span>   <span class="n">PERSONAL</span>     <span class="n">YES</span>
<span class="n">z</span><span class="o">/</span><span class="n">OS</span> <span class="n">signing</span> <span class="n">certificate</span>            <span class="n">CERTAUTH</span>       <span class="n">CERTAUTH</span>     <span class="n">NO</span>
<span class="n">SSL</span> <span class="n">client</span> <span class="n">certificate</span>              <span class="n">ID</span><span class="p">(</span><span class="n">SPTHOLT</span><span class="p">)</span>    <span class="n">CERTAUTH</span>     <span class="n">NO</span>
</pre></div>
</div>
</div>
<div class="section" id="importing-the-certificate-on-the-client-work-station">
<h5>Importing the certificate on the client work station.<a class="headerlink" href="#importing-the-certificate-on-the-client-work-station" title="Permalink to this headline">¶</a></h5>
<p>To import the user certificate into the client workstation the P12 file must be downloaded in binary and then the
certificate import wizard is run to import the certificate.</p>
<p><img alt="image19" src="../../../_images/image1910.png" /></p>
<p>After importing the following panel is displayed:</p>
<p><img alt="image20" src="../../../_images/image2010.png" /></p>
<p>At this stage we have completed our certificate generation. Through the use of the certificates we will be able to initiate a secure session (https) with an application and obtain a user id.</p>
</div>
</div>
<div class="section" id="passticket-support">
<h4>PassTicket support<a class="headerlink" href="#passticket-support" title="Permalink to this headline">¶</a></h4>
<p>The next step is to obtain a pass ticket in place of a password so that Virtel can log on to the target application and present a user id and password combination on behalf of the user. The following job will enable PassTicket support for our target application SPCICSH and using user id SPVIRSTC, out Virtel server user id. This job will have to be customized
accordingly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">STEP1</span> <span class="n">EXEC</span> <span class="n">PGM</span><span class="o">=</span><span class="n">IKJEFT1A</span><span class="p">,</span><span class="n">DYNAMNBR</span><span class="o">=</span><span class="mi">20</span>
<span class="o">//*</span> <span class="n">RDEFINE</span> <span class="n">FACILITY</span> <span class="n">IRR</span><span class="o">.</span><span class="n">RTICKETSERV</span>
<span class="o">//</span><span class="n">SYSTSPRT</span> <span class="n">DD</span> <span class="n">SYSOUT</span><span class="o">=*</span>
<span class="o">//</span><span class="n">SYSTSIN</span> <span class="n">DD</span> <span class="o">*</span>
 <span class="n">SETROPTS</span> <span class="n">CLASSACT</span><span class="p">(</span><span class="n">APPL</span><span class="p">)</span>
 <span class="n">SETROPTS</span> <span class="n">CLASSACT</span><span class="p">(</span><span class="n">PTKTDATA</span><span class="p">)</span>
 <span class="n">SETROPTS</span> <span class="n">RACLIST</span><span class="p">(</span><span class="n">PTKTDATA</span><span class="p">)</span>
 <span class="n">SETROPTS</span> <span class="n">GENERIC</span><span class="p">(</span><span class="n">PTKTDATA</span><span class="p">)</span>
 <span class="n">RDELETE</span> <span class="n">PTKTDATA</span> <span class="n">SPCICSH</span>
 <span class="n">RDELETE</span> <span class="n">PTKTDATA</span> <span class="n">IRRPTAUTH</span><span class="o">.</span><span class="n">SPCICSH</span><span class="o">.*</span>
 <span class="n">RDEFINE</span> <span class="n">PTKTDATA</span> <span class="n">IRRPTAUTH</span><span class="o">.</span><span class="n">SPCICSH</span><span class="o">.*</span> <span class="n">UACC</span><span class="p">(</span><span class="n">NONE</span><span class="p">)</span>
 <span class="n">RDEFINE</span> <span class="n">PTKTDATA</span> <span class="n">SPCICSH</span> <span class="n">SSIGNON</span><span class="p">(</span><span class="n">KEYMASKED</span><span class="p">(</span><span class="mi">998</span><span class="n">A654FEBCDA123</span><span class="p">))</span> <span class="o">+</span>    <span class="o">&lt;&lt;&lt;</span>
 <span class="n">UACC</span><span class="p">(</span><span class="n">NONE</span><span class="p">)</span>
<span class="o">//</span><span class="n">STEP1</span> <span class="n">EXEC</span> <span class="n">PGM</span><span class="o">=</span><span class="n">IKJEFT1A</span><span class="p">,</span><span class="n">DYNAMNBR</span><span class="o">=</span><span class="mi">20</span>
<span class="o">//</span><span class="n">SYSTSPRT</span> <span class="n">DD</span> <span class="n">SYSOUT</span><span class="o">=*</span>
<span class="o">//</span><span class="n">SYSTSIN</span> <span class="n">DD</span> <span class="o">*</span>
 <span class="n">PERMIT</span> <span class="n">IRR</span><span class="o">.</span><span class="n">RTICKETSERV</span> <span class="n">CL</span><span class="p">(</span><span class="n">FACILITY</span><span class="p">)</span> <span class="n">ID</span><span class="p">(</span><span class="n">SPVIRSTC</span><span class="p">)</span> <span class="n">ACC</span><span class="p">(</span><span class="n">READ</span><span class="p">)</span>            <span class="o">&lt;&lt;&lt;</span>
 <span class="n">PERMIT</span> <span class="n">IRRPTAUTH</span><span class="o">.</span><span class="n">SPCICSH</span><span class="o">.*</span> <span class="n">CL</span><span class="p">(</span><span class="n">PTKTDATA</span><span class="p">)</span> <span class="n">ID</span><span class="p">(</span><span class="n">SPVIRSTC</span><span class="p">)</span> <span class="n">ACC</span><span class="p">(</span><span class="n">UPDATE</span><span class="p">)</span>
 <span class="n">SETROPTS</span> <span class="n">REFRESH</span> <span class="n">RACLIST</span><span class="p">(</span><span class="n">PTKTDATA</span><span class="p">)</span>
 <span class="n">SETROPTS</span> <span class="n">REFRESH</span> <span class="n">RACLIST</span><span class="p">(</span><span class="n">FACILITY</span><span class="p">)</span>
</pre></div>
</div>
<p>In order for Virtel to generate PassTickets, you must also modify your VIRTCT to include the parameter PASSTCK=YES and then reassemble the VIRTCT. See chapter 6 of the Virtel Installation Guide for more details on the Virtel VIRTCT.</p>
</div>
<div class="section" id="pagent-configuration">
<h4>PAGENT Configuration<a class="headerlink" href="#pagent-configuration" title="Permalink to this headline">¶</a></h4>
<p>To enable system SSL sessions to take place between the browser and the application we have to tell AT-TLS and SSL which sockets to intercept. This is configured in the pagent configuration file which can be found in /etc/pagent.conf. The two areas that we are interested in are the TTLSEnvironmentAction section and the TTLSRule section.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TTLSEnvironmentAction</span> <span class="n">VIRTELenvir_inSec</span>
<span class="p">{</span>
    <span class="n">HandshakeRole</span> <span class="n">ServerWithClientAuth</span>
    <span class="n">Trace</span> <span class="mi">7</span>
    <span class="n">TTLSKeyringParms</span>
    <span class="p">{</span>
        <span class="n">Keyring</span> <span class="n">VIRTRING</span>
    <span class="p">}</span>
    <span class="n">TTLSEnvironmentAdvancedParms</span>
    <span class="p">{</span>
        <span class="n">SSLv2</span> <span class="n">On</span>
        <span class="n">SSLv3</span> <span class="n">On</span>
        <span class="n">TLSv1</span> <span class="n">On</span>
        <span class="n">ClientAuthType</span> <span class="n">SAFCheck</span>
    <span class="p">}</span>
    <span class="n">TTLSCipherParmsRef</span> <span class="n">VIRTELcipher</span>
<span class="p">}</span>

<span class="o">....</span>

<span class="n">TTLSRule</span> <span class="n">VIRTELrule_in_eh</span>
<span class="p">{</span>
    <span class="n">Jobname</span> <span class="n">SPVIREH</span>
    <span class="n">LocalPortRange</span> <span class="mi">41002</span>
    <span class="n">Direction</span> <span class="n">Inbound</span>
    <span class="n">TTLSGroupActionRef</span> <span class="n">VIRTELgroup</span>
    <span class="n">TTLSEnvironmentActionRef</span> <span class="n">VIRTELenvir_inSec</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The TTLS Rule identifies Virtel Started task name via the Jobname parameter and also the port number that can support secured sessions _ https. In this case it is port 41002.</p>
<p>The rules section also identifies the environmental section. In this case we have selected an environment section called VIRTELenvir_insec.</p>
<p>In VIRTELenvir_insec we identify that we want to use both server and client certificates:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HandShakeRole</span>   <span class="n">ServerWithClientAuth</span>
</pre></div>
</div>
<p>That the user certificate must be associated with a valid RACF userid:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ClientAuthType</span>  <span class="n">SAFCheck</span>
</pre></div>
</div>
<p>The name of the keyring that holds the keys(certificates):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Keyring</span>     <span class="n">VIRTRING</span>
</pre></div>
</div>
<p>A default pagent.conf is shipped with the SAMPLIB member SSLSETUP which you can use to modify accordingly to define the above SSL sections. To refresh a pagent.conf profile after
you have made changes you can issue the following z/OS command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="n">PAGENT</span><span class="p">,</span><span class="n">REFRESH</span>
</pre></div>
</div>
</div>
<div class="section" id="configuring-virtel-cics-example">
<h4>Configuring Virtel - CICS Example<a class="headerlink" href="#configuring-virtel-cics-example" title="Permalink to this headline">¶</a></h4>
<p>The final part in our configuration is to configure Virtel to use SSL to obtain the user id and PassTicket support to create a password. We configure Virtel in the transaction associated with our target application, in this case the CICS application called SPCICSH.</p>
<p><img alt="image21" src="../../../_images/image2121.png" /></p>
<p><em>Note that PassTicket is set to 2.</em> This will enable Virtel to generate a temporary password. Security is set to 3. This indicates that Virtel will receive a USERID based upon the user certificate used in the authentication process. The TIOA at logon is a string that will logon to the CICS application using the user id and password values that Virtel has
obtained.</p>
<p>With this configuration we can logon to our CICS application without the user presenting any user id or password. This is very much like the Express Logon Facility implemented in our Telnet clients.</p>
<div class="section" id="logon-example">
<h5>Logon Example<a class="headerlink" href="#logon-example" title="Permalink to this headline">¶</a></h5>
<p>In the following screen shots we demonstrate logging into a CICS application via a secure session (https) without specifying any user id/password. Our initial URL is <a class="reference external" href="https://192.168.170.30:41002/w2h/WEB2AJAX.htm+CICS">https://192.168.170.30:41002/w2h/WEB2AJAX.htm+CICS</a>; you will replace the IP address with your own installation IP address or domain name.</p>
<p><img alt="image22" src="../../../_images/image2219.png" /></p>
<p>We are presented with a « Select a certificate » window from the browser requesting the certificate we wish to user for authenication purposes. We select the certificate we downloaded. The next panel is a warning panel which identifes that the certificate we are using has not been authenticated by a well-known CA authority. We are of course aware of this as we are using a RACF self signed certifcate.</p>
<p><img alt="image23" src="../../../_images/image2312.png" /></p>
<p>We select Advanced and are then presented with information about the certificate.</p>
<p><img alt="image24" src="../../../_images/image2410.png" /></p>
<p>We select the “Proceed” link.</p>
<p><img alt="image25" src="../../../_images/image2510.png" /></p>
<p>We are signed into CICS without having to specify any user id or password.</p>
</div>
</div>
<div class="section" id="at-tls-problems">
<h4>AT-TLS Problems<a class="headerlink" href="#at-tls-problems" title="Permalink to this headline">¶</a></h4>
<p>It is easy to miss something when configuring user certificate sign on. Here are some general guidelines that should help in debugging configuration errors.</p>
<ol class="arabic simple">
<li><p>Is AT-TLS active.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Issue the following z/OS command – D TCPIP,,N,TTLS
The response should be :
    EZD0101I NETSTAT CS V1R13 TCPIP 706
    TTLSGRPACTION GROUP ID CONNS
    VIRTELGROUP 00000002 3
    1 OF 1 RECORDS DISPLAYED
    END OF THE REPORT
</pre></div>
</div>
<dl class="simple">
<dt>2   PAGENT return codes.</dt><dd><p>Common session startup/handshake errors are reported through messqge EZD1287I. In the example below we can see that the handshake has failed with a return code of 5003. Return codes under 5000 are generated by System SSL and are defined in the System SSL Programming manual. Return codes over 5000 are generated by AT-TLS and are defined in the IP Diagnosis Guide. In the following the 5013 suggests that the browser has sent clear text; in other words, http was used instead of https in the URL.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BPXF024I</span> <span class="p">(</span><span class="n">TCPIP</span><span class="p">)</span> <span class="n">Oct</span> <span class="mi">7</span> <span class="mi">13</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mi">08</span> <span class="n">TTLS</span> <span class="mi">83951769</span> <span class="p">:</span> <span class="mi">15</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mi">08</span> <span class="n">TCPIP</span> <span class="mi">367</span>
<span class="n">EZD1281I</span> <span class="n">TTLS</span> <span class="n">Map</span> <span class="n">CONNID</span><span class="p">:</span> <span class="mi">000006</span><span class="n">A2</span> <span class="n">LOCAL</span><span class="p">:</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">170.30</span><span class="o">..</span><span class="mi">41002</span>
<span class="n">REMOTE</span><span class="p">:</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">92.62</span><span class="o">..</span><span class="mi">57545</span> <span class="n">JOBNAME</span><span class="p">:</span> <span class="n">SPVIREH</span> <span class="n">USERID</span><span class="p">:</span> <span class="n">SPVIRSTC</span> <span class="n">TYPE</span><span class="p">:</span>
<span class="n">InBound</span> <span class="n">STATUS</span><span class="p">:</span> <span class="n">Enabled</span> <span class="n">RULE</span><span class="p">:</span> <span class="n">VIRTELrule_in_eh</span> <span class="n">ACTIONS</span><span class="p">:</span> <span class="n">VIRTELgroup</span>
<span class="n">VIRTELenvir_inSec</span> <span class="o">**</span><span class="n">N</span><span class="o">/</span><span class="n">A</span><span class="o">**</span>
<span class="n">BPXF024I</span> <span class="p">(</span><span class="n">TCPIP</span><span class="p">)</span> <span class="n">Oct</span> <span class="mi">7</span> <span class="mi">13</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mi">08</span> <span class="n">TTLS</span> <span class="mi">83951769</span> <span class="p">:</span> <span class="mi">15</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mi">08</span> <span class="n">TCPIP</span> <span class="mi">368</span>
<span class="n">EZD1286I</span> <span class="n">TTLS</span> <span class="n">Error</span> <span class="n">GRPID</span><span class="p">:</span> <span class="mi">00000002</span> <span class="n">ENVID</span><span class="p">:</span> <span class="mi">00000000</span> <span class="n">CONNID</span><span class="p">:</span> <span class="mi">000006</span><span class="n">A2</span>
<span class="n">LOCAL</span><span class="p">:</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">170.30</span><span class="o">..</span><span class="mi">41002</span>
<span class="n">REMOTE</span><span class="p">:</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">92.62</span><span class="o">..</span><span class="mi">57545</span>
<span class="n">JOBNAME</span><span class="p">:</span> <span class="n">SPVIREH</span> <span class="n">USERID</span><span class="p">:</span> <span class="n">SPVIRSTC</span>
<span class="n">RULE</span><span class="p">:</span> <span class="n">VIRTELrule_in_eh</span>
<span class="n">RC</span><span class="p">:</span> <span class="mi">5003</span> <span class="n">Data</span> <span class="n">Decryption</span> <span class="n">EZD1287I</span> <span class="n">TTLS</span> <span class="n">Error</span> <span class="n">RC</span><span class="p">:</span> <span class="mi">5003</span> <span class="n">Data</span> <span class="n">Decryption</span> <span class="mi">369</span>   <span class="o">&lt;&lt;&lt;&lt;</span>
<span class="n">LOCAL</span><span class="p">:</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">170.30</span><span class="o">..</span><span class="mi">41002</span>
<span class="n">REMOTE</span><span class="p">:</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">92.62</span><span class="o">..</span><span class="mi">57545</span>
<span class="n">JOBNAME</span><span class="p">:</span> <span class="n">SPVIREH</span> <span class="n">RULE</span><span class="p">:</span>
<span class="n">VIRTELrule_in_eh</span> <span class="n">USERID</span><span class="p">:</span>
<span class="n">SPVIRSTC</span> <span class="n">GRPID</span><span class="p">:</span> <span class="mi">00000002</span>
<span class="n">ENVID</span><span class="p">:</span> <span class="mi">00000000</span>
<span class="n">CONNID</span><span class="p">:</span> <span class="mi">000006</span><span class="n">A2</span>
</pre></div>
</div>
<dl class="simple">
<dt>Common PAGENT return codes:</dt><dd><ul class="simple">
<li><p>7 No certificate</p></li>
<li><p>8 Certificate not trusted</p></li>
<li><p>109 No certification authority certificates</p></li>
<li><p>202 Keyring does not exist</p></li>
<li><p>401 Certificate expired or not yet valid</p></li>
<li><p>402 or 412 Client and server cannot agree on cipher suite</p></li>
<li><p>416 VIRTEL does not have permission to list the keyring</p></li>
<li><p>431 Certificate is revoked</p></li>
<li><p>434 Certificate key not compatible with cipher suite</p></li>
<li><p>435 Certificate authority unknown</p></li>
<li><p>5003 Browser sent clear text (http instead of https)</p></li>
</ul>
</dd>
</dl>
<p>3   Virtel messages</p>
<blockquote>
<div><p><strong>VIRHT57E LINE IS NOT SET UP FOR HTTPS</strong></p>
<p>This means that the browser has sent encypted text (https) but that AT-TLS has not decrypted it before sending it to VIRTEL. The PAGENT rules haven’t correctly identified this port as a SSL jobname/port. Check the /etc/pagent.conf member. The message is a bit misleading as there is no line setup required by Virtel.</p>
<p>Normally AT-TLS is transparent to VIRTEL. AT-TLS performs the decryption and transforms the https request into an http request before passing it to VIRTEL. The only case where VIRTEL is AT-TLS aware is when the VIRTEL transaction definition specifies SECURITY=3 (TLS) and in this case VIRTEL will check that the session has been processed by AT-TLS and will issue an IOCTL to obtain the userid associated with the certificate.</p>
<p>In the normal case, you should specify HandshakeRole Server, ClientAuthType Full, and ApplicationControlled Off in the AT-TLS rules, as in the example in VIRT447.SAMPLIB(SSLSETUP). VIRTEL does not issue an IOCTL to turn decryption on and off, so if you specified ApplicationControlled On then you would get VIRHT57E because AT-TLS has not been instructed to start decryption.</p>
<p>If you still get an error when you have ApplicationControlled Off then we will need to see the SYSLOG (for the EZD TTLS messages), the JESMSGLG from the VIRTEL started task, and the SYSPRINT resulting from a z/OS command F VIRTEL,SNAP immediately after the error occurs. We would also like to see the exact URL which was entered at the browser, as well as the AT-TLS pagent.conf file.</p>
</div></blockquote>
</div>
<div class="section" id="references">
<h4>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h4>
<div class="section" id="z-os-ibm-references">
<h5>z/OS IBM References<a class="headerlink" href="#z-os-ibm-references" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><p>SA22-7683-07 z/OS V1R7 Security Server: RACF Security Administrator’s Guide Chapter 21. RACF and Digital Certificates</p></li>
<li><p>SC24-5901-04 z/OS V1R6 Cryptographic Services: System SSL Programming Chapter 12. Messages and Codes</p></li>
<li><p>SC31-8775-07 z/OS V1R7 Communications Server: IP Configuration Guide Chapter 14. Policy-based networking Chapter 18. Application Transparent Transport Layer Security (AT-TLS) data protection</p></li>
<li><p>SC31-8776-08 z/OS V1R7 Communications Server: IP Configuration Reference Chapter 21. Policy Agent and policy applications</p></li>
<li><p>GC31-8782-06 z/OS V1R7 Communications Server: IP Diagnosis Guide Chapter 28. Diagnosing Application Transparent Transport Layer Security (AT-TLS)</p></li>
<li><p>SC31-8784-05 z/OS V1R7 Communications Server: IP Messages: Volume 2 (EZB, EZD) Chapter 10. EZD1xxxx messages</p></li>
</ul>
</div>
<div class="section" id="virtel-references">
<h5>Virtel References<a class="headerlink" href="#virtel-references" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><p>VIRTEL Installation Guide PASSTCK parameter</p></li>
<li><p>VIRTEL Connectivity Reference Transactions – PassTicket Parameter / Transactions – Security Parameter</p></li>
<li><p>VIRTEL Web Access Guide Security – Data encryption by SSL</p></li>
</ul>
</div>
</div>
</div>
<div class="section" id="ntlm-support">
<h3>NTLM Support<a class="headerlink" href="#ntlm-support" title="Permalink to this headline">¶</a></h3>
<p>Windows Integrated Authentication allows a users’ Active Directory credentials to pass through their browser to a web server. The NTLM support is automatically activated whenever the Virtel transaction invoked is defined with type 2 security (NTLM). The NTLM support allows to retrieve the Windows userid but NOT the associated password. It could be therefore appropriate to complete the signon process by obtaining a password using a PASSTICKET request. Windows Integrated Authentication is enabled by default for Internet Explorer but not necessarily for Google Chrome or Mozilla Firefox. Users who use the non-Microsoft browsers will receive a pop-up box to enter their Mainframe credentials before continuing to the Virtel Web Access website. In an effort to make this process as easy as possible for end-users and if the Mainframe and Active Directory userid are the same it could be efficient to enable Windows Integrated Authentication for the browser. This can be done with Chrome and Firefox with a few additional steps.</p>
<div class="section" id="enable-windows-integrated-authentication-for-internet-exmplorer">
<h4>Enable Windows Integrated Authentication for Internet Exmplorer<a class="headerlink" href="#enable-windows-integrated-authentication-for-internet-exmplorer" title="Permalink to this headline">¶</a></h4>
<div class="section" id="for-internet-explorer-11">
<h5>For Internet Explorer 11<a class="headerlink" href="#for-internet-explorer-11" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><p>Open Internet Explorer and select “Tools” Pull-down menu,</p></li>
<li><p>Select the “Internet Option” line,</p></li>
<li><p>In the opened Pop Up window, select the “Advanced” tab,</p></li>
<li><p>Scroll down to the “Security” section until you see “Enable Integrated Windows Authentication”. Select the box next to this field to enable,</p></li>
<li><p>Select the “Security” tab,</p></li>
<li><p>Select the “Local Intranet Area”,</p></li>
<li><p>Add the web server address (DNS or IP address) to the list.</p></li>
</ul>
</div>
</div>
<div class="section" id="enable-windows-integrated-authentication-for-google-chrome">
<h4>Enable Windows Integrated Authentication for Google Chrome<a class="headerlink" href="#enable-windows-integrated-authentication-for-google-chrome" title="Permalink to this headline">¶</a></h4>
<p>The latest version of Chrome uses existing Internet Explorer settings, but older version require additional configurations (see below). You can use three methods to enable Chrome to use Windows Integrated Authentication.Your options are the command line, editing the registry, or using ADMX templates through group policy. If you choose to use the command line or edit the registry, you could use Group Policy Preferences to distribute those changes on a broader scale. Each of these three methods achieve the same results for configuring Google Chrome for Windows Integrated Authentication. Below are the steps for the three methods:</p>
<p><strong>To use the command line to configure Google Chrome.</strong></p>
<p>Start Chrome with the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Chrome.exe  –auth-server-whitelist=”MyVirtel.Domain.Name”
            –auth-negotiate-delegatewhitelist=”MyVirtel.Domain.Name”
            –auth-schemes=”digest,ntlm,negotiate”
</pre></div>
</div>
<div class="section" id="to-modify-the-registry-to-configure-google-chrome">
<h5>To modify the registry to configure Google Chrome<a class="headerlink" href="#to-modify-the-registry-to-configure-google-chrome" title="Permalink to this headline">¶</a></h5>
<p>Configure the following registry settings with the corresponding values:</p>
<p>Registry AuthSchemes</p>
<ul class="simple">
<li><p>Data type: String (REG_SZ)</p></li>
<li><p>Windows registry location: SoftwarePoliciesGoogleChromeAuthSchemes</p></li>
<li><p>Mac/Linux preference name: AuthSchemes</p></li>
<li><p>Supported on: Google Chrome (Linux, Mac, Windows) since version 9</p></li>
<li><p>Supported features: Dynamic Policy Refresh: No, Per Profile: No</p></li>
<li><p>Description: Specifies which HTTP Authentication schemes are supported by Google Chrome. Possible values are ‘basic’, ‘digest’, ‘ntlm’ and ‘negotiate’. Separate multiple values with commas. If this policy is left not set, all four schemes will be used.</p></li>
<li><p>Value: “basic,digest,ntlm,negotiate”</p></li>
</ul>
<p>AuthServerWhitelist</p>
<ul class="simple">
<li><p>Data type: String (REG_SZ)</p></li>
<li><p>Windows registry location: SoftwarePoliciesGoogleChromeAuthServerWhitelist</p></li>
<li><p>Mac/Linux preference name: AuthServerWhitelist</p></li>
<li><p>Supported on: Google Chrome (Linux, Mac, Windows) since version 9</p></li>
<li><p>Supported features: Dynamic Policy Refresh: No, Per Profile: No</p></li>
<li><p>Description: Specifies which servers should be whitelisted for integrated authentication. Integrated authentication is only enabled when Google Chrome receives an authentication challenge from a proxy or from a server which is in this permitted list. Separate multiple server names with commas. Wildcards (*) are allowed. If you leave this policy not set Chrome will try to detect if a server is on the Intranet and only then will it respond to IWA requests. If a server is detected as Internet then IWA requests from it will be ignored by Chrome.</p></li>
<li><p>Value: “MyVirtel.Domain.Name”</p></li>
</ul>
<p>AuthNegotiateDelegateWhitelist</p>
<ul class="simple">
<li><p>Data type: String (REG_SZ)</p></li>
<li><p>Windows registry location: SoftwarePoliciesGoogleChromeAuthNegotiateDelegateWhitelist</p></li>
<li><p>Mac/Linux preference name: AuthServerWhitelist</p></li>
<li><p>Supported on: Google Chrome (Linux, Mac, Windows) since version 9</p></li>
<li><p>Supported features: Dynamic Policy Refresh: No, Per Profile: No</p></li>
<li><p>Description: Servers that Google Chrome may delegate to. Separate multiple server names with commas. Wildcards (*) are allowed. If you leave this policy not set Chrome will not delegate user credentials even if a server is detected as Intranet.</p></li>
<li><p>Value: “MyVirtel.Domain.Name”</p></li>
</ul>
<p>To use ADM/ADMX templates through Group Policy to configure Google Chrome:</p>
<ul class="simple">
<li><p>Download Zip file of ADM/ADMX templates and documentation from: <a class="reference external" href="http://www.chromium.org/administrators/">http://www.chromium.org/administrators/</a> policy-templates,</p></li>
<li><p>Add the ADMX template to your central store, if you are using a central store,</p></li>
<li><p>Configure a GPO with your application server DNS host name with Kerberos Delegation Server Whitelist and Authentication Server Whitelist enabled.</p></li>
</ul>
</div>
</div>
<div class="section" id="enable-windows-integrated-authentication-for-mozilla-firefox">
<h4>Enable Windows Integrated Authentication for Mozilla Firefox<a class="headerlink" href="#enable-windows-integrated-authentication-for-mozilla-firefox" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>Open Firefox,</p></li>
<li><p>In the address bar type <a class="reference external" href="about:config">about:config</a></p></li>
<li><p>In the opened Pop Up window, select the “Advanced” tab,</p></li>
<li><p>You will receive a security warning. To continue, click “I’ll be careful, I promise”,</p></li>
<li><p>You will see a list of preferences listed. Find the settings below by browsing through the list or searching for them in the search box. Once you have located each setting, update the value to the following:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Setting</span> <span class="n">Value</span>

    <span class="n">network</span><span class="o">.</span><span class="n">automatic</span><span class="o">-</span><span class="n">ntlm</span><span class="o">-</span><span class="n">auth</span><span class="o">.</span><span class="n">trusted</span><span class="o">-</span><span class="n">uris</span> <span class="n">MyVirtel</span><span class="o">.</span><span class="n">Domain</span><span class="o">.</span><span class="n">Name</span>

    <span class="n">network</span><span class="o">.</span><span class="n">automatic</span><span class="o">-</span><span class="n">ntlm</span><span class="o">-</span><span class="n">auth</span><span class="o">.</span><span class="n">allow</span><span class="o">-</span><span class="n">proxies</span> <span class="kc">True</span>

    <span class="n">network</span><span class="o">.</span><span class="n">negotiate</span><span class="o">-</span><span class="n">auth</span><span class="o">.</span><span class="n">allow</span><span class="o">-</span><span class="n">proxies</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h4>Problem determination<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<div class="section" id="still-receiving-login-prompt">
<h5>Still receiving login prompt<a class="headerlink" href="#still-receiving-login-prompt" title="Permalink to this headline">¶</a></h5>
<p>If you still continue to receive logon prompt, please check your configuration. Most common error are:</p>
<ul class="simple">
<li><p>The accessed server is not listed in the NTLM trusted uris section (Local Intranet Area for Internet Explorer).</p></li>
<li><p>The invoked Virtel transaction is not defined with security = 2.</p></li>
</ul>
</div>
</div>
</div>
</div>
<div class="section" id="system-management">
<h2>System Management<a class="headerlink" href="#system-management" title="Permalink to this headline">¶</a></h2>
<div class="section" id="suppress-messages-from-syslog">
<h3>Suppress Messages From SYSLOG<a class="headerlink" href="#suppress-messages-from-syslog" title="Permalink to this headline">¶</a></h3>
<p>By default, the system messages prefixed by VIR issued by VIRTEL and the messages issued from the scenarios are written both in the STC SYSOUT or the JOB as well as on the system console. If certain messages prefixed by VIR can be deleted using the parameter (or command line) SILENCE of the VIRTCT, it may sometimes be necessary to stop the
message issuance to SYSLOG or restrict their diffusion to another direction. From Virtel 4.54 (not available until 2015/Q1) the LOG feature enables the VIRTEL log to be spun off to JES2. Setting up VIRTEL to use the LOG sysout facility requires a change to the TCT definition to direct WTOs to a SYSOUT dataset. In the TCT code the following statement:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LOG</span><span class="o">=</span><span class="p">(</span><span class="n">SYSOUT</span><span class="p">,</span><span class="n">class</span><span class="p">,</span><span class="n">destination</span><span class="p">)</span>
</pre></div>
</div>
<p>For example, <em>LOG=(SYSOUT,A,EDSPRT)</em> directs all WTOs to a SYSOUT dataset rather than the system console log (SYSLOG). If you want WTO messages going to both the system console and a SYSOUT dataset then issue the following VIRTEL command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="n">VIRTEL</span><span class="p">,</span><span class="n">LOG</span><span class="o">=</span><span class="n">BOTH</span>
</pre></div>
</div>
<p>The LOG feature in Virtel 4.54 is controlled by the TCT parameters and a new LOG command. The new LOG command has the following format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="n">VIRTEL</span><span class="p">,</span><span class="n">LOG</span><span class="o">=</span><span class="n">CONSOLE</span> <span class="o">|</span> <span class="n">SYSOUT</span> <span class="o">|</span> <span class="n">BOTH</span> <span class="o">|</span> <span class="n">SPIN</span> <span class="n">Default</span><span class="o">=</span><span class="n">CONSOLE</span>
</pre></div>
</div>
<p><strong>LOG</strong></p>
<p>The following parameters are available:</p>
<ul class="simple">
<li><p>CONSOLE: Routes all WTO message to the system console. This is the default action.</p></li>
<li><p>SYSOUT : Routes all WTO messages to a VIRTEL SYSOUT dataset which is dynamically allocated.</p></li>
<li><p>BOTH : Routes all WTO messages to both the system console and a dynamically allocated SYSOUT dataset.</p></li>
<li><p>SPIN : Forces Virtel to release the current SYSOUT dataset for further processing and allocates a new SYSOUT dataset.</p></li>
</ul>
<p>Virtel will direct messages to an allocated SYSOUT data set and | or the console (default). If SYSOUT processing is being used you will see a dynamically allocated dataset in the SDSF display panel named SYSnnnnn. You can spin this dataset off using the Virtel command LOG=SPIN . VIRTEL will release the SYSOUT dataset from JES2 and allocate a new one.</p>
<p>Once the LOG command activated, only the following messages will be displayed at the SYSLOG during startup process :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">15.20</span><span class="o">.</span><span class="mi">18</span> <span class="n">STC07592</span> <span class="n">VIR0096I</span> <span class="n">VIRTEL</span> <span class="n">IS</span> <span class="n">USING</span> <span class="n">VIRTCT</span> <span class="s1">&#39;VIRTCTDO&#39;</span>
<span class="mf">15.20</span><span class="o">.</span><span class="mi">18</span> <span class="n">STC07592</span> <span class="n">VIR0000I</span> <span class="n">STARTING</span> <span class="n">LICENCE</span> <span class="n">SPVIRDOC</span><span class="o">-</span><span class="n">VIRTEL</span><span class="o">-</span><span class="n">A20191231</span> <span class="p">(</span><span class="mi">2019</span> <span class="o">-</span> <span class="mi">12</span> <span class="o">-</span> <span class="mi">31</span><span class="p">)</span>
<span class="mf">15.20</span><span class="o">.</span><span class="mi">18</span> <span class="n">STC07592</span> <span class="n">VIR0019I</span> <span class="n">VIRTEL</span> <span class="mf">4.57</span> <span class="n">HAS</span> <span class="n">NO</span> <span class="n">PTFS</span> <span class="n">APPLIED</span>
<span class="mf">15.20</span><span class="o">.</span><span class="mi">18</span> <span class="n">STC07592</span> <span class="n">VIR0089I</span> <span class="n">VIRTEL</span> <span class="n">RUNNING</span> <span class="n">FROM</span> <span class="n">AN</span> <span class="n">AUTHORIZED</span> <span class="n">LIBRARY</span>
<span class="mf">15.20</span><span class="o">.</span><span class="mi">18</span> <span class="n">STC07592</span> <span class="n">VIR0860I</span> <span class="n">VIRTEL</span> <span class="n">IS</span> <span class="n">USING</span> <span class="n">RACROUTE</span> <span class="n">SECURITY</span>
<span class="mf">15.20</span><span class="o">.</span><span class="mi">18</span> <span class="n">STC07592</span> <span class="n">VIR0861I</span> <span class="n">MIXED</span><span class="o">-</span><span class="n">CASE</span> <span class="n">PASSWORD</span> <span class="n">SUPPORT</span> <span class="n">IS</span> <span class="n">ACTIVE</span>
<span class="mf">15.20</span><span class="o">.</span><span class="mi">18</span> <span class="n">STC07592</span> <span class="n">VSV0207I</span> <span class="n">VIRSV</span> <span class="n">V3R3</span> <span class="n">STARTED</span>
<span class="mf">15.20</span><span class="o">.</span><span class="mi">19</span> <span class="n">STC07592</span> <span class="n">VIR0093I</span> <span class="n">VTAM</span> <span class="n">GENERIC</span> <span class="n">RESOURCE</span> <span class="n">NAME</span> <span class="n">IS</span> <span class="n">ABOVE</span>
<span class="mf">15.20</span><span class="o">.</span><span class="mi">19</span> <span class="n">STC07592</span> <span class="n">VIR0024I</span> <span class="n">OPENING</span> <span class="n">FILE</span> <span class="n">VIRARBO</span>
<span class="mf">15.20</span><span class="o">.</span><span class="mi">19</span> <span class="n">STC07592</span> <span class="n">VIR0024I</span> <span class="n">OPENING</span> <span class="n">FILE</span> <span class="n">VIRSWAP</span>
<span class="mf">15.20</span><span class="o">.</span><span class="mi">19</span> <span class="n">STC07592</span> <span class="n">VIR0024I</span> <span class="n">OPENING</span> <span class="n">FILE</span> <span class="n">VIRHTML</span>
<span class="mf">15.20</span><span class="o">.</span><span class="mi">20</span> <span class="n">STC07592</span> <span class="n">VIR0024I</span> <span class="n">OPENING</span> <span class="n">FILE</span> <span class="n">HTMLTRSF</span>
<span class="mf">15.20</span><span class="o">.</span><span class="mi">20</span> <span class="n">STC07592</span> <span class="n">VIR0024I</span> <span class="n">OPENING</span> <span class="n">FILE</span> <span class="n">SAMPTRSF</span>
<span class="mf">15.20</span><span class="o">.</span><span class="mi">20</span> <span class="n">STC07592</span> <span class="n">VIR0024I</span> <span class="n">OPENING</span> <span class="n">FILE</span> <span class="n">VIRHTML</span>
<span class="mf">15.20</span><span class="o">.</span><span class="mi">20</span> <span class="n">STC07592</span> <span class="n">VIR0024I</span> <span class="n">OPENING</span> <span class="n">FILE</span> <span class="n">CUSTRSF</span>
<span class="mf">15.20</span><span class="o">.</span><span class="mi">20</span> <span class="n">STC07592</span> <span class="n">VIR0024I</span> <span class="n">ATTACHING</span> <span class="n">SUBTASKS</span>
<span class="mf">15.20</span><span class="o">.</span><span class="mi">21</span> <span class="n">STC07592</span> <span class="n">VIR0000I</span> <span class="n">THIS</span> <span class="n">COPY</span> <span class="n">OF</span> <span class="n">VIRTEL</span> <span class="n">IS</span> <span class="n">FOR</span> <span class="n">THE</span> <span class="n">EXCLUSIVE</span> <span class="n">USE</span> <span class="n">OF</span><span class="p">:</span>
<span class="mf">15.20</span><span class="o">.</span><span class="mi">21</span> <span class="n">STC07592</span> <span class="n">VIR0000I</span> <span class="n">SYSPERTEC</span> <span class="n">COMMUNICATION</span>
<span class="mf">15.20</span><span class="o">.</span><span class="mi">21</span> <span class="n">STC07592</span> <span class="n">VIR0000I</span> <span class="mi">196</span> <span class="n">BUREAUX</span> <span class="n">DE</span> <span class="n">LA</span> <span class="n">COLLINE</span>
<span class="mf">15.20</span><span class="o">.</span><span class="mi">21</span> <span class="n">STC07592</span> <span class="n">VIR0000I</span> <span class="mi">92213</span> <span class="n">SAINT</span> <span class="n">CLOUD</span> <span class="n">CEDEX</span>
<span class="mf">15.20</span><span class="o">.</span><span class="mi">21</span> <span class="n">STC07592</span> <span class="n">VIR0000I</span> <span class="n">HTTP</span> <span class="n">Date</span><span class="p">:</span> <span class="n">Thu</span><span class="p">,</span> <span class="mi">10</span> <span class="n">Aug</span> <span class="mi">2017</span> <span class="mi">13</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">21</span> <span class="n">GMT</span>
<span class="mf">15.20</span><span class="o">.</span><span class="mi">21</span> <span class="n">STC07592</span> <span class="n">VIR0000I</span> <span class="n">SMTP</span> <span class="n">Date</span><span class="p">:</span> <span class="n">Thu</span><span class="p">,</span> <span class="mi">10</span> <span class="n">Aug</span> <span class="mi">2017</span> <span class="mi">14</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">21</span> <span class="o">+</span><span class="mi">0100</span>
<span class="mf">15.20</span><span class="o">.</span><span class="mi">21</span> <span class="n">STC07592</span> <span class="n">VIR0900I</span> <span class="n">LICENCE</span> <span class="n">SPVIRDOC</span><span class="o">-</span><span class="n">VIRTEL</span><span class="o">-</span><span class="n">A20191231</span> <span class="p">(</span><span class="mi">2019</span> <span class="o">-</span> <span class="mi">12</span> <span class="o">-</span> <span class="mi">31</span><span class="p">)</span>
<span class="mf">15.20</span><span class="o">.</span><span class="mi">21</span> <span class="n">STC07592</span> <span class="n">VIR0099I</span> <span class="n">SPVIRDOC</span> <span class="n">STARTED</span> <span class="n">AT</span> <span class="mi">10</span><span class="o">/</span><span class="mi">08</span><span class="o">/</span><span class="mi">17</span> <span class="mi">14</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">21</span> <span class="p">,</span> <span class="n">VERSION</span> <span class="mf">4.57</span>
</pre></div>
</div>
<p>The display of message VIR0099I requires the PTF 5530 be applied. Similarly the following messages will be displayed at the SYSLOG during shutdown process:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">15.21</span><span class="o">.</span><span class="mi">48</span> <span class="n">STC07592</span> <span class="n">VIR0009I</span> <span class="n">SPVIRDOC</span> <span class="p">:</span> <span class="n">SHUT</span> <span class="n">DOWN</span> <span class="n">IN</span> <span class="n">PROGRESS</span>
<span class="mf">15.21</span><span class="o">.</span><span class="mi">48</span> <span class="n">STC07592</span> <span class="n">VIR0024I</span> <span class="n">CLOSING</span> <span class="n">FILE</span> <span class="n">VIRARBO</span>
<span class="mf">15.21</span><span class="o">.</span><span class="mi">49</span> <span class="n">STC07592</span> <span class="n">VIR0024I</span> <span class="n">CLOSING</span> <span class="n">FILE</span> <span class="n">VIRSWAP</span>
<span class="mf">15.21</span><span class="o">.</span><span class="mi">49</span> <span class="n">STC07592</span> <span class="n">VIR0024I</span> <span class="n">CLOSING</span> <span class="n">FILE</span> <span class="n">VIRHTML</span>
<span class="mf">15.21</span><span class="o">.</span><span class="mi">49</span> <span class="n">STC07592</span> <span class="n">VIR0024I</span> <span class="n">CLOSING</span> <span class="n">FILE</span> <span class="n">HTMLTRSF</span>
<span class="mf">15.21</span><span class="o">.</span><span class="mi">49</span> <span class="n">STC07592</span> <span class="n">VIR0024I</span> <span class="n">CLOSING</span> <span class="n">FILE</span> <span class="n">SAMPTRSF</span>
<span class="mf">15.21</span><span class="o">.</span><span class="mi">49</span> <span class="n">STC07592</span> <span class="n">VIR0024I</span> <span class="n">CLOSING</span> <span class="n">FILE</span> <span class="n">VIRHTML</span>
<span class="mf">15.21</span><span class="o">.</span><span class="mi">49</span> <span class="n">STC07592</span> <span class="n">VIR0024I</span> <span class="n">CLOSING</span> <span class="n">FILE</span> <span class="n">CUSTRSF</span>
<span class="mf">15.21</span><span class="o">.</span><span class="mi">49</span> <span class="n">STC07592</span> <span class="n">VIR0026W</span> <span class="n">HTTP</span><span class="o">-</span><span class="n">CLI</span> <span class="n">OPEN</span> <span class="n">SESSION</span> <span class="mi">00000000</span> <span class="o">-</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">170.046</span><span class="p">:</span><span class="mi">41002</span>
<span class="mf">15.21</span><span class="o">.</span><span class="mi">49</span> <span class="n">STC07592</span> <span class="n">VIRT922W</span> <span class="n">HTTP</span><span class="o">-</span><span class="n">CLI</span> <span class="n">SOCKET</span> <span class="mi">00000000</span> <span class="n">ENDED</span> <span class="n">FOR</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">170.046</span><span class="p">:</span><span class="mi">41002</span>
<span class="mf">15.21</span><span class="o">.</span><span class="mi">49</span> <span class="n">STC07592</span> <span class="n">VIR0026W</span> <span class="n">HTTP</span><span class="o">-</span><span class="n">W2H</span> <span class="n">OPEN</span> <span class="n">SESSION</span> <span class="mi">00000000</span> <span class="o">-</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">170.046</span><span class="p">:</span><span class="mi">41001</span>
<span class="mf">15.21</span><span class="o">.</span><span class="mi">49</span> <span class="n">STC07592</span> <span class="n">VIRT922W</span> <span class="n">HTTP</span><span class="o">-</span><span class="n">W2H</span> <span class="n">SOCKET</span> <span class="mi">00000000</span> <span class="n">ENDED</span> <span class="n">FOR</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">170.046</span><span class="p">:</span><span class="mi">41001</span>
<span class="mf">15.21</span><span class="o">.</span><span class="mi">49</span> <span class="n">STC07592</span> <span class="n">VIR0006I</span> <span class="n">CLOSING</span> <span class="n">ACBS</span>
<span class="mf">15.21</span><span class="o">.</span><span class="mi">49</span> <span class="n">STC07592</span> <span class="n">VIR0006I</span> <span class="n">DETACHING</span> <span class="n">CONSOLE</span> <span class="n">SUBTASK</span>
<span class="mf">15.21</span><span class="o">.</span><span class="mi">49</span> <span class="n">STC07592</span> <span class="n">VIR0233I</span> <span class="n">VIRTEL</span> <span class="n">SYSOUT</span> <span class="n">DATASET</span> <span class="n">HAS</span> <span class="n">BEEN</span> <span class="n">SPUN</span> <span class="n">OFF</span>
<span class="mf">15.21</span><span class="o">.</span><span class="mi">49</span> <span class="n">STC07592</span> <span class="n">VIR0006I</span> <span class="n">DETACHING</span> <span class="n">LOADER</span> <span class="n">SUBTASK</span>
<span class="mf">15.21</span><span class="o">.</span><span class="mi">49</span> <span class="n">STC07592</span> <span class="n">VIR0006I</span> <span class="n">DETACHING</span> <span class="n">VSAM</span> <span class="n">SUBTASK</span>
<span class="mf">15.21</span><span class="o">.</span><span class="mi">49</span> <span class="n">STC07592</span> <span class="n">VIR0006I</span> <span class="n">DETACHING</span> <span class="n">STATISTICS</span> <span class="n">SUBTASK</span>
<span class="mf">15.21</span><span class="o">.</span><span class="mi">49</span> <span class="n">STC07592</span> <span class="n">VIR0006I</span> <span class="n">CLOSING</span> <span class="n">VIRSV</span>
<span class="mf">15.21</span><span class="o">.</span><span class="mi">50</span> <span class="n">STC07592</span> <span class="n">VIR0003I</span> <span class="n">SPVIRDOC</span> <span class="n">ENDED</span>
</pre></div>
</div>
</div>
<div class="section" id="virconf-usage">
<h3>VIRCONF Usage<a class="headerlink" href="#virconf-usage" title="Permalink to this headline">¶</a></h3>
<p>VIRCONF is a batch facilty you can use to add, update or delete definition strored in the ARBO file.</p>
<p><strong>VIRCONF does not open the ARBO for output.</strong></p>
<p>If you run VIRCONF when Virtel is active you can get IEC161I error messages. The reason for this error is that the VIRCONF program requires an exclusive control on the ARBO file and following the performance improvements through the introduction of VSAM LSR the VIRCONF is no longer able to access the ARBO VSAM file when VIRTEL is running. To avoid this problem a new feature was added to V4.56 which enables a VIRCONF UNLOAD through an operator command :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="n">virtel</span><span class="p">,</span><span class="n">unload</span>
</pre></div>
</div>
<p>This command invokes the VIRCONF program which unloads the ARBO file. The following DD statement must be added to the Virtel procedure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">SYSPUNCH</span> <span class="n">DD</span> <span class="n">DSN</span><span class="o">=</span><span class="n">SP000</span><span class="o">.</span><span class="n">VIRTELxx</span><span class="o">.</span><span class="n">VIRCONF</span><span class="o">.</span><span class="n">SYSIN</span><span class="p">,</span><span class="n">DISP</span><span class="o">=</span><span class="p">(,</span><span class="n">CATLG</span><span class="p">),</span>
<span class="o">//</span> <span class="n">UNIT</span><span class="o">=</span><span class="n">SYSDA</span><span class="p">,</span><span class="n">VOL</span><span class="o">=</span><span class="n">SER</span><span class="o">=</span><span class="n">VVVVVV</span><span class="p">,</span><span class="n">SPACE</span><span class="o">=</span><span class="p">(</span><span class="n">TRK</span><span class="p">,(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span>
<span class="o">//</span> <span class="n">DCB</span><span class="o">=</span><span class="p">(</span><span class="n">RECFM</span><span class="o">=</span><span class="n">FB</span><span class="p">,</span><span class="n">LRECL</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span><span class="n">BLKSIZE</span><span class="o">=</span><span class="mi">6080</span><span class="p">)</span>
</pre></div>
</div>
<p>Or alternatively:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">SYSPUNCH</span> <span class="n">DD</span> <span class="n">SYSOUT</span><span class="o">=</span><span class="n">B</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="faq">
<h2>FAQ<a class="headerlink" href="#faq" title="Permalink to this headline">¶</a></h2>
<div class="section" id="how-to-use-the-tso-omvs-panel-command-with-vwa">
<h3>How to use the TSO OMVS panel command with VWA<a class="headerlink" href="#how-to-use-the-tso-omvs-panel-command-with-vwa" title="Permalink to this headline">¶</a></h3>
<p>TSO OMVS writes to the screen after 20 seconds changing the status from RUNNING to INPUT. This asynchronous nature forces Virtel to generate a HTML page which updates the whole screen, erasing any partially entered input field. Once the screen is in INPUT mode OMVS will not write to the screen in this ASYNC fashion anymore. The work around for this is to wait for the status change before entering any input. Alternatively you can put the screen into INPUT mode immediately by pressing F12=Retrieve, and then pressing Home and End to clear the input area.</p>
<p>Another solution is to use PuTTY to connect to the OMVS shell via rlogin to port 513. This solution avoids many of the other usability problems which are inherent in the OMVS shell.</p>
</div>
<div class="section" id="can-virtel-web-access-emulate-z-os-operator-consoles">
<h3>Can VIRTEL WEB ACCESS emulate z/OS Operator consoles<a class="headerlink" href="#can-virtel-web-access-emulate-z-os-operator-consoles" title="Permalink to this headline">¶</a></h3>
<p>Technically VIRTEL does not support the OSA-ICC console server because it is based on the tn3270 protocol which VIRTEL does not use. But in any case it probably would not make sense to put consoles under VIRTEL control because the consoles need to be operational during IPL before TCP/IP and VIRTEL are started. So we would expect customers to continue to run tn3270 emulators on those PCs which are used as z/OS operator consoles.</p>
</div>
<div class="section" id="can-i-customize-hotspot-recognition">
<h3>Can I customize hotspot recognition<a class="headerlink" href="#can-i-customize-hotspot-recognition" title="Permalink to this headline">¶</a></h3>
<p>The regular expressions which control hotspot recognition may be overridden by setting VIR3270.customPfKeysHotspotRegex and/or VIR3270.customUrlHotspotsRegex in a customized javascript member. For example, an application requires strings of the format “PFnn-caption” to be recognized as PF hotspots. The customized code in the javascript member would look like would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>function after_responseHandle(o, url, xtim) {
VIR3270.customPfKeysHotspotRegex = /(P?F\d{1,2}|PA[1-3]|ENTER|CLEAR)((?:\/P?F\d{1,2})?\s*[=:-])/;
}
</pre></div>
</div>
</div>
</div>
<div class="section" id="appendix">
<h2>Appendix<a class="headerlink" href="#appendix" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="trademarks">
<h2>Trademarks<a class="headerlink" href="#trademarks" title="Permalink to this headline">¶</a></h2>
<p>SysperTec, the SysperTec logo, syspertec.com and VIRTEL are trademarks or registered trademarks of SysperTec
Communication Group, registered in France and other countries.</p>
<p>IBM, VTAM, CICS, IMS, RACF, DB2, z/OS, WebSphere, MQSeries, System z are trademarks or registered trademarks of
International Business Machines Corp., registered in United States and other countries.</p>
<p>Adobe, Acrobat, PostScript and all Adobe-based trademarks are either registered trademarks or trademarks of Adobe
Systems Incorporated in the United States and other countries.</p>
<p>Microsoft, Windows, Windows NT, and the Windows logo are trademarks of Microsoft Corporation in the United States
and other countries.</p>
<p>UNIX is a registered trademark of The Open Group in the United States and other countries.
Java and all Java-based trademarks and logos are trademarks or registered trademarks of Oracle and/or its affiliates.</p>
<p>Linux is a trademark of Linus Torvalds in the United States, other countries, or both.</p>
<p>Other company, product, or service names may be trademarks or service names of others.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Virtel459IG/Installation_Guide.html" class="btn btn-neutral float-right" title="Installation Guide V4.59" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../Virtel459CN/connectivity_guide.html" class="btn btn-neutral float-left" title="Connectivity Reference V4.59" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Syspertec. All rights reserved

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>