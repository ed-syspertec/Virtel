

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Audit, Administration, Operations and Performance V4.60 &mdash; Virtel 9 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Connectivity Reference V4.60" href="../Virtel460CN/connectivity_guide.html" />
    <link rel="prev" title="User Guide V4.59" href="../Virtel459UG/User_Guide.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home" alt="Documentation Home"> Virtel
          

          
            
            <img src="../../../_static/logo_virtel_web.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                4.59
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../virtel.html">Virtel Manuals</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../virtel.html#v4-56">V4.56</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../virtel.html#v4-57">V4.57</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../virtel.html#v4-58">V4.58</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../virtel.html#v4-59">V4.59</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../virtel.html#v4-60">V4.60</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Audit, Administration, Operations and Performance V4.60</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#operations">Operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#administration">Administration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#performance">Performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="#audit">Audit</a></li>
<li class="toctree-l4"><a class="reference internal" href="#appendix">Appendix</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Virtel460CN/connectivity_guide.html">Connectivity Reference V4.60</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Virtel460CS/Customization.html">Customization Guide V4.60</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Virtel460GS/Getting_Started.html">Getting Started with Virtel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Virtel460IG/Installation_Guide.html">Installation Guide V4.60</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Virtel460MG/messages.html">Messages V4.60</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Virtel460MI/Migration_Guide.html">Migration Guide V4.60</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Virtel460UG/User_Guide.html">User Guide V4.60</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../newsletters.html">Technical Newsletters</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Virtel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../virtel.html">Virtel Manuals</a> &raquo;</li>
        
      <li>Audit, Administration, Operations and Performance V4.60</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/manuals/virtel/Virtel460AP/audit_operations_ and_performance.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="audit-administration-operations-and-performance-v4-60">
<span id="virtel460ap"></span><h1>Audit, Administration, Operations and Performance V4.60<a class="headerlink" href="#audit-administration-operations-and-performance-v4-60" title="Permalink to this headline">¶</a></h1>
<p><a class="reference internal" href="../../../_images/logo_virtel_web22.png"><img alt="imagelogo" src="../../../_images/logo_virtel_web22.png" style="width: 275.0px; height: 102.0px;" /></a></p>
<p><strong>VIRTEL Audit, Administration, Operations and Performance</strong></p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This is a draft version of the document.</p>
</div>
<p>Version : 4.60</p>
<p>Release Date : 11 Oct 2020. Publication Date : 25/11/2020</p>
<p>Syspertec Communication</p>
<p>196, Bureaux de la Colline 92213 Saint-Cloud Cedex Tél. : +33 (0) 1 46 02 60 42</p>
<p><a class="reference external" href="http://www.syspertec.com/">www.syspertec.com</a></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Reproduction, transfer, distribution, or storage, in any form, of all or any part of
the contents of this document, except by prior authorization of SysperTec
Communication, is prohibited.</p>
<p>Every possible effort has been made by SysperTec Communication to ensure that this document
is complete and relevant. In no case can SysperTec Communication be held responsible for
any damages, direct or indirect, caused by errors or omissions in this document.</p>
<p>As SysperTec Communication uses a continuous development methodology; the information
contained in this document may be subject to change without notice. Nothing in this
document should be construed in any manner as conferring a right to use, in whole or in
part, the products or trademarks quoted herein.</p>
<p class="last">“SysperTec Communication” and “VIRTEL” are registered trademarks. Names of other products
and companies mentioned in this document may be trademarks or registered trademarks of
their respective owners.</p>
</div>
<div class="section" id="operations">
<span id="v460ap-introduction"></span><h2>Operations<a class="headerlink" href="#operations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="commands">
<span id="index-0"></span><h3>Commands<a class="headerlink" href="#commands" title="Permalink to this headline">¶</a></h3>
<p>VIRTEL allows certain functions to be controlled dynamically by console commands. Use one of the following methods to send a command to VIRTEL, according to the operating system:</p>
<div class="section" id="z-os-environment">
<span id="index-1"></span><h4>z/OS Environment<a class="headerlink" href="#z-os-environment" title="Permalink to this headline">¶</a></h4>
<p>The following modify command may be issued at the z/OS operator console, or from an SDSF session under TSO, in which case the command must be prefixed by the character “/”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="n">stcvirte</span><span class="p">,</span><span class="n">virtel</span><span class="o">-</span><span class="n">command</span>
</pre></div>
</div>
<dl class="docutils">
<dt>stcvirte</dt>
<dd>the name of the VIRTEL started task STC</dd>
<dt>virtel-cmd</dt>
<dd>a VIRTEL command, as described in the following section.</dd>
</dl>
</div>
<div class="section" id="z-vse-environment">
<span id="index-2"></span><h4>z/VSE Environment<a class="headerlink" href="#z-vse-environment" title="Permalink to this headline">¶</a></h4>
<p>To send a command to VIRTEL, issue the following command at the VSE operator console:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MSG</span> <span class="n">virtel</span><span class="p">,</span><span class="n">DATA</span><span class="o">=</span><span class="n">cirtel</span><span class="o">-</span><span class="n">command</span>
</pre></div>
</div>
<dl class="docutils">
<dt>virtel</dt>
<dd>The VIRTEL jobname (usually VIRTEL), or the partition in which VIRTEL is executing (for example, F4)</dd>
<dt>virtel-cmd</dt>
<dd>A VIRTEL command, as described in the following section. Alternatively, issue the following command at the VSE operator console:</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MSG</span> <span class="n">Fx</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Fx</dt>
<dd><p class="first">Partition in which VIRTEL is executing</p>
<p class="last">The system responds with:</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AR</span> <span class="mi">0015</span> <span class="mi">1</span><span class="n">I40I</span> <span class="n">READY</span>
<span class="n">Fx</span><span class="o">-</span><span class="n">nnnnAR</span> <span class="mi">0015</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note the reply number (nnnn) and issue the following command:</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nnnn</span> <span class="n">virtel</span><span class="o">-</span><span class="n">cmd</span>
</pre></div>
</div>
<dl class="docutils">
<dt>nnnn</dt>
<dd>reply number</dd>
<dt>virtel-cmd</dt>
<dd>A VIRTEL command, as described in the following section</dd>
</dl>
</div>
</div>
<div class="section" id="kill-command">
<span id="index-3"></span><h3>KILL Command<a class="headerlink" href="#kill-command" title="Permalink to this headline">¶</a></h3>
<p>The KILL command can be used to stop a scenario.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">KILL</span><span class="p">,</span><span class="n">T</span><span class="o">=</span><span class="n">termid</span>
</pre></div>
</div>
<dl class="docutils">
<dt>termid</dt>
<dd>terminal name</dd>
</dl>
<p>The KILL command requests VIRTEL to abnormally terminate the scenario currently active on the specified terminal.</p>
</div>
<div class="section" id="lines-command">
<span id="index-4"></span><h3>LINES Command<a class="headerlink" href="#lines-command" title="Permalink to this headline">¶</a></h3>
<p>The LINES command can be used to display a summary of the line status.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LINES</span> <span class="o">|</span> <span class="n">LINES</span><span class="p">,</span><span class="n">ACT</span> <span class="o">|</span> <span class="n">LINES</span><span class="p">,</span><span class="n">INACT</span>
</pre></div>
</div>
<p>The LINES command displays the VIRTEL ACB name and a list of the lines defined in the VIRTEL configuration file. The optional keywords ACT or INACT may be used to restrict the display to lines that are in a “active” or “inactive” state respectively.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>F VIRTEL,LINES
VIR0200I LINES
VIR0201I VIRTEL 4.60 APPLID=VIRTEL  LINES
VIR0202I ALLOCATED IP ADDRESS = 192.168.170.047
VIR0202I INT.NAME EXT.NAME TYPE  ACB OR IP
VIR0202I -------- -------- ----- ---------
VIR0202I C-HTTP   HTTP-CLI TCP1  :41002
VIR0202I E-HTTP   HTTP-EDS TCP1  :41003
VIR0202I F-HTTP   HTTP-FOR TCP1  :41005
VIR0202I I-CONN   IVP1    *TCP1
VIR0202I LM01TX1  LM01TX1  /FAST UMEHTX1
VIR0202I O-HTTP   HTTP-OUT TCP1  £NONE£
VIR0202I P-PCLPDF PCL2PDF  TCP1  £NONE£
VIR0202I V-HTTP   HTTP-VSR TCP1  :41004
VIR0202I W-HTTP   HTTP-W2H TCP1  :41001
VIR0202I 9-XMPASS VIRTELXM*XM2   XM44000
VIR0202I 9-XMVTA  QLNKHOLT XM1   QLNKCICH
VIR0202I ---END OF LIST---
</pre></div>
</div>
</div>
<div class="section" id="line-command">
<span id="index-5"></span><h3>LINE Command<a class="headerlink" href="#line-command" title="Permalink to this headline">¶</a></h3>
<div class="section" id="display-line-detail">
<h4>Display line detail<a class="headerlink" href="#display-line-detail" title="Permalink to this headline">¶</a></h4>
<p>To display detail information about a Virtel line use the line detail command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LINE</span><span class="o">=</span><span class="n">linename</span><span class="p">,</span><span class="n">DISPLAY</span> <span class="p">(</span><span class="ow">or</span> <span class="n">L</span><span class="o">=</span><span class="n">linename</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>linename</dt>
<dd>Internal or external name of the line</dd>
</dl>
<p>The LINE DISPLAY command displays the status of a line and its associated terminals.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="n">VIRTEL</span><span class="p">,</span><span class="n">LINE</span><span class="o">=</span><span class="n">C</span><span class="o">-</span><span class="n">HTTP</span><span class="p">,</span><span class="n">D</span>
<span class="n">VIR0200I</span> <span class="n">LINE</span><span class="o">=</span><span class="n">C</span><span class="o">-</span><span class="n">HTTP</span><span class="p">,</span><span class="n">D</span>
<span class="n">VIR0207I</span> <span class="n">LINE</span> <span class="n">C</span><span class="o">-</span><span class="n">HTTP</span>   <span class="n">TCP1</span>  <span class="n">HTTP</span> <span class="n">STARTED</span>
<span class="n">VIR0203I</span> <span class="n">TERMINALS</span> <span class="n">ASSOCIATED</span> <span class="n">WITH</span> <span class="n">LINE</span> <span class="n">C</span><span class="o">-</span><span class="n">HTTP</span>
<span class="n">VIR0203I</span> <span class="n">TERMINAL</span> <span class="n">RELAY</span>    <span class="n">STATUS</span>
<span class="n">VIR0203I</span> <span class="o">--------</span> <span class="o">--------</span> <span class="o">--------</span>
<span class="n">VIR0203I</span> <span class="n">CLLOC000</span><span class="o">+</span>                              <span class="n">LINKED</span>
<span class="n">VIR0203I</span> <span class="n">CLLOC001</span>                               <span class="n">LINKED</span>
<span class="n">VIR0203I</span> <span class="n">CLLOC002</span>                               <span class="n">LINKED</span>
<span class="n">VIR0203I</span> <span class="n">CLLOC003</span>                               <span class="n">LINKED</span>
<span class="n">VIR0203I</span> <span class="n">CLLOC004</span>                               <span class="n">LINKED</span>
<span class="n">VIR0203I</span> <span class="n">CLLOC005</span>                               <span class="n">LINKED</span>
<span class="n">VIR0203I</span> <span class="n">CLLOC006</span>                               <span class="n">LINKED</span>
<span class="n">VIR0203I</span> <span class="n">CLLOC007</span>                               <span class="n">LINKED</span>
<span class="n">VIR0203I</span> <span class="n">CLLOC008</span>                               <span class="n">LINKED</span>
<span class="n">VIR0203I</span> <span class="n">CLLOC009</span>                               <span class="n">LINKED</span>
<span class="n">VIR0203I</span> <span class="n">CLVTA000</span> <span class="o">*</span><span class="n">W2HPOOL</span>                      <span class="n">LINKED</span>
<span class="n">VIR0203I</span> <span class="n">CLVTA001</span> <span class="o">*</span><span class="n">W2HPOOL</span>                      <span class="n">LINKED</span>
<span class="n">VIR0203I</span> <span class="n">CLVTA002</span> <span class="o">*</span><span class="n">W2HPOOL</span>                      <span class="n">LINKED</span>
<span class="n">VIR0203I</span> <span class="n">CLVTA003</span> <span class="o">*</span><span class="n">W2HPOOL</span>                      <span class="n">LINKED</span>
<span class="n">VIR0203I</span> <span class="n">CLVTA004</span> <span class="o">*</span><span class="n">W2HPOOL</span>                      <span class="n">LINKED</span>
<span class="n">VIR0203I</span> <span class="o">---</span><span class="n">END</span> <span class="n">OF</span> <span class="n">LIST</span><span class="o">---</span>
<span class="n">VIR0204I</span> <span class="n">TERMINALS</span> <span class="n">IN</span> <span class="n">POOL</span> <span class="o">*</span><span class="n">W2HPOOL</span>
<span class="n">VIR0204I</span> <span class="n">TERMINAL</span> <span class="n">RELAY</span>    <span class="n">PRINTER</span>  <span class="n">USED</span> <span class="n">BY</span>
<span class="n">VIR0204I</span> <span class="o">--------</span> <span class="o">--------</span> <span class="o">--------</span> <span class="o">--------</span>
<span class="n">VIR0204I</span> <span class="n">W2HTP000</span> <span class="n">REHVT000</span> <span class="n">REHIP000</span>
<span class="n">VIR0204I</span> <span class="n">W2HTP001</span> <span class="n">REHVT001</span> <span class="n">REHIP001</span>
<span class="n">VIR0204I</span> <span class="n">W2HTP002</span> <span class="n">REHVT002</span> <span class="n">REHIP002</span>
<span class="n">VIR0204I</span> <span class="n">W2HTP003</span> <span class="n">REHVT003</span> <span class="n">REHIP003</span>
<span class="n">VIR0204I</span> <span class="n">W2HTP004</span> <span class="n">REHVT004</span> <span class="n">REHIP004</span>
<span class="n">VIR0204I</span> <span class="o">---</span><span class="n">END</span> <span class="n">OF</span> <span class="n">LIST</span><span class="o">---</span>
</pre></div>
</div>
</div>
<div class="section" id="tracing-a-line">
<span id="index-6"></span><h4>Tracing a line<a class="headerlink" href="#tracing-a-line" title="Permalink to this headline">¶</a></h4>
<p>To activate or deactive a trace on the line the following command can be used:-:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LINE</span><span class="o">=</span><span class="n">linename</span><span class="p">,</span><span class="n">NOTRACE</span> <span class="o">|</span> <span class="n">TRACE</span>  <span class="p">[</span> <span class="ow">or</span> <span class="n">L</span><span class="o">=</span><span class="n">linename</span><span class="p">,</span><span class="n">N</span> <span class="o">|</span> <span class="n">T</span> <span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="starting-and-stopping-a-line">
<span id="index-7"></span><h4>Starting and Stopping A Line<a class="headerlink" href="#starting-and-stopping-a-line" title="Permalink to this headline">¶</a></h4>
<p>To STOP or START a line use the LINE command with the START or STOP function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LINE</span><span class="o">=</span><span class="n">linename</span><span class="p">,</span><span class="n">START</span> <span class="o">|</span> <span class="n">STOP</span>

<span class="n">OR</span>

<span class="n">L</span><span class="o">=</span><span class="n">linename</span><span class="p">,</span><span class="n">P</span> <span class="o">|</span> <span class="n">S</span>
</pre></div>
</div>
<dl class="docutils">
<dt>linename</dt>
<dd>Internal or external name of the line</dd>
</dl>
<p>The LINE START and LINE STOP commands perform the same function as the <a class="reference external" href="#_bookmark12">“S” and “P” commands</a> on the “Status of lines”. These commands may only be issued for line types AntiGATE, AntiPCNE, AntiFASTC, and TCP/IP.</p>
</div>
</div>
<div class="section" id="log-command">
<span id="index-8"></span><h3>LOG command<a class="headerlink" href="#log-command" title="Permalink to this headline">¶</a></h3>
<p>The LOG command enables the VIRTEL log to be spun off to the console, a JES2 output dataset , a dataset [new in V4.58]. The LOG command has the following format:-</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="n">VIRTEL</span><span class="p">,</span><span class="n">LOG</span><span class="o">=</span><span class="n">CONSOLE</span> <span class="o">|</span> <span class="n">SYSOUT</span> <span class="o">|</span> <span class="n">BOTH</span> <span class="o">|</span> <span class="n">SPIN</span> <span class="o">|</span> <span class="n">FILE</span>
</pre></div>
</div>
<p>where</p>
<blockquote>
<div><ul class="simple">
<li>CONSOLE means switch console messages back to the console.</li>
<li>SYSOUT means switch to spooling consoles messages to SYSOUT.</li>
<li>BOTH means write console messages to the console and SYSOUT.</li>
<li>SPIN means spin off the current SYSOUT dataset.</li>
<li>FILE means write messages to file.</li>
</ul>
</div></blockquote>
<div class="section" id="log-sysout-tct-definition">
<h4>LOG=SYSOUT TCT definition<a class="headerlink" href="#log-sysout-tct-definition" title="Permalink to this headline">¶</a></h4>
<p>Setting up VIRTEL to use the LOG=SYSOUT facility requires a change to the TCT definition to direct WTOs to a SYSOUT dataset. In the TCT code the following statement:-</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LOG</span><span class="o">=</span><span class="p">(</span><span class="n">SYSOUT</span><span class="p">[,</span><span class="n">class</span><span class="p">[,</span><span class="n">destination</span><span class="p">]])</span>

<span class="n">For</span> <span class="n">example</span><span class="p">,</span> <span class="n">LOG</span><span class="o">=</span><span class="p">(</span><span class="n">SYSOUT</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">EDSPRT</span><span class="p">)</span>
</pre></div>
</div>
<p>This directs all WTOs to a SYSOUT dataset rather than the system console log (SYSLOG). If you want WTO messages going to both the system console and a SYSOUT dataset than issue the following VIRTEL command:-</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="n">VIRTEL</span><span class="p">,</span><span class="n">LOG</span><span class="o">=</span><span class="n">BOTH</span>
</pre></div>
</div>
</div>
<div class="section" id="log-file-new-in-v4-58">
<h4>LOG=FILE [New in V4.58]<a class="headerlink" href="#log-file-new-in-v4-58" title="Permalink to this headline">¶</a></h4>
<p>Setting up Virtel to use the LOG=FILE facility requires a change to the TCT definition. In the TCT code the following statement:-</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LOG</span><span class="o">=</span><span class="n">FILE</span>
</pre></div>
</div>
<p>This will trigger the log program VIR0021A to write messages to either the VIRLOGX DD statement or the VIRLOGY DD statement depending on the active LOG. These DDNAMES need to be added to the Virtel procedure to support LOG=FILE option. The following DCB attributes. Recommended space allocation could be 10 tracks for each dataset.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LOGFILEX</span> <span class="ow">and</span> <span class="n">LOGFILEY</span>
<span class="n">DCB</span> <span class="n">attributes</span> <span class="p">:</span> <span class="n">PS</span><span class="p">,</span> <span class="n">LRECL</span><span class="o">=</span><span class="mi">165</span><span class="p">,</span> <span class="n">RECFM</span><span class="o">=</span><span class="n">VB</span><span class="p">,</span> <span class="n">BLKSIZE</span><span class="o">=</span><span class="mi">32000</span>
</pre></div>
</div>
<p>If either LOGFILE becomes full (X37 Abend) an automatic switch will occur to to the inactive logfile.</p>
<span class="target" id="index-9"></span></div>
</div>
<div class="section" id="log-status-switch-commands">
<span id="index-10"></span><h3>LOG Status | Switch Commands<a class="headerlink" href="#log-status-switch-commands" title="Permalink to this headline">¶</a></h3>
<p>To determine the status of the LOG file, or to switch the log file manually issue one of the following commands:-</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="n">VIRTEL</span><span class="p">,</span><span class="n">LOG</span><span class="p">,</span><span class="n">D</span>              <span class="n">Display</span> <span class="n">active</span> <span class="n">logfile</span>
<span class="n">F</span> <span class="n">VIRTEL</span><span class="p">,</span><span class="n">LOG</span><span class="p">,</span><span class="n">I</span>              <span class="n">Switch</span> <span class="n">logfiles</span>
</pre></div>
</div>
</div>
<div class="section" id="memdisplay-command">
<span id="index-11"></span><h3>MEMDISPLAY Command<a class="headerlink" href="#memdisplay-command" title="Permalink to this headline">¶</a></h3>
<p>To display Virtel Internal Memory Usage use the MEMDISPLAY command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MEMDISPLAY</span>
</pre></div>
</div>
<p>With the memory diagnostic tool active the MEMDISPLAY command summarize the VIRTEL subpool active allocated memory.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">VIR0200I</span> <span class="n">MEMDISPLAY</span>
<span class="n">VIR0271I</span> <span class="n">DISPLAY</span> <span class="mi">978</span>
<span class="n">SP1</span><span class="o">=</span><span class="mi">00024478</span> <span class="n">SP2</span><span class="o">=</span><span class="mi">00001044</span> <span class="n">SP3</span><span class="o">=</span><span class="mf">0008E35</span><span class="n">F</span> <span class="n">SP4</span><span class="o">=</span><span class="mi">00002</span><span class="n">F61</span>
    <span class="mi">00910091</span> <span class="mi">00040009</span> <span class="mi">02380294</span> <span class="mi">000</span><span class="n">B0011</span>
<span class="n">SP5</span><span class="o">=</span><span class="mi">000317</span><span class="n">DC</span> <span class="n">SP6</span><span class="o">=</span><span class="mi">0004</span><span class="n">DF73</span> <span class="n">SP7</span><span class="o">=</span><span class="mi">00000000</span> <span class="n">SP8</span><span class="o">=</span><span class="mi">00000220</span>
    <span class="mi">00</span><span class="n">C504C7</span> <span class="mi">01370137</span> <span class="mi">00000000</span> <span class="mi">00000002</span>
<span class="n">POOL</span> <span class="n">CONTROL</span> <span class="n">BLOCK</span><span class="o">.</span> <span class="n">SUBPOOL</span><span class="o">=</span><span class="mi">1</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">00109000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">00109008</span> <span class="c1">#FQ=00000001 FRE=0000B2A0</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">000</span><span class="n">F9000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">000</span><span class="n">F9008</span> <span class="c1">#FQ=00000001 FRE=00000080</span>
<span class="n">PAG</span><span class="o">=</span><span class="mf">000E9000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mf">000E9008</span> <span class="c1">#FQ=00000001 FRE=00000078</span>
<span class="n">POOL</span> <span class="n">CONTROL</span> <span class="n">BLOCK</span><span class="o">.</span> <span class="n">SUBPOOL</span><span class="o">=</span><span class="mi">2</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">1</span><span class="n">EC14000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">1</span><span class="n">EC14008</span> <span class="c1">#FQ=00000005 FRE=0000EF68</span>
<span class="n">POOL</span> <span class="n">CONTROL</span> <span class="n">BLOCK</span><span class="o">.</span> <span class="n">SUBPOOL</span><span class="o">=</span><span class="mi">3</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">1</span><span class="n">ECD4000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">1</span><span class="n">ECD4008</span> <span class="c1">#FQ=00000002 FRE=00009DF8</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">1</span><span class="n">ED54000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">1</span><span class="n">ED54008</span> <span class="c1">#FQ=00000002 FRE=00001750</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">1</span><span class="n">EC84000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">1</span><span class="n">EC84008</span> <span class="c1">#FQ=00000001 FRE=00000878</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">1</span><span class="n">ED04000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">1</span><span class="n">ED04008</span> <span class="c1">#FQ=00000001 FRE=00000878</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">1</span><span class="n">ED94000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">1</span><span class="n">ED94008</span> <span class="c1">#FQ=00000002 FRE=00002768</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">1</span><span class="n">ECF4000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">1</span><span class="n">ECF4008</span> <span class="c1">#FQ=00000001 FRE=00000878</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">1</span><span class="n">EE04000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">1</span><span class="n">EE04008</span> <span class="c1">#FQ=00000001 FRE=00000878</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">1</span><span class="n">ED74000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">1</span><span class="n">ED74008</span> <span class="c1">#FQ=00000001 FRE=00000878</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">1</span><span class="n">ECE4000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">1</span><span class="n">ECE4008</span> <span class="c1">#FQ=00000001 FRE=00000878</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">1</span><span class="n">EC64000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">1</span><span class="n">EC64008</span> <span class="c1">#FQ=00000001 FRE=00000878</span>
<span class="n">POOL</span> <span class="n">CONTROL</span> <span class="n">BLOCK</span><span class="o">.</span> <span class="n">SUBPOOL</span><span class="o">=</span><span class="mi">4</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">1</span><span class="n">EC04000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">1</span><span class="n">EC04008</span> <span class="c1">#FQ=00000004 FRE=0000CFA0</span>
<span class="n">POOL</span> <span class="n">CONTROL</span> <span class="n">BLOCK</span><span class="o">.</span> <span class="n">SUBPOOL</span><span class="o">=</span><span class="mi">5</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">1</span><span class="n">ECA4000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">1</span><span class="n">ECA4008</span> <span class="c1">#FQ=00000002 FRE=0000D870</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">1</span><span class="n">ED14000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">1</span><span class="n">ED14008</span> <span class="c1">#FQ=00000001 FRE=000043B8</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">1</span><span class="n">ED24000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">1</span><span class="n">ED24008</span> <span class="c1">#FQ=00000001 FRE=000043B8</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">1</span><span class="n">EC74000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">1</span><span class="n">EC74008</span> <span class="c1">#FQ=00000001 FRE=0000A1D8</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">1</span><span class="n">EC54000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">1</span><span class="n">EC54008</span> <span class="c1">#FQ=00000001 FRE=0000A1D8</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">1</span><span class="n">EBB4000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">1</span><span class="n">EBB4008</span> <span class="c1">#FQ=00000001 FRE=000043B8</span>
<span class="n">POOL</span> <span class="n">CONTROL</span> <span class="n">BLOCK</span><span class="o">.</span> <span class="n">SUBPOOL</span><span class="o">=</span><span class="mi">6</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">1</span><span class="n">EBF4000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">1</span><span class="n">EBF4008</span> <span class="c1">#FQ=00000002 FRE=00000A50</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">1</span><span class="n">EBE4000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">1</span><span class="n">EBE4008</span> <span class="c1">#FQ=00000001 FRE=00000088</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">1</span><span class="n">EBD4000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">1</span><span class="n">EBD4008</span> <span class="c1">#FQ=00000001 FRE=000000B8</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">1</span><span class="n">EBC4000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">1</span><span class="n">EBC4008</span> <span class="c1">#FQ=00000001 FRE=000000D0</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">1</span><span class="n">EBA4000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">1</span><span class="n">EBA4008</span> <span class="c1">#FQ=00000001 FRE=00000108</span>
<span class="n">POOL</span> <span class="n">CONTROL</span> <span class="n">BLOCK</span><span class="o">.</span> <span class="n">SUBPOOL</span><span class="o">=</span><span class="mi">7</span>
<span class="n">PAG</span><span class="o">=</span><span class="mi">00000000</span> <span class="n">NFQ</span><span class="o">=</span><span class="mi">00000000</span> <span class="c1">#FQ=00000000 FRE=00000000</span>
<span class="n">POOL</span> <span class="n">CONTROL</span> <span class="n">BLOCK</span><span class="o">.</span> <span class="n">SUBPOOL</span><span class="o">=</span><span class="mi">8</span>
</pre></div>
</div>
<p>The display response is split into a summary section for each subpool and a detailed allocated page block and free queue element display for each subpool.In the summary display, each subpool has two displayed values. The top value is the amount of storage currently allocated and the value below represents the current allocation in 1K chunks and a peak allocation in 1K chunks.</p>
<p>For example in the above display in SP5 we can see that there is an allocated value of 317DC bytes, represented by 00C5 in 1K chunks, and a peak value of 04C7 in 1K chunks.At the bottom of the display is a line which provide allocated, free and total values.</p>
<div class="section" id="enabling-the-memdisplay-function">
<span id="index-12"></span><h4>Enabling the MEMDISPLAY function<a class="headerlink" href="#enabling-the-memdisplay-function" title="Permalink to this headline">¶</a></h4>
<p>Memory Display feature is activated by using the MEMHST subparameter in the MEMORY parameter present in the VIRTCT.(see the VIRTCT subparameter MEMHST in “VIRTEL460 Installation User Guide”).</p>
</div>
<div class="section" id="disabling-the-memdisplay-function">
<span id="index-13"></span><h4>Disabling the MEMDISPLAY function<a class="headerlink" href="#disabling-the-memdisplay-function" title="Permalink to this headline">¶</a></h4>
<p>It can be deactivated by using the command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="n">VIRTEL</span><span class="p">,</span><span class="n">MEMDISPLAY</span><span class="p">,</span><span class="n">DISABLE</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This command should only be implemented when advised to do so by Technical Support. Performance degradation might occur due to the additional monitoring services. This will depend on VIRTEL demand.</p>
</div>
</div>
</div>
<div class="section" id="msg-command">
<span id="index-14"></span><h3>MSG Command<a class="headerlink" href="#msg-command" title="Permalink to this headline">¶</a></h3>
<p>To send a mesage to VIRTEL Multi-Session users use the MSG command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MSG</span><span class="o">=</span><span class="n">message</span> <span class="n">text</span>
</pre></div>
</div>
<p>The specified message will be displayed on the VIRTEL multi-session screen.</p>
</div>
<div class="section" id="new-command">
<span id="index-15"></span><h3>NEW Command<a class="headerlink" href="#new-command" title="Permalink to this headline">¶</a></h3>
<p>The NEW command refreshes a VIRTEL program, VIRSV service or scenario.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NEW</span><span class="o">=</span><span class="n">progname</span>
</pre></div>
</div>
<dl class="docutils">
<dt>progname</dt>
<dd>program name</dd>
</dl>
<p>The NEW command requests VIRTEL to load a fresh copy of a program  (presentation module, exit, etc) into the VIRTEL address space. This is required after an update has been made to a program. The message     VIR0060W PROGRAM progname IS A NEW COPY indicates a successful reload. The message VIR0061W PROGRAM progname NOT IN MEMORY indicates that the program has not yet been loaded into the VIRTEL address space. In this case, VIRTEL will load the program automatically when it is next needed.</p>
</div>
<div class="section" id="relay-trace-command">
<span id="index-16"></span><h3>RELAY TRACE Command<a class="headerlink" href="#relay-trace-command" title="Permalink to this headline">¶</a></h3>
<p>Use the RELAY command to trace the Virtel buffers between Virtel and the application.</p>
<p>RELAY=relayname,NOTRACE | TRACE</p>
</div>
<div class="section" id="relays-command">
<span id="index-17"></span><h3>RELAYS Command<a class="headerlink" href="#relays-command" title="Permalink to this headline">¶</a></h3>
<p>To display a list of Virtel LU relays use the RELAY command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RELAYS</span>
</pre></div>
</div>
<p>The RELAYS command displays the VIRTEL ACB name and a list of the relay LUs opened by VIRTEL. Foe example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="n">VIRTEL</span><span class="p">,</span><span class="n">RELAYS</span>
<span class="n">VIR0200I</span> <span class="n">RELAYS</span>
<span class="n">VIR0214I</span> <span class="n">ACTIVE</span> <span class="n">RELAY</span> <span class="n">ACBS</span> <span class="n">FOR</span> <span class="n">VIRTEL</span> <span class="mf">4.60</span> <span class="n">APPLID</span><span class="o">=</span><span class="n">APPLHOLT</span>
<span class="n">VIR0214I</span> <span class="n">TERMINAL</span> <span class="n">RELAY</span>    <span class="n">APPLID</span>   <span class="n">CLIENT</span>
<span class="n">VIR0214I</span> <span class="o">--------</span> <span class="o">--------</span> <span class="o">--------</span> <span class="o">---------------</span>
<span class="n">VIR0214I</span> <span class="n">CLVTA004</span> <span class="n">REHVT000</span> <span class="n">SPCICST</span>  <span class="mf">192.168</span><span class="o">.</span><span class="mf">92.58</span>
<span class="n">VIR0214I</span> <span class="n">W2HIP000</span> <span class="n">REHIP000</span>
<span class="n">VIR0214I</span> <span class="o">---</span><span class="n">END</span> <span class="n">OF</span> <span class="n">LIST</span><span class="o">---</span>
</pre></div>
</div>
</div>
<div class="section" id="silence-command">
<span id="index-18"></span><h3>SILENCE Command<a class="headerlink" href="#silence-command" title="Permalink to this headline">¶</a></h3>
<p>The SILENCE command manages message suppression. The format of the command is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SILENCE</span>                     <span class="n">Toggle</span> <span class="n">SILENCE</span> <span class="n">mode</span> <span class="n">ON</span> <span class="ow">or</span> <span class="n">OFF</span>
<span class="n">SILENCE</span><span class="o">=</span><span class="n">messagid</span>            <span class="n">Add</span> <span class="n">message</span> <span class="n">to</span> <span class="n">message</span> <span class="n">table</span>
<span class="n">SILENCE</span><span class="o">=</span><span class="n">messageid</span><span class="p">,</span><span class="n">D</span>         <span class="n">Delete</span> <span class="n">message</span> <span class="kn">from</span> <span class="nn">message</span> <span class="n">table</span>
<span class="n">SILENCE</span><span class="o">=</span><span class="n">RESET</span>               <span class="n">Reset</span> <span class="n">message</span> <span class="n">table</span> <span class="ow">and</span> <span class="n">remove</span> <span class="nb">all</span> <span class="n">entries</span>
<span class="n">SILENCE</span><span class="o">=</span><span class="n">LIST</span>                <span class="n">List</span> <span class="n">messages</span>
</pre></div>
</div>
<p>The SILENCE command initially reverses the state of the SILENCE parameter as defined in the VIRTCT. A default static message table of connection and disconnection messages is built at initialization. This table includes the following messages - VIR0026W, VIR0028W, VIR0051I, VIR0052I, VIR0505I, VIR0507I, VIR1551I, VIRHT51I, VIRNA51I, VIRPF28I, VIRPF51I, VIRPF52I, VIRPF99I, VIRQ912W, VIRQ922W, VIRT912W, VIRT922W, VIR0002W and VIR0914E. These messages ids are not effected by the RESET or LIST option of the SILENCE command.</p>
</div>
<div class="section" id="snap-command">
<span id="index-19"></span><h3>SNAP Command<a class="headerlink" href="#snap-command" title="Permalink to this headline">¶</a></h3>
<p>This command is used to take a dump of the Virtel SNAP internal trace table.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SNAP</span>
</pre></div>
</div>
<p>The SNAP command prints the contents of the VIRTEL internal trace table to the SYSPRINT file . See “VIRTEL SNAP” for further information.</p>
<div class="section" id="terminal-or-relay-snap">
<h4>Terminal or Relay SNAP<a class="headerlink" href="#terminal-or-relay-snap" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SNAP</span><span class="p">,</span><span class="n">T</span><span class="o">=</span><span class="n">termid</span> <span class="o">|</span> <span class="n">R</span><span class="o">=</span><span class="n">relayname</span>
</pre></div>
</div>
<dl class="docutils">
<dt>termid</dt>
<dd>terminal name</dd>
<dt>relayname</dt>
<dd>name of VTAM relay LU currently associated with the terminal</dd>
</dl>
</div>
</div>
<div class="section" id="snapmsg-command">
<span id="index-20"></span><h3>SNAPMSG Command<a class="headerlink" href="#snapmsg-command" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SNAPMSG</span><span class="p">,</span><span class="n">ALL</span>
</pre></div>
</div>
<p>The SNAPMSG command requests VIRTEL to generate an automatic SNAP after certain messages (VIRI902W VIR0026W VIR0052I VIR1552I VIR0526W VIR1952I).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SNAPMSG</span><span class="o">=</span><span class="n">message</span><span class="p">,</span><span class="n">search</span><span class="p">,</span><span class="n">action</span>
</pre></div>
</div>
<p>The SNAPMSG commmand allows a SNAP or DUMP to be taken whenever a particular message number is issued by VIRTEL. The command has an additional search field which can be used to identify a message with a paticular character string, for example a specific return code. This feature is also avalable by using the SNAPMSG parameter in the TCT. See “SNAPMSG parameter” in the Virtel Installation Guide.</p>
<dl class="docutils">
<dt>message</dt>
<dd>Any message that can be issued by Virtel.</dd>
<dt>search</dt>
<dd>Any seache criteria issued within the message. The search file is restricted to a maximu of 10 characters. Anything beyond will be ignored. Default search is none.</dd>
<dt>action</dt>
<dd>Possible values are S for SNAP or A for ABEND. Virtel will abend with a U0999 abend code, reason code 15 if the ABEND action is used.</dd>
</dl>
<p>Default action is SNAP.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="n">VIRTEL</span><span class="p">,</span><span class="n">SNAPMSG</span><span class="o">=</span><span class="n">VIRHT51I</span><span class="p">,</span><span class="n">CALL</span><span class="p">,</span><span class="n">S</span>
</pre></div>
</div>
</div>
<div class="section" id="snap80-command">
<span id="index-21"></span><h3>SNAP80 Command<a class="headerlink" href="#snap80-command" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SNAP80</span>
</pre></div>
</div>
<p>The SNAP80 command prints the contents of the VIRTEL internal trace table in 80 column format, whatever the current value of the SNAPW parameter.</p>
</div>
<div class="section" id="snapw-command">
<span id="index-22"></span><h3>SNAPW Command<a class="headerlink" href="#snapw-command" title="Permalink to this headline">¶</a></h3>
<p>The format of the SNAP output can be adjusted with the SNAPW command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SNAPW</span><span class="o">=</span><span class="mi">80</span> <span class="o">|</span> <span class="mi">132</span>
</pre></div>
</div>
<p>The SNAPW command sets the width for future SNAP commands (80 or 132 columns). The SNAPW parameter in the VIRTCT determines the default width at VIRTEL startup. Refer to the section “Parameters of the VIRTCT” in the VIRTEL Installation Guide for details of the SNAPW parameter.</p>
</div>
<div class="section" id="stat-command">
<span id="index-23"></span><h3>STAT Command<a class="headerlink" href="#stat-command" title="Permalink to this headline">¶</a></h3>
<div class="section" id="display-statistics-file-information">
<h4>Display statistics file information<a class="headerlink" href="#display-statistics-file-information" title="Permalink to this headline">¶</a></h4>
<p>To display information about the Virtel statistics file management use the STAT command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">STAT</span><span class="p">,</span><span class="n">D</span>
</pre></div>
</div>
<p>This command displays the status of the VIRSTATx files (message VIR0601I). The STAT command is used to manage the VIRTEL statistics recording files (VIRSTATx). This command can be used only if STATS=MULTI is specified in the VIRTCT.</p>
</div>
<div class="section" id="switch-the-virstat-file">
<h4>Switch the VIRSTAT file<a class="headerlink" href="#switch-the-virstat-file" title="Permalink to this headline">¶</a></h4>
<p>To switch the STATISTIC file using the STAT switch command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">STAT</span><span class="p">,</span><span class="n">I</span>
</pre></div>
</div>
<p>This command forces VIRTEL to free the current VIRSTATx file and to start recording onto the next file.</p>
</div>
</div>
<div class="section" id="stop-command">
<span id="index-24"></span><h3>STOP Command<a class="headerlink" href="#stop-command" title="Permalink to this headline">¶</a></h3>
<p>To stop Virtel issue the STOP command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">STOP</span>
</pre></div>
</div>
<p>The STOP command allows to STOP the VIRTEL task. This command is intended to be mainly used in VSE environment even if it is also available in z/OS environmment. On z/OS environment you can also use the following command :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="n">VIRTEL</span>
</pre></div>
</div>
</div>
<div class="section" id="tct-command">
<span id="index-25"></span><h3>TCT Command<a class="headerlink" href="#tct-command" title="Permalink to this headline">¶</a></h3>
<p>The TCT command displays some of the TCT options that have been defined in the active TCT.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="n">VIRTEL</span><span class="p">,</span><span class="n">TCT</span>
<span class="n">VIR0200I</span> <span class="n">TCT</span>
<span class="n">VIR0270I</span> <span class="n">DISPLAY</span>
<span class="n">VIRTEL</span> <span class="n">TCT</span><span class="o">=</span><span class="n">VIRTCTEH</span><span class="p">:</span>
<span class="n">SILENCE</span><span class="o">=</span><span class="n">N</span><span class="p">,</span><span class="n">MEMORY</span><span class="o">=</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">N</span><span class="p">),</span><span class="n">BFVSAM</span><span class="o">=</span><span class="mi">32768</span><span class="p">,</span><span class="n">BUFDATA</span><span class="o">=</span><span class="mi">016</span><span class="p">,</span><span class="n">BUFSIZE</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span><span class="n">STR</span><span class="o">=</span><span class="mi">03</span>
<span class="n">COUNTRY</span><span class="o">=</span><span class="n">FR</span><span class="p">,</span><span class="n">GMT</span><span class="o">=</span><span class="n">SYSTZ</span><span class="p">,</span><span class="n">DEFUTF8</span><span class="o">=</span><span class="n">IBM1147</span> <span class="p">,</span><span class="n">LANG</span><span class="o">=</span><span class="n">E</span><span class="p">,</span><span class="n">MAXSOCK</span><span class="o">=</span><span class="mi">00240</span><span class="p">,</span><span class="n">VSAMTYP</span><span class="o">=</span><span class="n">N</span>
<span class="n">APPLID</span><span class="o">=</span><span class="n">VIRTEL</span> <span class="p">,</span><span class="n">SMF</span><span class="o">=</span><span class="n">N</span><span class="p">,</span><span class="n">PASSTCK</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span><span class="n">VIRSECU</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span><span class="n">SWA</span><span class="o">=</span><span class="n">N</span><span class="p">,</span><span class="n">NBTERM</span><span class="o">=</span><span class="mi">0500</span><span class="p">,</span><span class="n">NTASK</span><span class="o">=</span><span class="mi">04</span>
<span class="n">MEMORY</span><span class="o">=</span><span class="p">(</span><span class="n">SYS</span><span class="p">(</span><span class="mi">0001688</span><span class="n">K</span><span class="p">,</span><span class="mi">0001688</span><span class="n">K</span><span class="p">),</span><span class="n">DATA</span><span class="p">(</span><span class="mi">0002304</span><span class="n">K</span><span class="p">,</span><span class="mi">0003200</span><span class="n">K</span><span class="p">)),</span><span class="n">LOG</span><span class="o">=</span><span class="n">CONSOLE</span>
<span class="n">VIR0280I</span> <span class="n">END</span>
</pre></div>
</div>
</div>
<div class="section" id="term-command">
<span id="index-26"></span><h3>TERM Command<a class="headerlink" href="#term-command" title="Permalink to this headline">¶</a></h3>
<p>Use the TERM command to activate a Terminal trace. This will trace data between the browser and Virtel.</p>
<p>TERM=termid,NOTRACE | TRACE  [or T=termid,N | T ]</p>
<span class="target" id="index-27"></span></div>
<div class="section" id="trace-notrace-command">
<span id="index-28"></span><h3>TRACE | NOTRACE Command<a class="headerlink" href="#trace-notrace-command" title="Permalink to this headline">¶</a></h3>
<p>A trace can be activated or deactivated on a terminal, line or relay.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TRACE</span><span class="p">,</span><span class="n">T</span><span class="o">=</span><span class="n">termid</span>
<span class="n">TRACE</span><span class="p">,</span><span class="n">L</span><span class="o">=</span><span class="n">linename</span>
<span class="n">TRACE</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="n">relayname</span>
<span class="n">NOTRACE</span><span class="p">,</span><span class="n">T</span><span class="o">=</span><span class="n">termid</span>
<span class="n">NOTRACE</span><span class="p">,</span><span class="n">L</span><span class="o">=</span><span class="n">linename</span>
<span class="n">NOTRACE</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="n">relayname</span>
</pre></div>
</div>
<dl class="docutils">
<dt>termid</dt>
<dd>terminal name</dd>
<dt>linename</dt>
<dd>Internal or external name of the line</dd>
<dt>relayname</dt>
<dd>relay associated to the terminal</dd>
</dl>
<p>It is often easier to identify the relay used whose name appears at the bottom of the 3270 session screen as shown below.</p>
<p><img alt="image23" src="../../../_images/image2317.png" />
<em>Associated relay names</em></p>
<dl class="docutils">
<dt>linename</dt>
<dd>Internal or external name of the line</dd>
</dl>
<p>The following alternate forms of the TRACE/NOTRACE commands are also  valid</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TERM</span><span class="o">=</span><span class="n">termid</span><span class="p">,</span><span class="n">TRACE</span> <span class="p">(</span><span class="ow">or</span> <span class="n">T</span><span class="o">=</span><span class="n">termid</span><span class="p">,</span><span class="n">T</span><span class="p">)</span>
<span class="n">TERM</span><span class="o">=</span><span class="n">termid</span><span class="p">,</span><span class="n">NOTRACE</span> <span class="p">(</span><span class="ow">or</span> <span class="n">T</span><span class="o">=</span><span class="n">termid</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">LINE</span><span class="o">=</span><span class="n">linename</span><span class="p">,</span><span class="n">TRACE</span> <span class="p">(</span><span class="ow">or</span> <span class="n">L</span><span class="o">=</span><span class="n">linename</span><span class="p">,</span><span class="n">T</span><span class="p">)</span>
<span class="n">LINE</span><span class="o">=</span><span class="n">linename</span><span class="p">,</span><span class="n">NOTRACE</span> <span class="p">(</span><span class="ow">or</span> <span class="n">L</span><span class="o">=</span><span class="n">linename</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">RELAY</span><span class="o">=</span><span class="n">relayname</span><span class="p">,</span><span class="n">TRACE</span> <span class="p">(</span><span class="ow">or</span> <span class="n">R</span><span class="o">=</span><span class="n">relayname</span><span class="p">,</span><span class="n">T</span><span class="p">)</span>
<span class="n">RELAY</span><span class="o">=</span><span class="n">relayname</span><span class="p">,</span><span class="n">NOTRACE</span> <span class="p">(</span><span class="ow">or</span> <span class="n">R</span><span class="o">=</span><span class="n">relayname</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>termid</dt>
<dd>terminal name</dd>
<dt>linename</dt>
<dd>Internal or external name of the line</dd>
<dt>relayname</dt>
<dd>Name of VTAM relay LU currently associated with the terminal</dd>
</dl>
<div class="section" id="display-a-list-of-active-traces">
<span id="index-29"></span><h4>Display a list of active traces<a class="headerlink" href="#display-a-list-of-active-traces" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TRACE</span><span class="p">,</span><span class="n">DISPLAY</span> <span class="o">|</span> <span class="n">D</span>
</pre></div>
</div>
<p>An example of the response is:-:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="n">VIRTEL</span><span class="p">,</span><span class="n">TRACE</span><span class="p">,</span><span class="n">DISPLAY</span> <span class="ow">or</span> <span class="n">F</span> <span class="n">VIRTEL</span><span class="p">,</span><span class="n">TRACE</span><span class="p">,</span><span class="n">D</span>
<span class="n">VIR0200I</span> <span class="n">TRACE</span><span class="p">,</span><span class="n">D</span>
<span class="n">VIR0208I</span> <span class="n">VIRTEL</span> <span class="n">INTERNAL</span> <span class="n">TRACE</span> <span class="o">=</span> <span class="n">YYY</span><span class="o">.</span> <span class="n">EXT</span><span class="o">.</span> <span class="n">BUFFERS</span> <span class="o">=</span> <span class="mi">0001</span><span class="o">/</span><span class="mi">00</span><span class="n">FF</span><span class="o">.</span>
<span class="n">VIR0213I</span> <span class="n">NO</span> <span class="n">ACTIVE</span> <span class="n">TRACES</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-trace-options">
<span id="index-30"></span><h4>Setting trace options<a class="headerlink" href="#setting-trace-options" title="Permalink to this headline">¶</a></h4>
<p>To set the trace options issue the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TRACE</span><span class="p">,</span><span class="n">VIT</span><span class="o">=</span><span class="n">Y</span><span class="o">|</span><span class="n">N</span> <span class="n">Y</span><span class="o">|</span><span class="n">N</span> <span class="n">Y</span><span class="o">|</span><span class="n">N</span>
</pre></div>
</div>
<p>The default VIT trace parametr is YYN. The external archive trace setting should only be set when instructed to by Virtel support.</p>
<p>The VIT indicators apply the the level of tracing.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">Y</span><span class="o">|</span><span class="n">N</span>           <span class="n">No</span> <span class="n">tracing</span> <span class="ow">or</span> <span class="n">minimal</span> <span class="n">tracing</span>
<span class="o">-</span> <span class="n">Y</span><span class="o">|</span><span class="n">N</span>           <span class="n">Data</span> <span class="n">elements</span> <span class="n">traced</span>
<span class="o">-</span> <span class="n">Y</span><span class="o">|</span><span class="n">N</span>           <span class="n">External</span> <span class="n">Archive</span> <span class="n">active</span>
</pre></div>
</div>
</div>
<div class="section" id="deactivate-all-traces">
<span id="index-31"></span><h4>Deactivate all traces<a class="headerlink" href="#deactivate-all-traces" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NOTRACE</span><span class="p">,</span><span class="n">ALL</span>
</pre></div>
</div>
<p>This command does not affect any memory trace. To stop a memory trace, refer to “Memory trace management”</p>
</div>
</div>
<div class="section" id="unload-command">
<span id="index-32"></span><h3>UNLOAD Command<a class="headerlink" href="#unload-command" title="Permalink to this headline">¶</a></h3>
<p>Unload the ARBO configuration file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">UNLOAD</span>
<span class="n">UNLOAD</span><span class="p">,</span><span class="n">DSN</span><span class="o">=*</span><span class="n">dsname</span><span class="o">*</span>
</pre></div>
</div>
<p>The UNLOAD commands writes the contents of the ARBO file. Depending on the VIRTEL JCL, the output will be directed to the SYSPUNCH DD statement. If no SYSPUNCH DD statement is defined, one will be allocated through dynamic allocation. Output will then by written to JES class SYSOUT=B or, if the DSN= option is specified, to the dsname provided. The dataset must be pre-allocated with DCB attributes LRECL=80,RECFM=FB,BLKSIZE=3200. The SYSPUNCH DD statement will be dynamically allocated if not provided in the Virtel JCL.</p>
</div>
<div class="section" id="virsv-command">
<span id="index-33"></span><h3>VIRSV Command<a class="headerlink" href="#virsv-command" title="Permalink to this headline">¶</a></h3>
<p>Refreshing a VIRSV Service program</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">VIRSV</span><span class="p">,</span><span class="n">NEW</span><span class="o">=</span><span class="n">servname</span>
</pre></div>
</div>
<dl class="docutils">
<dt>servname</dt>
<dd>service name</dd>
</dl>
<p>The VIRSV,NEW command requests VIRTEL to stop the requested VIRSV service. This has the effect of loading a fresh copy of the associated service program the next time the service is invoked by a scenario. The message VIR0260W SERVICE servname IS A NEW COPY indicates that the service was stopped successfully. The message VIR0261W</p>
<p>SERVICE servname NOT IN MEMORY indicates that the service is not yet started. In this case, VIRTEL will start the service and load the  program automatically when it is next needed.</p>
</div>
<div class="section" id="zap-command">
<span id="index-34"></span><h3>ZAP Command<a class="headerlink" href="#zap-command" title="Permalink to this headline">¶</a></h3>
<p>The ZAP command allows dynamic patching of a Virtel Program</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ZAP</span><span class="o">=</span><span class="n">progname</span><span class="o">+</span><span class="n">offset</span><span class="p">,</span><span class="n">verify</span><span class="p">,</span><span class="n">replace</span>
</pre></div>
</div>
<dl class="docutils">
<dt>progname</dt>
<dd>program name</dd>
<dt>offset</dt>
<dd>offset into program</dd>
<dt>verify</dt>
<dd>verify value (2 to 8 hexadecimal digits)</dd>
<dt>replace</dt>
<dd>replacement value (2 to 8 hexadecimal digits)</dd>
</dl>
<p>The ZAP command allows the dynamic application of a corrective patch to a program while VIRTEL is running. This command is intended to be used only under the advice of Syspertec technical support personnel.</p>
</div>
</div>
<div class="section" id="administration">
<span id="index-35"></span><h2>Administration<a class="headerlink" href="#administration" title="Permalink to this headline">¶</a></h2>
<div class="section" id="line-status-application">
<span id="index-36"></span><h3>Line Status Application<a class="headerlink" href="#line-status-application" title="Permalink to this headline">¶</a></h3>
<p>The Line Status sub-application allows the administrator to display the current status of lines and terminals or irtual circuits (CVC) managed by VIRTEL control, and optionally to modify the status of lines.</p>
<div class="section" id="displaying-line-status">
<span id="index-37"></span><h4>Displaying line status<a class="headerlink" href="#displaying-line-status" title="Permalink to this headline">¶</a></h4>
<p>The Line Status sub-application is invoked by pressing [PF9] in the Configuration Menu, by pressing [PF10] in the Sub- Application Menu, or via the Multi-Session Menu using a transaction which calls module VIR0027.</p>
<p>When the security subsystem is active, access to Line Status sub-application from the Configuration Menu or the Sub- Application Menu is controlled by the resource $$UTIL$$.
When accessed by a transaction, normal transaction security rules will apply. Security management is described in chapter 4 of the VIRTEL Technical Documentation.</p>
<p>The sub-application begins by displaying the Line Status Display screen. Started lines are displayed in high-intensity or white text, stopped lines are displayed in low intensity or blue text.</p>
<p><img alt="image21" src="../../../_images/image2124.png" /></p>
<p><em>Fig.1 - Line Status Display screen</em></p>
<dl class="docutils">
<dt>STATUS OF-LINES</dt>
<dd>Allows the administrator to display a subset of lines, by typing the
first character of the name of each desired line into this field and
pressing [Enter]. If the field is blank, all lines are displayed.</dd>
<dt>C</dt>
<dd>Command input field.</dd>
<dt>Name</dt>
<dd>The internal name of the line.</dd>
<dt>In</dt>
<dd>The number of virtual circuits currently in use by incoming calls.</dd>
<dt>Out</dt>
<dd>The number of virtual circuits currently in use by outgoing calls.</dd>
<dt>Links</dt>
<dd>The number of terminals linked to the line.</dd>
<dt>Description</dt>
<dd>Comments.</dd>
<dt>Seen</dt>
<dd>User name.</dd>
</dl>
</div>
<div class="section" id="positioning-the-list">
<h4>Positioning the list<a class="headerlink" href="#positioning-the-list" title="Permalink to this headline">¶</a></h4>
<p>If the line status display occupies more than one screen, you can scroll through the list of lines by using [PF5], [PF7] and [PF8].</p>
<dl class="docutils">
<dt>[PF5]</dt>
<dd>return to the first page of the list.</dd>
<dt>[PF7]</dt>
<dd>scroll back to previous page.</dd>
<dt>[PF8]</dt>
<dd>scroll forward to next page.</dd>
</dl>
</div>
<div class="section" id="sending-a-command">
<span id="index-38"></span><h4>Sending a command<a class="headerlink" href="#sending-a-command" title="Permalink to this headline">¶</a></h4>
<p>To send a command to a line, place the cursor in the “C” field in front of the line name, type the command, then press [Enter]. The  commands available are:</p>
<dl class="docutils">
<dt>S</dt>
<dd><dl class="first last docutils">
<dt>Starts a line.</dt>
<dd>If the line is already started, VIRTEL attempts to start or restart any terminals associated with the line but not currently linked. This allows VIRTEL to recover LU’s which have been     deactivated and reactivated by VTAM, without stopping the line.</dd>
</dl>
</dd>
<dt>p</dt>
<dd><dl class="first last docutils">
<dt>Stops a line.</dt>
<dd>The LINE START and STOP commands can also be issued from the z/OS or VSE console. See “Starting and stopping a line”</dd>
</dl>
</dd>
</dl>
<p>To return to the configuration menu, press [PF3] or [Clear].</p>
</div>
<div class="section" id="displaying-line-usage">
<span id="index-39"></span><h4>Displaying Line Usage<a class="headerlink" href="#displaying-line-usage" title="Permalink to this headline">¶</a></h4>
<p>To display the status and line usage place the cursor on the desired line in the Line Status Display screen and press [PF12].</p>
<p>Security rules are the same as those which apply to the previous screen.</p>
<p>This sub-application begins by displaying the terminal usage for the selected line, as shown in the example below:</p>
<p><img alt="image22" src="../../../_images/image2222.png" /></p>
<p><em>Fig.2 - Line Usage Detail Display screen</em></p>
<dl class="docutils">
<dt>ACTIVE TERMINALS for LINE</dt>
<dd>Indicates the internal name of the line whose virtual circuits are being displayed.</dd>
<dt>Prefix</dt>
<dd>The terminal name prefix associated with this line.</dd>
<dt>Type</dt>
<dd>The line type, as defined in the line definition.</dd>
<dt>Defined</dt>
<dd>The number of terminals defined for this line.</dd>
<dt>Linked</dt>
<dd>The number of terminals currently linked to this line.</dd>
<dt>Number of occupied circuits</dt>
<dd>The number of terminals or virtual circuits currently in use.</dd>
<dt>Number of connections</dt>
<dd>The total number of calls received.</dd>
<dt>Maximum simultaneously used</dt>
<dd>The maximum number of terminals or virtual circuits in use at any one time.</dd>
<dt>Total time connected</dt>
<dd>The total connection time.</dd>
<dt>Terminal</dt>
<dd>The terminal name (name of the virtual circuit).</dd>
<dt>User</dt>
<dd>User name if signed on to VIRTEL.</dd>
<dt>Sends</dt>
<dd>The number of messages sent to the terminal.</dd>
<dt>Time</dt>
<dd>The connection time in minutes.</dd>
<dt>Node (for Minitel)</dt>
<dd>The name of the node to which the terminal is currently connected.</dd>
<dt>Node (for HTTP lines)</dt>
<dd>The relay name (3270 LU name) used to connect to the host application.</dd>
<dt>Remote number (for X25 lines)</dt>
<dd>The X25 called number for an outgoing call, or the X25 calling number for an incoming call.</dd>
<dt>Remote number (for HTTP lines)</dt>
<dd>The IP address of the client.</dd>
<dt>Call Data (for X25 lines)</dt>
<dd>The call user data field of the call packet (for both incoming and outgoing calls).</dd>
<dt>Call Data (for HTTP lines)</dt>
<dd><p class="first">The external name of the transaction which represents the directory (pathname) in the URL.</p>
<p class="last">If the Virtual Circuit Status Display occupies more than one screen, you can scroll through the list of terminals by using [PF7] and [PF8].</p>
</dd>
<dt>[PF7]</dt>
<dd>scroll back to previous page.</dd>
<dt>[PF8]</dt>
<dd><p class="first">scroll forward to next page.</p>
<p>You can use the [PF4] and [PF5] keys to display information about the other lines under VIRTEL control. To view the terminal or Virtual Circuit Status Display screen for the following line, press [PF4]. To return to the Detail Usage Status Display screen for the first line defined in VIRTEL, press [PF5].</p>
<p class="last">To return to the Lines Status Display, press [PF3]. To return to the Configuration Menu, press [Clear].</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="memory-display-application">
<span id="index-40"></span><h3>Memory Display Application<a class="headerlink" href="#memory-display-application" title="Permalink to this headline">¶</a></h3>
<p>The VIRTEL memory management sub-application allows the system  administrator to display VIRTEL memory utilisation in real time. The memory management sub-application is a pseudo-graphical display which shows the allocation of VIRTEL memory by function. VIRTEL manages its own memory, in order to avoid memory shortages as a result of fragmentation. The memory management display can be used by the administrator to help understand VIRTEL’s memory requirements during normal operation.</p>
<p>To invoke the memory management sub-application, press [PA2] in the Configuration Menu to display the Sub- Application Menu, then press [PF4] in the Sub-Application Menu. The sub-application displays a screen similar to the example shown below. This screen represents the contents of the VIRTEL address space after deducting the space  occupied by the VIRTEL kernel modules.</p>
<p><img alt="image26" src="../../../_images/image2612.png" /></p>
<p><em>Fig 25. Memory display of VIRTEL address space</em></p>
<p>Each screen position represents a 2K memory block (if MEMORY=BELOW is specified in the VIRTCT), or a 64K memory block (if MEMORY=ABOVE). The address displayed at the start of each line is the virtual address represented by the first position in the line. Each free memory block is represented by a dot. Lines which consist entirely of dots are not displayed.</p>
<p>Permanently allocated memory blocks are represented by the following character types:</p>
<blockquote>
<div><ol class="arabic simple">
<li>To avoid memory shortages as a result of fragmentation, these blocks are always allocated at the end of the VIRTEL address space.</li>
<li>Temporarily allocated memory blocks. Blocks of this type are allocated and freed by VIRTEL as required.</li>
<li>Memory blocks used by the VIRTEL Multi-Session feature to save screen images. Blocks of this type are allocated and freed by VIRTEL as required.</li>
<li>Memory blocks used for saving EIB and other session-related information. Blocks of this type are allocated and freed by VIRTEL as required.</li>
<li>Communication areas by VIRTEL sub-applications. Blocks of this type are allocated and freed by VIRTEL as required.</li>
<li>Sub-application modules loaded in the z/VSE SUBPOOL. Blocks of this type are allocated and freed by VIRTELas required.</li>
</ol>
</div></blockquote>
<div class="section" id="memory-display-in-memory-test-mode">
<span id="index-41"></span><h4>Memory display in Memory=Test mode.<a class="headerlink" href="#memory-display-in-memory-test-mode" title="Permalink to this headline">¶</a></h4>
<p>If MEMORY=TEST is specified in the VIRTCT, the memory management sub-application displays its results in a different format. MEMORY=TEST mode allows support technicians to analyse memory occupation by module, as a debugging aid for possible memory shortage problems.</p>
<p><img alt="image28" src="../../../_images/image2814.png" /></p>
<p><em>Fig. 26 - Memory display in MEMORY=TEST mode</em></p>
<p>Each line of the screen represents one VIRTEL module which has obtained one or more memory blocks. The first column represents the number of bytes of memory (en hexadecimal) currently allocated by the module. The first 16 modules are displayed, in descending order of memory utilisation.</p>
<p>Where the memory display occupies more than one screen, you can press [PF8] to view the following page, [PF7] to view the previous page, and [PF6] to go back to the first page.</p>
<p>To refresh the display with up-to-date information, press [Enter].</p>
<p>To return to the sub-application menu, press [PF3] or [Clear]</p>
<p>5.2 Virtual Memory Display</p>
<p>The Memory display feature is a memory diagnostic tool created to trap possible invalid Virtel memory free requests. Such request can lead to ABEND0C4s and other unwanted behaviour. Virtel memory requests (PRENDRE and RENDRE) are tracked in a diagnostic storage area located above the bar. The area is 1MB in size and can contain 65536 active storage requests. An active storage request is a storage area that has been gotten (PRENDRE) and is pending a Virtel storage release (RENDRE).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This diagnostic tool should only be used when recommended by Technical Support.</p>
</div>
</div>
<div class="section" id="memory-trace-management">
<span id="index-42"></span><h4>Memory trace management<a class="headerlink" href="#memory-trace-management" title="Permalink to this headline">¶</a></h4>
<div class="section" id="activating-the-memory-trace">
<h5>Activating the memory trace<a class="headerlink" href="#activating-the-memory-trace" title="Permalink to this headline">¶</a></h5>
<p>A memory trace can be activated using a command or from the VIRTCT. In both case, VIRTEL records an history of memory allocations that appears in a SNAP listing. A memory trace can be activated by using the following command</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MEMTRACE</span>
</pre></div>
</div>
<p>The will produce the following response:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">VIR0200I</span> <span class="n">MEMTRACE</span>
<span class="n">VIR0214I</span> <span class="n">MEMORY</span> <span class="n">TRACE</span> <span class="n">STARTED</span>
<span class="n">VIR0218I</span> <span class="n">MEMORY</span> <span class="n">TRACE</span> <span class="n">FOUND</span> <span class="mi">00000000</span> <span class="n">BLOCKS</span> <span class="n">USING</span> <span class="mi">0000000000000000</span> <span class="n">BYTES</span> <span class="p">(</span><span class="mi">00000000</span> <span class="n">MEGS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="resetting-the-memory-trace">
<h5>Resetting the memory trace<a class="headerlink" href="#resetting-the-memory-trace" title="Permalink to this headline">¶</a></h5>
<p>A memory trace can be reseted by using the following command:-</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MEMTRACE</span><span class="p">,</span><span class="n">Clear</span>
</pre></div>
</div>
<p>The trace is stopped, memory blocks used by the memory trace are released, the trace is restarted.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">VIR0200I</span> <span class="n">MEMTRACE</span><span class="p">,</span><span class="n">CLEAR</span>
<span class="n">VIR0218I</span> <span class="n">MEMORY</span> <span class="n">TRACE</span> <span class="n">FOUND</span> <span class="mi">00000011</span> <span class="n">BLOCKS</span> <span class="n">USING</span> <span class="mi">0000000000053344</span> <span class="n">BYTES</span> <span class="p">(</span><span class="mi">00000000</span> <span class="n">MEGS</span><span class="p">)</span>
<span class="n">VIR0216I</span> <span class="n">CLEARING</span> <span class="n">MEMORY</span> <span class="n">TRACE</span>
<span class="n">VIR0217I</span> <span class="n">MEMORY</span> <span class="n">TRACE</span> <span class="n">CLEARED</span>
<span class="n">VIR0214I</span> <span class="n">MEMORY</span> <span class="n">TRACE</span> <span class="n">STARTED</span>
<span class="n">VIR0218I</span> <span class="n">MEMORY</span> <span class="n">TRACE</span> <span class="n">FOUND</span> <span class="mi">00000000</span> <span class="n">BLOCKS</span> <span class="n">USING</span> <span class="mi">0000000000000000</span> <span class="n">BYTES</span> <span class="p">(</span><span class="mi">00000000</span> <span class="n">MEGS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="stopping-the-memory-trace">
<h5>Stopping the memory trace<a class="headerlink" href="#stopping-the-memory-trace" title="Permalink to this headline">¶</a></h5>
<p>A memory trace can be stopped by using the following command:-</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NOMEMTRACE</span>
</pre></div>
</div>
<p>The trace is stopped, memory blocks used by the memory trace are released.</p>
</div>
<div class="section" id="setting-memory-trace-in-the-virtct">
<h5>Setting Memory Trace in the VIRTCT<a class="headerlink" href="#setting-memory-trace-in-the-virtct" title="Permalink to this headline">¶</a></h5>
<p>A memory trace can be activated from the VIRTCT by using MEMORY=TEST or MEMORY=(ABOVE,TRACE) parameter. In such case, the is no message VIR0218I display in the log, but only the benefit of recording the history of memory allocations is kept in the SNAP.</p>
<p>Since it is not possible to stop a trace initialized in this way, it is best to only use this method to perform an analysis of the memory allocation during the startup phase.
Once a memory trace activated, issuing a SNAP command produce a report of the memory allocations history in the SNAP listing.</p>
<p><img alt="image27" src="../../../_images/image2713.png" /></p>
<p><em>Example of a memory allocataion history</em></p>
<dl class="docutils">
<dt>Column Explanations</dt>
<dd><ol class="first last arabic simple">
<li>Line or terminal name for which memory allocation is performed. This information is omitted when the allocation relates VIRTEL itself.</li>
<li>Task number behind the allocation request.</li>
<li>Register 14 value.</li>
<li>Register 15 value.</li>
<li>Program name + offset of the origin request.</li>
<li>Memory allocation type. (8040 = GETMAIN).</li>
<li>Memory block state.</li>
<li>Time of the allocation.</li>
<li>Type and size of the allocation. The two first bytes represents the type of memory allocated (See “Memory display of VIRTEL address space” for a complete description of the memory block type.). The six last bytes represents the size of the memory block allocated.</li>
<li>Reserved for internal use.</li>
</ol>
</dd>
</dl>
<p>Tracing memory activity can produce an important overhead estimated to 20-30% of the activity. When using MEMTRACE command, the memory previously allocated to records history is released.</p>
<span class="target" id="v460ap-maintenance"></span><span class="target" id="index-43"></span></div>
</div>
</div>
<div class="section" id="maintenance">
<span id="index-44"></span><h3>Maintenance<a class="headerlink" href="#maintenance" title="Permalink to this headline">¶</a></h3>
<p>Maintence is normally delivered through email or by downloading a maintenance package from the Virtel ftp web server - <a class="reference external" href="http://ftp.syspertec.com/login/">http://ftp.syspertec.com/login/</a>. Maintenance comes as either zaps to the Virtel mainframe modules or updates to the web elements. Application of the mainframe zaps is through the IBM Utility AMASPZAP. The updates to the web elements is through a Virtel GUI Drag and Drop interface or via a Virtel Batch process. This is found in the Administration Portal of Virtel. The Drag and Drop interface is described in section 1.6.2 in the Virtel User Guide.</p>
<div class="section" id="applying-z-os-maintenance">
<span id="index-45"></span><h4>Applying z/OS maintenance.<a class="headerlink" href="#applying-z-os-maintenance" title="Permalink to this headline">¶</a></h4>
<p>By default, maintenance to the z/OS components of Virtel is delivered as AMASPZAP control statements either delivered as an email attachment or dowloaded from the Syspertec ftp web server. The mainframe zap packages come as an accumulation file called either <em>allptfs-mshpvrr.txt</em> (z/VSE) or <em>allptfs-mvsvrr-txt</em> (z/OS).</p>
<p><img alt="image29" src="../../../_images/image2910.png" /></p>
<p><em>Syspertec ftp web server</em></p>
<p>Once downloaded and unzipped, the zap package will contain a sequential text file of AMASPZAP statements. These should be uploaded to the Virtel CNTL file as PTFvrrMV. The JOB ZAPJCL, also located in the CNTL file, should then be submiited to apply the zaps contained in the PTFvrrMV file. As the PTFvrrMV is an accumulation of PTFs some editing will have to be done to remove zaps that have already been applied. Virtel will report the zap maintenace level when it starts up.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">VIR0018I</span> <span class="n">VIRTEL</span> <span class="mf">4.60</span> <span class="n">HAS</span> <span class="n">THE</span> <span class="n">FOLLOWING</span> <span class="n">PTF</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="n">APPLIED</span>
<span class="n">VIR0018I</span> <span class="mi">5530</span><span class="p">,</span><span class="mi">5540</span><span class="p">,</span><span class="mi">5549</span><span class="p">,</span><span class="mi">5557</span><span class="p">,</span><span class="mi">5559</span><span class="p">,</span><span class="mi">5567</span>
<span class="n">VIR0089I</span> <span class="n">VIRTEL</span> <span class="n">RUNNING</span> <span class="n">FROM</span> <span class="n">AN</span> <span class="n">AUTHORIZED</span> <span class="n">LIBRARY</span>
</pre></div>
</div>
</div>
<div class="section" id="applying-maintenance-to-the-trsf-files">
<span id="index-46"></span><h4>Applying maintenance to the TRSF files<a class="headerlink" href="#applying-maintenance-to-the-trsf-files" title="Permalink to this headline">¶</a></h4>
<p>The updates to the web entities are delivered as an accumulation update file called <em>virtelvrrupdtnnnn1.zip</em> where nnnn is the update number. These update files can be downloaded from the Syspertec ftp web server. Applying updates to the web elements is through a manual drap and drop GUI or via a batch process. Download the update package and unzip the contents. A directory structure representing the Virtel SAMPTRSF directories will be built. Note, not all of the directories are shipped with an update package, only those that have maintenance will be shipped. Normally, the W2H-DIR contains the majority of web element updates. The Administration portal is used to upload the updates to the Virtel directories. After applying the updates to the Virtel directories refresh the browsers cache to force an update of the client web elements.</p>
<p><img alt="image30" src="../../../_images/image309.png" /></p>
<p><em>Unzipped update file</em></p>
<p>In the above example, the update file contains updates to the W2H and DOC directories. The members in each directory should be selected (CTRL-A) and dragged over to the “Drag and Drop” upload option of the Virtel Administration portal, normally setup on port 41001.</p>
<p><img alt="image31" src="../../../_images/image3119.png" /></p>
<p><em>Virtel Administration Portal</em></p>
<p>Open the “Drag and Drop” interface in Virtel, and then drag the files over on to the relvant directory in the upload interface. A upload window will open showing the results of the upload.</p>
<p><img alt="image32" src="../../../_images/image3219.png" /></p>
<p><em>Virtel Drag and Drop Interface</em></p>
</div>
<div class="section" id="applying-maintenance-via-batch">
<span id="index-47"></span><h4>Applying maintenance via batch.<a class="headerlink" href="#applying-maintenance-via-batch" title="Permalink to this headline">¶</a></h4>
<p>A batch maintenace package called virtelrvvVMPnnnn.zip can also be used to apply maintenance to the SAMPTRSF file. Using the batch process doesn’t require any manual process, it runs as a batch job on the mainfram. However, the target Virtel instance cannot be running at the same time. the process for applying a Virtel Maintenace Package is outlined in the Virtel Technical newsletter “TN201709 Virtel batch maintenance”. This can be viewed online at <a class="reference external" href="http://virtel.readthedocs.io/en/latest/manuals/newsletters/TN201709/TN201709.html">http://virtel.readthedocs.io/en/latest/manuals/newsletters/TN201709/TN201709.html</a></p>
<span class="target" id="v460ap-correspondent-management"></span></div>
</div>
<div class="section" id="correspondent-management">
<span id="index-48"></span><h3>Correspondent Management<a class="headerlink" href="#correspondent-management" title="Permalink to this headline">¶</a></h3>
<p>One of the methods which VIRTEL may use to identify users is by means of a security code which the user presents to VIRTEL, either in an incoming e-mail, or by means of a “cookie” included in an HTTP request by the browser. A user which VIRTEL recognizes in this way is known as a “Correspondent”. VIRTEL stores the list of correspondents in a VSAM file known as the “Correspondent file”, also known as the “VIRHTML” file.</p>
<p>VIRTEL uses the correspondent file for the following purposes:
- the rules of an HTTP line permit VIRTEL to distinguish between correspondents and non-correspondents when processing incoming HTTP requests. When the requesting user is identified as a correspondent, a special entry point may be assigned, or a set of rules specific to the user may be executed. Refer to “Rules” in the VIRTEL Connectivity Reference manual for further details.
- the rules of an HTTP line may assign a specific LU name to a correspondent connecting to a host application via web access. This is known as “LU nailing” and is described in more detail in the VIRTEL LU Nailing HOWTO manual.
- a correspondent may be authorized to upload HTML pages and other elements into an HTMLTRSF file. For further details, refer to <a class="reference internal" href="#v460ap-http-uploading-pages-smtp"><span class="std std-ref">“Uploading pages by SMTP”</span></a> and <a class="reference internal" href="#v460ap-http-uploading-pages"><span class="std std-ref">“Uploading pages by HTTP (secured by cookie)”</span></a>.</p>
<p>There are two types of correspondent: an e-mail correspondent and a local correspondent:
- An <strong>e-mail correspondent</strong> is always defined by the VIRTEL administrator. When the administrator activates an email correspondent, VIRTEL sends an e-mail message to the correspondent containing the security code. The correspondent then either replies to the e-mail message or clicks on a link in the message to connect to VIRTEL.
- A <strong>local correspondent</strong> is activated by the correspondent using a procedure known as “self-registration”. The self-registration procedure creates a clickable link which delivers the security code to the correspondent’s browser via a cookie. The VIRTEL administrator may optionally pre-define or change the characteristics of a correspondent by using the correspondent management sub-application. Self-registration is described in the VIRTEL LU Nailing HOWTO manual.</p>
<div class="section" id="access-to-the-application">
<span id="index-49"></span><h4>Access to the application<a class="headerlink" href="#access-to-the-application" title="Permalink to this headline">¶</a></h4>
<p>The correspondent management sub-application, which allows the VIRTEL administrator to define the parameters
associated with a correspondent, is accessible by pressing [PF5] in the VIRTEL configuration menu, or [PF12] in the
system services sub-application menu, or from the VIRTEL Multi-Session screen via an application referencing the
module VIR0041A.</p>
</div>
<div class="section" id="security">
<span id="index-50"></span><h4>Security<a class="headerlink" href="#security" title="Permalink to this headline">¶</a></h4>
<p>When security is active, access to the correspondent management sub-application from the configuration menu or
from the system services sub-application menu is controlled by the resource $$PCPC$$.
When it is accessed by a transaction, the rules of security management of transactions will apply.
Security management is described under the heading “Security” 282.</p>
</div>
<div class="section" id="objectives">
<span id="index-51"></span><h4>Objectives<a class="headerlink" href="#objectives" title="Permalink to this headline">¶</a></h4>
<p>This sub-application initially displays a summary screen of existing definitions presented in alphanumeric order. Access
to the detail of a correspondent is achieved by positioning the cursor and pressing [PF12].</p>
<p><img alt="image74" src="../../../_images/image748.png" /></p>
<p><em>Summary of correspondence</em></p>
<p><img alt="image75" src="../../../_images/image758.png" />
<em>Correspondent detail screen (e-mail correspondent)</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CORRESPONDENT</span> <span class="n">DETAIL</span> <span class="n">DEFINITION</span> <span class="o">--------------------</span> <span class="n">Applid</span><span class="p">:</span> <span class="n">SPVIRE2</span> <span class="mi">16</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">04</span>
<span class="n">Id</span>                 <span class="o">===&gt;</span> <span class="n">WKSTN</span><span class="o">-</span><span class="n">A2FE</span><span class="o">/</span><span class="n">SYSPERTEC</span>
                        <span class="n">workstation</span><span class="o">/</span><span class="n">lan</span>
<span class="n">Type</span> <span class="n">of</span> <span class="n">Id</span>         <span class="o">===&gt;</span> <span class="mi">2</span>             <span class="mi">1</span><span class="p">:</span><span class="n">Email</span> <span class="mi">2</span><span class="p">:</span><span class="n">Local</span><span class="o">+</span><span class="n">fixed</span> <span class="mi">3</span><span class="p">:</span><span class="n">Local</span><span class="o">+</span><span class="n">changing</span>
<span class="n">Activation</span> <span class="n">message</span> <span class="o">===&gt;</span>
                                      <span class="n">Text</span> <span class="n">of</span> <span class="s1">&#39;OK&#39;</span> <span class="n">message</span> <span class="n">to</span> <span class="n">user</span><span class="o">.</span>
<span class="n">VTAM</span> <span class="n">name</span>          <span class="o">===&gt;</span> <span class="n">RRVTC006</span>      <span class="o">&amp;</span><span class="mi">1</span> <span class="n">parameter</span> <span class="n">to</span> <span class="n">specify</span> <span class="n">VTAM</span> <span class="n">LU</span> <span class="n">name</span>
<span class="n">Rule</span> <span class="n">Set</span>           <span class="o">===&gt;</span>               <span class="n">Rules</span> <span class="n">to</span> <span class="n">choose</span> <span class="n">an</span> <span class="n">entry</span> <span class="n">point</span>
<span class="n">Directory</span>          <span class="o">===&gt;</span>               <span class="n">Where</span> <span class="n">data</span> <span class="ow">is</span> <span class="n">to</span> <span class="n">be</span> <span class="n">uploaded</span>
<span class="n">Last</span> <span class="n">contact</span>       <span class="o">===&gt;</span> <span class="mi">30</span> <span class="n">Jun</span> <span class="mi">2009</span> <span class="mi">11</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">49</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">002.082</span>
<span class="n">Contacts</span>           <span class="o">===&gt;</span> <span class="mi">00000010</span> <span class="n">Number</span> <span class="n">of</span> <span class="n">times</span> <span class="n">cookie</span> <span class="n">was</span> <span class="n">updated</span>
<span class="n">Date</span> <span class="n">created</span>       <span class="o">===&gt;</span> <span class="mi">30</span> <span class="n">Jun</span> <span class="mi">2009</span> <span class="mi">10</span><span class="p">:</span><span class="mi">35</span><span class="p">:</span><span class="mi">30</span>
<span class="n">Created</span> <span class="n">by</span>         <span class="o">===&gt;</span> <span class="n">VIRDBA</span>
<span class="n">Date</span> <span class="n">activated</span>     <span class="o">===&gt;</span> <span class="mi">30</span> <span class="n">Jun</span> <span class="mi">2009</span> <span class="mi">10</span><span class="p">:</span><span class="mi">35</span><span class="p">:</span><span class="mi">30</span>
<span class="n">Activated</span> <span class="n">by</span>       <span class="o">===&gt;</span> <span class="n">VIRDBA</span>
<span class="n">Date</span> <span class="n">disabled</span>      <span class="o">===&gt;</span>
<span class="n">Disabled</span> <span class="n">by</span>        <span class="o">===&gt;</span>

<span class="n">P1</span><span class="o">=</span><span class="n">Update</span>                           <span class="n">P3</span><span class="o">=</span><span class="n">Return</span>                      <span class="n">Enter</span><span class="o">=</span><span class="n">Add</span>
<span class="n">P4</span><span class="o">=</span><span class="n">Activate</span>                         <span class="n">P5</span><span class="o">=</span><span class="n">Disable</span>                     <span class="n">P6</span><span class="o">=</span><span class="n">Rules</span>
</pre></div>
</div>
<p><em>Correspondent detail screen (local correspondent)</em></p>
</div>
<div class="section" id="field-contents">
<span id="index-52"></span><h4>Field Contents<a class="headerlink" href="#field-contents" title="Permalink to this headline">¶</a></h4>
<dl class="docutils">
<dt>Id</dt>
<dd>For an e-mail correspondent: the e-mail address of the correspondent. For a local correspondent: a unique identifier generated by the self-registration procedure, or assigned by the VIRTEL administrator.</dd>
<dt>Type of Id</dt>
<dd><ol class="first last arabic simple">
<li>this is an e-mail correspondent</li>
<li>this is a local correspondent whose security code is generated at activation time and subsequently remains constant</li>
<li>this is a local correspondent whose security code changes each time it is accessed.</li>
</ol>
</dd>
<dt>Activation message</dt>
<dd><p class="first">Message received by the user at time of activation of his account. This message can contain a link allowing the user to connect to a host application or to open the upload.htm page with automatic installation of an authorization cookie.</p>
<blockquote class="last">
<div><dl class="docutils">
<dt>The activation message may include the following variables:</dt>
<dd><p class="first">&amp;R meaning “insert a blank line”.</p>
<p class="last">&amp;C meaning “insert security code”. The activation security code is inserted into the message in the form VirtelCookie=xxx.</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>Rule Set</dt>
<dd>(optional) The name of the rule set associated with this user.</dd>
<dt>Directory</dt>
<dd>(optional) Name of the directory into which this correspondent may upload files.</dd>
<dt>Last contact</dt>
<dd>Date and time of the last transfer, and the IP address of the correspondent.</dd>
<dt>Contacts</dt>
<dd>The number of contacts since the last activation.</dd>
</dl>
<span class="target" id="v460ap-account-activation"></span></div>
<div class="section" id="account-activation">
<span id="index-53"></span><h4>Account activation<a class="headerlink" href="#account-activation" title="Permalink to this headline">¶</a></h4>
<p>In order to be operational, a correspondent account must be activated. This is achieved by pressing [PF4] at the CORRESPONDENT DETAIL DEFINITION screen. In the case of an e-mail correspondent, VIRTEL will transmit an initial email to the correspondent containing the security code to be used for the transfers. The message ACTIVATION WAS REQUESTED indicates that the correspondent’s security code has been activated, and, in the case of an e-mail
correspondent, that the e-mail was sent successfully. The number of contacts is reset to zero.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To activate an e-mail correspondent, the administrator must be logged on to VIRTEL via an entry point containing a transaction with external name $MAIL$ (application type=3) which contains, in the application field, the name of the SMTP line used by VIRTEL. The message YOU ARE NOT AUTHORISED TO USE THIS APPLICATION indicates that the $MAIL$ transaction is not defined.</p>
</div>
</div>
<div class="section" id="account-deactivation">
<span id="index-54"></span><h4>Account deactivation<a class="headerlink" href="#account-deactivation" title="Permalink to this headline">¶</a></h4>
<p>A correspondent’s security code may be cancelled by deactivating with the [PF5] key. The message DISABLE WAS DONE indicates that the deactivation was successful.</p>
</div>
<div class="section" id="access-to-associated-rule-set">
<span id="index-55"></span><h4>Access to associated rule set<a class="headerlink" href="#access-to-associated-rule-set" title="Permalink to this headline">¶</a></h4>
<p>To display the list of rules associated with this correspondent, press the [PF6] key.</p>
<span class="target" id="v460ap-web-entity-management"></span></div>
</div>
<div class="section" id="web-entity-management">
<span id="index-56"></span><h3>Web Entity Management<a class="headerlink" href="#web-entity-management" title="Permalink to this headline">¶</a></h3>
<p>Web Entity Management is concerned with maintaining the Virtel Web entities, such as HTML template pages, CSS, JavaScript elements and images etc. These can all be uploaded to the VIRTEL directories by any of the following methods:</p>
<ol class="arabic simple">
<li>by web browser (HTTP) from a PC, with signon security. Provided by Administration Portal.</li>
<li>Via a batch process from a PC.</li>
<li>by e-mail (SMTP). (Corresspondence Management only)</li>
<li>by web browser (HTTP), with cookie security. (Corresspondence Management only)</li>
</ol>
<span class="target" id="v460ap-http-uploading-pages-signon"></span><div class="section" id="uploading-by-web-browser-http-secured-by-signon">
<span id="index-57"></span><h4>Uploading by web browser (HTTP) (secured by signon)<a class="headerlink" href="#uploading-by-web-browser-http-secured-by-signon" title="Permalink to this headline">¶</a></h4>
<p>The upload4.htm page allows the administrator to upload HTML pages and graphics to VIRTEL. When this page is first loaded, the web browser displays a signon dialog box requesting a userid and password. The userid allows the security product (RACF, ACF2, TSS, or VIRTEL) to determine which, if any, of the page upload transactions the user is authorized to use. Each VIRTEL directory has its own upload transaction, so that upload security can be applied individually to each directory, by authorizing users to the corresponding directory’s upload transaction.</p>
</div>
<div class="section" id="definitions-for-upload-secured-by-signon">
<span id="index-58"></span><h4>Definitions for upload (secured by signon)<a class="headerlink" href="#definitions-for-upload-secured-by-signon" title="Permalink to this headline">¶</a></h4>
<p>All the elements needed for page upload by HTTP secured by signon are contained in the base configuration delivered with VIRTEL. Users who upgrade from a version prior to VIRTEL 4.27 while keeping their existing configuration need to add certain elements to their existing configuration to benefit from the new “page upload secured by signon” function.</p>
<p>The following steps show how to upgrade your configuration based on entry point WEB2HOST. You can also carry out these steps in batch by running the DEFUPLOD job in the SAMPLIB delivered with VIRTEL. Having updated the configuration, you then need to upload one new page (upload4.htm) to the W2H-DIR directory using the existing SMTP upload method.</p>
<ol class="arabic simple">
<li>In entry point WEB2HOST, define a new transaction W2H-68 with external name dirlist, application name VIR0041S and application type 2:</li>
</ol>
<p><img alt="image77" src="../../../_images/image778.png" />
<em>Page upload by HTTP with signon : Transaction dirlist</em></p>
<ol class="arabic simple" start="2">
<li>Still in entry point WEB2HOST, define three new transactions W2H–71, W2H-72, W2H-73 with external names uplbas, uplw2h, and uplcli. Each of these transactions specifies VIR0041C as the application name and application type 2. The “Logon message” field contains the name of the target directory: HTMLBAS for transaction uplbas, W2HDIR for transaction uplw2h, and CLI-DIR for uplcli :</li>
</ol>
<p><img alt="image78" src="../../../_images/image788.png" /> <em>Page upload by HTTP with signon : Directory HTMLBAS</em></p>
<p><img alt="image79" src="../../../_images/image798.png" /> <em>Page upload by HTTP with signon : Directory W2HDIR</em></p>
<p><img alt="image80" src="../../../_images/image807.png" /> <em>Page upload by HTTP with signon : Directory CLIDIR</em></p>
<ol class="arabic simple" start="3">
<li>Use your security package (VIRTEL/SECURITE, RACF, TOP SECRET, ACF2) to grant access to resources W2H-71 and HTMLBAS (for users authorized to upload pages to the HTMLBAS directory) and/or to resources W2H-72 and W2HDIR (for users authorized to upload pages to the W2H-DIR directory) and/or to resources W2H-73 and CLI-DIR (for users authorized to upload pages to the CLI-DIR directory). For more details, refer to the “VIRTEL Security Guide” manual.</li>
</ol>
</div>
<div class="section" id="procedure-for-upload-secured-by-signon">
<span id="index-59"></span><h4>Procedure for upload (secured by signon)<a class="headerlink" href="#procedure-for-upload-secured-by-signon" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li>Display the upload4.htm page by entering the URL <a class="reference external" href="http://ipaddr:port/SECURE/upload4.htm+dirlist">http://ipaddr:port/SECURE/upload4.htm+dirlist</a> in your browser, or by clicking the “Upload” link on the VIRTEL Web2Host welcome page. Because the directory named SECURE is defined as a secure transaction, VIRTEL first requests the browser to display the password dialog box shown below:</li>
</ol>
<p><img alt="image8" src="../../../_images/image829.png" /></p>
<p><em>Page upload by HTTP with signon : Entering the userid and password</em></p>
<p>The user must have authority to access the resource represented by the internal name of the page upload transaction for the desired directory.</p>
<ol class="arabic simple" start="2">
<li>After entering the user name and password, the upload4.htm page will be displayed:</li>
</ol>
<p><img alt="image9" src="../../../_images/image930.png" /></p>
<p><em>Page upload by HTTP with signon : Displaying the upload4.htm page</em></p>
<ol class="arabic simple" start="3">
<li>Press the “Browse” button to display the file selection dialog:</li>
</ol>
<p><img alt="image10" src="../../../_images/image1026.png" /></p>
<p><em>Page upload by HTTP with signon : File selection dialog</em></p>
<ol class="arabic simple" start="4">
<li>Select the file you want to upload, then press the “Open” button. The name of the selected file will be displayed in the input field:</li>
</ol>
<p><img alt="image11" src="../../../_images/image1130.png" /></p>
<p><em>Page upload by HTTP with signon : Sending the file</em></p>
<ol class="arabic simple" start="5">
<li>Press the button corresponding to the target directory (W2H-DIR in this example) to upload the file to VIRTEL. VIRTEL stores the file in the chosen directory, and displays the result:</li>
</ol>
<p><img alt="image12" src="../../../_images/image1224.png" /></p>
<p><em>Page upload by HTTP with signon : Confirmation of file upload</em></p>
<p>Depending on the values specified in the directory definition, VIRTEL may convert the filename to upper case, and truncate the filename to a maximum length, before storing it in the directory. The filename after conversion and truncation must not duplicate any other filename in the directory. For example, when uploading to a directory defined using the default parameters (not case sensitive, with maximum filename length 8), the file links.gif would be stored under the name LINKS.GI</p>
</div>
<div class="section" id="uploading-by-web-browser-http-by-gui-drag-and-drop">
<span id="index-60"></span><h4>Uploading by web browser (HTTP) by GUI drag and drop<a class="headerlink" href="#uploading-by-web-browser-http-by-gui-drag-and-drop" title="Permalink to this headline">¶</a></h4>
<p>The VIRTEL administrator can upload pages to a VIRTEL directory using the drag and drop upload interface with the Firefox or Chrome browser. This method has the advantage that multiple pages can be uploaded to a VIRTEL directory (for example, W2H-DIR) in a single operation.</p>
<div class="section" id="upload-interface-in-the-virtel-menu">
<h5>Upload interface in the VIRTEL menu<a class="headerlink" href="#upload-interface-in-the-virtel-menu" title="Permalink to this headline">¶</a></h5>
<p>After clicking on the Drag &amp; Drop Upload link on the VIRTEL Web Access menu (URL <a class="reference external" href="http://n.n.n.n:41001">http://n.n.n.n:41001</a>), the VIRTEL administrator will be presented with a signon screen, followed by the drag and drop upload interface screen shown below:</p>
<p><img alt="image13" src="../../../_images/image1321.png" /></p>
<p><em>Drag and drop upload interface</em></p>
<p>The administrator can then select one or more files using the workstation graphical user interface, drag them to the upload interface screen, and drop them on the button representing the VIRTEL directory (for example, CLI-DIR). Files in zipped archive may need to be extracted to a temporary directory first.</p>
</div>
<div class="section" id="displaying-upload-results">
<h5>Displaying upload results<a class="headerlink" href="#displaying-upload-results" title="Permalink to this headline">¶</a></h5>
<p><img alt="image14" src="../../../_images/image1420.png" /></p>
<p><em>Displaying upload results</em></p>
<p>The results of the upload are displayed on the screen with a return code for each file uploaded. Each file should produce the message RETURN CODE IS: 00 In addition, by clicking on + or -, the administrator can open and close the detail display for each file uploaded.</p>
</div>
<div class="section" id="upload-summary-report">
<h5>Upload summary report<a class="headerlink" href="#upload-summary-report" title="Permalink to this headline">¶</a></h5>
<p>After multiple files have been uploaded, the drag and drop upload interface will display a summary showing the number of files processed with return code 00, and, in case of error, the number of files which failed to upload nonzero return codes.</p>
<p>The summary is not displayed when files are dragged and dropped one at a time.</p>
<p>In this example, one file has failed to upload because of an invalid VIRTEL tag, and the user has clicked on the + sign to the left of the file to expand the error messages:</p>
<p><img alt="image15" src="../../../_images/image1519.png" /></p>
<p><em>Upload summary report</em></p>
</div>
</div>
<div class="section" id="extracting-upload-results-as-an-excel-spreadsheet">
<span id="index-61"></span><h4>Extracting upload results as an Excel spreadsheet<a class="headerlink" href="#extracting-upload-results-as-an-excel-spreadsheet" title="Permalink to this headline">¶</a></h4>
<p><img alt="image16" src="../../../_images/image1614.png" /> The Excel button allows the administrator to export the results log as a .SLK file which can be opened as an Excel spreadsheet.</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="24%" />
<col width="27%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Directory</th>
<th class="head">File name</th>
<th class="head">Report</th>
<th class="head">Time</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>CLI-DIR</td>
<td>custom.css</td>
<td>RETURN CODE IS: 00</td>
<td>Thu, 13 Sep 2012 08:13:16 GMT</td>
</tr>
<tr class="row-odd"><td>CLI-DIR</td>
<td>custom.js</td>
<td>RETURN CODE IS: 00</td>
<td>Thu, 13 Sep 2012 08:13:16 GMT</td>
</tr>
</tbody>
</table>
<p><img alt="image17" src="../../../_images/image1713.png" /> The Delete button allows the administrator to clear the results log.</p>
<blockquote>
<div><span class="target" id="index-62"></span></div></blockquote>
</div>
<div class="section" id="uploading-in-batch-with-curl">
<span id="index-64"></span><h4>Uploading in batch with cURL<a class="headerlink" href="#uploading-in-batch-with-curl" title="Permalink to this headline">¶</a></h4>
<p>You can upload multiple pages (or other elements) at a time from a Windows workstation by using a command-line HTTP-client program, such as cURL from www.haxx.se.
The following example shows a Windows command to upload all files of type .htm from the current directory to VIRTEL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="o">%</span><span class="n">F</span> <span class="ow">in</span> <span class="p">(</span><span class="o">*.</span><span class="n">htm</span><span class="p">)</span> <span class="n">do</span> <span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">F</span> <span class="s2">&quot;file=@</span><span class="si">%F</span><span class="s2">;type=text/html&quot;</span> <span class="o">-</span><span class="n">u</span>
<span class="n">virdba</span><span class="p">:</span><span class="n">virdbapw</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">235.30</span><span class="p">:</span><span class="mi">41001</span><span class="o">/</span><span class="n">SECURE</span><span class="o">/</span><span class="n">virmsg</span><span class="o">.</span><span class="n">txt</span><span class="o">+</span><span class="n">uplbas</span>
</pre></div>
</div>
<p>In this example:</p>
<dl class="docutils">
<dt>*.htm</dt>
<dd>the files to be uploaded</dd>
<dt>virdba:virdbapw</dt>
<dd>userid and password for VIRTEL</dd>
<dt>192.168.235.30:41001</dt>
<dd>identifies the VIRTEL HTTP line</dd>
<dt>virmsg.txt</dt>
<dd>page template for displaying upload result messages</dd>
<dt>uplbas</dt>
<dd>external name of the upload transaction in VIRTEL which specifies the target directory (HTMLBAS). See <a class="reference internal" href="#v460ap-http-uploading-pages-signon"><span class="std std-ref">“Uploading pages by HTTP (secured by signon)”</span></a> for a list of upload transactions.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<blockquote class="last">
<div>%F appears twice in the command shown above. In conformance with the syntax requirements of the Windows command interpreter, you must use %F if you execute the command from the command prompt, but %%F if you execute the command from within a command (.cmd) file.</div></blockquote>
<span class="target" id="index-65"></span></div>
</div>
<div class="section" id="uploading-in-batch-using-the-upl2virt-command">
<span id="index-66"></span><h4>Uploading in batch using the upl2virt command<a class="headerlink" href="#uploading-in-batch-using-the-upl2virt-command" title="Permalink to this headline">¶</a></h4>
<p>For users of Windows XP and above, the command procedure upl2virt.cmd may be used to upload elements to VIRTEL from the Windows command prompt, or from Windows Explorer. upl2virt automatically generates the required cURL commands as described in the previous section.</p>
<p><strong>Pre-requisites</strong></p>
<p>upl2virt requires as a pre-requisite the cURL package described in the previous section.</p>
<p>Optionally, Bill Stewart’s editvar freeware package from www.westmesatech.com may also be installed. This package allows upl2virt to securely prompt the administrator for a password. If the editvar package is not installed, then upl2virt can still prompt for a password but it will be unable to mask the password as the administrator types it into
the command window.</p>
<p><strong>Installation</strong></p>
<p>upl2virt may be downloaded from VIRTEL to the workstation by entering the following URL in your browser:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">n</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">n</span><span class="p">:</span><span class="mi">41001</span><span class="o">/</span><span class="n">upl2virt</span><span class="o">.</span><span class="n">cmd</span>
</pre></div>
</div>
<p>where n.n.n.n is the IP address of VIRTEL). When prompted, save the upl2virt.cmd file in a directory in your path (for example, C:WINDOWS).</p>
<p><strong>Using upl2virt at the command prompt</strong></p>
<p id="index-67">To execute upl2virt as a command, open a Windows command prompt, navigate to the directory which contains the file(s) to be uploaded, and execute the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">upl2virt</span> <span class="p">[</span><span class="o">-</span><span class="n">u</span> <span class="n">userid</span><span class="p">:</span><span class="n">password</span><span class="p">]</span> <span class="o">-</span><span class="n">d</span> <span class="n">directory</span> <span class="o">-</span><span class="n">a</span> <span class="n">n</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">n</span>
         <span class="p">[</span><span class="o">-</span><span class="n">p</span> <span class="n">port</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">r</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">f</span> <span class="n">ctlfile</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">k</span><span class="p">]</span> <span class="p">[</span><span class="n">file1</span> <span class="n">file2</span> <span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>In the above command:</p>
<dl class="docutils">
<dt>userid:password</dt>
<dd>is your VIRTEL userid and password. If not specified, upl2virt will prompt for userid and password. If userid is specified without the password, then upl2virt will prompt for password.</dd>
<dt>directory</dt>
<dd>is the name of the target VIRTEL directory (for example, CLI-DIR)</dd>
<dt>n.n.n.n</dt>
<dd>is the IP address of VIRTEL</dd>
<dt>port</dt>
<dd>is the VIRTEL administration port number (default 41001).</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is the port number for the WEB2HOST entry point, not the port number associated with the directory you are uploading to.</p>
</div>
<dl class="docutils">
<dt>ctlfile</dt>
<dd>specifies the name of a control file containing a list of file names to be uploaded</dd>
<dt>file1 file2 …</dt>
<dd>are the names of files to be uploaded</dd>
<dt>-r</dt>
<dd>specifies recursion into subdirectories</dd>
<dt>-k</dt>
<dd>keeps the command window open after the last upload</dd>
</dl>
<p>If no file names are specified, and no control file is specified, the default is to upload all web elements from the current directory (and also from all subdirectories if the –r option is specified).</p>
<p id="index-68"><strong>Using upl2virt from Windows Explorer</strong></p>
<p>The upl2virt command may also be used to upload elements to VIRTEL from the Windows Explorer interface. Having selected one or more files in Windows Explorer, the administrator right-clicks on the selected files and chooses the “Send To” option, then chooses “Upload to VIRTEL” from the “Send To” menu. To activate the “Upload to VIRTEL” option in the “Send To” menu, use Windows Explorer to navigate to the “c:Documents and SettingsusernameSendTo” folder, where username is your Windows username. If you cannot see the SendTo folder, then click on “Tools” – “Folder options” – “View”, tick the option “Display hidden files and folders”, and click “OK”.</p>
<p>In the “SendTo” folder, right click and select “New” – “Shortcut”. Then click “Browse”, navigate to the place where you stored the upl2virt.cmd file, and click on it. Click “Next” and enter a descriptive title for the menu item, such as “Upload to VIRTEL”. Then click “Finish”. You now have an item in the “SendTo” folder named “Upload to VIRTEL”. Right-click on this item and choose “Properties”. In the “Target” field you will see the path to the upl2virt.cmd file which you specified. Update this field with parameters as shown in the example below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>C:\WINDOWS\upl2virt.cmd -u MYUSERID -d CLI-DIR -a 10.1.12.101 –k
</pre></div>
</div>
<p>where:</p>
<dl class="docutils">
<dt>MYUSERID</dt>
<dd>is your VIRTEL userid</dd>
<dt>CLI-DIR</dt>
<dd>is the name of the VIRTEL directory that this shortcut will upload to</dd>
<dt>10.1.12.101</dt>
<dd>is the IP address of VIRTEL.</dd>
</dl>
<p>You may omit the –u MYUSERID parameter and upl2virt will prompt you for your userid.</p>
<span class="target" id="v460ap-http-uploading-pages-smtp"></span></div>
<div class="section" id="uploading-template-pages-using-smtp">
<span id="index-69"></span><h4>Uploading template pages using SMTP<a class="headerlink" href="#uploading-template-pages-using-smtp" title="Permalink to this headline">¶</a></h4>
<p>Upload by SMTP allows the administrator to load HTML pages into VIRTEL by e-mail. VIRTEL sends the administrator an e-mail, and the administrator replies to this e-mail with the pages to be uploaded included as attachments. VIRTEL sends another e-mail to inform the administrator that the upload was successful. The administrator saves this e-mail and replies to it the next time he has a set of pages to upload.</p>
<div class="section" id="definitions-for-page-upload-by-smtp">
<span id="index-70"></span><h5>Definitions for page upload by SMTP<a class="headerlink" href="#definitions-for-page-upload-by-smtp" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Check the definition of your SMTP line (F1 then F12 from the Configuration Menu, see the VIRTEL Connectivity Reference documentation).</li>
<li>Press F5 from the Configuration Menu and define an e-mail correspondent specifying W2H-DIR as the directory name:</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CORRESPONDENT</span> <span class="n">DETAIL</span> <span class="n">DEFINITION</span> <span class="o">--------------------</span> <span class="n">Applid</span><span class="p">:</span> <span class="n">SPVIRE2</span> <span class="mi">14</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">33</span>
<span class="n">Id</span>                  <span class="o">===&gt;</span> <span class="n">upload2</span><span class="nd">@saint</span><span class="o">.</span><span class="n">cloud</span><span class="o">.</span><span class="n">com</span>
                    <span class="n">email</span> <span class="n">address</span> <span class="k">with</span> <span class="s1">&#39;@&#39;</span> <span class="n">sign</span>
<span class="n">Type</span> <span class="n">of</span> <span class="n">Id</span>          <span class="o">===&gt;</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">:</span><span class="n">Email</span> <span class="mi">2</span><span class="p">:</span><span class="n">Local</span><span class="o">+</span><span class="n">fixed</span> <span class="mi">3</span><span class="p">:</span><span class="n">Local</span><span class="o">+</span><span class="n">changing</span>
<span class="n">Activation</span> <span class="n">message</span>  <span class="o">===&gt;</span> <span class="n">To</span> <span class="n">upload</span> <span class="n">file</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">to</span> <span class="n">VIRTEL</span><span class="p">,</span> <span class="n">reply</span> <span class="n">to</span> <span class="n">this</span> <span class="n">message</span><span class="o">.</span>
                    <span class="n">Text</span> <span class="n">of</span> <span class="s1">&#39;OK&#39;</span> <span class="n">message</span> <span class="n">to</span> <span class="n">user</span><span class="o">.</span>
<span class="n">VTAM</span> <span class="n">name</span>           <span class="o">===&gt;</span> <span class="o">&amp;</span><span class="mi">1</span> <span class="n">parameter</span> <span class="n">to</span> <span class="n">specify</span> <span class="n">VTAM</span> <span class="n">LU</span> <span class="n">name</span>
<span class="n">Rule</span> <span class="n">Set</span>            <span class="o">===&gt;</span> <span class="n">ADMRSET1</span> <span class="n">Rules</span> <span class="n">to</span> <span class="n">choose</span> <span class="n">an</span> <span class="n">entry</span> <span class="n">point</span>
<span class="n">Directory</span>           <span class="o">===&gt;</span> <span class="n">W2H</span><span class="o">-</span><span class="n">DIR</span> <span class="n">Where</span> <span class="n">data</span> <span class="ow">is</span> <span class="n">to</span> <span class="n">be</span> <span class="n">uploaded</span>
<span class="n">Last</span> <span class="n">contact</span>        <span class="o">===&gt;</span> <span class="n">QUEUE</span> <span class="n">ACTIVATION</span>
<span class="n">Contacts</span>            <span class="o">===&gt;</span> <span class="mi">00000000</span> <span class="n">Number</span> <span class="n">of</span> <span class="n">times</span> <span class="n">cookie</span> <span class="n">was</span> <span class="n">updated</span>
<span class="n">Date</span> <span class="n">created</span>        <span class="o">===&gt;</span> <span class="mi">11</span> <span class="n">May</span> <span class="mi">2004</span> <span class="mi">14</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">29</span>
<span class="n">Created</span> <span class="n">by</span>          <span class="o">===&gt;</span> <span class="n">VIRDBA</span>
<span class="n">Date</span> <span class="n">activated</span>      <span class="o">===&gt;</span> <span class="mi">11</span> <span class="n">May</span> <span class="mi">2004</span> <span class="mi">14</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">33</span>
<span class="n">Activated</span> <span class="n">by</span>        <span class="o">===&gt;</span> <span class="n">VIRDBA</span>
<span class="n">Date</span> <span class="n">disabled</span>       <span class="o">===&gt;</span>
<span class="n">Disabled</span> <span class="n">by</span>         <span class="o">===&gt;</span>
<span class="n">P1</span><span class="o">=</span><span class="n">Update</span>                       <span class="n">P3</span><span class="o">=</span><span class="n">Return</span>                           <span class="n">Enter</span><span class="o">=</span><span class="n">Add</span>
<span class="n">P4</span><span class="o">=</span><span class="n">Activate</span>                     <span class="n">P5</span><span class="o">=</span><span class="n">Disable</span>                          <span class="n">P6</span><span class="o">=</span><span class="n">Rules</span>
<span class="n">ACTIVATION</span> <span class="n">WAS</span> <span class="n">REQUESTED</span>
</pre></div>
</div>
<p><em>Page upload by SMTP: Creating an e-mail correspondent</em></p>
</div>
<div class="section" id="procedure-for-page-upload-by-smtp">
<span id="index-71"></span><h5>Procedure for page upload by SMTP<a class="headerlink" href="#procedure-for-page-upload-by-smtp" title="Permalink to this headline">¶</a></h5>
<ol class="arabic simple">
<li>Activate the e-mail correspondent: see “Account activation” under the heading <a class="reference internal" href="#v460ap-correspondent-management"><span class="std std-ref">“Correspondent Management”</span></a>. This triggers the sending of an e-mail containing the security code, as in the following example:-</li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Date</span><span class="p">:</span> <span class="n">Tue</span><span class="p">,</span> <span class="mi">27</span> <span class="n">Apr</span> <span class="mi">2004</span> <span class="mi">12</span><span class="p">:</span><span class="mi">04</span><span class="p">:</span><span class="mi">40</span> <span class="o">+</span><span class="mi">0100</span>
<span class="n">From</span><span class="p">:</span> <span class="n">virtel</span><span class="nd">@client</span><span class="o">.</span><span class="n">com</span>
<span class="n">Organization</span><span class="p">:</span> <span class="n">SYSPERTEC</span> <span class="n">COMMUNICATION</span>
<span class="n">To</span><span class="p">:</span> <span class="n">upload2</span><span class="nd">@saint</span><span class="o">.</span><span class="n">cloud</span><span class="o">.</span><span class="n">com</span>
<span class="n">Message</span><span class="o">-</span><span class="nb">id</span><span class="p">:</span>
<span class="o">&lt;</span><span class="mf">20040427120439.07</span><span class="n">F5DA7C</span><span class="o">.</span><span class="mf">5E416500</span><span class="n">Bgpamk4WZRKKBiZWjS4OTlqSES4OWlA</span><span class="o">==&gt;</span>
<span class="n">Subject</span><span class="p">:</span> <span class="n">OK</span> <span class="p">:</span> <span class="o">&lt;</span> <span class="n">W2H</span><span class="o">-</span><span class="n">DIR</span> <span class="o">&gt;</span>
<span class="n">SECURITY</span> <span class="n">TOKEN</span><span class="p">:</span>
<span class="mf">20040427120439.07</span><span class="n">F5DA7C</span><span class="o">.</span><span class="mf">5E416500</span><span class="n">Bgpamk4WZRKKBiZWjS4OTlqSES4OWlA</span><span class="o">==</span>
<span class="n">To</span> <span class="n">upload</span> <span class="n">file</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">to</span> <span class="n">VIRTEL</span><span class="p">,</span> <span class="n">reply</span> <span class="n">to</span> <span class="n">this</span> <span class="n">message</span><span class="o">.</span>
</pre></div>
</div>
<p><em>Page upload by SMTP : activation e-mail</em></p>
<ol class="arabic simple" start="2">
<li>Reply to this e-mail, with the files to be uploaded (HTML pages, graphics, etc) included as attachments. VIRTEL recognizes the security code returned automatically by the e-mail client in the “Message-id” field, and loads the attached files into the directory defined in the definition of the correspondent.</li>
<li>VIRTEL replies by sending an e-mail containing the result of the upload. The following example shows the reply sent by VIRTEL to a request to upload two files: LOGOVERT.GIF and WEB2VIRT.HTM. The “Message-id” field in this e-mail contains the new security code. You can reply to this e-mail the next time you have files to upload.</li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Date</span><span class="p">:</span> <span class="n">Tue</span><span class="p">,</span> <span class="mi">27</span> <span class="n">Apr</span> <span class="mi">2004</span> <span class="mi">12</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">14</span> <span class="o">+</span><span class="mi">0100</span>
<span class="n">From</span><span class="p">:</span> <span class="n">virtel</span><span class="nd">@client</span><span class="o">.</span><span class="n">com</span>
<span class="n">Organization</span><span class="p">:</span> <span class="n">SYSPERTEC</span> <span class="n">COMMUNICATION</span>
<span class="n">To</span><span class="p">:</span> <span class="n">upload2</span><span class="nd">@saint</span><span class="o">.</span><span class="n">cloud</span><span class="o">.</span><span class="n">com</span>
<span class="n">Message</span><span class="o">-</span><span class="nb">id</span><span class="p">:</span>
<span class="o">&lt;</span><span class="mf">20040427123911.07</span><span class="n">F5CDC4</span><span class="o">.</span><span class="n">F669FC80Bgpamk4WZRKKBiZWjS4OTlqSES4OWlA</span><span class="o">==&gt;</span>
<span class="n">Subject</span><span class="p">:</span> <span class="n">OK</span> <span class="p">:</span> <span class="o">&lt;</span><span class="n">W2H</span><span class="o">-</span><span class="n">DIR</span> <span class="o">&gt;</span>
<span class="n">VirtelCookie</span><span class="o">=</span>
<span class="mf">20040427123911.07</span><span class="n">F5CDC4</span><span class="o">.</span><span class="n">F669FC80Bgpamk4WZRKKBiZWjS4OTlqSES4OWlA</span><span class="o">==</span>
<span class="n">RETURN</span> <span class="n">CODE</span> <span class="n">IS</span><span class="p">:</span> <span class="mi">00</span>
<span class="mi">123911</span> <span class="n">MESSAGE</span> <span class="n">RECEIVED</span>
<span class="mi">123912</span> <span class="n">LOADING</span> <span class="n">FILE</span><span class="p">:</span> <span class="n">LOGOVERT</span>
<span class="mi">123912</span> <span class="n">SIZE</span> <span class="p">:</span> <span class="mi">14357</span> <span class="n">BYTES</span> <span class="p">(</span><span class="n">BINARY</span><span class="p">)</span>
<span class="mi">123912</span> <span class="n">MIME</span> <span class="p">:</span> <span class="n">image</span><span class="o">/</span><span class="n">jpeg</span>
<span class="mi">123914</span> <span class="n">LOADING</span> <span class="n">FILE</span><span class="p">:</span> <span class="n">WEB2VIRT</span>
<span class="mi">123914</span> <span class="n">SIZE</span> <span class="p">:</span> <span class="mi">11477</span> <span class="n">BYTES</span> <span class="p">(</span><span class="n">TEXT</span><span class="p">)</span>
<span class="mi">123914</span> <span class="n">MIME</span> <span class="p">:</span> <span class="n">text</span><span class="o">/</span><span class="n">html</span>
<span class="mi">123914</span> <span class="n">FIELD</span> <span class="p">:</span> <span class="n">SET</span><span class="o">-</span><span class="n">OUTPUT</span><span class="o">-</span><span class="n">ENCODING</span><span class="o">-</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span> <span class="s2">&quot;&quot;</span>
<span class="mi">123914</span> <span class="n">FIELD</span> <span class="p">:</span> <span class="n">COPY</span><span class="o">-</span><span class="n">FROM</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">43</span><span class="p">)</span>
<span class="mi">123914</span> <span class="n">FIELD</span> <span class="p">:</span> <span class="n">FIELD</span><span class="o">-</span><span class="n">WITH</span><span class="o">-</span><span class="n">CURSOR</span>
<span class="mi">123914</span> <span class="n">FIELD</span> <span class="p">:</span> <span class="n">FIELD</span><span class="o">-</span><span class="n">WITH</span><span class="o">-</span><span class="n">CURSOR</span>
</pre></div>
</div>
<p><em>Page upload by SMTP : upload response e-mail</em></p>
<p>Depending on the values specified in the directory definition, VIRTEL may convert the filename to upper case, and
truncate the filename to a maximum length, before storing it in the directory. The filename after conversion and
truncation must not duplicate any other filename in the directory. For example, when uploading to a directory defined
using the default parameters (not case sensitive, with maximum filename length 8), the file links.gif would be stored
under the name LINKS.GI</p>
<span class="target" id="v460ap-http-uploading-pages"></span></div>
</div>
<div class="section" id="uploading-pages-by-http-secured-by-cookie">
<span id="index-72"></span><h4>Uploading pages by HTTP (secured by cookie)<a class="headerlink" href="#uploading-pages-by-http-secured-by-cookie" title="Permalink to this headline">¶</a></h4>
<p>The upload.htm page allows HTML pages or graphics to be uploaded to VIRTEL. The user’s identity is guaranteed by a
cookie named VirtelRef= whose value changes after each upload. The value of the cookie is the same as the security
code used for uploading by SMTP.</p>
<p>To upload a page, a user must:</p>
<ul class="simple">
<li>have a valid cookie (obtained by activation of the VIRTEL e-mail correspondent)</li>
<li>click on the link contained in the e-mail, which displays the upload.htm page and loads the cookie into the browser (first time only)</li>
<li>click the “Browse” button and select a file</li>
<li>click the “Send” button</li>
</ul>
<p>The VIRTEL response is displayed in the page and is similar to the response received by e-mail when uploading via
SMTP.</p>
<div class="section" id="definitions-for-page-upload-secured-by-cookie">
<h5>Definitions for page upload (secured by cookie)<a class="headerlink" href="#definitions-for-page-upload-secured-by-cookie" title="Permalink to this headline">¶</a></h5>
<p>All the elements needed for page upload by HTTP secured by cookie are contained in the base configuration delivered
with VIRTEL 4.27. Users who upgrade to VIRTEL 4.27 while keeping their existing configuration need to add certain
elements to their existing configuration to benefit from the new “page upload secured by cookie” function.
The following steps show how to upgrade your configuration based on entry point WEB2HOST. You can also carry out
these steps in batch by running the DEFUPLOD job in the SAMPLIB delivered with VIRTEL version 4.27. Having updated
the configuration, you then need to upload three new elements (upload.htm, default.js, and logo_3.gif) to the W2HDIR
directory using the existing SMTP upload method.</p>
<p>1. In entry point WEB2HOST, define a new transaction W2H–70, with external name upload. This transaction specifies
VIR0041C as the application name and application type 2. The “Logon message” field is blank to indicate to VIRTEL
that the name of the target directory is to be found in the definition of the e-mail correspondent:</p>
<p><img alt="image76" src="../../../_images/image768.png" /></p>
<p><em>Page upload by HTTP with cookie : Creating the ‘upload’ transaction</em></p>
<ol class="arabic simple" start="2">
<li>Check the definition of your SMTP line (F1 then F12 from the Configuration Menu, see the VIRTEL Connectivity Reference documentation).</li>
<li>Press F5 from the Configuration Menu and define an e-mail correspondent specifying directory name W2H-DIR and ruleset name ADMRSET1 :</li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CORRESPONDENT</span> <span class="n">DETAIL</span> <span class="n">DEFINITION</span> <span class="o">--------------------</span> <span class="n">Applid</span><span class="p">:</span> <span class="n">SPVIRE2</span> <span class="mi">14</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">04</span>
<span class="n">e</span><span class="o">-</span><span class="n">mail</span> <span class="n">address</span> <span class="o">===&gt;</span> <span class="n">upload2</span><span class="nd">@saint</span><span class="o">.</span><span class="n">cloud</span><span class="o">.</span><span class="n">com</span>
                    <span class="n">email</span> <span class="n">address</span> <span class="k">with</span> <span class="s1">&#39;@&#39;</span> <span class="n">sign</span>
<span class="n">Type</span> <span class="n">of</span> <span class="n">Id</span>         <span class="o">===&gt;</span> <span class="mi">1</span>              <span class="mi">1</span><span class="p">:</span><span class="n">Email</span> <span class="mi">2</span><span class="p">:</span><span class="n">Local</span><span class="o">+</span><span class="n">fixed</span> <span class="mi">3</span><span class="p">:</span><span class="n">Local</span><span class="o">+</span><span class="n">changing</span>
<span class="n">Activation</span> <span class="n">message</span> <span class="o">===&gt;</span> <span class="n">To</span> <span class="n">upload</span> <span class="n">to</span> <span class="n">VIRTEL</span><span class="p">,</span> <span class="n">click</span><span class="p">:</span><span class="o">&amp;</span><span class="n">Rhttp</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">229.20</span><span class="p">:</span><span class="mi">4100</span>
<span class="mi">1</span><span class="o">/</span><span class="n">web2host</span><span class="o">/</span><span class="n">upload</span><span class="o">.</span><span class="n">htm</span><span class="o">+</span><span class="n">upload</span><span class="o">+&amp;</span><span class="n">C</span>
                                       <span class="n">Text</span> <span class="n">of</span> <span class="s1">&#39;OK&#39;</span> <span class="n">message</span> <span class="n">to</span> <span class="n">user</span><span class="o">.</span>
<span class="n">VTAM</span> <span class="n">name</span>          <span class="o">===&gt;</span> <span class="o">&amp;</span><span class="mi">1</span> <span class="n">parameter</span> <span class="n">to</span> <span class="n">specify</span> <span class="n">VTAM</span> <span class="n">LU</span> <span class="n">name</span>
<span class="n">Rule</span> <span class="n">Set</span>           <span class="o">===&gt;</span> <span class="n">ADMRSET1</span> <span class="n">Rules</span> <span class="n">to</span> <span class="n">choose</span> <span class="n">an</span> <span class="n">entry</span> <span class="n">point</span>
<span class="n">Directory</span>          <span class="o">===&gt;</span> <span class="n">W2H</span><span class="o">-</span><span class="n">DIR</span> <span class="n">Where</span> <span class="n">data</span> <span class="ow">is</span> <span class="n">to</span> <span class="n">be</span> <span class="n">uploaded</span>
<span class="n">Last</span> <span class="n">contact</span>       <span class="o">===&gt;</span>
<span class="n">Contacts</span>           <span class="o">===&gt;</span> <span class="mi">00000000</span> <span class="n">Number</span> <span class="n">of</span> <span class="n">times</span> <span class="n">cookie</span> <span class="n">was</span> <span class="n">updated</span>
<span class="n">Date</span> <span class="n">created</span>       <span class="o">===&gt;</span> <span class="mi">11</span> <span class="n">May</span> <span class="mi">2004</span> <span class="mi">14</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">29</span>
<span class="n">Created</span> <span class="n">by</span>         <span class="o">===&gt;</span> <span class="n">VIRDBA</span>
<span class="n">Date</span> <span class="n">activated</span>     <span class="o">===&gt;</span> <span class="mi">11</span> <span class="n">May</span> <span class="mi">2004</span> <span class="mi">14</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">04</span>
<span class="n">Activated</span> <span class="n">by</span>       <span class="o">===&gt;</span> <span class="n">VIRDBA</span>
<span class="n">Date</span> <span class="n">disabled</span>      <span class="o">===&gt;</span>
<span class="n">Disabled</span> <span class="n">by</span>        <span class="o">===&gt;</span>


<span class="n">P1</span><span class="o">=</span><span class="n">Update</span>                           <span class="n">P3</span><span class="o">=</span><span class="n">Return</span>                        <span class="n">Enter</span><span class="o">=</span><span class="n">Add</span>
<span class="n">P4</span><span class="o">=</span><span class="n">Activate</span>                         <span class="n">P5</span><span class="o">=</span><span class="n">Disable</span>                       <span class="n">P6</span><span class="o">=</span><span class="n">Rules</span>
<span class="n">ACTIVATION</span> <span class="n">WAS</span> <span class="n">REQUESTED</span>
</pre></div>
</div>
<p><em>Page upload by HTTP with cookie : Creating the e-mail correspondent</em></p>
<ol class="arabic simple" start="4">
<li>Press F6 then F12 to create rule UPLOAD1B in ruleset ADMRSET1 :</li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DETAIL</span> <span class="n">of</span> <span class="n">RULE</span> <span class="kn">from</span> <span class="nn">RULE</span> <span class="n">SET</span><span class="p">:</span> <span class="n">ADMRSET1</span> <span class="o">-------------</span> <span class="n">Applid</span><span class="p">:</span> <span class="n">SPVIRE2</span> <span class="mi">14</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">59</span>

<span class="n">Name</span>          <span class="o">===&gt;</span> <span class="n">UPLOAD1B</span>               <span class="n">Rule</span> <span class="n">priority</span> <span class="ow">is</span> <span class="n">per</span> <span class="n">name</span>
<span class="n">Status</span>        <span class="o">===&gt;</span> <span class="n">ACTIVE</span>                 <span class="n">Mon</span><span class="p">,</span> <span class="mi">24</span> <span class="n">Sep</span> <span class="mi">2001</span> <span class="mi">14</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">14</span>
<span class="n">Description</span>   <span class="o">===&gt;</span> <span class="n">Rule</span> <span class="k">for</span> <span class="n">WEB2HOST</span> <span class="n">administrator</span>
<span class="n">Entry</span> <span class="n">point</span>   <span class="o">===&gt;</span> <span class="n">WEB2HOST</span>               <span class="n">Target</span> <span class="n">Entry</span> <span class="n">Point</span>
<span class="n">Parameter</span>     <span class="o">===&gt;</span>                                    <span class="n">optional</span> <span class="o">&amp;</span><span class="mi">1</span> <span class="n">value</span>
<span class="n">Trace</span> <span class="o">===&gt;</span>                                <span class="mi">1</span><span class="o">=</span><span class="n">commands</span> <span class="mi">2</span><span class="o">=</span><span class="n">data</span> <span class="mi">3</span><span class="o">=</span><span class="n">partner</span>

<span class="n">C</span> <span class="p">:</span> <span class="mi">0</span><span class="o">=</span><span class="n">IGNORE</span> <span class="mi">1</span><span class="o">=</span><span class="n">IS</span> <span class="mi">2</span><span class="o">=</span><span class="n">IS</span> <span class="n">NOT</span> <span class="mi">3</span><span class="o">=</span><span class="n">STARTS</span> <span class="n">WITH</span> <span class="mi">4</span><span class="o">=</span><span class="n">DOES</span> <span class="n">NOT</span> <span class="mi">5</span><span class="o">=</span><span class="n">ENDS</span> <span class="n">WITH</span> <span class="mi">6</span><span class="o">=</span><span class="n">DOES</span> <span class="n">NOT</span>
<span class="mi">0</span> <span class="n">IP</span> <span class="n">Subnet</span>   <span class="o">===&gt;</span>                        <span class="n">Mask</span>     <span class="o">===&gt;</span>
<span class="mi">5</span> <span class="n">HTTP</span> <span class="n">Host</span>   <span class="o">===&gt;</span> <span class="p">:</span><span class="mi">41001</span>
<span class="mi">0</span> <span class="n">eMail</span>       <span class="o">===&gt;</span>
<span class="mi">0</span> <span class="n">Calling</span> <span class="n">DTE</span> <span class="o">===&gt;</span>                        <span class="n">Calling</span> <span class="n">DTE</span> <span class="n">address</span>
<span class="mi">0</span> <span class="n">Called</span>      <span class="o">===&gt;</span>                        <span class="n">Called</span> <span class="n">DTE</span> <span class="n">address</span>
<span class="mi">0</span> <span class="n">CUD0</span> <span class="p">(</span><span class="n">Hex</span><span class="p">)</span>  <span class="o">===&gt;</span>                        <span class="n">First</span> <span class="mi">4</span> <span class="nb">bytes</span> <span class="n">of</span> <span class="n">CUD</span> <span class="p">(</span><span class="n">X25</span> <span class="n">protocol</span><span class="p">)</span>
<span class="mi">0</span> <span class="n">User</span> <span class="n">Data</span>   <span class="o">===&gt;</span>
<span class="mi">0</span> <span class="n">Days</span>        <span class="o">===&gt;</span> <span class="n">M</span><span class="p">:</span>      <span class="n">T</span><span class="p">:</span>      <span class="n">W</span><span class="p">:</span>      <span class="n">T</span><span class="p">:</span>      <span class="n">F</span><span class="p">:</span>      <span class="n">S</span><span class="p">:</span>      <span class="n">S</span><span class="p">:</span>
<span class="mi">0</span> <span class="n">Start</span> <span class="n">time</span>  <span class="o">===&gt;</span> <span class="n">H</span><span class="p">:</span>      <span class="n">M</span><span class="p">:</span>      <span class="n">S</span><span class="p">:</span>     <span class="n">End</span> <span class="n">time</span> <span class="o">===&gt;</span> <span class="n">H</span><span class="p">:</span>     <span class="n">M</span><span class="p">:</span>     <span class="n">S</span><span class="p">:</span>

<span class="n">P1</span><span class="o">=</span><span class="n">Update</span>                          <span class="n">P3</span><span class="o">=</span><span class="n">Return</span>                      <span class="n">Enter</span><span class="o">=</span><span class="n">Add</span>
<span class="n">P4</span><span class="o">=</span><span class="n">Activate</span>                        <span class="n">P5</span><span class="o">=</span><span class="n">Inactivate</span>                  <span class="n">P12</span><span class="o">=</span><span class="n">Entry</span> <span class="n">P</span><span class="o">.</span>
</pre></div>
</div>
<p><em>Page upload by HTTP with cookie : Creating rule UPLOAD1B</em></p>
<ol class="arabic simple" start="5">
<li>Define two new rules attached to the HTTP line. The first rule, which specifies $COOKIE$ as the entry point name, will be used for administrators; the second rule, which specifies entry point WEB2HOST, is for all other users:</li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>LIST of RULES in RULE SET: W-HTTP ---------------- Applid: SPVIRE2     14:44:14

Name     Status   Description                                        Entry
                                                                     Point
WHT00100 ACTIVE   HTTP access (users authorised by cookie)           $COOKIE$
WHT00200 ACTIVE   HTTP access (other users)                          WEB2HOST

P1=Update            P2=Suppress             P3=Return
P6=1st page          P7=Page-1               P8=Page+1              P12=Edit
</pre></div>
</div>
<p><em>List of rules associated with UPLOAD</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DETAIL of RULE from RULE SET: W-HTTP ------------- Applid: SPVIRE2 14:45:34
Name          ===&gt; WHT00100              Rule priority is per name
Status        ===&gt; ACTIVE                Mon, 24 Sep 2001 14:19:14
Description   ===&gt; HTTP access (users authorised by cookie)
Entry point   ===&gt; $COOKIE$              Target Entry Point
Parameter     ===&gt;                                  optional &amp;1 value
Trace         ===&gt;                       1=commands 2=data 3=partner
C : 0=IGNORE 1=IS 2=IS NOT 3=STARTS WITH 4=DOES NOT 5=ENDS WITH 6=DOES NOT
0 IP Subnet   ===&gt;                       Mask ===&gt;
0 HTTP Host   ===&gt;
0 eMail       ===&gt;
0 Calling DTE ===&gt;                       Calling DTE address
0 Called      ===&gt;                       Called DTE address
0 CUD0 (Hex)  ===&gt;                       First 4 bytes of CUD (X25 protocol)
0 User Data   ===&gt;
0 Days        ===&gt; M:      T:      W:      T:      F:      S:      S:
0 Start time  ===&gt; H:      M:      S:     End time ===&gt; H:     M:     S:

P1=Update                          P3=Return                    Enter=Add
P4=Activate                        P5=Inactivate                P12=Entry P.
</pre></div>
</div>
<p><em>Page upload by HTTP with cookie : Rule $COOKIE$ of the HTTP line</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DETAIL</span> <span class="n">of</span> <span class="n">RULE</span> <span class="kn">from</span> <span class="nn">RULE</span> <span class="n">SET</span><span class="p">:</span> <span class="n">W</span><span class="o">-</span><span class="n">HTTP</span> <span class="o">-------------</span> <span class="n">Applid</span><span class="p">:</span> <span class="n">SPVIRE2</span> <span class="mi">14</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">34</span>
<span class="n">Name</span>          <span class="o">===&gt;</span> <span class="n">WHT00200</span>              <span class="n">Rule</span> <span class="n">priority</span> <span class="ow">is</span> <span class="n">per</span> <span class="n">name</span>
<span class="n">Status</span>        <span class="o">===&gt;</span> <span class="n">ACTIVE</span>                <span class="n">Mon</span><span class="p">,</span> <span class="mi">24</span> <span class="n">Sep</span> <span class="mi">2001</span> <span class="mi">14</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">14</span>
<span class="n">Description</span>   <span class="o">===&gt;</span> <span class="n">HTTP</span> <span class="n">a</span>
<span class="n">ccess</span> <span class="p">(</span><span class="n">users</span> <span class="n">authorised</span> <span class="n">by</span> <span class="n">cookie</span><span class="p">)</span>
<span class="n">Entry</span> <span class="n">point</span>   <span class="o">===&gt;</span> <span class="n">WEB2HOST</span>              <span class="n">Target</span> <span class="n">Entry</span> <span class="n">Point</span>
<span class="n">Parameter</span>     <span class="o">===&gt;</span>                                  <span class="n">optional</span> <span class="o">&amp;</span><span class="mi">1</span> <span class="n">value</span>
<span class="n">Trace</span>         <span class="o">===&gt;</span>                       <span class="mi">1</span><span class="o">=</span><span class="n">commands</span> <span class="mi">2</span><span class="o">=</span><span class="n">data</span> <span class="mi">3</span><span class="o">=</span><span class="n">partner</span>
<span class="n">C</span> <span class="p">:</span> <span class="mi">0</span><span class="o">=</span><span class="n">IGNORE</span> <span class="mi">1</span><span class="o">=</span><span class="n">IS</span> <span class="mi">2</span><span class="o">=</span><span class="n">IS</span> <span class="n">NOT</span> <span class="mi">3</span><span class="o">=</span><span class="n">STARTS</span> <span class="n">WITH</span> <span class="mi">4</span><span class="o">=</span><span class="n">DOES</span> <span class="n">NOT</span> <span class="mi">5</span><span class="o">=</span><span class="n">ENDS</span> <span class="n">WITH</span> <span class="mi">6</span><span class="o">=</span><span class="n">DOES</span> <span class="n">NOT</span>
<span class="mi">0</span> <span class="n">IP</span> <span class="n">Subnet</span>   <span class="o">===&gt;</span>                       <span class="n">Mask</span> <span class="o">===&gt;</span>
<span class="mi">0</span> <span class="n">HTTP</span> <span class="n">Host</span>   <span class="o">===&gt;</span>
<span class="mi">0</span> <span class="n">eMail</span>       <span class="o">===&gt;</span>
<span class="mi">0</span> <span class="n">Calling</span> <span class="n">DTE</span> <span class="o">===&gt;</span>                       <span class="n">Calling</span> <span class="n">DTE</span> <span class="n">address</span>
<span class="mi">0</span> <span class="n">Called</span>      <span class="o">===&gt;</span>                       <span class="n">Called</span> <span class="n">DTE</span> <span class="n">address</span>
<span class="mi">0</span> <span class="n">CUD0</span> <span class="p">(</span><span class="n">Hex</span><span class="p">)</span>  <span class="o">===&gt;</span>                       <span class="n">First</span> <span class="mi">4</span> <span class="nb">bytes</span> <span class="n">of</span> <span class="n">CUD</span> <span class="p">(</span><span class="n">X25</span> <span class="n">protocol</span><span class="p">)</span>
<span class="mi">0</span> <span class="n">User</span> <span class="n">Data</span>   <span class="o">===&gt;</span>
<span class="mi">0</span> <span class="n">Days</span>        <span class="o">===&gt;</span> <span class="n">M</span><span class="p">:</span>      <span class="n">T</span><span class="p">:</span>      <span class="n">W</span><span class="p">:</span>      <span class="n">T</span><span class="p">:</span>      <span class="n">F</span><span class="p">:</span>      <span class="n">S</span><span class="p">:</span>      <span class="n">S</span><span class="p">:</span>
<span class="mi">0</span> <span class="n">Start</span> <span class="n">time</span>  <span class="o">===&gt;</span> <span class="n">H</span><span class="p">:</span>      <span class="n">M</span><span class="p">:</span>      <span class="n">S</span><span class="p">:</span>     <span class="n">End</span> <span class="n">time</span> <span class="o">===&gt;</span> <span class="n">H</span><span class="p">:</span>     <span class="n">M</span><span class="p">:</span>     <span class="n">S</span><span class="p">:</span>

<span class="n">P1</span><span class="o">=</span><span class="n">Update</span>                          <span class="n">P3</span><span class="o">=</span><span class="n">Return</span>                    <span class="n">Enter</span><span class="o">=</span><span class="n">Add</span>
<span class="n">P4</span><span class="o">=</span><span class="n">Activate</span>                        <span class="n">P5</span><span class="o">=</span><span class="n">Inactivate</span>                <span class="n">P12</span><span class="o">=</span><span class="n">Entry</span> <span class="n">P</span><span class="o">.</span>
</pre></div>
</div>
<p><em>Page upload by HTTP with cookie : Rule WEB2HOST of the HTTP line</em></p>
</div>
<div class="section" id="procedure-for-page-upload-secured-by-cookie">
<h5>Procedure for page upload (secured by cookie)<a class="headerlink" href="#procedure-for-page-upload-secured-by-cookie" title="Permalink to this headline">¶</a></h5>
<ol class="arabic simple">
<li>(First time only) Activate the e-mail correspondent: see <a class="reference internal" href="#v460ap-account-activation"><span class="std std-ref">“Account activation”</span></a>. This triggers the sending of an e-mail containing the security code, as in the following example:</li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Date</span><span class="p">:</span> <span class="n">Tue</span><span class="p">,</span> <span class="mi">27</span> <span class="n">Apr</span> <span class="mi">2004</span> <span class="mi">13</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">44</span> <span class="o">+</span><span class="mi">0100</span>
<span class="n">From</span><span class="p">:</span> <span class="n">virtel</span><span class="nd">@client</span><span class="o">.</span><span class="n">com</span>
<span class="n">Organization</span><span class="p">:</span> <span class="n">SYSPERTEC</span> <span class="n">COMMUNICATION</span>
<span class="n">To</span><span class="p">:</span> <span class="n">upload2</span><span class="nd">@saint</span><span class="o">.</span><span class="n">cloud</span><span class="o">.</span><span class="n">com</span>
<span class="n">Message</span><span class="o">-</span><span class="nb">id</span><span class="p">:</span>
<span class="o">&lt;</span><span class="mf">20040427130843.07</span><span class="n">F5D1DC</span><span class="o">.</span><span class="mi">56</span><span class="n">A85680Bgpamk4WZRKKBiZWjS4OTlqSES4OWlA</span><span class="o">==&gt;</span>
<span class="n">Subject</span><span class="p">:</span> <span class="n">OK</span> <span class="p">:</span> <span class="o">&lt;</span> <span class="n">W2H</span><span class="o">-</span><span class="n">DIR</span> <span class="o">&gt;</span>
<span class="n">SECURITY</span> <span class="n">TOKEN</span><span class="p">:</span>
<span class="mf">20040427130843.07</span><span class="n">F5D1DC</span><span class="o">.</span><span class="mi">56</span><span class="n">A85680Bgpamk4WZRKKBiZWjS4OTlqSES4OWlA</span><span class="o">==</span>
<span class="n">To</span> <span class="n">upload</span> <span class="n">to</span> <span class="n">VIRTEL</span><span class="p">,</span> <span class="n">click</span><span class="p">:</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">229.20</span><span class="p">:</span><span class="mi">41001</span><span class="o">/</span><span class="n">web2host</span><span class="o">/</span><span class="n">upload</span><span class="o">.</span><span class="n">htm</span><span class="o">+</span><span class="n">upload</span><span class="o">+</span><span class="n">VirtelCookie</span><span class="o">=</span><span class="mi">20040</span>
<span class="mf">427130843.07</span><span class="n">F5D1DC</span><span class="o">.</span><span class="mi">56</span><span class="n">A85680Bgpamk4WZRKKBiZWjS4OTlqSES4OWlA</span><span class="o">==</span>
</pre></div>
</div>
<p><em>Page upload by HTTP with cookie : activation e-mail</em></p>
<ol class="arabic simple" start="2">
<li>Click the link in the e-mail to open the upload.htm page:</li>
</ol>
<p><img alt="image4" src="../../../_images/image450.png" /></p>
<p><em>Page upload by HTTP with cookie : Displaying the upload.htm page</em></p>
<ol class="arabic simple" start="3">
<li>Click the “Browse” button and the file selection dialog will be displayed:</li>
</ol>
<p><img alt="image5" src="../../../_images/image538.png" /></p>
<p><em>Page upload by HTTP with cookie : File selection dialog</em></p>
<ol class="arabic simple" start="4">
<li>Select the file you want to upload, then press the “Open” button. The name of the selected file will be displayed in the input field:</li>
</ol>
<p><img alt="image6" src="../../../_images/image636.png" /></p>
<p><em>Page upload by HTTP with cookie : Sending the file</em></p>
<ol class="arabic simple" start="5">
<li>Press the “Send File” button to upload the file to VIRTEL. VIRTEL stores the file in the directory (W2H-DIR in this example) specified in the definition of the correspondent associated with the cookie. VIRTEL then displays the result of the upload:</li>
</ol>
<p><img alt="image7" src="../../../_images/image739.png" /></p>
<p><em>Page upload by HTTP with cookie : Confirmation of file uploadr</em></p>
<p>From now on, the cookies are managed automatically. After each upload, VIRTEL sends a new cookie to the browser, as indicated by the message “Upload code was set by the remote host”.</p>
<p>Depending on the values specified in the directory definition, VIRTEL may convert the file name to upper case, and truncate the filename to a maximum length, before storing it in the directory. The filename after conversion and truncation must not duplicate any other filename in the directory. For example, when uploading to a directory defined using the default parameters (not case sensitive, with maximum filename length 8), the file links.gif would be stored under the name LINKS.GI</p>
</div>
</div>
</div>
</div>
<div class="section" id="performance">
<span id="index-73"></span><h2>Performance<a class="headerlink" href="#performance" title="Permalink to this headline">¶</a></h2>
<p>The VIRTEL started task offers the administrator 5 sources of information to verify the correct functioning and performance of VIRTEL, to monitor its activity, or to diagnose possible problems:</p>
<ul class="simple">
<li>the CONSOLE file</li>
<li>the VIRLOG file</li>
<li>the VIRTEL Logger</li>
<li>the TRACE in the VIRTRACE file</li>
<li>the SNAP in the SYSPRINT file</li>
</ul>
<div class="section" id="console-file">
<span id="index-74"></span><h3>CONSOLE file<a class="headerlink" href="#console-file" title="Permalink to this headline">¶</a></h3>
<p>In <strong>z/OS environment</strong>, the CONSOLE file is written to the VIRTEL started task’s JESMSGLG file.</p>
<p>In <strong>VSE environment</strong>, the CONSOLE file is written to the VIRTEL partition’s POWER LST file (LISTLOG)</p>
<p>The CONSOLE file allows the administrator to monitor the startup and subsequent activity of VIRTEL. Using the console file, the administrator can check that the VSAM files are correctly opened, verify that the customer key has been correctly recognized, check the initialization of the TCP/IP sockets interface using the correct IP address and port, and monitor connections and disconnections of terminals and applications.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The SILENCE=YES parameter in the VIRTCT allows the suppression of certain console messages relating to the connection and disconnection of terminals.</p>
</div>
<p><img alt="image24" src="../../../_images/image2413.png" />
<em>Fig. 4 Example of CONSOLE file</em></p>
</div>
<div class="section" id="virlog-file">
<span id="index-75"></span><h3>VIRLOG file<a class="headerlink" href="#virlog-file" title="Permalink to this headline">¶</a></h3>
<p>This is a printable file with record length 131 and record format FA which provides a record of IP connections to VIRTEL. The figure below shows an example of VIRLOG entries for incoming
HTTP calls:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>£Software: VIRTEL 4.32
£Date: 02/01/06
£Line Local Pseudo Started Ended Price Received Sent Remote Address User
W-HTTP WHT00200 DELOC003 I 15.34.53 15.34.53 00000007 00000381 00023135 192.168.000.043 200 PUBLIC DATA.JS W2H-DIR
W-HTTP WHT00200 DELOC002 I 15.34.53 15.34.53 00000004 00000381 00010833 192.168.000.043 200 PUBLIC JS01.JS W2H-DIR
W-HTTP WHT00200 DELOC003 I 15.34.53 15.34.53 00000007 00000386 00006976 192.168.000.043 200 PUBLIC VIRTBLUE W2H-DIR
W-HTTP WHT00200 DEVTA003 I 15.34.53 15.34.60 00000649 00001169 00010397 192.168.000.043 PUBLIC WEB2VIRT W2H-10
W-HTTP WHT00200 DELOC002 I 15.35.02 15.35.02 00000005 00000402 00000049 192.168.000.043 304 WEB2HOSTXHTML.JP W2H-DIR

*Fig. 5 Example of VIRLOG file (HTTP)*
</pre></div>
</div>
<p>The LINE column shows the internal name of the HTTP line.
The LOCAL column shows the name of the rule selected for each call.
The PSEUDO column shows the VIRTEL terminal name used.</p>
<p>The next column contains “I” to indicate this is an incoming call.</p>
<p>The STARTED and ENDED columns show the start and end time of each IP session.</p>
<p>The PRICE column represents the duration of the transaction in hundredths of a second This value may be modified by exit 7.</p>
<p>The RECEIVED and SENT columns contain the number of bytes received from and sent to the browser. The REMOTE ADDRESS column contains the IP address of the browser.</p>
<p>The USER column contains the userid if the transaction is secured.
The next column contains the HTTP status code (for static pages) The last three 8-byte columns represent:</p>
<blockquote>
<div><ul class="simple">
<li>The external name of the VIRTEL transaction which represents the HTTP path name.</li>
<li>The name of the HTML page.</li>
<li>For static pages: The name of the VIRTEL directory containing the HTML page.</li>
<li>For dynamic pages: The internal name of the HTTP transaction which was used to populate the page.</li>
</ul>
</div></blockquote>
<p>The figure below shows an example of VIRLOG entries for X25 calls:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>£Software: VIRTEL 4.32
£Date: 11/21/07
£Line Local Pseudo Started Ended Price Received Sent Remote Address User
X001LINE 001880 X001T007 I 13.47.37 13.48.00 00002288 00000392 00000119 191334833 MINITEL
X001LINE G001T004 X001T000 O 13.48.30 13.48.50 00001966 00000001 00000001 191334833001870
X001LINE P001O001 X001T001 O 13.48.49 13.49.20 00003069 00000001 00000001 001870 PCNE1
X001LINE G001T003 X001T002 O 13.49.01 13.49.22 00002147 00000001 00000001 001870

*Fig. 6 Example of VIRLOG file (X25)*
</pre></div>
</div>
<p>The LINE column shows the internal name of the X25 line.</p>
<p>The LOCAL column shows the called subaddress for incoming calls, or the name of the associated AntiGATE or AntiPCNE terminal for outgoing calls.</p>
<p>The PSEUDO column shows the VIRTEL terminal name used.</p>
<p>In the next column “I” indicates an incoming call, “O” indicates an outgoing call. The STARTED and ENDED columns show the start and end time of each call.</p>
<p>The PRICE column represents the duration of the transaction in hundredths of a second, except for calls on Fast Connect lines, where the PRICE column contains the “X25 units sent” value supplied by NPSI. This value may also be modified by exit 7.</p>
<p>The RECEIVED and SENT columns contain the number of bytes received from and sent to the X25 line.</p>
<p>The REMOTE ADDRESS column contains the caller X25 number for incoming calls, or the called X25 number for outgoing calls.</p>
<p>The last column contains the PCNE call user data (if present), otherwise it contains the default entry point name for X25 calls specified by the DEFENTR parameter in the VIRTCT. For GATE calls this column is blank.</p>
</div>
<div class="section" id="virtel-logger">
<span id="index-76"></span><h3>VIRTEL logger<a class="headerlink" href="#virtel-logger" title="Permalink to this headline">¶</a></h3>
<p>The CONSOLE log can also be written to the system logger when LOG=LOGGER is specified in the TCT. VIR0002B is a batch program that can be run to extract the VIRTEL records from the System Logger.</p>
<p>The figure below shows an example of JCL to extract and format the VIRTEL LOG entries recorded in the System Logger:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">LOGGER</span> <span class="n">PROC</span> <span class="n">P</span><span class="o">=</span>
<span class="o">//</span><span class="n">S01</span> <span class="n">EXEC</span> <span class="n">PGM</span><span class="o">=</span><span class="n">VIR0002B</span><span class="p">,</span><span class="n">PARM</span><span class="o">=</span><span class="s1">&#39;&amp;P&#39;</span>
<span class="o">//</span><span class="n">STEPLIB</span> <span class="n">DD</span> <span class="n">DSN</span><span class="o">=</span><span class="n">VIRTEL</span><span class="o">.</span><span class="n">LOADLIB</span><span class="p">,</span><span class="n">DISP</span><span class="o">=</span><span class="n">SHR</span>
<span class="o">//</span><span class="n">VIRLOG</span> <span class="n">DD</span> <span class="n">SYSOUT</span><span class="o">=*</span><span class="p">,</span><span class="n">DCB</span><span class="o">=</span><span class="n">BLKSIZE</span><span class="o">=</span><span class="mi">25500</span>
<span class="o">//</span> <span class="n">PEND</span>
<span class="o">//</span><span class="n">S01</span> <span class="n">EXEC</span> <span class="n">LOGGER</span><span class="p">,</span><span class="n">P</span><span class="o">=</span><span class="s1">&#39;DELETE(&gt;2)&#39;</span>
<span class="n">VIRLOG</span> <span class="n">DCB</span> <span class="n">LRECL</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span><span class="n">BLKSIZE</span><span class="o">=</span><span class="mi">25500</span><span class="p">,</span><span class="n">RECFM</span><span class="o">=</span><span class="n">VB</span>

<span class="o">*</span><span class="n">Fig</span><span class="o">.</span> <span class="mi">7</span> <span class="n">Example</span> <span class="n">of</span> <span class="n">JCL</span> <span class="n">to</span> <span class="n">extract</span> <span class="n">the</span> <span class="n">VIRTEL</span> <span class="n">LOG</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">System</span> <span class="n">Logger</span><span class="o">*</span>
</pre></div>
</div>
<p>The available JCL parameters are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>            <span class="p">(</span><span class="o">&gt;</span><span class="n">nnn</span><span class="p">)</span>
<span class="n">COPY</span> <span class="p">[</span><span class="o">----------------------</span><span class="p">]</span>
        <span class="p">(</span><span class="n">fromdate</span><span class="p">[,</span><span class="n">todate</span><span class="p">])</span>
            <span class="p">(</span><span class="o">&gt;</span><span class="n">nnn</span><span class="p">)</span>
<span class="n">DELETE</span> <span class="p">[</span><span class="o">--------------------</span><span class="p">]</span>
            <span class="p">(</span><span class="n">date</span><span class="p">)</span>
</pre></div>
</div>
<p>The date format is yyyyddd.</p>
<div class="section" id="examples">
<span id="index-77"></span><h4>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">COPY</span> <span class="n">Copy</span> <span class="nb">all</span> <span class="n">records</span>
<span class="n">COPY</span><span class="p">(</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)</span> <span class="n">Copy</span> <span class="n">records</span> <span class="n">older</span> <span class="n">than</span> <span class="mi">2</span> <span class="n">days</span>
<span class="n">COPY</span><span class="p">(</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">Copy</span> <span class="n">up</span> <span class="n">to</span> <span class="n">yesterday</span>
<span class="n">DELETE</span><span class="p">(</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)</span> <span class="n">Delete</span> <span class="n">records</span> <span class="n">older</span> <span class="n">than</span> <span class="mi">2</span> <span class="n">days</span>
<span class="n">COPY</span><span class="p">(</span><span class="mi">2015047</span><span class="p">)</span> <span class="n">Copy</span> <span class="n">records</span> <span class="kn">from</span> <span class="mf">2015.047</span>
<span class="n">COPY</span><span class="p">(</span><span class="mi">2015047</span><span class="p">,</span><span class="mi">2015048</span><span class="p">)</span> <span class="n">Copy</span> <span class="n">records</span> <span class="kn">from</span> <span class="mf">2015.047</span> <span class="n">thru</span> <span class="n">to</span> <span class="mf">2015.048</span> <span class="n">DELETE</span><span class="p">(</span><span class="mi">2015047</span><span class="p">)</span> <span class="n">Delete</span> <span class="n">records</span> <span class="n">prior</span> <span class="n">to</span> <span class="mf">2015.047</span>
<span class="n">COPY</span><span class="p">(</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">),</span><span class="n">DELETE</span><span class="p">(</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="n">Will</span> <span class="n">copy</span> <span class="n">records</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">previous</span> <span class="ow">and</span> <span class="n">earlier</span><span class="p">,</span>
<span class="ow">and</span> <span class="n">will</span> <span class="n">then</span> <span class="n">delete</span> <span class="kn">from</span> <span class="mi">2</span> <span class="n">days</span> <span class="n">ago</span> <span class="n">leaving</span> <span class="n">about</span> <span class="mi">24</span> <span class="n">hours</span> <span class="n">of</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">log</span> <span class="n">stream</span><span class="o">.</span>
</pre></div>
</div>
<p><em>Fig. 8  Example of VIRTEL LOGGER extraction parameter</em></p>
</div>
</div>
<div class="section" id="virtel-trace">
<span id="index-78"></span><h3>Virtel trace<a class="headerlink" href="#virtel-trace" title="Permalink to this headline">¶</a></h3>
<p>All messages which pass between a terminal and a host application, or all messages received and sent on a line, can be traced to a print file.</p>
<p>Activation and deactivation of a trace on a terminal or a line is performed by means of the TRACE and NOTRACE commands (see “VIRTEL commands” and “Activating and deactivating a terminal or line trace”).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A terminal or line trace remains active until a corresponding NOTRACE command is issued or until the VIRTEL started task terminates.</p>
</div>
<p>It is also possible to trace specific incoming calls (“tracing by rule”). In this case, activation of the trace is specified in the definition of the rule which VIRTEL uses to route the incoming call. For example, a rule can be created to activate the trace for calls which originate from a specific terminal address (X25 or IP). The trace can be activated for commands and/or data packets.</p>
<p>Activation or deactivation of a “trace by rule” is performed via the VIRTEL on-line configuration menus, and consists of updating the “Trace” field in the rule definition, followed by pressing the F1 key. See “Rules” in the VIRTEL Connectivity Reference manual for more details.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A “trace by rule” remains active as long as the “Trace” field in the rule definition is not empty. Message VIR0036W confirms the activation of the trace.</p>
</div>
<p>In <strong>z/OS environment</strong>, the trace data is written to the VIRTRACE file in the VIRTEL started task.
In <strong>VSE environment</strong>, the trace data is written to the POWER LST file of the VIRTEL partition.</p>
<p>Activation and deactivation of a memory trace is performed by means of the MEMTRACE and NOMEMTRACE commands (see “Memory Trace Management”). The allocation memory is written in the SNAP file when a SNAP command is issued.</p>
<div class="section" id="contents-of-the-trace">
<span id="index-79"></span><h4>Contents of the trace<a class="headerlink" href="#contents-of-the-trace" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="42%" />
<col width="47%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" rowspan="2">Line type</th>
<th class="head" rowspan="2">Contents of line trace</th>
<th class="head" rowspan="2">Contents of terminal trace or trace by rule</th>
</tr>
<tr class="row-even"></tr>
</thead>
<tbody valign="top">
<tr class="row-odd"><td rowspan="5">HTTP</td>
<td rowspan="5">All messages flowing  between the VIRTEL
HTTP server and client browsers</td>
<td rowspan="5">Terminal without relay: None
Terminal with relay: Contents of the 3270
datastream between VIRTEL and the host
application</td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"><td rowspan="3">SMTP</td>
<td rowspan="3"><dl class="first last docutils">
<dt>All messages flowing to and from the</dt>
<dd>VIRTEL SMTP server</dd>
</dl>
</td>
<td rowspan="3">None</td>
</tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="3">XOT</td>
<td rowspan="3">All messages flowing between VIRTEL and
the router, including the XOT headers</td>
<td rowspan="3">All X25 messages (excluding the XOT header)
belonging to the specified virtual circuit.</td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"><td rowspan="5"><p class="first">/GATE</p>
<p class="last">/FASTC</p>
</td>
<td rowspan="5">Messages on the control session between
the MCH LU and the CTCP
(call packet and call acknowledgement)</td>
<td rowspan="5">Messages on the data session between the CVC
LU and the CTCP (data packets, X25 RESET and
CLEAR commands)</td>
</tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="3">/PCNE</td>
<td rowspan="3">None</td>
<td rowspan="3">Data flowing between the terminal LU and the
application.</td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"><td rowspan="2">APPC</td>
<td rowspan="2">N/A</td>
<td rowspan="2">Messages on the LU6.2 session</td>
</tr>
<tr class="row-odd"></tr>
<tr class="row-even"><td rowspan="3">GATE
FASTC</td>
<td rowspan="3">N/A</td>
<td rowspan="3">Messages on the data session between the NCP
and VIRTEL.</td>
</tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="4">3270</td>
<td rowspan="4">N/A</td>
<td rowspan="4">The 3270 datastream between the terminal and
VIRTEL, and the 3270 datastream between VIRTEL
and the host application.</td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="4">PCNE
(Minitel)</td>
<td rowspan="4">N/A</td>
<td rowspan="4">The Vidéotex datastream between the terminal
and VIRTEL, and the 3270 datastream between
VIRTEL and the host application.</td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="trace-examples">
<span id="index-80"></span><h4>Trace Examples<a class="headerlink" href="#trace-examples" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>LCL712 11A: from application SPCICST 13:05:47.48
00000 F1C2 *1B * 099A95B4
LCL712 11A: from application SPCICST 13:05:47.49
00000 F5C2114B E9131140 5B290242 F1C0F8E2 89879596 9540A396 40C3C9C3 E24011C1 *5B..Z.. $...1é8Signon to CICS .A* 099A95B4
00020 40290242 F4C0F0C1 D7D7D3C9 C4290242 F5C0F0E2 D7C3C9C3 E2E34011 C8F02902 * ...4é0APPLID...5é0SPCICST .H0..* 099A95D4
00040 42F4C0F0 E3A89785 40A896A4 9940A4A2 85998984 40819584 409781A2 A2A69699 *.4é0Type your userid and passwor* 099A95F4
00060 846B40A3 88859540 979985A2 A240C5D5 E3C5D97A 114BD929 0242F4C0 F0E4A285 *d, then press ENTER:..R...4é0Use* 099A9614
00080 99898440 4B404B40 4B404B29 0241F442 F5114BF1 1DF0114B F4290242 F4C0F0C7 *rid . . . ....4.5..1.0..4...4é0G* 099A9634
000A0 9996A497 8984404B 404B404B 290241F4 42F5114C 4B1DF011 4CE92902 42F4C0F0 *roupid . . ....4.5.&lt;..0.&lt;Z...4é0* 099A9654
000C0 D781A2A2 A6969984 404B404B 404B2903 41F442F5 C04C114D C11DF011 4DF92902 *Password . . ....4.5é&lt;.(A.0.(9..* 099A9674
000E0 42F4C0F0 D3819587 A4818785 404B404B 404B2902 41F442F5 114E4C1D F01150D5 *.4é0Language . . ....4.5.+&lt;.0.&amp;N* 099A9694
00100 290242F4 C0F0D585 A640D781 A2A2A696 9984404B 404B404B 290341F4 42F5C04C *...4é0New Password . . ....4.5é&lt;* 099A96B4
00120 1150F11D F0115A50 1D7C115B 5B1DF011 5B602902 42F2C0F8 C4C6C8C3 C5F3F5F2 *.&amp;1.0.&amp;.to.$$.0.$-...2é8DFHCE352* 099A96D4
</pre></div>
</div>
<p><em>Example of terminal trace (inbound 3270 terminal)</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>X001T007 XOT: RECEIVED FROM ROUTER                          13:48:15.57
00000 00000003 100121                                                         * ....                           * 0989117C
X001T007 XOT: RECEIVED FROM ROUTER                          13:48:15.72
00000 00000083 10013200 A0402000 D9030853 59535843 46544104 08535953 58434654 *........to ....SYSXCFTA..SYSXCFT* 0989117C
00020 42050653 59535041 53060102 07030024 02160102 17010163 6E434654 20593D4D *B..SYSPAS......$.......cnCFT Y=M* 0989119C
00040 2C443D32 30303530 31303531 33343831 3536302C 563D3233 302C5A3D 702D312D *,D=2005010513481560,V=230,Z=p-1-* 098911BC
00060 31352D2D 4D565332 3230432D 41323330 3033352D 32303031 2F31302F 32322C4B *15--MVS220C-A230035-2001/10/22,K* 098911DC
00080 3D514334 443248                                                         *=QC4D2H                         * 098911FC
X001T007 XOT: SENT TO ROUTER                                13:48:15.72
00000 00000003 100141                                                         * ....                           * 0989117C
X001T007 XOT: RECEIVED FROM ROUTER 13:48:15.72
00000 00000023 1001245A 56444850 37444C4E 39374A49 36513153 49594C2C 433D3830 *...£..$ZVDHP7DLN97JI6Q1SIYL,C=80* 0989117C
00020 33333430 333832                                                         *3340382                         * 0989119C
X001T007 XOT: SENT TO ROUTER                                13:48:15.73
00000 00000003 100161
</pre></div>
</div>
<p><em>Example of line trace (XOT line)</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>X001T007 005: INBOUND CALL PACKET                           15:10:11.97
00000 0BF00806 0018800A 42070743 030302CC 0300C018 80105043 4E4531                  *........B..C..........PCNE1     * 09896176
X001T007 XOT: OUTBOUND X25 COMMAND                          15:10:11.99
00000 0F                                                                            *.                               * 0989617E
X001T007 XOT: INBOUND DATA                                  15:10:12.08
00000 00C3C6E3 D7E2C9E3 E7C3D7C1 E7F14040 40D7D8D9 E2404040 400D25                  * CFTPSITXCPAX1 PQRS ..          * 09891182
P001I001 AP80LU51 I09: DATA TO CFTBACB1                     15:10:12.21
00000 C3C6E3D7 E2C9E3E7 C3D7C1E7 F1404040 D7D8D9E2 40404040 0D25                    *CFTPSITXCPAX1 PQRS ..           * 0989617D
P001I001 AP80LU51 I09: DATA FROM CFTBACB1                   15:10:12.23
00000 C1C3D2F0 0D25                                                                 *ACK0..                          * 0989617C
X001T007 XOT: OUTBOUND DATA                                 15:10:12.23
00000 00C1C3D2 F00D25                                                               * ACK0..                         * 098A417C
X001T007 XOT: INBOUND DATA                                  15:10:12.46
00000 22003240 2000D903 0D4F5020 20202020 20435041 5831040D 4F502020 20202020       *&quot;.to ....OP CPAX1..OP           * 09891182
00020 43504258 31060101 07030024 02160100 170101                                    *CPBX1......$.......             * 098911A2
P001I001 AP80LU51 I09: DATA TO CFTBACB1                     15:10:12.47
00000 00324020 00D9030D 4F502020 20202020 43504158 31040D4F 50202020 20202043       *.to ....OP CPAX1..OP C          * 098A417D
00020 50425831 06010107 03002402 16010017 0101                                      *PBX1......$.......              * 098A419D
P001I001 AP80LU51 I09: DATA FROM CFTBACB1                   15:10:12.55
00000 00114021 D9E20601 01070300 24021701 01                                        * . .RS..... .....               * 0989617C
</pre></div>
</div>
<p><em>Example of “trace by rule” (XOT terminal to application on /PCNE line)</em></p>
</div>
</div>
<div class="section" id="virtel-snap">
<span id="index-81"></span><h3>VIRTEL SNAP<a class="headerlink" href="#virtel-snap" title="Permalink to this headline">¶</a></h3>
<p>VIRTEL maintains an internal trace table in which it records  significant events which occur during VIRTEL processing. The SNAP command allows the administrator to obtain a snapshot listing of the contents of the trace table at a given point in time.</p>
<p>The SNAP listing is primarily intended for use by VIRTEL development personnel and will normally need to be forwarded to Syspertec for analysis. For customer diagnostics, the TRACE command (described     above) may often be more useful.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The format, the contents, and the size of the SNAP depend on the SNAPW, TRACBIG, TRACEB, TRACEON parameters in the VIRTCT.</p>
</div>
<p>The internal trace table is recorded in a circular fashion, so that each new event added to the table overlays and replaces the oldest event in the table. The table contains a fixed number of event slots (determined by the TRACBIG parameter in the VIRTCT), and additionally certain events may have a variable amount (up to 256 bytes) of data recorded. The variable data is stored in a separate area whose size is determined by the TRACEB parameter in the VIRTCT, and this area is also filled in a circular manner, with the oldest information being dropped from the table when new information is added. Thus, depending on the values of the TRACBIG and TRACB parameters, older entries in the trace table may no longer have data associated with them.</p>
<p>Clearly, the greater the level of activity in the VIRTEL system, the quicker the trace table will wrap and information will be pushed out to make way for new entries. Thus, in order for the SNAP listing to provide useful information, the size of the trace table and its associated buffer area must be adequate for the level of system activity, and the SNAP command must be issued as quickly as possible after the event under investigation occurs. In some cases it may be necessary to use an automation tool to issue the SNAP command immediately following the appearance of a certain console message.</p>
<p>As well as dumping the contents of the internal trace table, the SNAP command also dumps certain VIRTEL internal control blocks. A dump of the control blocks associated with a particular terminal may optionally be requested.</p>
<p>The SNAP command is described under the heading “VIRTEL commands”. VIRTEL may also produce a SNAP listing automatically if a program check or other abend occurs during VIRTEL processing.</p>
<p>In <strong>z/OS environment</strong>, the SNAP output is written to the SYSPRINT file in the VIRTEL started task.
In <strong>z/VSE environment</strong>, the SNAP output is written to the POWER LST file of the VIRTEL partition.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Several SNAP commands may be issued during a single run of VIRTEL. The output file may thus contain successive SNAP listings concatenated one after the other.</p>
</div>
<p><img alt="image25" src="../../../_images/image2512.png" /></p>
<p><em>Example of SNAP listing</em></p>
<div class="section" id="message-triggered-snapmsg">
<span id="index-82"></span><h4>Message-triggered SNAPMSG<a class="headerlink" href="#message-triggered-snapmsg" title="Permalink to this headline">¶</a></h4>
<p>The SNAPMSG command requests VIRTEL to generate an automatic SNAP after certain messages (VIRI902W, VIR0026W, VIR0052I, VIR1552I, VIR0526W or VIR1952I).Only one SNAP can also be obtained with user specific code provided by SYSPERTEC for messages VIRHT31E and VIRHT63E. See “VIRTEL commands”. See the SNAPMSG command for further details.</p>
</div>
</div>
</div>
<div class="section" id="audit">
<span id="index-83"></span><h2>Audit<a class="headerlink" href="#audit" title="Permalink to this headline">¶</a></h2>
<div class="section" id="virstat-file">
<span id="index-84"></span><h3>VIRSTAT file<a class="headerlink" href="#virstat-file" title="Permalink to this headline">¶</a></h3>
<p>The VIRSTAT file is a sequential file into which VIRTEL writes connection statistics.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>When the STATS=YES parameter is coded in the VIRTCT, the VIRSTAT file is reinitialised at each VIRTEL startup. With STATS=YES, VIRTEL must be stopped periodically in order to avoid filling the VIRSTAT
file, and the file should be defined as a GDG in order not to lose the information from a previous run. The STATS=MULTI parameter may be coded in the z/OS environment to permit continuous operation.</p>
<p class="last">Trying to browse the contents of the file from ISPF while it is in use by VIRTEL, can result to the obtain a system message indicating that the file is empty. In reality this is not true, because in fact
the records are buffered in memory before being written in block.</p>
</div>
<p>The format of the statistics records depends on the value specified in the “Write Stats to” field of the VIRTEL terminal definition (refer to the VIRTEL Connectivity Reference manual for details of terminal definitions). Each terminal may request statistics in one or more of the possible formats:</p>
<dl class="docutils">
<dt>Classic</dt>
<dd>VIRSTAT classic format recording is intended for use with Minitel calls on terminals associated with NPSI lines (Gate or Fast Connect).</dd>
<dt>Alternate X25</dt>
<dd>VIRSTAT alternate format recording may be requested for terminals associated with any X25 line (GATE, FASTC, XOT).</dd>
<dt>Web</dt>
<dd>VIRSTAT format suitable for terminals associated with an HTTP line.</dd>
</dl>
<p>For terminals associated with all other line types (including /GATE, /PCNE, and /FASTC) the statistics record may not contain meaningful information and the statistics field in the terminal definition     should be left blank.</p>
<p>The statistics file may contain a mixture of classic, alternate X25, and web format records. The record type indicator at position 61 of each record identifies the format of the particular record.</p>
<div class="section" id="virstat-classsic-format">
<span id="index-85"></span><h4>VIRSTAT classsic format<a class="headerlink" href="#virstat-classsic-format" title="Permalink to this headline">¶</a></h4>
<p>For terminals which specify classic format recording (STATS=1), the  VIRSTAT record format is shown in the following table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">**</span><span class="n">Position</span>    <span class="n">Format</span>          <span class="n">Type</span> <span class="n">of</span> <span class="n">information</span><span class="o">**</span>
<span class="o">-----------------------------------------------</span>
<span class="mi">1</span> <span class="n">to</span> <span class="mi">8</span>      <span class="n">Alphanumeric</span>    <span class="n">Terminal</span> <span class="n">name</span>
<span class="mi">9</span> <span class="n">to</span> <span class="mi">12</span>     <span class="n">Packed</span> <span class="n">Decimal</span>  <span class="n">Date</span> <span class="p">(</span><span class="n">CCYYDDDF</span><span class="p">)</span>
<span class="mi">13</span> <span class="n">to</span> <span class="mi">16</span>    <span class="n">Packed</span> <span class="n">Decimal</span>  <span class="n">Time</span> <span class="p">(</span><span class="n">HHMMSSTF</span><span class="p">)</span>
<span class="mi">17</span> <span class="n">to</span> <span class="mi">28</span>    <span class="n">Alphanumeric</span>    <span class="n">User</span> <span class="nb">id</span>
<span class="mi">29</span> <span class="n">to</span> <span class="mi">36</span>    <span class="n">Alphanumeric</span>    <span class="n">Originating</span> <span class="n">terminal</span> <span class="n">name</span> <span class="p">(</span><span class="n">outbound</span> <span class="n">calls</span><span class="p">)</span>
<span class="mi">37</span> <span class="n">to</span> <span class="mi">40</span>    <span class="n">Hexadecimal</span>     <span class="n">No</span> <span class="n">of</span> <span class="nb">bytes</span> <span class="n">inbound</span> <span class="p">(</span><span class="n">uncompressed</span><span class="p">)</span>
<span class="mi">41</span> <span class="n">to</span> <span class="mi">44</span>    <span class="n">Hexadecimal</span>     <span class="n">No</span> <span class="n">of</span> <span class="nb">bytes</span> <span class="n">inbound</span> <span class="p">(</span><span class="n">compressed</span><span class="p">)</span>
<span class="mi">45</span> <span class="n">to</span> <span class="mi">48</span>    <span class="n">Hexadecimal</span>     <span class="n">No</span> <span class="n">of</span> <span class="nb">bytes</span> <span class="n">outbound</span> <span class="p">(</span><span class="n">uncompressed</span><span class="p">)</span>
<span class="mi">49</span> <span class="n">to</span> <span class="mi">52</span>    <span class="n">Hexadecimal</span>     <span class="n">No</span> <span class="n">of</span> <span class="nb">bytes</span> <span class="n">outbound</span> <span class="p">(</span><span class="n">compressed</span><span class="p">)</span>
<span class="mi">53</span> <span class="n">to</span> <span class="mi">56</span>    <span class="n">Hexadecimal</span>     <span class="n">No</span> <span class="n">of</span> <span class="n">sends</span>
<span class="mi">57</span> <span class="n">to</span> <span class="mi">60</span>    <span class="n">Hexadecimal</span>     <span class="n">No</span> <span class="n">of</span> <span class="n">receives</span>
<span class="mi">61</span> <span class="n">to</span> <span class="mi">61</span>    <span class="n">Alphanumeric</span>    <span class="n">Record</span> <span class="nb">type</span> <span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">cumulative</span><span class="p">,</span><span class="n">P</span><span class="o">=</span><span class="n">partial</span><span class="p">,</span><span class="n">E</span><span class="o">=</span><span class="n">end</span><span class="p">)</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="mi">62</span> <span class="n">to</span> <span class="mi">62</span>    <span class="n">Alphanumeric</span>    <span class="n">Compression</span> <span class="n">level</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="mi">63</span> <span class="n">to</span> <span class="mi">70</span>    <span class="n">Alphanumeric</span>    <span class="n">Minitel</span><span class="p">:</span> <span class="n">Server</span> <span class="n">access</span> <span class="n">node</span>
<span class="mi">71</span> <span class="n">to</span> <span class="mi">74</span>    <span class="n">Alphanumeric</span>    <span class="n">Minitel</span><span class="p">:</span> <span class="n">Call</span> <span class="n">duration</span> <span class="ow">in</span> <span class="n">minutes</span> <span class="p">(</span><span class="n">ZZZ9</span><span class="p">)</span>
<span class="mi">75</span> <span class="n">to</span> <span class="mi">82</span>    <span class="n">Alphanumeric</span>    <span class="n">Session</span> <span class="n">start</span> <span class="n">date</span> <span class="p">(</span><span class="n">MM</span><span class="o">/</span><span class="n">DD</span><span class="o">/</span><span class="n">YY</span><span class="p">)</span>
<span class="mi">83</span> <span class="n">to</span> <span class="mi">86</span>    <span class="n">Alphanumeric</span>    <span class="n">Session</span> <span class="n">start</span> <span class="n">date</span> <span class="p">(</span><span class="o">.</span><span class="n">DDD</span><span class="p">)</span>
<span class="mi">87</span> <span class="n">to</span> <span class="mi">94</span>    <span class="n">Alphanumeric</span>    <span class="n">Session</span> <span class="n">start</span> <span class="n">time</span> <span class="p">(</span><span class="n">HH</span><span class="o">.</span><span class="n">MM</span><span class="o">.</span><span class="n">SS</span><span class="p">)</span>
<span class="mi">95</span> <span class="n">to</span> <span class="mi">102</span>   <span class="n">Alphanumeric</span>    <span class="n">Session</span> <span class="n">end</span> <span class="n">date</span> <span class="p">(</span><span class="n">MM</span><span class="o">/</span><span class="n">DD</span><span class="o">/</span><span class="n">YY</span><span class="p">)</span>
<span class="mi">103</span> <span class="n">to</span> <span class="mi">106</span>  <span class="n">Alphanumeric</span>    <span class="n">Session</span> <span class="n">end</span> <span class="n">date</span> <span class="p">(</span><span class="o">.</span><span class="n">DDD</span><span class="p">)</span>
<span class="mi">107</span> <span class="n">to</span> <span class="mi">114</span>  <span class="n">Alphanumeric</span>    <span class="n">Session</span> <span class="n">end</span> <span class="n">time</span> <span class="p">(</span><span class="n">HH</span><span class="o">.</span><span class="n">MM</span><span class="o">.</span><span class="n">SS</span><span class="p">)</span>
<span class="mi">115</span> <span class="n">to</span> <span class="mi">115</span>  <span class="n">Alphanumeric</span>    <span class="n">Tarification</span> <span class="n">level</span> <span class="p">(</span><span class="n">External</span> <span class="n">Servers</span><span class="p">)</span>
<span class="mi">116</span> <span class="n">to</span> <span class="mi">116</span>  <span class="n">Alphanumeric</span>    <span class="n">Disconnection</span> <span class="n">Type</span> <span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">by</span> <span class="n">TIME</span><span class="o">-</span><span class="n">OUT</span><span class="p">)</span>
<span class="mi">117</span> <span class="n">to</span> <span class="mi">120</span>  <span class="n">Hexadecimal</span>     <span class="n">X25</span> <span class="n">units</span> <span class="n">received</span> <span class="p">(</span><span class="n">Fast</span><span class="o">-</span><span class="n">Connect</span><span class="p">)</span>
<span class="mi">121</span> <span class="n">to</span> <span class="mi">124</span>  <span class="n">Hexadecimal</span>     <span class="n">X25</span> <span class="n">units</span> <span class="n">sent</span> <span class="p">(</span><span class="n">Fast</span><span class="o">-</span><span class="n">Connect</span><span class="p">)</span>
</pre></div>
</div>
<p><em>Format of VIRSTAT record (classic format)</em></p>
<p>For NPSI Fast Connect lines, the X25 accounting statistics are recorded in billing units provided by NPSI at virtual circuit disconnection time. Their interpretation depends on the TAXUNIT parameter in the NPSI X25.MCH macro. Similarly, the session start and end times (Fast Connect only) are provided by NPSI and depend on the clock settings in the NCP. For other types of lines, accounting statistics and times are generated by VIRTEL.</p>
<dl class="docutils">
<dt>Type C (cumulative)</dt>
<dd>Records are implemented at terminal disconnection.</dd>
<dt>Type P (partial)</dt>
<dd>Records are implemented at regular intervals.</dd>
<dt>Type E (end of job)</dt>
<dd>Records are implemented at VIRTEL shutdown.</dd>
</dl>
</div>
<div class="section" id="virstat-alternative-x25-format">
<span id="index-86"></span><h4>VIRSTAT alternative X25 format<a class="headerlink" href="#virstat-alternative-x25-format" title="Permalink to this headline">¶</a></h4>
<p>For terminals which specify alternate X25 format recording (STATS=4), the VIRSTAT record format is shown in the following  table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Position</span>        <span class="n">Format</span>          <span class="n">Type</span> <span class="n">of</span> <span class="n">information</span>
<span class="mi">1</span> <span class="n">to</span> <span class="mi">8</span>          <span class="n">Alphanumeric</span>    <span class="n">Terminal</span> <span class="n">name</span>
<span class="mi">9</span> <span class="n">to</span> <span class="mi">12</span>         <span class="n">Packed</span> <span class="n">Decimal</span>  <span class="n">Date</span> <span class="p">(</span><span class="n">CCYYDDDF</span><span class="p">)</span>
<span class="mi">13</span> <span class="n">to</span> <span class="mi">16</span>        <span class="n">Packed</span> <span class="n">Decimal</span>  <span class="n">Time</span> <span class="p">(</span><span class="n">HHMMSSTF</span><span class="p">)</span>
<span class="mi">17</span> <span class="n">to</span> <span class="mi">36</span>        <span class="n">Alphanumeric</span>    <span class="n">Remote</span> <span class="n">X25</span> <span class="n">number</span>
<span class="mi">37</span> <span class="n">to</span> <span class="mi">40</span>        <span class="n">Hexadecimal</span>     <span class="n">Unused</span>
<span class="mi">41</span> <span class="n">to</span> <span class="mi">44</span>        <span class="n">Hexadecimal</span>     <span class="n">Unused</span>
<span class="mi">45</span> <span class="n">to</span> <span class="mi">48</span>        <span class="n">Hexadecimal</span>     <span class="n">Unused</span>
<span class="mi">49</span> <span class="n">to</span> <span class="mi">52</span>        <span class="n">Hexadecimal</span>     <span class="n">Unused</span>
<span class="mi">53</span> <span class="n">to</span> <span class="mi">56</span>        <span class="n">Hexadecimal</span>     <span class="n">Unused</span>
<span class="mi">57</span> <span class="n">to</span> <span class="mi">60</span>        <span class="n">Hexadecimal</span>     <span class="n">Unused</span>
<span class="mi">61</span> <span class="n">to</span> <span class="mi">61</span>        <span class="n">Alphanumeric</span>    <span class="n">Record</span> <span class="nb">type</span> <span class="p">(</span><span class="n">I</span><span class="o">=</span><span class="n">inbound</span><span class="p">,</span><span class="n">O</span><span class="o">=</span><span class="n">outbound</span><span class="p">)</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="mi">62</span> <span class="n">to</span> <span class="mi">62</span>        <span class="n">Alphanumeric</span>    <span class="n">Unused</span>
<span class="mi">63</span> <span class="n">to</span> <span class="mi">70</span>        <span class="n">Alphanumeric</span>    <span class="n">Originating</span> <span class="n">GATE</span><span class="o">/</span><span class="n">PCNE</span> <span class="n">terminal</span> <span class="n">name</span> <span class="p">(</span><span class="n">outbound</span><span class="p">)</span>
                                <span class="n">Entry</span> <span class="n">point</span> <span class="n">name</span> <span class="p">(</span><span class="n">inbound</span><span class="p">)</span>
<span class="mi">71</span> <span class="n">to</span> <span class="mi">74</span>        <span class="n">Alphanumeric</span>    <span class="n">Unused</span>
<span class="mi">75</span> <span class="n">to</span> <span class="mi">82</span>        <span class="n">Alphanumeric</span>    <span class="n">Session</span> <span class="n">start</span> <span class="n">date</span> <span class="p">(</span><span class="n">MM</span><span class="o">/</span><span class="n">DD</span><span class="o">/</span><span class="n">YY</span><span class="p">)</span>
<span class="mi">83</span> <span class="n">to</span> <span class="mi">86</span>        <span class="n">Alphanumeric</span>    <span class="n">Session</span> <span class="n">start</span> <span class="n">date</span> <span class="p">(</span><span class="o">.</span><span class="n">DDD</span><span class="p">)</span>
<span class="mi">87</span> <span class="n">to</span> <span class="mi">94</span>        <span class="n">Alphanumeric</span>    <span class="n">Session</span> <span class="n">start</span> <span class="n">time</span> <span class="p">(</span><span class="n">HH</span><span class="o">.</span><span class="n">MM</span><span class="o">.</span><span class="n">SS</span><span class="p">)</span>
<span class="mi">95</span> <span class="n">to</span> <span class="mi">102</span>       <span class="n">Alphanumeric</span>    <span class="n">Session</span> <span class="n">end</span> <span class="n">date</span> <span class="p">(</span><span class="n">MM</span><span class="o">/</span><span class="n">DD</span><span class="o">/</span><span class="n">YY</span><span class="p">)</span>
<span class="mi">103</span> <span class="n">to</span> <span class="mi">106</span>      <span class="n">Alphanumeric</span>    <span class="n">Session</span> <span class="n">end</span> <span class="n">date</span> <span class="p">(</span><span class="o">.</span><span class="n">DDD</span><span class="p">)</span>
<span class="mi">107</span> <span class="n">to</span> <span class="mi">114</span>      <span class="n">Alphanumeric</span>    <span class="n">Session</span> <span class="n">end</span> <span class="n">time</span> <span class="p">(</span><span class="n">HH</span><span class="o">.</span><span class="n">MM</span><span class="o">.</span><span class="n">SS</span><span class="p">)</span>
<span class="mi">115</span> <span class="n">to</span> <span class="mi">115</span>      <span class="n">Alphanumeric</span>    <span class="n">Unused</span>
<span class="mi">116</span> <span class="n">to</span> <span class="mi">116</span>      <span class="n">Alphanumeric</span>    <span class="n">Disconnection</span> <span class="n">Type</span> <span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">by</span> <span class="n">TIME</span><span class="o">-</span><span class="n">OUT</span><span class="p">)</span>
<span class="mi">117</span> <span class="n">to</span> <span class="mi">120</span>      <span class="n">Hexadecimal</span>     <span class="n">Unused</span>
<span class="mi">121</span> <span class="n">to</span> <span class="mi">124</span>      <span class="n">Hexadecimal</span>     <span class="n">Call</span> <span class="n">duration</span> <span class="ow">in</span> <span class="mi">1</span><span class="o">/</span><span class="mi">100</span> <span class="n">second</span>
</pre></div>
</div>
<p><em>Format of VIRSTAT record (alternate X25 format)</em></p>
<p>For NPSI Fast Connect lines, the X25 session start and end times are provided by NPSI at virtual circuit disconnection time and depend on the clock settings in the NCP. For other types of lines, times are     generated by VIRTEL.</p>
<dl class="docutils">
<dt>Type I (inbound)</dt>
<dd>Records relate to X25 incoming calls.</dd>
<dt>Type O (outbound)</dt>
<dd>Records relate to X25 outgoing calls.</dd>
</dl>
<p>For terminals which specify web format recording (STATS=5 or STATS=6), the VIRSTAT record format is shown in the following  tables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Position        Format          Type of information
1 to 8          Alphanumeric    Terminal name
9 to 12         Packed Decimal  Date (CCYYDDDF)
13 to 16        Packed Decimal  Time (HHMMSSTF)
17 to 31        Alphanumeric    Caller’s IP address
32 to 36        Alphanumeric    Alphanumeric
37 to 44        Alphanumeric    Entry point name
45 to 52        Alphanumeric    Transaction external name
53 to 60        Alphanumeric    Rule name
61 to 61        Alphanumeric    Record type (H=HTTP inbound)
62 to 64        Alphanumeric    Unused
65 to 68        Alphanumeric    Error code
69 to 76        Alphanumeric    Relay LU name
77 to 84        Alphanumeric    Call duration in 1/100 second
85 to 92        Alphanumeric    No of bytes received
93 to 100       Alphanumeric    No of bytes sent
101 to 108      Alphanumeric    Session start date (MM/DD/YY)
109 to 116      Alphanumeric    Session start time (HH.MM.SS)
117 to 124      Alphanumeric    Session end time (HH.MM.SS)
</pre></div>
</div>
<p><em>Format of VIRSTAT record (type 5 for Web Access)</em></p>
<p>This record type is written when 5 is specified in the STATS field of the terminal definition used for the HTTP line. If the terminal is disconnected by TIMEOUT, the “Error Code” field contains the word     “TIME”.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Position        Format          Type of information
1 to 8          Alphanumeric    Terminal name
9 to 12         Packed Decimal  Date (CCYYDDDF)
13 to 16        Packed Decimal  Time (HHMMSSTF)
17 to 31        Alphanumeric    Caller’s IP address
32 to 36        Alphanumeric    Caller’s port number
37 to 44        Alphanumeric    Entry point name
45 to 52        Alphanumeric    Transaction external name
53 to 60        Alphanumeric    Rule name
61 to 61        Alphanumeric    Record type (B=binary HTTP inbound)
62 to 64        Alphanumeric    Unused
65 to 68        Alphanumeric    Error code
69 to 76        Alphanumeric    Relay LU name
77 to 80        Hexadecimal     Call duration in 1/100 second
81 to 84        Hexadecimal     No of bytes received
85 to 88        Hexadecimal     No of bytes sent
89 to 108       Alphanumeric    User name
109 to 124      Alphanumeric    URL parameter
</pre></div>
</div>
<p><em>Format of VIRSTAT record (type 6 for Web Access)</em></p>
<p>For this record type, the counters are in binary, and the Session Date and Time fields are replaced by User name (20 bytes) and URL parameter (first 16 bytes).</p>
<p>This record type is written when 6 is specified in the STATS field of the terminal definition used for the HTTP line.</p>
</div>
<div class="section" id="printing-the-contents-of-the-virstat-file-x25">
<span id="index-87"></span><h4>Printing the contents of the VIRSTAT file (X25)<a class="headerlink" href="#printing-the-contents-of-the-virstat-file-x25" title="Permalink to this headline">¶</a></h4>
<p>The VIR0070 program allows the contents of the VIRSTAT file to be printed. The source for this program is supplied in the SSL (VSE) or in the SAMPLIB (z/OS) and you can use this as the basis of a     user-written program to print statistics.</p>
<p>Examples of the JCL required to execute this program are shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>* $$ JOB JNM=VIRSTAT,CLASS=0,DISP=D
* $$ LST DISP=D,CLASS=V,DEST=(,SPTUSER)
// JOB VIRPRNT
// LIBDEF *,SEARCH=VIRT442.SUBLIB
// DLBL STAT,&#39;VIRTEL.VIRSTAT.ESDS&#39;,,VSAM,CAT=VSESPUC
// EXEC VIR0070,SIZE=AUTO
/*
/&amp;
* $$ EOJ
</pre></div>
</div>
<p><em>Fig. 17 VIR0070 JCL to print VIRSTAT file (VSE)</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">VIRSTAT</span> <span class="n">JOB</span> <span class="mi">1</span><span class="p">,</span><span class="n">USER</span><span class="p">,</span><span class="n">CLASS</span><span class="o">=</span><span class="n">A</span><span class="p">,</span><span class="n">MSGCLASS</span><span class="o">=</span><span class="n">X</span><span class="p">,</span><span class="n">NOTIFY</span><span class="o">=&amp;</span><span class="n">SYSUID</span>
<span class="o">//</span><span class="n">TRI</span> <span class="n">EXEC</span> <span class="n">PGM</span><span class="o">=</span><span class="n">SORT</span>
<span class="o">//</span><span class="n">SYSPRINT</span> <span class="n">DD</span> <span class="n">SYSOUT</span><span class="o">=*</span>
<span class="o">//</span><span class="n">SYSOUT</span> <span class="n">DD</span> <span class="n">SYSOUT</span><span class="o">=*</span>
<span class="o">//</span><span class="n">SORTWK01</span> <span class="n">DD</span> <span class="n">UNIT</span><span class="o">=</span><span class="mi">3380</span><span class="p">,</span><span class="n">SPACE</span><span class="o">=</span><span class="p">(</span><span class="n">TRK</span><span class="p">,(</span><span class="mi">100</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span><span class="n">RLSE</span><span class="p">)</span>
<span class="o">//</span><span class="n">SORTWK02</span> <span class="n">DD</span> <span class="n">UNIT</span><span class="o">=</span><span class="mi">3380</span><span class="p">,</span><span class="n">SPACE</span><span class="o">=</span><span class="p">(</span><span class="n">TRK</span><span class="p">,(</span><span class="mi">100</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span><span class="n">RLSE</span><span class="p">)</span>
<span class="o">//</span><span class="n">SORTIN</span> <span class="n">DD</span> <span class="n">DISP</span><span class="o">=</span><span class="n">SHR</span><span class="p">,</span><span class="n">DSN</span><span class="o">=</span><span class="n">VIRTEL</span><span class="o">.</span><span class="n">STAT</span>
<span class="o">//</span><span class="n">SORTOUT</span> <span class="n">DD</span> <span class="n">DSN</span><span class="o">=&amp;&amp;</span><span class="n">STAT</span><span class="p">,</span><span class="n">UNIT</span><span class="o">=</span><span class="n">SYSDA</span><span class="p">,</span><span class="n">DISP</span><span class="o">=</span><span class="p">(,</span><span class="n">PASS</span><span class="p">),</span>
<span class="o">//</span> <span class="n">DCB</span><span class="o">=</span><span class="p">(</span><span class="n">LRECL</span><span class="o">=</span><span class="mi">124</span><span class="p">,</span><span class="n">BLKSIZE</span><span class="o">=</span><span class="mi">620</span><span class="p">,</span><span class="n">RECFM</span><span class="o">=</span><span class="n">FB</span><span class="p">),</span>
<span class="o">//</span> <span class="n">SPACE</span><span class="o">=</span><span class="p">(</span><span class="n">TRK</span><span class="p">,(</span><span class="mi">100</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span><span class="n">RLSE</span><span class="p">)</span>
<span class="o">//</span><span class="n">SYSIN</span> <span class="n">DD</span> <span class="o">*</span>
<span class="n">SORT</span> <span class="n">FIELDS</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="n">A</span><span class="p">),</span><span class="n">FORMAT</span><span class="o">=</span><span class="n">CH</span>
<span class="n">END</span>
<span class="o">//</span><span class="n">STAT</span> <span class="n">EXEC</span> <span class="n">PGM</span><span class="o">=</span><span class="n">VIR0070</span>
<span class="o">//</span><span class="n">STEPLIB</span> <span class="n">DD</span> <span class="n">DISP</span><span class="o">=</span><span class="n">SHR</span><span class="p">,</span><span class="n">DSN</span><span class="o">=</span><span class="n">VIRT442</span><span class="o">.</span><span class="n">LOADLIB</span>
<span class="o">//</span><span class="n">SYSUDUMP</span> <span class="n">DD</span> <span class="n">SYSOUT</span><span class="o">=*</span>
<span class="o">//</span><span class="n">SYSPRINT</span> <span class="n">DD</span> <span class="n">SYSOUT</span><span class="o">=*</span>
<span class="o">//</span><span class="n">VIRSTAT</span> <span class="n">DD</span> <span class="n">DISP</span><span class="o">=</span><span class="p">(</span><span class="n">OLD</span><span class="p">,</span><span class="n">DELETE</span><span class="p">),</span><span class="n">DSN</span><span class="o">=&amp;&amp;</span><span class="n">STAT</span>
<span class="o">//</span>
</pre></div>
</div>
<p><em>VIR0070 JCL to print VIRSTAT file (z/OS)</em></p>
</div>
<div class="section" id="printing-the-contents-of-the-virstat-file-http">
<span id="index-88"></span><h4>Printing the contents of the VIRSTAT file (HTTP)<a class="headerlink" href="#printing-the-contents-of-the-virstat-file-http" title="Permalink to this headline">¶</a></h4>
<p>The PRTSTATW program supplied with the system allows printing of type 6 records from the VIRSTAT file. This program is delivered as a load module in the VIRTEL LOADLIB (from version 4.45 onwards) and the execution JCL is provided as member JCLPRTST in the VIRTEL SAMPLIB.</p>
<p>Examples of the execution JCL for this program are shown below.</p>
<div class="section" id="z-vse-jcl">
<h5>z/VSE JCL<a class="headerlink" href="#z-vse-jcl" title="Permalink to this headline">¶</a></h5>
<p>In the VSE environment the VIRPRTST job, loaded into the POWER reader queue during VIRTEL installation, contains an example of JCL for printing the VIRSTAT file. This job is an example only and must be modified before execution:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>* $$ JOB JNM=VIRPRTST,CLASS=0,DISP=D
* $$ LST DA
// JOB VIRPRTST
* *****************************************************************
* * VIRTEL: EXAMPLE JCL TO EXECUTE STAT VIRTEL PRINT *
* *****************************************************************
// LIBDEF *,SEARCH=(VIRT452.SUBLIB,PRD2.CONFIG,PRD1.BASE)
// DLBL SORTIN1,&#39;VIRTEL.STAT&#39;,,VSAM,CAT=VSESPUC
// DLBL SORTOUT,&#39;%VIRTEL.SORTFILE&#39;,0,VSAM,CAT=VSESPUC,DISP=(NEW,KEEP), C
RECORDS=(10,100),RECSIZE=124
* // DLBL SORTOUT,&#39;VIRTEL.SORTFILE&#39;,0,SD
* // EXTENT SYS001,SYSWK2,1,0,NNNN,15
* // ASSGN SYS001,DISK,VOL=SYSWK2,SHR
// EXEC SORT,SIZE=100K
SORT FIELDS=(01,08,A),FORMAT=CH
RECORD TYPE=F,LENGTH=124
END
/*
* OPTIONS FOR PRINT OR COUNT
* // DLBL SYSPRINT DD SYSOUT=*
* // DLBL SYSABEND DD SYSOUT=*
* // DLBL IJSYSLS DD SYSOUT=*
*
// DLBL VIRSTAT,&#39;%VIRTEL.SORTFILE&#39;,0,VSAM,CAT=VSESPUC,DISP=(,DELETE)
// ASSGN SYS007,SYSLST
// ASSGN SYS006,SYSRDR
// EXEC PGM=PRTSTATW,SIZE=AUTO
PRTSTATW PRINT NNN 0250
SELDATE 01012011 31122012
SELTERM DEVTA* CLVTA*
/*
* * MAIN CARD (REQUIRED)
* * ---------
* * 1 2 3 4 5 6
* *1...!....0....!....0....!....0....!....0....!....0....!....0...
* *PRTSTATW PRINT BREAK USER NNN PPPP
* * SPECIFIC REQUEST TO PRINT THE STATISTICS
* *PRTSTATW COUNT $ALL$ NNN PPPP
* * SPECIFIC REQUEST TO COUNT THE NUMBERS OF DIFFERENT
* * USERS
* *SELECT CARD (OPTIONAL)
* * -----------
* * 1 2 3 4 5 6
* *1...5....0....5....0....5....0....5....0....5....0....5....0
* *SELDATE DDMMYYYY DDMMYYYY
* * DATE SELECTION BEGIN,
* * END DATE
* *SELTERM TTTTTTTT XXXXXXXX YYYYYYYY ZZZZZZZZ (UP TO 8 BYTES)
* *SELUSER USER4571890123457789 (UP TO 20 BYTES)
* *SELPARM PARM457189012345 (UP TO 16 BYTES)
* *1...!....0....!....0....!....0....!....0....!....0....!....0...
* * THE &#39;*&#39; CHARACTER ALLOWS A GENERIC EVALUATION.
/&amp;
* $$ EOJ
</pre></div>
</div>
<p><em>PRTSTATW JCL to print VIRSTAT file in VSE (type=6)</em></p>
</div>
<div class="section" id="z-os-jcl">
<h5>z/OS JCL<a class="headerlink" href="#z-os-jcl" title="Permalink to this headline">¶</a></h5>
<p>In the z/OS environment the JCL for executing the PRTSTATW program is supplied as member JCLPRTST in the VIRTEL SAMPLIB:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>//VIRPRTST JOB 1,USER,CLASS=A,MSGCLASS=X,NOTIFY=&amp;SYSUID
/*JOBPARM LINES=9999
//*------------------------------------------------------------*
//* VIRSTAT FILE PRINTING JOB *
//* VIRSTAT RECORD TYPE 6 (VSTA-RECORD-TYPE=&#39;B&#39;) *
//*------------------------------------------------------------*
// SET LOAD=yourqual.VIRTnnn.LOADLIB
// SET STAT=yourqual.VIRTnnn.STAT
//*------------------------------------------------------------*
//JOBLIB DD DISP=SHR,DSN=&amp;LOAD
//*------------------------------------------------------------*
//*
//STEP0 EXEC PGM=SORT
//SYSOUT DD SYSOUT=*
//SORTIN DD DISP=SHR,DSN=&amp;STAT
//SORTOUT DD DSN=&amp;&amp;SORTSTAT,DISP=(NEW,PASS),UNIT=SYSDA,
// DCB=(BLKSIZE=1240,LRECL=124,RECFM=FB),
// SPACE=(TRK,(1,1))
//SYSIN DD *
SORT FIELDS=(1,8,A),FORMAT=CH
//*
//STEP1 EXEC PGM=PRTSTATW
//SYSPRINT DD SYSOUT=*
//SYSABEND DD SYSOUT=*
//IJSYSLS DD SYSOUT=*
//*
//VIRSTAT DD DSN=&amp;&amp;SORTSTAT,DISP=OLD
//SYSIN DD *
PRTSTATW PRINT NNN 0250
SELDATE 01012011 31122012
SELTERM DEVTA* CLVTA*
* ..!....0....!....0....!....0....!....0....!....0....!....0...
//* MAIN CARD (required)
//* ---------
//* 1 2 3 4 5 6
//* 1...!....0....!....0....!....0....!....0....!....0....!....0...
//* PRTSTATW PRINT BREAK USER NNN PPPP
//* specific request to print the statistics
//* PRTSTATW COUNT $ALL$ NNN PPPP
//* specific request to count the numbers of different
//* users
//* SELECT CARD (optional)
//* -----------
//* 1 2 3 4 5 6
//* 1...5....0....5....0....5....0....5....0....5....0....5....0
//* SELDATE DDMMYYYY DDMMYYYY
//* DATE selection begin,
//* end date
//* SELTERM TTTTTTTT XXXXXXXX YYYYYYYY ZZZZZZZZ (up to 8 bytes)
//* SELUSER USER4571890123457789 (up to 20 bytes)
//* SELPARM PARM457189012345 (up to 16 bytes)
//* 1...!....0....!....0....!....0....!....0....!....0....!....0...
//* The &#39;*&#39; character allows a generic evaluation.
//
</pre></div>
</div>
<p><em>PRTSTATW JCL to print VIRSTAT file in z/OS (type=6)</em></p>
<dl class="docutils">
<dt>This JCL consists of two main steps:</dt>
<dd><ul class="first last simple">
<li>a first step to sort the file</li>
<li>a second step to PRINT or COUNT the records</li>
</ul>
</dd>
</dl>
</div>
</div>
<div class="section" id="sorting-the-virstat-file">
<span id="index-89"></span><h4>Sorting the VIRSTAT file<a class="headerlink" href="#sorting-the-virstat-file" title="Permalink to this headline">¶</a></h4>
<p>The sort requirements are determined by the type of report desired. Since the PRTSTATW program offers the option of selecting records and also offers up to two levels of report break to allow printing of subtotals, it is important to specify the appropriate sort criteria to obtain the correct result.</p>
<p>The sort operates on one or more criteria, in ascending (A) or descending (D) mode. You should adapt the SORT SYSIN according to the syntax of the specific SORT program being used.</p>
<p>Several examples of sort criteria are shown below for various fields: terminal (TERM), date (DATE), user name (USER), URL parameter (PARM)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SORT FIELDS=(1,8,A) --&gt; TERM A: ascending D: descending
SORT FIELDS=(9,4,A) --&gt; DATE
SORT FIELDS=(89,20,A) --&gt; USER
SORT FIELDS=(109,16,A) --&gt; PARM
SORT FIELDS=(1,8,A,),FORMAT=CH sort by TERM
SORT FIELDS=(1,8,A,89,20,A),FORMAT=CH sort by TERM first then USER
SORT FIELDS=(17,15,A) --&gt; IP Adress (for $ALL$ request)
SORT FIELDS=(89,20,A,17,15,A),FORMAT=CH sort for $ALL$ request
</pre></div>
</div>
<p><em>PRTSTATW JCL sort criteria</em></p>
<p>For example, to obtain a report in ascending order of session start date, specify the following statements in the SORT SYSIN:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">SYSIN</span> <span class="n">DD</span> <span class="o">*</span>
<span class="n">SORT</span> <span class="n">FIELDS</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">A</span><span class="p">),</span><span class="n">FORMAT</span><span class="o">=</span><span class="n">CH</span>
<span class="o">//*</span>
</pre></div>
</div>
</div>
<div class="section" id="prtstatw-program">
<span id="index-90"></span><h4>PRTSTATW program<a class="headerlink" href="#prtstatw-program" title="Permalink to this headline">¶</a></h4>
<p>The PRTSTATW program executed in the second step reads the sorted output file from the first step. It contains required and optional SYSIN cards.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>First card (Required)
         1         2         3         4         5         6
1...!....0....!....0....!....0....!....0....!....0....!....0...
PRTSTATW PRINT                BREAK USER          NNN  PPPP
</pre></div>
</div>
<p><em>PRTSTATW first SYSIN card</em></p>
<dl class="docutils">
<dt>Columns 1 to 8</dt>
<dd>Program name: must be PRTSTATW</dd>
<dt>Columns 11 to 16</dt>
<dd>Report type: specify PRINT (print report) or COUNT (calculate number of distinct users)</dd>
<dt>Columns 31 to 35</dt>
<dd>Optionally specify BREAK if report break is desired (up to 2 levels) for printing (PRINT) or $ALL$ if counting (COUNT)</dd>
<dt>Columns 37 to 40</dt>
<dd>Optionally indicates the type of report break: TERM (break on change of terminal name), USER (break on change of user name), DATE (break on change of date) or PARM (break on change of URL parameter)</dd>
<dt>Columns 43 to 46</dt>
<dd>Optionally indicates the second level report break (TERM, USER, DATE, or PARM)</dd>
<dt>Columns 51 to 53</dt>
<dd>Optionally specify N (no) or O (yes) to print additional trace information (program trace, input/output trace, and miscellaneous trace respectively). The default is N for each trace.</dd>
<dt>Columns 56 to 59</dt>
<dd>Maximum number of pages to be printed (default 50 pages)</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Second</span> <span class="n">card</span> <span class="p">(</span><span class="n">Optional</span><span class="p">)</span>
         <span class="mi">1</span>         <span class="mi">2</span>         <span class="mi">3</span>         <span class="mi">4</span>         <span class="mi">5</span>         <span class="mi">6</span>
<span class="mf">1.</span><span class="o">..</span><span class="mf">5.</span><span class="o">...</span><span class="mf">0.</span><span class="o">...</span><span class="mf">5.</span><span class="o">...</span><span class="mf">0.</span><span class="o">...</span><span class="mf">5.</span><span class="o">...</span><span class="mf">0.</span><span class="o">...</span><span class="mf">5.</span><span class="o">...</span><span class="mf">0.</span><span class="o">...</span><span class="mf">5.</span><span class="o">...</span><span class="mf">0.</span><span class="o">...</span><span class="mf">5.</span><span class="o">...</span><span class="mi">0</span>
<span class="n">SELDATE</span>   <span class="n">DDMMYYYY</span>  <span class="n">DDMMYYYY</span>
          <span class="n">DATE</span> <span class="n">selection</span> <span class="n">begin</span><span class="p">,</span>
                    <span class="n">end</span> <span class="n">date</span>
<span class="n">SELTERM</span>   <span class="n">TTTTTTTT</span>  <span class="n">XXXXXXXX</span>  <span class="n">YYYYYYYY</span>  <span class="n">ZZZZZZZZ</span> <span class="p">(</span><span class="n">up</span> <span class="n">to</span> <span class="mi">8</span> <span class="nb">bytes</span><span class="p">)</span>
<span class="n">SELUSER</span>   <span class="n">USER4571890123457789</span>     <span class="p">(</span><span class="n">up</span> <span class="n">to</span> <span class="mi">20</span> <span class="nb">bytes</span><span class="p">)</span>
<span class="n">SELPARM</span>   <span class="n">PARM457189012345</span>         <span class="p">(</span><span class="n">up</span> <span class="n">to</span> <span class="mi">16</span> <span class="nb">bytes</span><span class="p">)</span>
</pre></div>
</div>
<p><em>PRTSTATW second SYSIN card</em></p>
<p>This card allows records to be selected according to 4 fields: DATE (selection by date range), TERM (selection of up to 4 different terminal names, otherwise 4 different HTTP lines), USER (selection by user name), PARM (selection by URL parameter).</p>
<p>It is possible to make a <strong>generic</strong> selection by coding a ‘*’ character at the end of a field. For example, specifying a terminal selection value of DEVT* allows the program to select all records whose terminal name begins with DEVT.</p>
<dl class="docutils">
<dt>Columns 1 to 7</dt>
<dd>Optional, indicates the selection type: SELDATE (for DATE), SELTERM (for terminal), SELUSER (for user), or SELPARM (for URL parameter).</dd>
<dt>Columns 11 to 19</dt>
<dd>Indicates up to 8 characters for the chosen value (SELDATE and SELTERM). The value may end in ‘*’ for a generic search.</dd>
<dt>Columns 21 to 29</dt>
<dd>For SELDATE: second date in the range, for SELTERM: second terminal name (optional)</dd>
<dt>Columns 31 to 39</dt>
<dd>For SELTERM: third terminal name (optional)</dd>
<dt>Columns 41 to 49</dt>
<dd>For SELTERM: fourth terminal name (optional)</dd>
<dt>Columns 21 to 40</dt>
<dd>For SELUSER:up to 20 characters for the user name. The value may end in ‘*’ for a generic search.</dd>
<dt>Columns 21 to 36</dt>
<dd>For SELPARM: up to 16 characters for the URL parameter. The value  may end in ‘*’ for a generic search.</dd>
</dl>
<div class="section" id="counter-report">
<h5>Counter Report<a class="headerlink" href="#counter-report" title="Permalink to this headline">¶</a></h5>
<p>Clients who wish to obtain the total number of unique users can execute the PRTSTATW program with the SYSIN shown below.</p>
<p>For the SORT: the first sort field is the user name, and the second sort field is the IP address:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">SYSIN</span> <span class="n">DD</span> <span class="o">*</span>
<span class="n">SORT</span> <span class="n">FIELDS</span><span class="o">=</span><span class="p">(</span><span class="mi">89</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="n">A</span><span class="p">),</span><span class="n">FORMAT</span><span class="o">=</span><span class="n">CH</span>
<span class="o">//</span>
</pre></div>
</div>
<p>For the PRTSTATW program:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>//SYSIN DD *
PRTSTATW COUNT $ALL$ NNN 0465
SELDATE 01012011 30122011
SELTERM DEVTA* CLVTA*
</pre></div>
</div>
<p>COUNT and $ALL$ are required. The selection cards are optional. They allow for example to report for a given period the number of different users connected to the system in HTTP mode and/or to filter on an HTTP line defined with transaction security active, which requires the user to sign on.</p>
<p>For z/OS, sample JCL for the user counter report is supplied in the JCLCOUST member of the VIRTEL SAMPLIB. For VSE, a sample job named VIRCOUST is loaded into the POWER Reader Queue at installation time.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1== VIRTEL == Statistics file COUNT job ==
Submit on: 18-01-2011 at: 14:23:12              PAGE : 000
Parameters CARDS list read by PRTSTATW

PRTSTATW COUNT                  $ALL$   PARM        NNN 0469
SELDATE 01012010 30122011
* ..!....0....!....0....!....0....!....0....!....0....!....0...

18-01-2011      14:23:12                * S U M M A R Y *
18-01-2011      14:23:12                With criterias put for selection at top of listing:
18-01-2011      14:23:12                Total Records read              : 00207
18-01-2011      14:23:12                Total Calls selected            : 00017
18-01-2011      14:23:12                Total Calls duration            : 001hr04mn35s
18-01-2011      14:23:12                Total Calls ended by &quot;Timeout&quot;  : 00007
18-01-2011      14:23:12                Total Defined different Users   : 00004
18-01-2011      14:23:12                Total Calls without signature   : 00001
18-01-2011      14:23:12                End of execution
</pre></div>
</div>
<p><em>PRTSTATW user counter report</em></p>
</div>
</div>
</div>
<div class="section" id="smf-support">
<span id="index-91"></span><h3>SMF Support<a class="headerlink" href="#smf-support" title="Permalink to this headline">¶</a></h3>
<p>Using VIRTEL 4.53+ and onwards allows VIRTEL SMF support writing VIRSTATS records into SMF. The VIRTCT must be reassembled and link-edited with a new value SMF or (SMF,nnn) for the STATS parameter to have this feature active. The SMF record format is the same as the current STATS record but prefixed by the standard SMF header. The default SMF record number is 223, but it can be modified using the (SMF,nnn) syntax.</p>
<div class="section" id="printing-the-virstat-smf-record">
<span id="index-92"></span><h4>Printing the VIRSTAT SMF record<a class="headerlink" href="#printing-the-virstat-smf-record" title="Permalink to this headline">¶</a></h4>
<p>The SMFPRINT job in VIRTEL.SAMPLIB can be used to print the SMF records from the SYS1.MANx dataset using SMFREXXP REXX procedure.</p>
<p>The SMFPRNTL job in VIRTEL.SAMPLIB can Be used to print SMF records that have been written to the SMF LOGSTREAM. This job calls the SMFREXXL REXX procedure to format and print the SMF records extracted from the LOGSTREAM.</p>
<p>Messages “VIR0612E VIRSTAT SMFWTM FAILED. RC=rc” and “VIR0611I VIRSTAT NOW RECORDING TO SMF” are in relation with SMF support. See “Virtel Messages and Operations” manual for more details.</p>
</div>
<div class="section" id="structure-of-the-binary-stats-record">
<h4>Structure of the Binary STATS record.<a class="headerlink" href="#structure-of-the-binary-stats-record" title="Permalink to this headline">¶</a></h4>
<p>The segment within the SMF record starts at offset X’0E’ within the record.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>*------------------------------------------------------------*
*        DESCRIPTION DU FICHIER DES STATISTIQUES (MCVFALT3)
*------------------------------------------------------------*
*
BSTATS   DSECT
B$LUNAME DS    CL8                     NOM DU TERMINAL
B$DATE   DS    PL4                     DATE STATISTIQUES
B$TIME   DS    PL4                     HEURE STATISTIQUES
B$CUMPAR DS    CL1                     B Binaire HTTP entrant
         DS    CL3                     filler
B$IPADDR DS    CL40  (was 15)          CALLER IP ADDRESS
B$ENTRY  DS    CL8                     ENTRY POINT
B$TRANS  DS    CL8                     TRANSACTION
B$RULE   DS    CL8                     RULE (default to LINE)
B$STATUS DS    CL4                     HTTP STATUS
B$RELAY  DS    CL8                     NOM DU RELAY
B$SPENT  DS    XL4                     Dur e d&#39;appel en 1/100s
B$BYTRD  DS    XL4                     BYTES RECEIVED
B$BYTST  DS    XL4                     BYTES SENT
B$USERID DS    CL20                    USERID
B$PARM   DS    CL16                    PARAMETER
B$PXYADR DS    CL40                    PROXY IP ADDRESS
        ORG   BSTATS+255
LBSTATS  EQU   *-BSTATS                LONGUEUR ENREGISTREMENT
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="appendix">
<h2>Appendix<a class="headerlink" href="#appendix" title="Permalink to this headline">¶</a></h2>
<div class="section" id="trademarks">
<h3>Trademarks<a class="headerlink" href="#trademarks" title="Permalink to this headline">¶</a></h3>
<p>SysperTec, the SysperTec logo, syspertec.com and VIRTEL are trademarks or registered trademarks of SysperTec Communication Group, registered in France and other countries.</p>
<p>IBM, VTAM, CICS, IMS, RACF, DB2, MVS, WebSphere, MQSeries, System z are trademarks or registered trademarks of International Business Machines Corp., registered in United States and other countries.</p>
<p>Adobe, Acrobat, PostScript and all Adobe-based trademarks are either registered trademarks or trademarks of Adobe Systems Incorporated in the United States and other countries.</p>
<p>Microsoft, Windows, Windows NT, and the Windows logo are trademarks of Microsoft Corporation in the United States and other countries.</p>
<p>UNIX is a registered trademark of The Open Group in the United States and other countries. Java and all Java-based trademarks and logos are trademarks or registered trademarks of Oracle and/or its affiliates.</p>
<p>Linux is a trademark of Linus Torvalds in the United States, other countries, or both.</p>
<p>Other company, product, or service names may be trademarks or service names of others.</p>
</div>
<div class="section" id="open-source-software">
<h3>Open Source Software<a class="headerlink" href="#open-source-software" title="Permalink to this headline">¶</a></h3>
<p>The current VIRTEL Web Access product uses the following open source software:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>jQuery</dt>
<dd>Under MIT license - <a class="reference external" href="https://jquery.org/license/">https://jquery.org/license/</a></dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>jQuery_UI</dt>
<dd>Under MIT license - <a class="reference external" href="http://en.wikipedia.org/wiki/JQuery_UI">http://en.wikipedia.org/wiki/JQuery_UI</a></dd>
</dl>
</li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Virtel460CN/connectivity_guide.html" class="btn btn-neutral float-right" title="Connectivity Reference V4.60" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../Virtel459UG/User_Guide.html" class="btn btn-neutral float-left" title="User Guide V4.59" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2017, Syspertec. All rights reserved

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>