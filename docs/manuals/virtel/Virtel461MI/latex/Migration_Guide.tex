%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\PassOptionsToPackage{warn}{textcomp}


\usepackage{cmap}

\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}

\usepackage[Bjarne]{fncychap}
\usepackage[,numfigreset=1,mathnumfig]{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}

% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}
\addto\captionsenglish{\renewcommand{\contentsname}{Table of Contents:}}

\addto\captionsenglish{\renewcommand{\figurename}{Fig.\@ }}
\makeatletter
\def\fnum@figure{\figurename\thefigure{}}
\makeatother
\addto\captionsenglish{\renewcommand{\tablename}{Table }}
\makeatletter
\def\fnum@table{\tablename\thetable{}}
\makeatother
\addto\captionsenglish{\renewcommand{\literalblockname}{Listing}}

\addto\captionsenglish{\renewcommand{\literalblockcontinuedname}{continued from previous page}}
\addto\captionsenglish{\renewcommand{\literalblockcontinuesname}{continues on next page}}
\addto\captionsenglish{\renewcommand{\sphinxnonalphabeticalgroupname}{Non-alphabetical}}
\addto\captionsenglish{\renewcommand{\sphinxsymbolsname}{Symbols}}
\addto\captionsenglish{\renewcommand{\sphinxnumbersname}{Numbers}}

\addto\extrasenglish{\def\pageautorefname{page}}

\setcounter{tocdepth}{1}


% Enable unicode and use Courier New to ensure the card suit
% characters that are part of the 'random' module examples
% appear properly in the PDF output.
\usepackage{fontspec}
\setmonofont{Courier New}


\title{Virtel Migration Guide}
\date{Oct 15, 2021}
\release{4.61}
\author{Syspertec Communications}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{Migration_Guide::doc}}


\sphinxstylestrong{VIRTEL Migration Guide}

\begin{sphinxadmonition}{warning}{Warning:}
This is a draft version of the document.
\end{sphinxadmonition}

Version : 4.61 Draft

Release Date : 14th October 2021. Publication Date : 10/10/2021

Syspertec Communication

196, Bureaux de la Colline 92213 Saint-Cloud Cedex Tél. : +33 (0) 1 46 02 60 42

\sphinxhref{http://www.syspertec.com/}{www.syspertec.com}

NOTICE
\begin{quote}

Reproduction, transfer, distribution, or storage, in any form, of all or any part of
the contents of this document, except by prior authorization of SysperTec
Communication, is prohibited.

Every possible effort has been made by SysperTec Communication to ensure that this document
is complete and relevant. In no case can SysperTec Communication be held responsible for
any damages, direct or indirect, caused by errors or omissions in this document.

As SysperTec Communication uses a continuous development methodology; the information
contained in this document may be subject to change without notice. Nothing in this
document should be construed in any manner as conferring a right to use, in whole or in
part, the products or trademarks quoted herein.

“SysperTec Communication” and “VIRTEL” are registered trademarks. Names of other products
and companies mentioned in this document may be trademarks or registered trademarks of
their respective owners.
\end{quote}

\newpage

\index{Migrating to Virtel V4.61@\spxentry{Migrating to Virtel V4.61}}\ignorespaces 

\chapter{Migrating to Virtel V4.61}
\label{\detokenize{Migration_Guide:migrating-to-virtel-v4-61}}\label{\detokenize{Migration_Guide:v461mi-introduction}}\label{\detokenize{Migration_Guide:index-0}}

\section{Overview}
\label{\detokenize{Migration_Guide:overview}}
The upgrade procedure detailed below will restore a complete “new” system on the mainframe.

Once restored you will have to integrate/migrate to the new librairies (sources or binaries), except for the ARBO (user configuration data) and HTML.TRSF (customisation data). Depending on your current Virtel level will dictate the migration path and consequently the updates you will need to do as part of the upgrade process.
\begin{itemize}
\item {} 
The SAMP.TRSF VSAM file will be completely replaced as part of the upgrade process. Any user directories located within the SAMP.TRSF VSAM file must be migrated to another TRSF file before beginning migration.

\item {} 
Similarly, you must ensure that you have not saved any customized elements into the SAMP.TRSF directories, a modified w2hparm.js for example. If this is the case, you must move these customisations to a directory hosted on another VSAM file and restore them back after the upgrade processes. Where possible, it is advisable than user modifications should not be kept in the SAMP.TRSF. Migrate them to another directory such as CLI-DIR, located on the HTML.TRSF VSAM file. This VSAM file is not affected by the migration process.

\end{itemize}

\newpage

\index{Upgrade Procedure@\spxentry{Upgrade Procedure}}\ignorespaces 

\section{Upgrade Procedure}
\label{\detokenize{Migration_Guide:upgrade-procedure}}\label{\detokenize{Migration_Guide:index-1}}
Before starting the upgrade read through this document first and build a migration plan. Depending on your current release and configuration some of the migration steps may not be applicable.

Download from our file server at \sphinxurl{http://ftp-group.syspertec.com}
\begin{itemize}
\item {} 
/VIRTEL 4.61/Produits/virtel461mvs.zip

\item {} 
/VIRTEL 4.61/PTFS/allptfs-mvs461.txt

\item {} 
/VIRTEL 4.61/PTFS/virtel461updtnnnn.zip

\end{itemize}

\begin{sphinxadmonition}{warning}{Warning:}
All jobs must be customized to your site standards before running. Backup and keep your existing HTML.TRSF and ARBO VSAM files.
\end{sphinxadmonition}

The procedure for upgrading from a previous release of VIRTEL (version 4.00 or later) is as follows:
\begin{enumerate}
\def\theenumi{\arabic{enumi}}
\def\labelenumi{\theenumi .}
\makeatletter\def\p@enumii{\p@enumi \theenumi .}\makeatother
\item {} 
Download and unzip virtel461mvs.zip.

\item {} 
Upload and run job \$ALOCDSU. This will allocate a XMIT file on the mainframe.

\item {} 
Upload virtel461mvs.xmit to the file allocated by \$ALOCDSU.

\item {} 
Upload and run job \$RESTDSU. This will allocate and install the new Virtel 4.61 libraries.

\item {} 
Apply any PTFs using AMASPZAP,PARM=IGNIDRFULL (job ZAPJCL from the new VIRTnnn.SAMPLIB). The input file is allptfs-mvs461.txt.

\item {} 
Copy your VIRTCTnn from the old VIRTnnn.CNTL library to the new VIRTnnn.CNTL

\item {} 
Reassemble your VIRTCTnn module using the ASMTCT job in VIRTnnn.CNTL

\item {} 
If you have any user scenario or user exit modules, copy them to the VIRTnnn.CNTL library and reassemble them using the ASMSCEN and ASMEXIT jobs respectively.

\item {} 
Add the new VIRTnnn.LOADLIB library to the system APF list in the MVS PARMLIB and use the SETPROG command to authorize the VIRTnnn.LOADLIB library.

\item {} 
Edit your VIRTEL procedure in the MVS PROCLIB, to ensure that:

\end{enumerate}
\begin{itemize}
\item {} 
The STEPLIB and DFHRPL DD statements reference the new VIRTxxx.LOADLIB

\item {} 
The SERVLIB DD statement references the new VIRTxxx.SERVLIB

\item {} 
The SAMPTRSF DD statement references the new VIRTxxx.SAMP.TRSF

\end{itemize}
\begin{enumerate}
\def\theenumi{\arabic{enumi}}
\def\labelenumi{\theenumi .}
\makeatletter\def\p@enumii{\p@enumi \theenumi .}\makeatother
\setcounter{enumi}{10}
\item {} 
Apply recommandations as shown below in “Check list and precautions”.

\end{enumerate}

\newpage
\begin{enumerate}
\def\theenumi{\arabic{enumi}}
\def\labelenumi{\theenumi .}
\makeatletter\def\p@enumii{\p@enumi \theenumi .}\makeatother
\setcounter{enumi}{11}
\item {} 
Apply any “update” maintenance (virtel461updtnnnn.zip), if any according to the instructions in the Readme-updtnnnn.txt file in the zip.

\item {} 
Stop and restart Virtel. If you want to create new copies of your existing ARBO and HTML.TRSF files, and rename them to your V4.61 HLQ, use the JCl shown below. This will preserve any configurational and customized elements you have. For example w2hparm.js, custom.js, custom.css and any customized option members:-

\end{enumerate}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
//\PYGZdl{}VSAMCPY JOB 9000,\PYGZsq{}COPY FILES\PYGZsq{},CLASS=A,MSGCLASS=X
//STEP0   EXEC PGM=ADRDSSU,REGION=0M PARM=(\PYGZsq{}TYPRUN=NORUN\PYGZsq{})
//SYSPRINT DD SYSOUT=*
//TEMP DD DUMMY
 DUMP DATASET              \PYGZhy{}
      (                    \PYGZhy{}
       INCLUDE(            \PYGZhy{}
      HLQ.VIRTnnn.ARBO.**, \PYGZhy{}
      HLQ.VIRTnnn.HTML.TRSF.**, \PYGZhy{}
                )         \PYGZhy{}
      )                   \PYGZhy{}
      DELETE    \PYGZhy{}
      PURGE      \PYGZhy{}
      TOL(ENQF) \PYGZhy{}
      OUTDDNAME(TEMP)
//STEP1   EXEC PGM=ADRDSSU,REGION=0M PARM=(\PYGZsq{}TYPRUN=NORUN\PYGZsq{})
//SYSPRINT DD  SYSOUT=*
//SYSUDUMP DD  SYSOUT=*
//SPT30B   DD  UNIT=3390,VOL=SER=SPT30B,DISP=SHR
//SYSIN    DD  *
 COPY                                             \PYGZhy{}
       DATASET(                                   \PYGZhy{}
       INCLUDE (                                  \PYGZhy{}
       HLQ.VIRTnnn.ARBO.**                    \PYGZhy{}
       HLQ.VIRTnnn.HTML.TRSF.**               \PYGZhy{}
  )                                               \PYGZhy{}
  )\PYGZhy{}
  RENAMEUNC(HLQ.VIRTxxx.**,HLQ.VIRTyyy.**) \PYGZhy{}
  TOL(ENQF)   \PYGZhy{}
  RECATALOG(*) \PYGZhy{}
  OUTDYNAM(SPT30B,3390) \PYGZhy{}
  OPTIMIZE(4)
/*
\end{sphinxVerbatim}

\sphinxstyleemphasis{Example job to copy current ARBO and HTML.TRSF user files}

\newpage

\index{Check list and precautions@\spxentry{Check list and precautions}}\index{All versions@\spxentry{All versions}!Check list and precautions@\spxentry{Check list and precautions}}\index{Check list and precautions@\spxentry{Check list and precautions}!All versions@\spxentry{All versions}}\ignorespaces 

\chapter{Check list and precautions}
\label{\detokenize{Migration_Guide:check-list-and-precautions}}\label{\detokenize{Migration_Guide:index-2}}
Before migration, you must check the following:-


\section{All versions}
\label{\detokenize{Migration_Guide:all-versions}}\begin{itemize}
\item {} 
You MUST backup and save a copy of your original configuration ARBO file as this file will be migrated to Virtel 4.61. This can be done using the example JCL procedure above. Alternatively, you can use a VIRCONF UNLOAD process to unload and reload to the new distributed V4.61 ARBO file. See “VIRCONF - Unloading a VIRARBO file” in your CURRENT Virtelxxx\_Installation\_User\_Guide.

\item {} 
If you are not using the new ‘option customization’ mode you will need to update your TCT to include the HTSET1=(OPTION-DEFAULT-COMPATIBILITY) TCT parameter. This maintains configuration compatibility with Virtel versions prior to V4.56 for users who have chosen to stay with the old “Compatibility Mode” of operation.

\item {} 
If you using some “custom” files or options files (“custom.js”, “customs.css”,custom “w2hparm.js” or any option related files) you MUST check that they are stored in a directory other than W2H-DIR. If not you must store your “custom” files in another directory (CLI-DIR for example).

\item {} 
Ensure that the directory on which “custom” file are stored is not the W2H-DIR directory as this directory is allocated to the VIRTxxx.SAMP.TRSF VSAM file. VIRTxxx.SAMP.TRSF is completely replaced as part of the migration procedure. Any customized elements will be lost or overwritten. See SAMPLIB(CUSTCSS) as a sample job to point the relevant transactions to a directory other than W2H-DIR. The suggested directory should be CLI-DIR. For further information on customization see the section “Virtel customization Modes” in the Virtel User Guide.

\end{itemize}

\begin{sphinxadmonition}{note}{Note:}
For customers who wish to run in ‘Option Customization’ mode you must run the ARBOLOAD job in the CNTL library with OPTIONS=YES. This will add the relevant transactions to support the /option/ pathname. Also, the SAMPLIB(CUSTCSS) job should be modified and run. It should only include the W2H-03P and CLI-03P transactions. Option customization mode still maintains a global w2hparm.js in CLI-DIR. This needs to refelcted in the ARBO VSAM file. Any w2hparm changes should be made to w2hparm.js and stored in CLI-DIR.
\end{sphinxadmonition}

\begin{sphinxadmonition}{note}{Note:}
w2hparm.js as shipped is now a dummy file and no longer includes any default settings. Your customized w2hparm.js should only include changes that are required by your installation. See “Global modification of web Access settings” in the Virtel User Guide.
\end{sphinxadmonition}

\index{Version older than 4.53@\spxentry{Version older than 4.53}!Check list and precautions@\spxentry{Check list and precautions}}\index{Check list and precautions@\spxentry{Check list and precautions}!Version older than 4.53@\spxentry{Version older than 4.53}}\ignorespaces 

\section{Upgrading from a version prior to 4.53}
\label{\detokenize{Migration_Guide:upgrading-from-a-version-prior-to-4-53}}\label{\detokenize{Migration_Guide:index-3}}
\begin{sphinxadmonition}{danger}{Danger:}
YOU MUST:
\end{sphinxadmonition}
\begin{itemize}
\item {} 
Add (or modify) the BFVSAM parameter in the VIRTCT to specify BFVSAM=32768. An “OPEN ERROR DC” on the SAMP.TRSF file will occur at STC startup if this is not done.

\item {} 
Check the content of the transaction with external name = “Administ” - W2H-20 - present under the WEB2HOST entry point and enter “ADMINVWM” in the “Output Scenario” field if the current value is different.

\end{itemize}

For performance YOU CAN:
\begin{itemize}
\item {} 
Modify the Shareoptions of the ARBO File from (4 3) to (2 3). To do this, use job ALTERSHR from the new VIRTnnn.SAMPLIB.

\item {} 
Increase the CISIZE of the data part of ALL existing TRSF file (except for the delivered SAMP.TRSF which is already correctly defined) to specify, CIZISE(32768) or CISIZE(16384) on the DATA part of the files. Use the job TRSFREOR from VIRTnnn.SAMPLIB.

\end{itemize}

\index{Version 4.53@\spxentry{Version 4.53}!Check list and precautions@\spxentry{Check list and precautions}}\index{Check list and precautions@\spxentry{Check list and precautions}!Version 4.53@\spxentry{Version 4.53}}\ignorespaces 

\section{Upgrading from a version prior to 4.54}
\label{\detokenize{Migration_Guide:upgrading-from-a-version-prior-to-4-54}}\label{\detokenize{Migration_Guide:index-4}}
In addition to the above instructions
\begin{itemize}
\item {} 
If the directory SCE-DIR does not exist in your environment, YOU MUST run the job MIGR454A found in the SAMPLIB library.

\item {} 
If you are not using the dynamic directory interface (DDI) remove redundant ARBO elements. See sample JCL below.

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
//\PYGZdl{}ARBODEL JOB 1,ARBODEL,CLASS=A,MSGCLASS=X,NOTIFY=\PYGZam{}SYSUID
//*
// SET LOAD=HLQ.VIRTnnn.LOADLIB
// SET ARBO=HLQ.VIRTnnn.ARBO
//*
//CONFIG  EXEC PGM=VIRCONF,PARM=\PYGZsq{}LOAD,REPL\PYGZsq{},REGION=2M
//STEPLIB  DD  DSN=\PYGZam{}LOAD,DISP=SHR
//SYSPRINT DD  SYSOUT=*
//SYSUDUMP DD  SYSOUT=*
//VIRARBO  DD  DSN=\PYGZam{}ARBO,DISP=SHR
//SYSIN      DD *
 DELETE TYPE=TRANSACT,ID=W2H\PYGZhy{}03A    Delete W2H\PYGZhy{}Global
 DELETE TYPE=TRANSACT,ID=W2H\PYGZhy{}03G    Delete W2H\PYGZhy{}Group
 DELETE TYPE=TRANSACT,ID=W2H\PYGZhy{}03U    Delete W2H\PYGZhy{}User
 DELETE TYPE=TRANSACT,ID=W2H\PYGZhy{}80A    Delete W2H\PYGZhy{}Global Upload
 DELETE TYPE=TRANSACT,ID=W2H\PYGZhy{}80G    Delete W2H\PYGZhy{}Group Upload
 DELETE TYPE=TRANSACT,ID=W2H\PYGZhy{}80U    Delete W2H\PYGZhy{}User Upload
 DELETE TYPE=TRANSACT,ID=CLI\PYGZhy{}03A    Delete CLI\PYGZhy{}Global
 DELETE TYPE=TRANSACT,ID=CLI\PYGZhy{}03G    Delete CLI\PYGZhy{}Group
 DELETE TYPE=TRANSACT,ID=CLI\PYGZhy{}03U    Delete CLI\PYGZhy{}User
 DELETE TYPE=TRANSACT,ID=CLI\PYGZhy{}80U    Delete CLI\PYGZhy{}User Upload
 DELETE TYPE=TRANSACT,ID=W2H\PYGZhy{}07     Delete DDI
 DELETE TYPE=TRANSACT,ID=W2H\PYGZhy{}66     Delete Capability token
 DELETE TYPE=SUBDIR,ID=GLB\PYGZhy{}DIR      Delete Global Sub\PYGZhy{}Dir
 DELETE TYPE=SUBDIR,ID=GRP\PYGZhy{}DIR      Delete Group Sub\PYGZhy{}Dir
 DELETE TYPE=SUBDIR,ID=USR\PYGZhy{}DIR      Delete User Sub\PYGZhy{}Dir
\end{sphinxVerbatim}

\index{Version 4.54@\spxentry{Version 4.54}!Check list and precautions@\spxentry{Check list and precautions}}\index{Check list and precautions@\spxentry{Check list and precautions}!Version 4.54@\spxentry{Version 4.54}}\ignorespaces 

\section{Upgrading from a version prior to 4.55}
\label{\detokenize{Migration_Guide:upgrading-from-a-version-prior-to-4-55}}\label{\detokenize{Migration_Guide:index-5}}\begin{itemize}
\item {} 
If you have developed JavaScript code which manipulates the status bar located at the bottom of the 3270 screen, YOU MUST refer to “Example: Modifying the text of the status bar” in “VIRTEL Web Access” document and review your changes.

\item {} 
You must modify the definition of the WEB2HOST entry point to reference the SCE-DIR in the field named DIRECTORY FOR SCENARIO. With Version V4.55 Virtel scenarios are now provided as objects in the SCE-DIR directory. Virtel scenarios located in the Virtel loadlib will no longer be maintained in future releases of Virtel. Customers who have users scenarios should consider migrating them to .390 objects using Virtel Studio and load them from SCE-DIR. Virtel will contain to still load scenarios from the Virtel loadlib providing the field name DIRECTORY FOR SCENARIO in the Entry point is blank.

\item {} 
If you are using customized Virtel Web Access (VWA) elements, you must add the following parameter in your VIRTCT: HTSET1=(OPTION-DEFAULT-COMPATIBILITY) unless you are planning to migrate to “option configuration’ mode. For further information on customization see the section “Virtel customization Modes” in the Virtel User Guide.

\end{itemize}

\index{Version 4.55@\spxentry{Version 4.55}!Check list and precautions@\spxentry{Check list and precautions}}\index{Check list and precautions@\spxentry{Check list and precautions}!Version 4.55@\spxentry{Version 4.55}}\ignorespaces 

\section{Upgrading from a version prior to 4.56}
\label{\detokenize{Migration_Guide:upgrading-from-a-version-prior-to-4-56}}\label{\detokenize{Migration_Guide:index-6}}
Run the ARBOMIGR job found in the SAMPLIB directory. This will add the transactions for the DOC-DIR directory.

\index{Version 4.56@\spxentry{Version 4.56}!Check list and precautions@\spxentry{Check list and precautions}}\index{Check list and precautions@\spxentry{Check list and precautions}!Version 4.56@\spxentry{Version 4.56}}\ignorespaces 

\section{Upgrading from a version prior to 4.57}
\label{\detokenize{Migration_Guide:upgrading-from-a-version-prior-to-4-57}}\label{\detokenize{Migration_Guide:index-7}}
None


\section{Upgrading from a version prior to 4.58}
\label{\detokenize{Migration_Guide:upgrading-from-a-version-prior-to-4-58}}
None


\section{Upgrading from a version prior to 4.59}
\label{\detokenize{Migration_Guide:upgrading-from-a-version-prior-to-4-59}}
None


\section{Upgrading from a version prior to 4.61}
\label{\detokenize{Migration_Guide:upgrading-from-a-version-prior-to-4-61}}
None

\newpage

\index{Running under VSE@\spxentry{Running under VSE}}\ignorespaces 

\chapter{Running under VSE}
\label{\detokenize{Migration_Guide:running-under-vse}}\label{\detokenize{Migration_Guide:index-8}}\begin{itemize}
\item {} 
Send a request to \sphinxhref{mailto:support@syspertec.com}{support@syspertec.com} for any missing JCL described above.

\item {} 
You MUST modify the VIRTEL startup JCL to increase the SIZE parameter from 40K to 80K (// EXEC VIR0000,SIZE=80K,DSPACE=2M).

\end{itemize}

\newpage

\index{What's new in this release.@\spxentry{What's new in this release.}}\ignorespaces 

\chapter{What’s new in this release}
\label{\detokenize{Migration_Guide:what-s-new-in-this-release}}\label{\detokenize{Migration_Guide:index-9}}
\sphinxstyleemphasis{VIRTEL Web Access:}
\begin{itemize}
\item {} 
Support for native browser clipboard API

\item {} 
Additional language and code page enhancements

\item {} 
Centralised user parameter feature.

\item {} 
Enhanced macro support features.

\item {} 
New structured field to allow enable extraction of security certificate.

\item {} 
Improved asynchronous support using SNASTAT indicator.

\item {} 
LOGFILE feature for VSE.

\item {} 
Hotspot enhancements including support for input fields.

\item {} 
Virplex enhancements

\end{itemize}

\sphinxstyleemphasis{VIRTEL Web Modernisation \& Integration:}
\begin{itemize}
\item {} 
Enhancements to COPY\$ to support multiple fields.

\item {} 
\$IF can now interrogate operator information area(OIA).

\item {} 
ACTION\$ SEND= and KEY= options.

\item {} 
Same scenario can be used for both input and output.

\end{itemize}

\sphinxstyleemphasis{Miscellaneous:}
\begin{itemize}
\item {} 
Improved VWA Settings messages.

\item {} 
Default MAXSOCKETS increased to 5000.

\item {} 
Japanese template support.

\item {} 
Show/Hide Virtel Tool bar option.

\item {} 
PA3 can be mapped to PGUP.

\item {} 
Virtel UP message VIR009I always written to syslog.

\item {} 
Message VIRT905I. Leading zeros removed.

\end{itemize}

Further details can be found in the “What’s new in Virtel V4.61” newsletter.



\renewcommand{\indexname}{Index}
\printindex
\end{document}